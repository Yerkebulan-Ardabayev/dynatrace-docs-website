---
title: Dynatrace Intelligence прогнозный анализ ИИ
source: https://www.dynatrace.com/docs/dynatrace-intelligence/reference/ai-models/forecast-analysis
scraped: 2026-03-01T21:09:09.550148
---

# Dynatrace Intelligence прогнозный анализ ИИ

# Dynatrace Intelligence прогнозный анализ ИИ

* Последнее Dynatrace
* Объяснение
* 14-минутное чтение
* Обновлено 28 января 2026 г.

Прогнозный анализ предсказывает будущие значения любого временного ряда числовых значений. Анализатор прогноза не ограничивается хранимыми данными метрик — вы можете принести свои собственные данные, использовать запрос метрики или выполнить запрос данных, который приводит к временному ряду числовых значений.

Анализ не зависит от распределения входных данных. Прогноз рассчитывается без каких-либо предположений о конкретном распределении данных и работает как для симметричных, так и для несимметричных распределений.

Вы можете запустить прогнозный анализ из своей [тетради](/docs/dynatrace-intelligence/dynatrace-intelligence-integrations/davis-for-notebooks "Запустить анализ ИИ в Dynatrace тетради.").

## Входные данные анализатора

## Методология анализа

Когда вы запускаете прогнозный анализ, временной ряд отправляется подходящему прогнозисту, который производит прогноз. Затем оценивается [качество прогноза](#качество), и прогноз и оценка возвращаются в качестве результатов анализа.

![Методология анализа](https://dt-cdn.net/images/analyser-methodology-1132-7fef138e18.png)

### Выбор алгоритма

Анализ использует один из двух прогнозистов:

* [Прогнозист выборки](#выборка)
* [Прогнозист линейной экстраполяции](#линейная-экстраполяция)

Прогнозист выборки используется, если дисперсия **линейного временного интервала истории** больше максимального значения пары `0,1` и `0,001 × дисперсия входного временного ряда`. Линейный временной интервал истории — это X самых недавних точек данных, где X находится в диапазоне от `14` до `20`.

В любом другом случае (включая случай, когда обучение прогнозиста выборки терпит неудачу) используется прогнозист линейной экстраполяции.

## Прогнозист выборки

Прогнозист выборки обеспечивает многоступенчатые прогнозы на основе сезонных закономерностей. Его архитектура показана на изображении ниже.

![Общий алгоритм прогнозиста](https://dt-cdn.net/images/generic-forecaster-analyser-940-f6f15f47fc.png)

Сначала к входному временному ряду применяется преобразователь пути, а затем прогнозист обучается на нем. Если полученная модель недействительна, вместо нее используется прогнозист линейной экстраполяции. Если модель действительна, пути выборки создаются сезонным прогнозистом. Эти пути затем обратно преобразуются перед применением квантилей на каждом временном шаге.

### Сезонные закономерности

Прогнозист всегда ищет различные сезонные закономерности во входном временном ряду. Входной временной ряд должен содержать достаточно данных, чтобы обнаружить сезонность надежно.

| Сезонная закономерность | Требуемая продолжительность временного ряда |
| --- | --- |
| 1 час | 2+ часа |
| 1 день (24 часа) | 7+ дней |
| 1 неделя (7 дней) | 14+ дней |
| День недели | 7+ дней |
| Время дня | 2+ дня |
| Минута часа | 2+ часа |

Помимо этих естественных закономерностей, прогнозист ищет любые повторяющиеся закономерности во временном ряду, разбивая их на основе определенного временного окна.

### Прогноз шаг за шагом

1. Сезонный прогнозист оценивает квартили распределения временного ряда на отметке времени следующей точки данных.

   ![Многоступенчатый алгоритм прогнозирования - шаг 1](https://dt-cdn.net/images/multi-step-prediction-1-547-f8edff4ed6.png)
2. Распределение для значения на следующем временном шаге оценивается из квартилей. Колоколообразная кривая на изображении приведена для иллюстрации и не представляет собой распределение, используемое в прогнозисте выборки.

   ![Многоступенчатый алгоритм прогнозирования - шаг 2](https://dt-cdn.net/images/multi-step-prediction-2-553-d30631c97f.png)
3. Значение для следующего временного шага выбирается из распределения, полученного на шаге 2.

   ![Многоступенчатый алгоритм прогнозирования - шаг 3](https://dt-cdn.net/images/multi-step-prediction-3-565-fe5b638654.png)
4. Значение, полученное на шаге 3, теперь считается частью временного ряда, и прогнозист повторяет шаги 1-4, пока не достигнет горизонта прогноза.

   ![Многоступенчатый алгоритм прогнозирования - шаг 4](https://dt-cdn.net/images/multi-step-prediction-4-559-33e251190f.png)
5. Предсказанные точки данных образуют один путь выборки (показан красным на изображении ниже).

   ![Многоступенчатый алгоритм прогнозирования - шаг 5](https://dt-cdn.net/images/multi-step-prediction-5-1051-f971c5a471.png)
6. Прогнозист повторяет этот процесс N раз, создавая несколько путей выборки.

   ![Многоступенчатый алгоритм прогнозирования - шаг 6](https://dt-cdn.net/images/multi-step-prediction-6-1049-931db96b7b.png)
7. Прогнозист берет искомый квантиль на каждом временном шаге, образуя интервал прогнозирования (показан светло-фиолетовым на изображении ниже).

   ![Многоступенчатый алгоритм прогнозирования - шаг 7](https://dt-cdn.net/images/multi-step-prediction-7-1049-68f5d98212.png)

## Прогнозист линейной экстраполяции

Прогнозист линейной экстраполяции — это алгоритм, который использует [простую линейную регрессию](https://ru.wikipedia.org/wiki/Простая_линейная_регрессия) для нахождения лучшей линии, проходящей через набор точек данных, и продления этой линии в будущее. Количество точек данных, используемых для обучения прогнозиста, определяется следующим образом

![Исторические точки данных формула](https://dt-cdn.net/images/nhistory-286-b4c31416bc.webp)

где `n` — длина входного временного ряда.

Для обучения прогнозиста линейной экстраполяции `nHistory` должно содержать **не менее 14** не-NULL точек данных.

Для простоты мы рассчитываем доверительный интервал, предполагая, что остатки распределены нормально, как показано ниже:

![Распределение остатков](https://dt-cdn.net/images/formula-1-280-ecc49db59c.png)

где tcrit — 95-й процентиль [распределения Стьюдента](https://ru.wikipedia.org/wiki/Распределение_Стьюдента). Стандартная ошибка равна

![Стандартная ошибка](https://dt-cdn.net/images/formula-2-540-88b340f223.png)

где `XÌ` — среднее значение x, суммы берутся по обучающим данным, а `s` — выборочная стандартная ошибка последних `nHistory` точек входного временного ряда.

![Прогноз линейной экстраполяции](https://dt-cdn.net/images/linear-extrapolation-forecaster-976-e7c59a3803.png)

## Оценка качества прогноза

После генерации прогнозов мы оцениваем их качество, чтобы обнаружить потенциальные численные проблемы. Для оценки качества прогноза анализатор сравнивает стандартное отклонение прогноза с стандартным отклонением входного временного ряда (SDinput).

Стандартное отклонение прогноза (SDprediction) рассчитывается как максимальное стандартное отклонение нижней и верхней границ прогнозного интервала, а также стандартное отклонение точечного прогноза.

Чтобы учесть допустимые тенденции в прогнозах, анализатор использует масштабный коэффициент (SCF). Когда длина прогнозных данных (Nprediction) велика по сравнению с входным временным рядом (Ninput), мы допускаем большее стандартное отклонение прогноза, чем для небольшого прогноза.

Дополнительным входом в масштабный коэффициент является **Фактор стандартного отклонения** (SDfactor) со значением по умолчанию `100`. Масштабный коэффициент рассчитывается следующим образом:

![Масштабный коэффициент](https://dt-cdn.net/images/formula-4-341-b9b7afb192.png)

Прогноз оценивается по следующему условию:

![Критерий оценки](https://dt-cdn.net/images/formula-5-298-ca5993874c.png)

Если условие удовлетворено, прогноз оценивается как действительный. В противном случае прогноз считается недействительным.

## Запись DQL запросов для прогнозирования

При использовании прогнозного анализа в одной из своих [тетрадей](/docs/analyze-explore-automate/dashboards-and-notebooks/notebooks "Анализируйте, визуализируйте и делитесь идеями из ваших данных наблюдаемости — все в одном совместном, настраиваемом рабочем пространстве.") вы можете записать любой DQL запрос, который возвращает данные временного ряда в [формате записи временного ряда](#формат-записи-временного-ряда).

* Если данные не соответствуют одному из вышеуказанных форматов, прогнозный анализ завершается неудачно.
* Каждое числовое значение в массиве данных должно иметь хотя бы одну десятичную точку (например, `1,0`).

### Примеры запросов

Примеры запросов DQL ниже возвращают допустимые ответы.

* Команда [`timeseries`](/docs/platform/grail/dynatrace-query-language/commands/metric-commands#timeseries "DQL metric commands") DQL всегда возвращает ответ в формате записи временного ряда.
* Вы также можете писать запросы, используя команду [`fetch`](/docs/platform/grail/dynatrace-query-language/commands/data-source-commands#fetch "DQL data source commands") вместе с командой [`summarize`](/docs/platform/grail/dynatrace-query-language/commands/aggregation-commands#summarize "DQL aggregation commands"). Эти запросы будут возвращать данные в формате единичного значения. Все записи должны иметь одинаковое расстояние (интервал) между ними. Это гарантировано при использовании команды `summarize`, поскольку она будет агрегировать и группировать значения для определенных временных интервалов. Каждая запись должна иметь поле с именем `value` типа double (см. [Формат единичного значения](#single-value-format) для получения дополнительной информации).

#### DQL команда timeseries

Команда DQL `timeseries` возвращает результат в формате записи временного ряда.

```
timeseries avg(dt.cloud.aws.rds.cpu.usage)
```

```
timeseries avg(dt.host.cpu.usage), interval: 1h, by: {dt.entity.host}, from: -3d
```

```
timeseries avg(dt.host.disk.used), interval: 15m, by: {dt.entity.disk}, from: now()-2d, to: now()
```

#### DQL запрос fetch и summarize

Запрос DQL, использующий команды `fetch` и `summarize`, возвращает результат в формате единичного значения.

```
fetch logs



| summarize value = count(), by: {timestamp = bin(timestamp, 1m)}
```

```
fetch events, from: -3d



| filter event.kind == "DAVIS_PROBLEM"



| summarize count(), by:{bin(timestamp, 1h), alias: timestamp}



| fieldsRename value=`count()`
```

#### DQL команда data

Вы можете использовать команду DQL [`data`](/docs/platform/grail/dynatrace-query-language/commands/data-source-commands#data "DQL data source commands") для генерации прогноза для своих собственных данных. Любые данные можно использовать, пока они соответствуют одному из двух форматов.

Следующая команда DQL `data` возвращает результат в формате записи временного ряда.

```
data record(



timeframe=timeframe(from: "2023-03-10T00:00:00.000Z", to: "2023-03-20T00:00:00.000Z"),



interval=duration(1, "h"),



`dt.entity.disk`="DISK-A",



data=array(



0.6096,  1.1460,  1.2770,  2.3939,  2.2370,  2.6167,  1.2414,



3.0011,  2.6842,  2.2949,  1.4132,  1.7749,  1.6472,  0.5800,



0.2937,  0.8003, -0.0277, -0.4114, -0.6020, -0.5019,  0.2261,



0.9875,  0.9601,  1.7021,  2.7538,  3.2475,  3.4133,  3.6173,



4.2067,  4.8679,  4.4176,  4.7181,  5.1461,  5.0898,  4.9806,



3.7390,  3.3774,  2.4088,  2.6754,  2.7673,  1.7551,  1.9633,



1.5918,  2.4702,  2.5765,  2.8267,  3.4773,  3.8841,  5.4904,



5.6528,  5.6221,  7.0052,  6.7039,  8.8618,  7.2853,  7.5175,



7.2200,  7.5092,  7.2807,  6.3166,  6.4115,  5.1241,  5.2359,



5.6137,  4.5477,  5.2841,  4.8689,  6.1404,  4.3398,  4.7527,



5.6016,  6.7526,  7.0054,  8.4009,  7.3848,  9.0195,  9.6028,



10.0891, 10.3137,  9.9700,  8.9944,  9.4415,  9.4228,  8.1233,



8.5862,  8.4357,  8.0413,  7.1731,  6.9146,  6.6773,  6.7132,



7.0178,  7.4880,  7.1100,  9.5785,  8.6518,  9.2125, 10.2238,



11.4487, 11.1977, 11.3190, 12.5375, 11.9569, 12.4308, 11.7920,



12.6200, 12.0601, 10.5243, 11.3639,  9.8979, 10.9811, 10.1095,



10.2067,  9.6794,  9.8522,  9.0232,  9.5124, 10.5887, 11.0222,



10.8741, 12.0817, 13.3625, 13.1324, 13.5550, 13.7834, 14.1806,



15.5751, 14.7827, 13.9171, 14.5871, 14.5652, 13.4159, 13.6262,



12.3931, 11.9045, 12.2807, 10.9243, 12.5514, 11.0550, 12.1066,



12.1569, 12.9026, 12.9851, 13.5527, 14.9463, 14.5251, 15.6653,



17.1333, 17.5200, 17.4643, 17.3053, 16.9866, 16.6806, 16.4379,



16.2866, 16.9108, 15.3212, 15.4509, 14.5511, 14.8598, 15.4171,



14.2590, 14.5359, 14.4026, 15.5683, 14.8414, 15.5065, 15.7033,



17.1206, 17.4528, 17.5131, 19.2782, 18.6581, 20.6962, 20.4152,



18.5865, 19.3483, 18.8283, 18.9540, 17.4941, 17.8047, 18.7973,



17.1900, 16.1135, 17.0345, 17.1779, 16.6910, 16.8454, 16.9357,



17.3166, 17.9157, 18.8126, 18.8176, 19.9470, 20.5230, 21.2858,



22.2686, 22.2769, 21.1908, 21.8713, 21.2280, 20.8140, 21.7997,



20.5656, 20.2129, 20.1171, 19.6284, 18.9140, 18.8314, 19.1833,



18.4992, 19.0013, 20.0113, 20.4361, 20.2264, 21.7505, 22.0324,



22.7636, 22.3307, 24.1297, 24.1968, 24.0366, 23.8212, 24.5346,



24.2898, 24.0449, 23.8067, 22.9443, 23.3615, 22.5078, 22.1239,



21.9639, 21.9736, 21.8018, 21.5930, 21.5247, 21.7674, 22.7781,



23.6532, 23.1769



)



)
```

### Формат записи временного ряда

В формате записи временного ряда временные ряды определяются как **простые массивы double**.

* Может быть несколько массивов на одну запись и несколько отдельных записей.
* Допустимый ответ временного ряда содержит только записи временного ряда.

Запись временного ряда должна содержать:

* Точно одно поле типа timeframe, которое содержит начало и конец [метки времени](/docs/platform/grail/dynatrace-query-language/data-types#timestamp "Список DQL типов данных.")
* Точно одно поле типа [duration](/docs/platform/grail/dynatrace-query-language/data-types#duration "Список DQL типов данных.")
* Одно или несколько полей типа `array`, содержащих только [double](/docs/platform/grail/dynatrace-query-language/data-types#double "Список DQL типов данных.") или [long](/docs/platform/grail/dynatrace-query-language/data-types#long "Список DQL типов данных.") значения и null

  + Все числовые массивы должны иметь столько же значений, сколько есть шагов времени шириной duration между началом и концом timeframe `(end-start)/duration`
* Поля в записи временного ряда, кроме timeframe, duration и числовых массивов данных, считаются измерениями

DQL ответ в формате записи временного ряда

Следующий JSON описывает структуру формата записи.

* Типы полей записи указаны в разделе `types`.
* Фактическое значение поля типа [duration](/docs/platform/grail/dynatrace-query-language/data-types#duration "Список DQL типов данных.") указано в наносекундах.

```
{



"records": [



{



"timeframe": {



"start": "2023-01-01T00:00Z",



"end": "2023-01-01T00:05Z"



},



"firstTimeSeries": [1.0, 3.0, 5.0, 7.0, 9.0],



"secondTimeSeries": [0.0, 2.0, 4.0, 6.0, 8.0],



"interval": "60000000000",



"dt.metricKey": "host.cpu.usage"



)



],



"types": [



{



"indexRange": [0, 0],



"mappings": {



"dt.entity.host": { "type": "string" },



"dt.metricKey": { "type": "string" },



"timeframe": { "type": "timeframe" },



"interval": { "type": "duration" },



"firstTimeSeries": {



"type": "array",



"types": [



{



"indexRange": [0, 4],



"mappings":?



"element": { "type": "double" }



}



]



},



"secondTimeSeries":?



"type": "array",?



"types":?



{



"indexRange": [0, 4],?



"mappings":?



"element": { "type": "double" }



?



]



?



?



]



?



]



}
```

### Формат единичного значения

В формате единственного значения каждая запись указывает одно значение в временном ряду. Допускается только одно числовое поле на запись.

Запись в допустимом формате единственного значения должна содержать:

* Точно одно поле с именем `value` типа [double](/docs/platform/grail/dynatrace-query-language/data-types#double "Список DQL типов данных.")
  или [long](/docs/platform/grail/dynatrace-query-language/data-types#long "Список DQL типов данных.")
* Информацию о времени в виде:

  + поля с именем `timestamp` типа [timestamp](/docs/platform/grail/dynatrace-query-language/data-types#timestamp "Список DQL типов данных.")
  + поля с именем `timeframe` типа `timeframe`, содержащего начало и конец [timestamp](/docs/platform/grail/dynatrace-query-language/data-types#timestamp "Список DQL типов данных.")

#### Интервал

Наименьший допустимый интервал (временная разница между двумя записями) составляет одну минуту.

* Интервал можно указать, добавив поле `interval` типа [duration](/docs/platform/grail/dynatrace-query-language/data-types#duration "Список DQL типов данных.").
* Это поле также можно назвать `frequency`, хотя `interval` имеет приоритет, если оба указаны.
* Если `interval`/`frequency` задан, он должен иметь одинаковое значение в каждой записи.

#### Измерения

Измерения можно добавлять в виде дополнительных свойств.

* Дополнительные свойства могут иметь только строковые значения.
* Серия определяется на основе уникальных значений для каждого измерения. Записи с одинаковыми измерениями (строковые свойства) считаются принадлежащими одной и той же временной серии.

DQL ответ в формате единственного значения

Следующий JSON описывает структуру формата единственного значения.

* Типы полей записи указаны в разделе `types`.
* Фактическое значение поля типа [duration](/docs/platform/grail/dynatrace-query-language/data-types#duration "Список DQL типов данных.") указано в наносекундах.

```
{



"records": [



{



"timestamp": "2019-05-14T08:01Z",



"interval": "60000000000",



"dt.metricKey": "host.cpu.usage",



"value": 0.0



},



{



"timestamp": "2019-05-14T08:02Z",



"interval": "60000000000",



"dt.metricKey": "host.cpu.usage",



"value": 2.0



},



{



"timestamp": "2020-05-14T08:03Z",



"interval": "60000000000",



"dt.metricKey": "host.cpu.usage",



"value": 4.0



}



],



"types": [



{



"indexRange": [0, 2],



"typeMappings": {



"timestamp": { "type": "timestamp" },



"interval": { "type": "duration" },



"dt.metricKey": { "type": "string" },



"value": { "type": "double" }



}



)



]



}
```

```
{



"records": [



{



"timeframe": {



"start": "2019-12-09T12:00Z",



"end": "2019-12-09T13:00Z"



},



"interval": "3600000000000",



"dt.metricKey": "host.cpu.usage",



"dt.entity.host": "HOST-A",



"value": 0.0



},



{



"timeframe": {



"start": "2019-12-09T13:00Z",



"end": "2019-12-09T14:00Z"



},



"interval": "3600000000000",



"dt.metricKey": "host.cpu.usage",



"dt.entity.host": "HOST-A",



"value": 2.0



}



],



"types": [



{



"indexRange": [0, 2],



"typeMappings": {



"timeframe": { "type": "timeframe" },



"interval": { "type": "duration" },



"dt.metricKey": { "type": "string" },



"dt.entity.host": { "type": "string" },



"value": { "type": "double" }



)



)



]



}
```

## Примеры прогнозов

Качество прогноза зависит от качества данных, которые вы подаете в анализатор, и ширины временного интервала, который вы хотите предсказать. Лучшие результаты получаются для короткого временного интервала из данных без шума и с четкими сезонными закономерностями. Вот некоторые примеры прогнозов для различных типов данных.

Нет сезонности, нисходящая тенденция

Этот пример показывает прогноз для метрики доступного диска. В данных нет сезонной закономерности, и есть нисходящая тенденция. Здесь используется [линейный экстраполятор](#linear-extrapolation), который производит широкий интервал прогноза.

![Прогноз - емкость диска](https://dt-cdn.net/images/disk-capacity-notebook-forecast-result-1541-792e2fa2cf.png)

Сезонные данные со шумом

Этот пример показывает прогноз для временного интервала 1,5 часа. Обратите внимание, что интервал прогноза не гладкий, отражая шум в входных данных.

![Сезонный прогноз со шумом](https://dt-cdn.net/images/seasonal-forecast-with-noise-result-1731-9d50baa8e5.png)

Сезонные данные со шумом на расширенном временном интервале

Этот пример показывает прогноз для временного интервала 6 часов. Помимо обширного временного интервала прогноза, сами данные имеют некоторый шум и нисходящую тенденцию, которые влияют на качество прогноза - интервал прогноза становится все шире и шире, когда он продвигается в будущее.

![Сезонный прогноз со шумом за 6-часовой временной интервал](https://dt-cdn.net/images/seasonal-forecast-with-noise-result-6h-1730-75d0e7ceb1.png)
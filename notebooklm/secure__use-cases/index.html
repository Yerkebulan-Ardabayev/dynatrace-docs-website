
<!doctype html>
<html lang="ru" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è Dynatrace Managed —Å AI-–ø–æ–º–æ—â–Ω–∏–∫–æ–º">
      
      
        <meta name="author" content="Yerkebulan Ardabayev">
      
      
        <link rel="canonical" href="https://yerkebulan-ardabayev.github.io/dynatrace-docs-website/notebooklm/secure__use-cases/">
      
      
      
      
        
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Dynatrace Documentation: secure/use-cases - Dynatrace Managed - –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CJetBrains+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"JetBrains Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="deep-purple" data-md-color-accent="cyan">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#dynatrace-documentation-secureuse-cases" class="md-skip">
          –ü–µ—Ä–µ–π—Ç–∏ –∫ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏—é
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="–í–µ—Ä—Ö–Ω–∏–π –∫–æ–ª–æ–Ω—Ç–∏—Ç—É–ª">
    <a href="../.." title="Dynatrace Managed - –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è" class="md-header__button md-logo" aria-label="Dynatrace Managed - –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 1h16a1 1 0 0 1 1 1v4a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1m0 8h16a1 1 0 0 1 1 1v4a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1v-4a1 1 0 0 1 1-1m0 8h16a1 1 0 0 1 1 1v4a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1v-4a1 1 0 0 1 1-1M9 5h1V3H9zm0 8h1v-2H9zm0 8h1v-2H9zM5 3v2h2V3zm0 8v2h2v-2zm0 8v2h2v-2z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Dynatrace Managed - –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Dynatrace Documentation: secure/use-cases
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="deep-purple" data-md-color-accent="cyan"  aria-label="–°–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="–°–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent="cyan"  aria-label="–¢—ë–º–Ω–∞—è —Ç–µ–º–∞"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="–¢—ë–º–Ω–∞—è —Ç–µ–º–∞" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="–ü–æ–∏—Å–∫" placeholder="–ü–æ–∏—Å–∫" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="–ü–æ–∏—Å–∫">
        
        <button type="reset" class="md-search__icon md-icon" title="–û—á–∏—Å—Ç–∏—Ç—å" aria-label="–û—á–∏—Å—Ç–∏—Ç—å" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–∏—Å–∫–∞
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/Yerkebulan-Ardabayev/dynatrace-docs-website" title="–ü–µ—Ä–µ–π—Ç–∏ –∫ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—é" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    dynatrace-docs-website
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="–í–∫–ª–∞–¥–∫–∏" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  üè† –ì–ª–∞–≤–Ω–∞—è

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../managed/" class="md-tabs__link">
          
  
  
  üéØ Managed

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../common/" class="md-tabs__link">
          
  
  
  üìä –û–±—â–µ–µ

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../saas-reference/" class="md-tabs__link">
        
  
  
    
  
  üìñ SaaS

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../ai/groq/" class="md-tabs__link">
        
  
  
    
  
  ü§ñ AI

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="–ù–∞–≤–∏–≥–∞—Ü–∏—è" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Dynatrace Managed - –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è" class="md-nav__button md-logo" aria-label="Dynatrace Managed - –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 1h16a1 1 0 0 1 1 1v4a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1m0 8h16a1 1 0 0 1 1 1v4a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1v-4a1 1 0 0 1 1-1m0 8h16a1 1 0 0 1 1 1v4a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1v-4a1 1 0 0 1 1-1M9 5h1V3H9zm0 8h1v-2H9zm0 8h1v-2H9zM5 3v2h2V3zm0 8v2h2v-2zm0 8v2h2v-2z"/></svg>

    </a>
    Dynatrace Managed - –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Yerkebulan-Ardabayev/dynatrace-docs-website" title="–ü–µ—Ä–µ–π—Ç–∏ –∫ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—é" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    dynatrace-docs-website
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    üè† –ì–ª–∞–≤–Ω–∞—è
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    üéØ Managed
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    üéØ Managed
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../managed/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    –û–±–∑–æ—Ä
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../managed/installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    –£—Å—Ç–∞–Ω–æ–≤–∫–∞
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../managed/configuration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    –ù–∞—Å—Ç—Ä–æ–π–∫–∞
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../managed/operations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    –û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../managed/update/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    –û–±–Ω–æ–≤–ª–µ–Ω–∏—è
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../managed/security/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../managed/backup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    –ë—ç–∫–∞–ø
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../managed/managed-cluster/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    –ö–ª–∞—Å—Ç–µ—Ä
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../managed/license/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    –õ–∏—Ü–µ–Ω–∑–∏—è
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../managed/dynatrace-api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    API
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../managed/observe/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../managed/ingest-from/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    üìä –û–±—â–µ–µ
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    üìä –û–±—â–µ–µ
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../common/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    –û–±–∑–æ—Ä
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../saas-reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    üìñ SaaS
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ai/groq/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ü§ñ AI
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#source-ai-remediation-github-copilotmd" class="md-nav__link">
    <span class="md-ellipsis">
      
        Source: ai-remediation-github-copilot.md
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="dynatrace-documentation-secureuse-cases">Dynatrace Documentation: secure/use-cases<a class="headerlink" href="#dynatrace-documentation-secureuse-cases" title="Permanent link">&para;</a></h1>
<p>Generated: 2026-02-17</p>
<p>Files combined: 17</p>
<hr />
<h2 id="source-ai-remediation-github-copilotmd">Source: ai-remediation-github-copilot.md<a class="headerlink" href="#source-ai-remediation-github-copilotmd" title="Permanent link">&para;</a></h2>
<hr />
<p>title: Automate vulnerability remediation with GitHub Copilot and Dynatrace
source: https://www.dynatrace.com/docs/secure/use-cases/ai-remediation-github-copilot
scraped: 2026-02-17T04:58:48.943181</p>
<hr />
<h1 id="automate-vulnerability-remediation-with-github-copilot-and-dynatrace">Automate vulnerability remediation with GitHub Copilot and Dynatrace<a class="headerlink" href="#automate-vulnerability-remediation-with-github-copilot-and-dynatrace" title="Permanent link">&para;</a></h1>
<h1 id="automate-vulnerability-remediation-with-github-copilot-and-dynatrace_1">Automate vulnerability remediation with GitHub Copilot and Dynatrace<a class="headerlink" href="#automate-vulnerability-remediation-with-github-copilot-and-dynatrace_1" title="Permanent link">&para;</a></h1>
<ul>
<li>Latest Dynatrace</li>
<li>Tutorial</li>
<li>Updated on Jan 28, 2026</li>
<li>Preview</li>
</ul>
<h2 id="overview">Overview<a class="headerlink" href="#overview" title="Permanent link">&para;</a></h2>
<p>Not every code issue needs to be fixed. Dynatrace helps development teams focus on what matters by verifying vulnerabilities with runtime context and streamlining remediation through <a href="https://docs.github.com/en/copilot">GitHub Copilot√Ø¬ª¬ø</a>.
This use case demonstrates how to prioritize and remediate vulnerabilities that impact production applications. It supports two implementation paths, depending on where you want to triage and trigger fixes√¢¬Ä¬îboth powered by Dynatrace and GitHub integrations.</p>
<h2 id="challenge">Challenge<a class="headerlink" href="#challenge" title="Permanent link">&para;</a></h2>
<p>In complex codebases, the number of detected vulnerabilities can be overwhelming. While AI agents like GitHub Copilot can assist with automated remediation, human review and approval are still essential. Code changes may also introduce breaking changes, adding to development overhead. This makes effective prioritization and triaging of vulnerabilities√¢¬Ä¬îsupported by rich context√¢¬Ä¬îcritical to maintaining velocity and stability.</p>
<h2 id="solution">Solution<a class="headerlink" href="#solution" title="Permanent link">&para;</a></h2>
<p>Dynatrace integrates with GitHub by enriching <a href="https://docs.github.com/en/code-security/dependabot/dependabot-alerts/about-dependabot-alerts">Dependabot alerts√Ø¬ª¬ø</a> with runtime context and <a href="/docs/secure/application-security/vulnerability-analytics" title="Monitor, visualize, analyze, and remediate third-party and code-level vulnerabilities, track the remediation progress, and create monitoring rules.">Runtime Vulnerability Analytics (RVA)</a> validation. This enables GitHub Copilot to take targeted action:</p>
<ul>
<li><strong>Confirmed vulnerabilities are automatically fixed</strong>: GitHub Copilot opens a pull request with a secure fix for each vulnerability validated and confirmed by Dynatrace.</li>
</ul>
<p>Example</p>
<p><img alt="GitHub Copilot coding agent applies fixes" src="https://dt-cdn.net/images/30603523-539a-49f2-a8ea-bdecf457877f-1056-0f4f097777.png" />
* <strong>Unconfirmed vulnerabilities are dismissed with a reason</strong>: If Dynatrace validated a vulnerability at runtime and the vulnerable library isn't loaded or the vulnerable function isn't in use, the vulnerability is not confirmed, and GitHub Copilot dismisses the alert and explains why.</p>
<p>Example</p>
<p><img alt="GitHub Copilot coding agent automatically dismisses unconfirmed vulnerabilities" src="https://dt-cdn.net/images/5ef668ff-9db4-4027-a740-3c9bbe7cb836-1061-4c1d7cd672.png" /></p>
<p>This reduces noise and developer effort by ensuring only relevant vulnerabilities are remediated.</p>
<p>You can implement this solution in two ways, depending on where you want to triage vulnerabilities and trigger remediation:</p>
<ul>
<li><a href="#github-based"><strong>GitHub-based workflow</strong></a>: Uses the <a href="/docs/dynatrace-intelligence/dynatrace-intelligence-integrations/dynatrace-mcp" title="Learn about the Dynatrace MCP server and how you can connect to it.">Dynatrace MCP Server</a> integrated with the <a href="https://docs.github.com/en/copilot/concepts/agents/coding-agent/about-coding-agent">GitHub Copilot coding agent√Ø¬ª¬ø</a> or as a Dynatrace Security <a href="https://docs.github.com/en/copilot/how-tos/use-copilot-agents/coding-agent/create-custom-agents">custom agent√Ø¬ª¬ø</a>, triggered by a <a href="https://docs.github.com/en/actions/concepts/workflows-and-actions/workflows">GitHub Actions workflows√Ø¬ª¬ø</a>.</li>
<li><a href="#dynatrace-driven"><strong>Dynatrace-driven workflow</strong></a>: Uses <a href="/docs/analyze-explore-automate/workflows" title="Automate IT processes with Dynatrace Workflows√¢¬Ä¬îreact to events, schedule tasks, and connect services.">Dynatrace <img alt="Workflows" src="https://dt-cdn.net/images/workflows-1024-b5708f3cf9.webp" title="Workflows" /> <strong>Workflows</strong></a> as the trigger and processing engine, with <a href="https://docs.github.com/en/copilot">generative AI√Ø¬ª¬ø</a> as the AI-driven analysis tool.</li>
</ul>
<h2 id="github-based-workflow">GitHub-based workflow<a class="headerlink" href="#github-based-workflow" title="Permanent link">&para;</a></h2>
<p>This scenario uses GitHub Actions workflow to detect new critical vulnerabilities and trigger GitHub Copilot to fix only those verified by Dynatrace.</p>
<h3 id="how-it-works-github-based-workflow">How it works (GitHub-based workflow)<a class="headerlink" href="#how-it-works-github-based-workflow" title="Permanent link">&para;</a></h3>
<p><img alt="GitHub-based - how it works" src="https://dt-cdn.net/images/image-60-2043-f1d3d4c1d0.png" /></p>
<ol>
<li><a href="https://docs.github.com/en/code-security/getting-started/dependabot-quickstart-guide">GitHub Dependabot√Ø¬ª¬ø</a> detects vulnerabilities in code dependencies.</li>
<li>A GitHub workflow runs on a configured period to check for new critical vulnerabilities.</li>
<li>If new vulnerabilities are found, a GitHub issue is created and assigned to GitHub Copilot.</li>
<li>GitHub Copilot verifies each vulnerability by querying Dynatrace MCP for runtime context and RVA confirmation.</li>
<li>Confirmed vulnerabilities are remediated in a pull request; unconfirmed ones are dismissed in Dependabot with a reason.</li>
<li>Developers review and merge the pull request.</li>
</ol>
<h3 id="get-started-github-based-workflow">Get started (GitHub-based workflow)<a class="headerlink" href="#get-started-github-based-workflow" title="Permanent link">&para;</a></h3>
<p>To get started, follow the steps below.</p>
<ol>
<li>
<p>Set up Dynatrace</p>
</li>
<li>
<p>Set up monitoring with <a href="/docs/platform/oneagent" title="Learn the monitoring capabilities of OneAgent.">Dynatrace OneAgent</a> for the production services.</p>
</li>
<li><a href="/docs/secure/application-security/vulnerability-analytics#start" title="Monitor, visualize, analyze, and remediate third-party and code-level vulnerabilities, track the remediation progress, and create monitoring rules.">Enable Runtime Vulnerability Analytics</a>.</li>
<li>
<p><a href="/docs/manage/identity-access-management/access-tokens-and-oauth-clients/platform-tokens" title="Create personalised platform tokens to access Dynatrace services via the API in your user context.">Create a Dynatrace platform token</a> with the proper permissions to both access the MCP server and to query various event types.</p>
</li>
<li>
<p>List permissions</p>
</li>
<li>
<p><code>mcp-gateway:servers:invoke</code></p>
</li>
<li><code>mcp-gateway:servers:read</code></li>
<li><code>davis-copilot:conversations:execute</code></li>
<li><code>davis-copilot:nl2dql:execute</code></li>
<li><code>davis-copilot:dql2nl:execute</code></li>
<li><code>davis-copilot:document-search:execute</code></li>
<li><code>storage:entities:read</code></li>
<li><code>storage:smartscape:read</code></li>
<li><code>storage:buckets:read</code></li>
<li><code>storage:bucket-definitions:read</code></li>
<li><code>storage:security.events:read</code></li>
<li>
<p><a href="/docs/whats-new/preview-releases#mcp-server" title="Learn about our Preview releases and how you can participate in them.">Request access to Dynatrace MCP Server</a>.</p>
</li>
<li>
<p>Prepare your GitHub repository</p>
</li>
<li>
<p><a href="https://docs.github.com/en/code-security/getting-started/dependabot-quickstart-guide#enabling-dependabot-for-your-repository">Enable Dependabot√Ø¬ª¬ø</a>. This ensures GitHub can detect vulnerabilities in dependencies and raise alerts.</p>
</li>
<li>
<p><a href="https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/managing-your-personal-access-tokens#creating-a-fine-grained-personal-access-token">Generate a fine-grained personal access token (PAT)√Ø¬ª¬ø</a> with the proper permissions.</p>
</li>
<li>
<p>List permissions</p>
</li>
<li>
<p><strong>Read</strong>:</p>
<ul>
<li><code>Variables</code></li>
<li><code>Administration</code></li>
<li><code>Dependabot secrets</code></li>
<li><code>Environments</code></li>
<li><code>Metadata</code></li>
<li><code>Webhooks</code></li>
<li><code>Secrets</code></li>
<li>
<p><strong>Read and write</strong>:</p>
</li>
<li>
<p><code>Dependabot alerts</code></p>
</li>
<li><code>Actions</code></li>
<li><code>Code scanning alerts</code></li>
<li><code>Custom properties</code></li>
<li><code>Issues</code></li>
<li><code>Pull requests</code></li>
<li><code>Workflows</code></li>
<li><code>Contents</code></li>
<li>Store the PAT created in step 2 <a href="https://docs.github.com/en/enterprise-cloud@latest/copilot/how-tos/use-copilot-agents/coding-agent/customize-the-agent-environment#setting-environment-variables-in-copilots-environment">as a GitHub secret for Copilot environment√Ø¬ª¬ø</a> named <code>COPILOT_SPONSOR_PAT</code>. This secret is exposed to the GitHub Copilot coding agent as an environment variable, allowing it to authenticate and perform actions in your repository on your behalf.</li>
<li><a href="https://docs.github.com/en/copilot/how-tos/administer-copilot/manage-for-organization/manage-access/grant-access">Assign a Copilot seat to the sponsor user√Ø¬ª¬ø</a>.</li>
</ul>
</li>
<li>
<p>Connect GitHub Copilot to Dynatrace</p>
</li>
</ol>
<p>To connect GitHub Copilot with Dynatrace MCP Server:</p>
<ol>
<li><a href="https://docs.github.com/en/copilot/how-tos/use-copilot-agents/coding-agent/extend-coding-agent-with-mcp">Configure Dynatrace MCP Server in your GitHub code repository√Ø¬ª¬ø</a>.</li>
<li>Store your Dynatrace platform token as a GitHub secret for the Copilot environment named <code>COPILOT_MCP_DT_API_TOKEN</code>.</li>
<li>In your GitHub repo, go to <strong>Settings</strong> &gt; <strong>Copilot</strong> &gt; <strong>Agents</strong>.</li>
<li>Add an MCP server configuration like this:</li>
</ol>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>{
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>&quot;mcpServers&quot;:
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>{
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>&quot;dynatrace&quot;: {
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>&quot;type&quot;: &quot;http&quot;,
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a>&quot;url&quot;: &quot;https://pia1134d.dev.apps.dynatracelabs.com/platform-reserved/mcp-gateway/v0.1/servers/dynatrace-mcp/mcp&quot;,
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a>&quot;headers&quot;: {
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a>
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a>
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a>
<a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a>&quot;Authorization&quot;: &quot;Bearer $COPILOT_MCP_DT_API_TOKEN&quot;
<a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a>
<a id="__codelineno-0-31" name="__codelineno-0-31" href="#__codelineno-0-31"></a>
<a id="__codelineno-0-32" name="__codelineno-0-32" href="#__codelineno-0-32"></a>
<a id="__codelineno-0-33" name="__codelineno-0-33" href="#__codelineno-0-33"></a>},
<a id="__codelineno-0-34" name="__codelineno-0-34" href="#__codelineno-0-34"></a>
<a id="__codelineno-0-35" name="__codelineno-0-35" href="#__codelineno-0-35"></a>
<a id="__codelineno-0-36" name="__codelineno-0-36" href="#__codelineno-0-36"></a>
<a id="__codelineno-0-37" name="__codelineno-0-37" href="#__codelineno-0-37"></a>&quot;tools&quot;: [&quot;*&quot;]
<a id="__codelineno-0-38" name="__codelineno-0-38" href="#__codelineno-0-38"></a>
<a id="__codelineno-0-39" name="__codelineno-0-39" href="#__codelineno-0-39"></a>
<a id="__codelineno-0-40" name="__codelineno-0-40" href="#__codelineno-0-40"></a>
<a id="__codelineno-0-41" name="__codelineno-0-41" href="#__codelineno-0-41"></a>}
<a id="__codelineno-0-42" name="__codelineno-0-42" href="#__codelineno-0-42"></a>
<a id="__codelineno-0-43" name="__codelineno-0-43" href="#__codelineno-0-43"></a>
<a id="__codelineno-0-44" name="__codelineno-0-44" href="#__codelineno-0-44"></a>
<a id="__codelineno-0-45" name="__codelineno-0-45" href="#__codelineno-0-45"></a>}
<a id="__codelineno-0-46" name="__codelineno-0-46" href="#__codelineno-0-46"></a>
<a id="__codelineno-0-47" name="__codelineno-0-47" href="#__codelineno-0-47"></a>
<a id="__codelineno-0-48" name="__codelineno-0-48" href="#__codelineno-0-48"></a>
<a id="__codelineno-0-49" name="__codelineno-0-49" href="#__codelineno-0-49"></a>}
</code></pre></div>
<p>Make sure to replace <code>your-tenant-id</code> with the ID of your Dynatrace environment.</p>
<p>For reference, see <a href="https://docs.github.com/en/copilot/how-tos/use-copilot-agents/coding-agent/extend-coding-agent-with-mcp">Extending GitHub Copilot coding agent with the Model Context Protocol (MCP)√Ø¬ª¬ø</a>.</p>
<ol>
<li>Add instructions for GitHub Copilot</li>
</ol>
<p>To guide the GitHub Copilot coding agent on the verification procedure with Dynatrace, as well as required DQL knowledge for a successful Dynatrace MCP interaction, you have two options:</p>
<ul>
<li><strong>Guide GitHub Copilot coding agent through a global instructions file</strong>: Download the <a href="https://dt-url.net/ug032yv"><code>copilot-instructions.md</code>√Ø¬ª¬ø</a> file and add it in <code>.github/</code>. For instructions, see <a href="https://docs.github.com/en/copilot/how-tos/configure-custom-instructions/add-repository-instructions">Adding repository custom instructions for GitHub Copilot√Ø¬ª¬ø</a>.</li>
<li>
<p><strong>Define a Dynatrace custom agent that GitHub Copilot will use to perform the use case</strong>: Download the <a href="https://dt-url.net/8r032d2"><code>dynatrace-security-agent.md</code>√Ø¬ª¬ø</a> file and add it in <code>.github/agents</code>.</p>
</li>
<li>
<p>Set up the GitHub workflow</p>
</li>
</ul>
<p>Download <a href="https://dt-url.net/po23283"><code>dependabot-alerts-processing.yml</code>√Ø¬ª¬ø</a> and add it in <code>.github/workflows/</code>. This checks for new critical vulnerabilities and triggers GitHub Copilot to remediate only those confirmed by Dynatrace.</p>
<p>For details, see <a href="https://docs.github.com/en/actions/get-started/quickstart#creating-your-first-workflow">Creating your first workflow√Ø¬ª¬ø</a>.</p>
<p>Once configured, GitHub Copilot will begin triaging and remediating vulnerabilities as new alerts are detected.</p>
<p>You can <a href="https://docs.github.com/en/actions/how-tos/manage-workflow-runs/manually-run-a-workflow">test the workflow√Ø¬ª¬ø</a> to ensure that everything is working as expected.</p>
<h2 id="dynatrace-driven-workflow">Dynatrace-driven workflow<a class="headerlink" href="#dynatrace-driven-workflow" title="Permanent link">&para;</a></h2>
<p>This scenario uses Dynatrace to ingest and triage GitHub Advanced Security (GHAS) alerts, then trigger GitHub Copilot to apply fixes only for vulnerabilities confirmed with runtime evidence.</p>
<h3 id="how-it-works-dynatrace-driven-workflow">How it works (Dynatrace-driven workflow)<a class="headerlink" href="#how-it-works-dynatrace-driven-workflow" title="Permanent link">&para;</a></h3>
<p><img alt="Dynatrace-driven - how it works" src="https://dt-cdn.net/images/image-61-2188-3661817c05.png" /></p>
<ol>
<li>GitHub Advanced Security (GHAS) detects vulnerabilities via <a href="https://docs.github.com/en/code-security/getting-started/dependabot-quickstart-guide">Dependabot√Ø¬ª¬ø</a>.</li>
<li>The <a href="/docs/secure/threat-observability/security-events-ingest/ingest-github-advanced-security" title="Ingest GitHub Advanced Security audit logs and security events into Dynatrace as security events.">Dynatrace integration with GHAS</a> ingests these alerts using the GitHub Advanced Security extension and stores them in <a href="/docs/platform/grail" title="Insights on what and how you can query Dynatrace data.">Grail</a> for analysis.</li>
<li>A Dynatrace workflow triages alerts using runtime context and Dynatrace Intelligence generative AI workflow action for validation. For more information, see <a href="/docs/dynatrace-intelligence/dynatrace-intelligence-integrations/copilot-for-workflows" title="Learn how to automate Dynatrace Intelligence generative AI actions and responses with workflows.">Dynatrace Intelligence (Preview) app</a>.</li>
<li>A GitHub issue is created and assigned to GitHub Copilot, including both confirmed and unconfirmed vulnerabilities.</li>
<li>GitHub Copilot coding agent automatically picks up the issue, remediates confirmed vulnerabilities, and dismisses unconfirmed ones.</li>
<li>Developers review and merge the pull request with the fixes applied.</li>
</ol>
<h3 id="get-started-dynatrace-driven-workflow">Get started (Dynatrace-driven workflow)<a class="headerlink" href="#get-started-dynatrace-driven-workflow" title="Permanent link">&para;</a></h3>
<p>To get started, follow the steps below.</p>
<ol>
<li>
<p>Set up Dynatrace</p>
</li>
<li>
<p><a href="/docs/secure/application-security/vulnerability-analytics#start" title="Monitor, visualize, analyze, and remediate third-party and code-level vulnerabilities, track the remediation progress, and create monitoring rules.">Enable Runtime Vulnerability Analytics</a>.</p>
</li>
<li><a href="/docs/whats-new/preview-releases#mcp-server" title="Learn about our Preview releases and how you can participate in them.">Request access to Dynatrace MCP Server</a>.</li>
<li><a href="/docs/manage/identity-access-management/access-tokens-and-oauth-clients/platform-tokens" title="Create personalised platform tokens to access Dynatrace services via the API in your user context.">Create a Dynatrace platform token</a> with the proper permissions to both access the MCP server and to query various event types.</li>
<li>
<p><a href="/docs/secure/threat-observability/security-events-ingest/ingest-github-advanced-security" title="Ingest GitHub Advanced Security audit logs and security events into Dynatrace as security events.">Install and configure the GitHub Advanced Security integration</a> in Dynatrace.</p>
</li>
<li>
<p>Prepare your GitHub repository</p>
</li>
<li>
<p><a href="https://docs.github.com/en/code-security/getting-started/dependabot-quickstart-guide#enabling-dependabot-for-your-repository">Enable Dependabot√Ø¬ª¬ø</a> to detect vulnerabilities in dependencies.</p>
</li>
<li>
<p><a href="https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/managing-your-personal-access-tokens#creating-a-fine-grained-personal-access-token">Generate a fine-grained personal access token (PAT)√Ø¬ª¬ø</a> with the proper permissions.</p>
</li>
<li>
<p>List permissions</p>
</li>
<li>
<p><strong>Read</strong>:</p>
<ul>
<li><code>Variables</code></li>
<li><code>Administration</code></li>
<li><code>Dependabot secrets</code></li>
<li><code>Environments</code></li>
<li><code>Metadata</code></li>
<li><code>Webhooks</code></li>
<li><code>Secrets</code></li>
<li>
<p><strong>Read and write</strong>:</p>
</li>
<li>
<p><code>Dependabot alerts</code></p>
</li>
<li><code>Actions</code></li>
<li><code>Code scanning alerts</code></li>
<li><code>Custom properties</code></li>
<li><code>Issues</code></li>
<li><code>Pull requests</code></li>
<li><code>Workflows</code></li>
<li><code>Contents</code></li>
<li>Store the PAT created in step 2 <a href="https://docs.github.com/en/enterprise-cloud@latest/copilot/how-tos/use-copilot-agents/coding-agent/customize-the-agent-environment#setting-environment-variables-in-copilots-environment">as a GitHub secret for Copilot environment√Ø¬ª¬ø</a> named <code>COPILOT_SPONSOR_PAT</code>. This secret is exposed to the GitHub Copilot coding agent as an environment variable, allowing it to authenticate and perform actions in your repository on your behalf.</li>
</ul>
</li>
<li>
<p>Connect GitHub Copilot to Dynatrace</p>
</li>
</ol>
<p>To connect GitHub Copilot with Dynatrace MCP Server</p>
<ol>
<li>Store your Dynatrace platform token as a GitHub secret named <code>COPILOT_MCP_DT_API_TOKEN</code>.</li>
<li>In your GitHub repo, go to <strong>Settings</strong> &gt; <strong>Copilot</strong> &gt; <strong>Agents</strong>.</li>
<li>Add an MCP server configuration like this:</li>
</ol>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>{
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>&quot;mcpServers&quot;:
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>
<a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a>{
<a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a>
<a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a>
<a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a>
<a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a>&quot;dynatrace&quot;: {
<a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a>
<a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a>
<a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a>
<a id="__codelineno-1-17" name="__codelineno-1-17" href="#__codelineno-1-17"></a>&quot;type&quot;: &quot;http&quot;,
<a id="__codelineno-1-18" name="__codelineno-1-18" href="#__codelineno-1-18"></a>
<a id="__codelineno-1-19" name="__codelineno-1-19" href="#__codelineno-1-19"></a>
<a id="__codelineno-1-20" name="__codelineno-1-20" href="#__codelineno-1-20"></a>
<a id="__codelineno-1-21" name="__codelineno-1-21" href="#__codelineno-1-21"></a>&quot;url&quot;: &quot;https://pia1134d.dev.apps.dynatracelabs.com/platform-reserved/mcp-gateway/v0.1/servers/dynatrace-mcp/mcp&quot;,
<a id="__codelineno-1-22" name="__codelineno-1-22" href="#__codelineno-1-22"></a>
<a id="__codelineno-1-23" name="__codelineno-1-23" href="#__codelineno-1-23"></a>
<a id="__codelineno-1-24" name="__codelineno-1-24" href="#__codelineno-1-24"></a>
<a id="__codelineno-1-25" name="__codelineno-1-25" href="#__codelineno-1-25"></a>&quot;headers&quot;: {
<a id="__codelineno-1-26" name="__codelineno-1-26" href="#__codelineno-1-26"></a>
<a id="__codelineno-1-27" name="__codelineno-1-27" href="#__codelineno-1-27"></a>
<a id="__codelineno-1-28" name="__codelineno-1-28" href="#__codelineno-1-28"></a>
<a id="__codelineno-1-29" name="__codelineno-1-29" href="#__codelineno-1-29"></a>&quot;Authorization&quot;: &quot;Bearer $COPILOT_MCP_DT_API_TOKEN&quot;
<a id="__codelineno-1-30" name="__codelineno-1-30" href="#__codelineno-1-30"></a>
<a id="__codelineno-1-31" name="__codelineno-1-31" href="#__codelineno-1-31"></a>
<a id="__codelineno-1-32" name="__codelineno-1-32" href="#__codelineno-1-32"></a>
<a id="__codelineno-1-33" name="__codelineno-1-33" href="#__codelineno-1-33"></a>},
<a id="__codelineno-1-34" name="__codelineno-1-34" href="#__codelineno-1-34"></a>
<a id="__codelineno-1-35" name="__codelineno-1-35" href="#__codelineno-1-35"></a>
<a id="__codelineno-1-36" name="__codelineno-1-36" href="#__codelineno-1-36"></a>
<a id="__codelineno-1-37" name="__codelineno-1-37" href="#__codelineno-1-37"></a>&quot;tools&quot;: [&quot;*&quot;]
<a id="__codelineno-1-38" name="__codelineno-1-38" href="#__codelineno-1-38"></a>
<a id="__codelineno-1-39" name="__codelineno-1-39" href="#__codelineno-1-39"></a>
<a id="__codelineno-1-40" name="__codelineno-1-40" href="#__codelineno-1-40"></a>
<a id="__codelineno-1-41" name="__codelineno-1-41" href="#__codelineno-1-41"></a>}
<a id="__codelineno-1-42" name="__codelineno-1-42" href="#__codelineno-1-42"></a>
<a id="__codelineno-1-43" name="__codelineno-1-43" href="#__codelineno-1-43"></a>
<a id="__codelineno-1-44" name="__codelineno-1-44" href="#__codelineno-1-44"></a>
<a id="__codelineno-1-45" name="__codelineno-1-45" href="#__codelineno-1-45"></a>}
<a id="__codelineno-1-46" name="__codelineno-1-46" href="#__codelineno-1-46"></a>
<a id="__codelineno-1-47" name="__codelineno-1-47" href="#__codelineno-1-47"></a>
<a id="__codelineno-1-48" name="__codelineno-1-48" href="#__codelineno-1-48"></a>
<a id="__codelineno-1-49" name="__codelineno-1-49" href="#__codelineno-1-49"></a>}
</code></pre></div>
<p>Make sure to replace <code>&lt;your-dynatrace-mcp-endpoint&gt;</code> with your Dynatrace MCP URL.</p>
<p>For reference, see <a href="https://docs.github.com/en/copilot/how-tos/use-copilot-agents/coding-agent/extend-coding-agent-with-mcp">Extending GitHub Copilot coding agent with the Model Context Protocol (MCP)√Ø¬ª¬ø</a>.</p>
<ol>
<li>Add instructions for GitHub Copilot</li>
</ol>
<p>To help tailor suggestions from the GitHub Copilot coding agent to your coding standards and security policies, you have two options:</p>
<ul>
<li><strong>Guide GitHub Copilot coding agent through a global instructions file</strong>: Download the <a href="https://dt-url.net/ug032yv"><code>copilot-instructions.md</code>√Ø¬ª¬ø</a> file and add it in <code>.github/</code>. For instructions, see <a href="https://docs.github.com/en/copilot/how-tos/configure-custom-instructions/add-repository-instructions">Adding repository custom instructions for GitHub Copilot√Ø¬ª¬ø</a>.</li>
<li><strong>Define a Dynatrace custom agent that GitHub Copilot will use to perform the use case</strong>: Download the <a href="https://dt-url.net/8r032d2"><code>dynatrace-security-agent.md</code>√Ø¬ª¬ø</a> file and add it in <code>.github/agents</code>.</li>
</ul>
<p>Once configured, GitHub Copilot will begin triaging and remediating vulnerabilities as new alerts are detected.</p>
<ol>
<li>Deploy and schedule the Dynatrace triaging workflow</li>
</ol>
<p>To automate vulnerability triage and issue creation, download the following two Dynatrace workflows for Dependabot alerts and upload them in <img alt="Workflows" src="https://dt-cdn.net/images/workflows-1024-b5708f3cf9.webp" title="Workflows" /> <strong>Workflows</strong>:</p>
<ol>
<li>
<p><a href="https://dt-url.net/97432ns">GitHub Dependabot alert verification.yml√Ø¬ª¬ø</a>: This is the parent workflow, which performs the following actions:</p>
</li>
<li>
<p>Queries new GitHub Dependabot critical findings.</p>
</li>
<li>Verifies them using runtime context.</li>
<li>Prepares the issue content and calls the sub-workflow.</li>
<li>
<p><a href="https://dt-url.net/ss632s6">GitHub issue creation and Copilot assignment.yml√Ø¬ª¬ø</a>: This is the sub-workflow, called by the parent workflow to:</p>
</li>
<li>
<p>Create a GitHub issue with the verification results.</p>
</li>
<li>Assign the issue to GitHub Copilot for remediation.</li>
</ol>
<p><strong>Before running the workflow</strong>:</p>
<ul>
<li>Store the GitHub personal access token (PAT) created in step 2 (<strong>Prepare your GitHub repository</strong>) in the Dynatrace vault so it can be securely accessed by the workflow.</li>
<li>Update the default input configuration of the sub-workflow to specify the owner and repository where the GitHub issue should be created.</li>
<li>In the HTTP actions of the sub-workflow, reference the vault-stored credentials to authenticate GitHub API requests.</li>
</ul>
<p>Once configured, GitHub Copilot will assist with remediating vulnerabilities by suggesting code changes based on new alerts.</p>
<hr />
<h2 id="source-ai-remediation-kiro-climd">Source: ai-remediation-kiro-cli.md<a class="headerlink" href="#source-ai-remediation-kiro-climd" title="Permanent link">&para;</a></h2>
<hr />
<p>title: Automate cloud misconfiguration triaging and remediation with Kiro CLI and Dynatrace
source: https://www.dynatrace.com/docs/secure/use-cases/ai-remediation-kiro-cli
scraped: 2026-02-16T21:32:52.821154</p>
<hr />
<h1 id="automate-cloud-misconfiguration-triaging-and-remediation-with-kiro-cli-and-dynatrace">Automate cloud misconfiguration triaging and remediation with Kiro CLI and Dynatrace<a class="headerlink" href="#automate-cloud-misconfiguration-triaging-and-remediation-with-kiro-cli-and-dynatrace" title="Permanent link">&para;</a></h1>
<h1 id="automate-cloud-misconfiguration-triaging-and-remediation-with-kiro-cli-and-dynatrace_1">Automate cloud misconfiguration triaging and remediation with Kiro CLI and Dynatrace<a class="headerlink" href="#automate-cloud-misconfiguration-triaging-and-remediation-with-kiro-cli-and-dynatrace_1" title="Permanent link">&para;</a></h1>
<ul>
<li>Latest Dynatrace</li>
<li>Tutorial</li>
<li>Updated on Jan 28, 2026</li>
<li>Preview</li>
</ul>
<h2 id="overview_1">Overview<a class="headerlink" href="#overview_1" title="Permanent link">&para;</a></h2>
<p>Not every cloud misconfiguration needs to be fixed. Dynatrace helps SREs focus on what matters by verifying cloud misconfigurations with runtime context and streamlining remediation with <a href="https://kiro.dev/cli/">Kiro CLI√Ø¬ª¬ø</a>. This use case demonstrates how to prioritize and remediate cloud misconfigurations that impact production applications. It supports two implementation paths, depending on where and how you want to triage the issues√¢¬Ä¬îboth powered by Dynatrace and Kiro CLI integrations.</p>
<h2 id="challenge_1">Challenge<a class="headerlink" href="#challenge_1" title="Permanent link">&para;</a></h2>
<p>In complex cloud environments, the number of high and critical findings that need to be handled is very high. SREs cannot handle all of them, and they need an effective way to remediate those misconfigurations that risk their environments and introduce compliance issues. Cloud misconfiguration might not have a direct impact on production applications. An additional validation and context is needed for more effective triage and remediation efforts.</p>
<h2 id="solution_1">Solution<a class="headerlink" href="#solution_1" title="Permanent link">&para;</a></h2>
<p>Dynatrace integrates with AWS products, such as <a href="https://aws.amazon.com/de/security-hub/">AWS Security Hub√Ø¬ª¬ø</a>, to enrich their findings with additional runtime context and verify them for production impact.</p>
<ul>
<li>Confirmed findings require an immediate fix, which can be automated with the Kiro CLI.</li>
<li>Unconfirmed findings can be suppressed to remove them from the list of active issues.</li>
</ul>
<p>This reduces noise and SRE effort by ensuring only relevant misconfigurations are remediated.</p>
<p>You can implement this solution in two ways, depending on where you want to triage cloud misconfigurations:</p>
<ul>
<li><a href="#kiro-cli-triaging"><strong>Kiro CLI-based triaging</strong></a>: Uses Kiro CLI as the main engagement point, connected to Dynatrace and (natively) AWS MCP servers. Users interact with Kiro CLI to first get the top cloud misconfigurations, contextualize and prioritize with Dynatrace context, and finally, remediate them.</li>
<li><a href="#dynatrace-triaging"><strong>Dynatrace-driven triaging</strong></a>: Uses <img alt="Workflows" src="https://dt-cdn.net/images/workflows-1024-b5708f3cf9.webp" title="Workflows" /> <strong>Workflows</strong> as the main triaging engine with Dynatrace Intelligence generative AI workflow action to summarize the outcomes into a Jira ticket. The rest of the flow takes place in the Kiro CLI as in the first scenario.</li>
</ul>
<h2 id="prerequisites">Prerequisites<a class="headerlink" href="#prerequisites" title="Permanent link">&para;</a></h2>
<p>See below for the <a href="#aws">AWS</a> and <a href="#dt">Dynatrace</a> requirements.</p>
<h3 id="aws">AWS<a class="headerlink" href="#aws" title="Permanent link">&para;</a></h3>
<ul>
<li>Enable AWS Security Hub to monitor your AWS environment.</li>
<li>Install <a href="https://kiro.dev/cli/">Kiro CLI√Ø¬ª¬ø</a> and authenticate it with AWS.</li>
</ul>
<h3 id="dynatrace">Dynatrace<a class="headerlink" href="#dynatrace" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p><a href="/docs/ingest-from/amazon-web-services" title="Set up and configure monitoring for Amazon Web Services.">Set up Dynatrace AWS monitoring</a> for the desired AWS environment.</p>
</li>
<li>
<p><a href="/docs/secure/threat-observability/security-events-ingest/ingest-aws-security-hub" title="Ingest AWS Security Hub security findings and analyze them in Dynatrace.">Set up Dynatrace integration with AWS Security Hub</a>.</p>
</li>
<li><a href="/docs/whats-new/preview-releases#mcp-server" title="Learn about our Preview releases and how you can participate in them.">Request access to Dynatrace MCP Server</a>.</li>
<li><a href="/docs/manage/identity-access-management/access-tokens-and-oauth-clients/platform-tokens" title="Create personalised platform tokens to access Dynatrace services via the API in your user context.">Create a Dynatrace platform token</a> with the proper permissions to both access the MCP server and to query various event types.</li>
</ul>
<h2 id="kiro-cli-based-triaging">Kiro CLI-based triaging<a class="headerlink" href="#kiro-cli-based-triaging" title="Permanent link">&para;</a></h2>
<p>In this scenario, an SRE interacts with Kiro CLI to perform validation and remediation actions with the help of Dynatrace MCP.</p>
<h3 id="how-it-works-kiro-cli-based-triaging">How it works (Kiro CLI-based triaging)<a class="headerlink" href="#how-it-works-kiro-cli-based-triaging" title="Permanent link">&para;</a></h3>
<p><img alt="Kiro CLI-based triaging" src="https://dt-cdn.net/images/dd7782f2-aaa7-47db-a2ba-be0d9701e734-1920-c3a5adeea6.png" /></p>
<ol>
<li>Detection</li>
</ol>
<p>AWS Security Hub identifies cloud misconfigurations.</p>
<ol>
<li>
<p>Verification</p>
</li>
<li>
<p>An SRE interacts with the Kiro CLI to extract top findings.</p>
</li>
<li>
<p>The Dynatrace agent, invoked by the Kiro CLI, utilizes the Dynatrace MCP server to verify whether these findings impact production applications.</p>
</li>
<li>
<p>Remediation</p>
</li>
<li>
<p>SRE remediates confirmed findings via Kiro CLI; others are suppressed.</p>
</li>
<li>Findings are resolved and verified in AWS Security Hub.</li>
</ol>
<h3 id="get-started-kiro-cli-based-triaging">Get started (Kiro CLI-based triaging)<a class="headerlink" href="#get-started-kiro-cli-based-triaging" title="Permanent link">&para;</a></h3>
<p>To get started, follow the steps below.</p>
<ol>
<li>
<p>Download the <a href="https://dt-url.net/ov0301d"><code>dynatrace-security-agent.json</code> file√Ø¬ª¬ø</a> and place it in <code>.kiro/agents/</code>. It contains the Dynatrace MCP configuration with the proper Dynatrace API Platform Token, and the reference to an instructions file.
   Make sure to replace:</p>
</li>
<li>
<p><code>&lt;DYNATRACE_TENANT&gt;</code> with your environment, for example <code>mytenant.apps.dynatrace.com</code>.</p>
</li>
<li><code>&lt;DYNATRACE_PLATFORM_TOKEN&gt;</code> with the Dynatrace token generated in <a href="#dt">prerequisites</a>.</li>
<li>Download the <a href="https://dt-url.net/cp2300s"><code>instructions.md</code> file√Ø¬ª¬ø</a> and place it in the same <code>.kiro/agents/</code> directory, next to the agent configuration file.</li>
</ol>
<h2 id="dynatrace-driven-triaging">Dynatrace-driven triaging<a class="headerlink" href="#dynatrace-driven-triaging" title="Permanent link">&para;</a></h2>
<p>In this scenario, initial validation and triage are automated in Dynatrace Workflows, and the SRE then acts on the Jira tickets to perform assisted remediation using the Kiro CLI.</p>
<h3 id="how-it-works-dynatrace-driven-triaging">How it works (Dynatrace-driven triaging)<a class="headerlink" href="#how-it-works-dynatrace-driven-triaging" title="Permanent link">&para;</a></h3>
<p><img alt="Dynatrace-driven triaging" src="https://dt-cdn.net/images/kiro-cli-2-2088-7ca80c5d12.png" /></p>
<ol>
<li>Detection</li>
</ol>
<p>AWS Security Hub identifies cloud misconfigurations.</p>
<ol>
<li>
<p>Verification</p>
</li>
<li>
<p>AWS Security Hub integration ingests findings into Dynatrace.</p>
</li>
<li>
<p>A Dynatrace workflow analyzes new critical/high-risk findings and performs the automated verification using the Dynatrace Intelligence generative AI workflow action.</p>
</li>
<li>
<p>Remediation</p>
</li>
<li>
<p>A Jira ticket is created automatically with the summary of the verification results.</p>
</li>
<li>An SRE uses Kiro CLI to act on the Jira findings. Confirmed findings are remediated, while the unconfirmed findings can be suppressed.</li>
<li>Findings are resolved in AWS Security Hub and are no longer in the top findings dashboard in Dynatrace.</li>
</ol>
<h3 id="get-started-dynatrace-driven-triaging">Get started (Dynatrace-driven triaging)<a class="headerlink" href="#get-started-dynatrace-driven-triaging" title="Permanent link">&para;</a></h3>
<p>To get started, follow the steps below.</p>
<ol>
<li>
<p>Download the <a href="https://dt-url.net/ov0301d"><code>dynatrace-security-agent.json</code> file√Ø¬ª¬ø</a> and place it in <code>.kiro/agents/</code>. It contains the Dynatrace MCP configuration with the proper Dynatrace API Platform Token, and the reference to an instructions file.
   Make sure to replace:</p>
</li>
<li>
<p><code>&lt;DYNATRACE_TENANT&gt;</code> with your environment, for example <code>mytenant.apps.dynatrace.com</code>.</p>
</li>
<li><code>&lt;DYNATRACE_PLATFORM_TOKEN&gt;</code> with the Dynatrace token generated in <a href="#dt">prerequisites</a>.</li>
<li>Download the <a href="https://dt-url.net/cp2300s"><code>instructions.md</code> file√Ø¬ª¬ø</a> and place it in the same <code>.kiro/agents/</code> directory, next to the agent configuration file.</li>
<li>Optional Configure the Jira remote MCP as part of the Dynatrace agent or as a global Kiro setting (<code>.kiro/settings/mcp.json</code>). For details, see <a href="https://kiro.dev/docs/cli/mcp/">Model context protocol (MCP)√Ø¬ª¬ø</a>.</li>
<li>
<p>Deploy the <a href="https://dt-url.net/a9032pe">Dynatrace triaging workflow for AWS Security Hub findings√Ø¬ª¬ø</a>.</p>
</li>
<li>
<p>Edit the configuration to set the desired values for Jira parameters (such as project key, issue type, assignee, reporter, and labels), which will be used by the Jira ticket creation action.</p>
</li>
<li>Schedule the workflow to run periodically.</li>
</ol>
<hr />
<h2 id="source-analyze-aws-api-gateway-access-logs-with-security-investigatormd">Source: analyze-aws-api-gateway-access-logs-with-security-investigator.md<a class="headerlink" href="#source-analyze-aws-api-gateway-access-logs-with-security-investigatormd" title="Permanent link">&para;</a></h2>
<hr />
<p>title: Analyze Amazon API Gateway access logs with Investigations
source: https://www.dynatrace.com/docs/secure/use-cases/analyze-aws-api-gateway-access-logs-with-security-investigator
scraped: 2026-02-16T09:27:21.832273</p>
<hr />
<h1 id="analyze-amazon-api-gateway-access-logs-with-investigations">Analyze Amazon API Gateway access logs with Investigations<a class="headerlink" href="#analyze-amazon-api-gateway-access-logs-with-investigations" title="Permanent link">&para;</a></h1>
<h1 id="analyze-amazon-api-gateway-access-logs-with-investigations_1">Analyze Amazon API Gateway access logs with Investigations<a class="headerlink" href="#analyze-amazon-api-gateway-access-logs-with-investigations_1" title="Permanent link">&para;</a></h1>
<ul>
<li>Latest Dynatrace</li>
<li>Tutorial</li>
<li>Published Jan 29, 2025</li>
</ul>
<p><a href="https://dt-url.net/dm03wn5">Amazon API Gateway√Ø¬ª¬ø</a> is a powerful service that enables you to build serverless web APIs using Lambda functions or to add "bolt-on security" for existing services. It can range from straightforward actions such as <a href="https://dt-url.net/q823w6q">applying TLS encryption√Ø¬ª¬ø</a> or <a href="https://dt-url.net/bj43w6c">caching√Ø¬ª¬ø</a> to more advanced measures such as <a href="https://dt-url.net/iq63wsn">Access control√Ø¬ª¬ø</a>, <a href="https://dt-url.net/km83wry">API throttling√Ø¬ª¬ø</a>, or <a href="https://dt-url.net/vqa3w97">security logging√Ø¬ª¬ø</a>. API Gateway provides an extra layer of security that can be applied to your services quickly without modifying your underlying code.</p>
<p>In the following, you'll learn how <a href="/docs/secure/investigations" title="Combine Grail functionalities for evidence-driven investigations, including incident resolution, root cause analysis, and threat hunting."><img alt="Investigations" src="https://dt-cdn.net/images/security-investigator-256-93f6c187d9.png" title="Investigations" /> <strong>Investigations</strong></a> can help you monitor and identify errors in your Amazon API Gateway access logs.</p>
<h2 id="target-audience">Target audience<a class="headerlink" href="#target-audience" title="Permanent link">&para;</a></h2>
<p>This article is intended for security engineers and site reliability engineers who are involved in maintaining and securing cloud applications in AWS. It shows you how to make the most of the Amazon API Gateway logs ingested to Dynatrace to detect security issues.</p>
<h2 id="prerequisites_1">Prerequisites<a class="headerlink" href="#prerequisites_1" title="Permanent link">&para;</a></h2>
<ul>
<li>Create an <a href="https://dt-url.net/r8c3wk1">Amazon CloudWatch log group√Ø¬ª¬ø</a> for the Amazon API Gateway access logs</li>
<li><a href="/docs/ingest-from/amazon-web-services/integrate-with-aws/aws-logs-ingest/lma-stream-logs-with-firehose" title="Amazon Data Firehose integration allows ingest of cloud logs directly, without additional infrastructure needed, and at higher throughput.">Set up Amazon Data Firehose</a> for the log group to send the logs to Dynatrace</li>
<li>
<p>Knowledge of</p>
</li>
<li>
<p><a href="/docs/platform/grail/dynatrace-query-language" title="How to use Dynatrace Query Language.">Dynatrace Query Language</a> and <a href="/docs/platform/grail/dynatrace-query-language/dql-guide" title="Find out how DQL works and what are DQL key concepts.">how to use DQL queries</a></p>
</li>
<li><a href="/docs/platform/grail/dynatrace-pattern-language" title="Use Dynatrace Pattern Language to describe patterns using matchers.">Dynatrace Pattern Language</a></li>
</ul>
<h2 id="before-you-begin">Before you begin<a class="headerlink" href="#before-you-begin" title="Permanent link">&para;</a></h2>
<p>Enable logging and ensure that the logs are saved to the CloudWatch log group (in this example, <code>/aws/apigateway/my-gateway-demo</code>) and sent to your Dynatrace environment.</p>
<ol>
<li>
<p>Enable Amazon API Gateway logging</p>
</li>
<li>
<p>In AWS, go to the <strong>API Gateway</strong> service page.</p>
</li>
<li>Select your <strong>API Gateway API</strong> from the API list.</li>
</ol>
<p>In this example, an HTTP API has been used (API Gateway supports multiple API types and logging configurations are different for each of them).
3. In the sidebar menu, select <strong>Monitor</strong> &gt; <strong>Logging</strong>.
4. Select <strong>Choose a stage</strong> to configure logging, then select <strong>Edit</strong>.
5. Turn on <strong>Access logging</strong>.
6. For <strong>Log destination</strong>, enter the ARN of the <code>/aws/apigateway/my-gateway-demo</code> log group.
7. For <strong>Log format</strong>, select <code>JSON</code> to simplify log record parsing.
8. In <strong>Additional fields</strong>, customize the log format, then select <strong>Save</strong>.</p>
<p>For a list of available fields, see <a href="https://dt-url.net/hk03wez">Customize HTTP API access logs√Ø¬ª¬ø</a>.</p>
<p>This example uses the following log format:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>{
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>&quot;requestId&quot;: &quot;$context.requestId&quot;,
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a>
<a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a>
<a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a>&quot;ip&quot;: &quot;$context.identity.sourceIp&quot;,
<a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a>
<a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a>
<a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a>
<a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a>&quot;requestTime&quot;: &quot;$context.requestTime&quot;,
<a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a>
<a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a>
<a id="__codelineno-2-16" name="__codelineno-2-16" href="#__codelineno-2-16"></a>
<a id="__codelineno-2-17" name="__codelineno-2-17" href="#__codelineno-2-17"></a>&quot;httpMethod&quot;: &quot;$context.httpMethod&quot;,
<a id="__codelineno-2-18" name="__codelineno-2-18" href="#__codelineno-2-18"></a>
<a id="__codelineno-2-19" name="__codelineno-2-19" href="#__codelineno-2-19"></a>
<a id="__codelineno-2-20" name="__codelineno-2-20" href="#__codelineno-2-20"></a>
<a id="__codelineno-2-21" name="__codelineno-2-21" href="#__codelineno-2-21"></a>&quot;routeKey&quot;: &quot;$context.routeKey&quot;,
<a id="__codelineno-2-22" name="__codelineno-2-22" href="#__codelineno-2-22"></a>
<a id="__codelineno-2-23" name="__codelineno-2-23" href="#__codelineno-2-23"></a>
<a id="__codelineno-2-24" name="__codelineno-2-24" href="#__codelineno-2-24"></a>
<a id="__codelineno-2-25" name="__codelineno-2-25" href="#__codelineno-2-25"></a>&quot;path&quot;: &quot;$context.path&quot;,
<a id="__codelineno-2-26" name="__codelineno-2-26" href="#__codelineno-2-26"></a>
<a id="__codelineno-2-27" name="__codelineno-2-27" href="#__codelineno-2-27"></a>
<a id="__codelineno-2-28" name="__codelineno-2-28" href="#__codelineno-2-28"></a>
<a id="__codelineno-2-29" name="__codelineno-2-29" href="#__codelineno-2-29"></a>&quot;status&quot;: &quot;$context.status&quot;,
<a id="__codelineno-2-30" name="__codelineno-2-30" href="#__codelineno-2-30"></a>
<a id="__codelineno-2-31" name="__codelineno-2-31" href="#__codelineno-2-31"></a>
<a id="__codelineno-2-32" name="__codelineno-2-32" href="#__codelineno-2-32"></a>
<a id="__codelineno-2-33" name="__codelineno-2-33" href="#__codelineno-2-33"></a>&quot;protocol&quot;: &quot;$context.protocol&quot;,
<a id="__codelineno-2-34" name="__codelineno-2-34" href="#__codelineno-2-34"></a>
<a id="__codelineno-2-35" name="__codelineno-2-35" href="#__codelineno-2-35"></a>
<a id="__codelineno-2-36" name="__codelineno-2-36" href="#__codelineno-2-36"></a>
<a id="__codelineno-2-37" name="__codelineno-2-37" href="#__codelineno-2-37"></a>&quot;responseLength&quot;: &quot;$context.responseLength&quot;,
<a id="__codelineno-2-38" name="__codelineno-2-38" href="#__codelineno-2-38"></a>
<a id="__codelineno-2-39" name="__codelineno-2-39" href="#__codelineno-2-39"></a>
<a id="__codelineno-2-40" name="__codelineno-2-40" href="#__codelineno-2-40"></a>
<a id="__codelineno-2-41" name="__codelineno-2-41" href="#__codelineno-2-41"></a>&quot;responseLatency&quot;: &quot;$context.responseLatency&quot;,
<a id="__codelineno-2-42" name="__codelineno-2-42" href="#__codelineno-2-42"></a>
<a id="__codelineno-2-43" name="__codelineno-2-43" href="#__codelineno-2-43"></a>
<a id="__codelineno-2-44" name="__codelineno-2-44" href="#__codelineno-2-44"></a>
<a id="__codelineno-2-45" name="__codelineno-2-45" href="#__codelineno-2-45"></a>&quot;integrationLatency&quot;: &quot;$context.integrationLatency&quot;,
<a id="__codelineno-2-46" name="__codelineno-2-46" href="#__codelineno-2-46"></a>
<a id="__codelineno-2-47" name="__codelineno-2-47" href="#__codelineno-2-47"></a>
<a id="__codelineno-2-48" name="__codelineno-2-48" href="#__codelineno-2-48"></a>
<a id="__codelineno-2-49" name="__codelineno-2-49" href="#__codelineno-2-49"></a>&quot;integrationStatus&quot;: &quot;$context.integrationStatus&quot;,
<a id="__codelineno-2-50" name="__codelineno-2-50" href="#__codelineno-2-50"></a>
<a id="__codelineno-2-51" name="__codelineno-2-51" href="#__codelineno-2-51"></a>
<a id="__codelineno-2-52" name="__codelineno-2-52" href="#__codelineno-2-52"></a>
<a id="__codelineno-2-53" name="__codelineno-2-53" href="#__codelineno-2-53"></a>&quot;errorMessage&quot;: &quot;$context.error.message&quot;,
<a id="__codelineno-2-54" name="__codelineno-2-54" href="#__codelineno-2-54"></a>
<a id="__codelineno-2-55" name="__codelineno-2-55" href="#__codelineno-2-55"></a>
<a id="__codelineno-2-56" name="__codelineno-2-56" href="#__codelineno-2-56"></a>
<a id="__codelineno-2-57" name="__codelineno-2-57" href="#__codelineno-2-57"></a>&quot;integrationErrorMessage&quot;: &quot;$context.integrationErrorMessage&quot;
<a id="__codelineno-2-58" name="__codelineno-2-58" href="#__codelineno-2-58"></a>
<a id="__codelineno-2-59" name="__codelineno-2-59" href="#__codelineno-2-59"></a>
<a id="__codelineno-2-60" name="__codelineno-2-60" href="#__codelineno-2-60"></a>
<a id="__codelineno-2-61" name="__codelineno-2-61" href="#__codelineno-2-61"></a>}
</code></pre></div>
<ol>
<li>
<p>Verify that the API Gateway requests are logged</p>
</li>
<li>
<p>In Dynatrace, open <img alt="Investigations" src="https://dt-cdn.net/images/security-investigator-256-93f6c187d9.png" title="Investigations" /> <strong>Investigations</strong> and select  <strong>Investigation</strong> to create a new investigation scenario.</p>
</li>
<li>To verify that the logs from the Amazon CloudWatch log group are reaching your Dynatrace environment, run the following query:</li>
</ol>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>fetch logs
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>| filter aws.log_group == &quot;/aws/apigateway/my-gateway-demo&quot;
</code></pre></div>
<p>Example result:</p>
<p><img alt="fetch logs" src="https://dt-cdn.net/images/2025-01-27-11-45-07-1546-309fa661f3.png" /></p>
<p>If no logs are displayed, check your CloudWatch subscription filter and Data Firehose settings (including performance metrics, tenant and buffer settings).</p>
<h2 id="get-started">Get started<a class="headerlink" href="#get-started" title="Permanent link">&para;</a></h2>
<p>Analyze your Amazon API Gateway logs with <a href="/docs/secure/investigations" title="Combine Grail functionalities for evidence-driven investigations, including incident resolution, root cause analysis, and threat hunting."><img alt="Investigations" src="https://dt-cdn.net/images/security-investigator-256-93f6c187d9.png" title="Investigations" /> <strong>Investigations</strong></a>.</p>
<ol>
<li>
<p>Discover backend issues using latency metrics</p>
</li>
<li>
<p>How to decide which metrics to use</p>
</li>
</ol>
<p>API Gateway logs contain a lot of helpful information that can be used to debug your backend applications. One standard metric to monitor from an API Gateway is latency. Two types of latencies can be monitored from API Gateway logs:</p>
<ul>
<li><strong>Integration latency</strong>: The time between when API Gateway relays a request to the backend and when it receives a response from the backend.</li>
<li><strong>Response latency</strong>: The time between when API Gateway receives a request from a client and when it returns a response to the client. It includes the integration latency and other API Gateway overhead.</li>
</ul>
<p>Deciding which metric to use for performance monitoring depends on your use case. Since this example focuses on the backend performance, not the whole request cycle, the integration latency will be used.</p>
<p>Follow the steps below to analyze and discover the services with the highest latency.</p>
<ol>
<li>Fetch your API Gateway logs from Grail:</li>
</ol>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>fetch logs
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a>| filter aws.log_group == &quot;/aws/apigateway/my-gateway-demo&quot;
</code></pre></div>
2. In the query results table, right-click on a field and select <strong>View field details</strong> to <a href="/docs/secure/investigations/enhance-results#view-details" title="Organize and interpret query outputs across investigations --- from performance analysis to threat detection.">view the log record in the original format</a>.</p>
<p>Example JSON-formatted log record:</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>{
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a>&quot;requestId&quot;: &quot;Dzfa6gNrrks42Tw=&quot;,
<a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a>
<a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a>
<a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a>
<a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a>&quot;ip&quot;: &quot;14.21.74.45&quot;,
<a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a>
<a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a>
<a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a>
<a id="__codelineno-5-13" name="__codelineno-5-13" href="#__codelineno-5-13"></a>&quot;requestTime&quot;: &quot;03/Jan/2025:09:22:13 +0000&quot;,
<a id="__codelineno-5-14" name="__codelineno-5-14" href="#__codelineno-5-14"></a>
<a id="__codelineno-5-15" name="__codelineno-5-15" href="#__codelineno-5-15"></a>
<a id="__codelineno-5-16" name="__codelineno-5-16" href="#__codelineno-5-16"></a>
<a id="__codelineno-5-17" name="__codelineno-5-17" href="#__codelineno-5-17"></a>&quot;httpMethod&quot;: &quot;GET&quot;,
<a id="__codelineno-5-18" name="__codelineno-5-18" href="#__codelineno-5-18"></a>
<a id="__codelineno-5-19" name="__codelineno-5-19" href="#__codelineno-5-19"></a>
<a id="__codelineno-5-20" name="__codelineno-5-20" href="#__codelineno-5-20"></a>
<a id="__codelineno-5-21" name="__codelineno-5-21" href="#__codelineno-5-21"></a>&quot;routeKey&quot;: &quot;ANY /&quot;,
<a id="__codelineno-5-22" name="__codelineno-5-22" href="#__codelineno-5-22"></a>
<a id="__codelineno-5-23" name="__codelineno-5-23" href="#__codelineno-5-23"></a>
<a id="__codelineno-5-24" name="__codelineno-5-24" href="#__codelineno-5-24"></a>
<a id="__codelineno-5-25" name="__codelineno-5-25" href="#__codelineno-5-25"></a>&quot;path&quot;: &quot;/getStuff&quot;,
<a id="__codelineno-5-26" name="__codelineno-5-26" href="#__codelineno-5-26"></a>
<a id="__codelineno-5-27" name="__codelineno-5-27" href="#__codelineno-5-27"></a>
<a id="__codelineno-5-28" name="__codelineno-5-28" href="#__codelineno-5-28"></a>
<a id="__codelineno-5-29" name="__codelineno-5-29" href="#__codelineno-5-29"></a>&quot;status&quot;: &quot;200&quot;,
<a id="__codelineno-5-30" name="__codelineno-5-30" href="#__codelineno-5-30"></a>
<a id="__codelineno-5-31" name="__codelineno-5-31" href="#__codelineno-5-31"></a>
<a id="__codelineno-5-32" name="__codelineno-5-32" href="#__codelineno-5-32"></a>
<a id="__codelineno-5-33" name="__codelineno-5-33" href="#__codelineno-5-33"></a>&quot;protocol&quot;: &quot;HTTP/1.1&quot;,
<a id="__codelineno-5-34" name="__codelineno-5-34" href="#__codelineno-5-34"></a>
<a id="__codelineno-5-35" name="__codelineno-5-35" href="#__codelineno-5-35"></a>
<a id="__codelineno-5-36" name="__codelineno-5-36" href="#__codelineno-5-36"></a>
<a id="__codelineno-5-37" name="__codelineno-5-37" href="#__codelineno-5-37"></a>&quot;responseLength&quot;: &quot;33&quot;,
<a id="__codelineno-5-38" name="__codelineno-5-38" href="#__codelineno-5-38"></a>
<a id="__codelineno-5-39" name="__codelineno-5-39" href="#__codelineno-5-39"></a>
<a id="__codelineno-5-40" name="__codelineno-5-40" href="#__codelineno-5-40"></a>
<a id="__codelineno-5-41" name="__codelineno-5-41" href="#__codelineno-5-41"></a>&quot;responseLatency&quot;: &quot;1671&quot;,
<a id="__codelineno-5-42" name="__codelineno-5-42" href="#__codelineno-5-42"></a>
<a id="__codelineno-5-43" name="__codelineno-5-43" href="#__codelineno-5-43"></a>
<a id="__codelineno-5-44" name="__codelineno-5-44" href="#__codelineno-5-44"></a>
<a id="__codelineno-5-45" name="__codelineno-5-45" href="#__codelineno-5-45"></a>&quot;integrationLatency&quot;: &quot;1665&quot;,
<a id="__codelineno-5-46" name="__codelineno-5-46" href="#__codelineno-5-46"></a>
<a id="__codelineno-5-47" name="__codelineno-5-47" href="#__codelineno-5-47"></a>
<a id="__codelineno-5-48" name="__codelineno-5-48" href="#__codelineno-5-48"></a>
<a id="__codelineno-5-49" name="__codelineno-5-49" href="#__codelineno-5-49"></a>&quot;integrationStatus&quot;: &quot;200&quot;,
<a id="__codelineno-5-50" name="__codelineno-5-50" href="#__codelineno-5-50"></a>
<a id="__codelineno-5-51" name="__codelineno-5-51" href="#__codelineno-5-51"></a>
<a id="__codelineno-5-52" name="__codelineno-5-52" href="#__codelineno-5-52"></a>
<a id="__codelineno-5-53" name="__codelineno-5-53" href="#__codelineno-5-53"></a>&quot;errorMessage&quot;: &quot;-&quot;,
<a id="__codelineno-5-54" name="__codelineno-5-54" href="#__codelineno-5-54"></a>
<a id="__codelineno-5-55" name="__codelineno-5-55" href="#__codelineno-5-55"></a>
<a id="__codelineno-5-56" name="__codelineno-5-56" href="#__codelineno-5-56"></a>
<a id="__codelineno-5-57" name="__codelineno-5-57" href="#__codelineno-5-57"></a>&quot;integrationErrorMessage&quot;: &quot;-&quot;
<a id="__codelineno-5-58" name="__codelineno-5-58" href="#__codelineno-5-58"></a>
<a id="__codelineno-5-59" name="__codelineno-5-59" href="#__codelineno-5-59"></a>
<a id="__codelineno-5-60" name="__codelineno-5-60" href="#__codelineno-5-60"></a>
<a id="__codelineno-5-61" name="__codelineno-5-61" href="#__codelineno-5-61"></a>}
</code></pre></div>
3. Add the following <a href="/docs/platform/grail/dynatrace-query-language/commands/extraction-and-parsing-commands" title="DQL extraction commands">parse command</a> to the DQL query to extract the <code>path</code> and <code>integrationLatency</code> properties from the JSON record.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>| parse content, &quot;JSON{ STRING:path, INT:integrationLatency }(flat=true)&quot;
</code></pre></div>
<p>This example uses <a href="/docs/platform/grail/dynatrace-pattern-language" title="Use Dynatrace Pattern Language to describe patterns using matchers.">Dynatrace Pattern Language</a> and the <a href="/docs/platform/grail/dynatrace-pattern-language/log-processing-json-object" title="Explore DPL syntax for handling JSON Objects.">JSON matcher</a> to extract <a href="/docs/platform/grail/dynatrace-pattern-language/log-processing-json-object#parse-selected" title="Explore DPL syntax for handling JSON Objects.">selected matchers</a> to separate fields.</p>
<p>DPL pattern used:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>JSON{
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>
<a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a>
<a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a>STRING:path,
<a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a>
<a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a>
<a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a>
<a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a>INT:integrationLatency
<a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a>
<a id="__codelineno-7-11" name="__codelineno-7-11" href="#__codelineno-7-11"></a>
<a id="__codelineno-7-12" name="__codelineno-7-12" href="#__codelineno-7-12"></a>
<a id="__codelineno-7-13" name="__codelineno-7-13" href="#__codelineno-7-13"></a>}(flat=true)
</code></pre></div>
<p>After running the query, you can see two new columns called <strong>path</strong> and <strong>integrationLatency</strong> in the results table.
4. To simplify viewing the results, add the following <a href="/docs/platform/grail/dynatrace-query-language/commands/aggregation-commands#makeTimeseries" title="DQL aggregation commands"><code>makeTimeseries</code> command</a> to the DQL query to create a metric from the API Gateway logs. The metric should have the path as a dimension and average latency per minute as the metric values.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>| makeTimeseries {
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a>
<a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a>latency = avg(integrationLatency, default:0)
<a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a>
<a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a>
<a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a>
<a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a>},
<a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a>
<a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a>
<a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a>
<a id="__codelineno-8-13" name="__codelineno-8-13" href="#__codelineno-8-13"></a>by: { path },
<a id="__codelineno-8-14" name="__codelineno-8-14" href="#__codelineno-8-14"></a>
<a id="__codelineno-8-15" name="__codelineno-8-15" href="#__codelineno-8-15"></a>
<a id="__codelineno-8-16" name="__codelineno-8-16" href="#__codelineno-8-16"></a>
<a id="__codelineno-8-17" name="__codelineno-8-17" href="#__codelineno-8-17"></a>interval:1m
</code></pre></div>
<p>Your DQL query should look like this:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>fetch logs
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>
<a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a>
<a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a>| filter aws.log_group == &quot;/aws/apigateway/my-gateway-demo&quot;
<a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a>
<a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a>
<a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a>
<a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a>| parse content, &quot;JSON{ STRING:path, INT:integrationLatency }(flat=true)&quot;
<a id="__codelineno-9-10" name="__codelineno-9-10" href="#__codelineno-9-10"></a>
<a id="__codelineno-9-11" name="__codelineno-9-11" href="#__codelineno-9-11"></a>
<a id="__codelineno-9-12" name="__codelineno-9-12" href="#__codelineno-9-12"></a>
<a id="__codelineno-9-13" name="__codelineno-9-13" href="#__codelineno-9-13"></a>| makeTimeseries {
<a id="__codelineno-9-14" name="__codelineno-9-14" href="#__codelineno-9-14"></a>
<a id="__codelineno-9-15" name="__codelineno-9-15" href="#__codelineno-9-15"></a>
<a id="__codelineno-9-16" name="__codelineno-9-16" href="#__codelineno-9-16"></a>
<a id="__codelineno-9-17" name="__codelineno-9-17" href="#__codelineno-9-17"></a>latency = avg(integrationLatency, default:0)
<a id="__codelineno-9-18" name="__codelineno-9-18" href="#__codelineno-9-18"></a>
<a id="__codelineno-9-19" name="__codelineno-9-19" href="#__codelineno-9-19"></a>
<a id="__codelineno-9-20" name="__codelineno-9-20" href="#__codelineno-9-20"></a>
<a id="__codelineno-9-21" name="__codelineno-9-21" href="#__codelineno-9-21"></a>}, by: { path }, interval:1m
</code></pre></div>
<p>Example result viewed as a chart:</p>
<p><img alt="chart1" src="https://dt-cdn.net/images/2025-01-27-15-02-11-1530-a85e8ff3a0.png" /></p>
<p>It turns out you're experiencing some periodical latency issues for both service endpoints.</p>
<ol>
<li>Identify latency issues and troubleshoot response codes</li>
</ol>
<p>Follow the steps below to dig deeper into the response codes.</p>
<ol>
<li>Extract the response codes as an additional column with an <a href="/docs/platform/grail/dynatrace-pattern-language/log-processing-numeric#int" title="Explore DPL syntax for handling numeric data.">INT matcher</a>, as you're expecting to get an integer value from the field.</li>
</ol>
<p>DPL pattern used:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>JSON{ STRING:path, INT:status, INT:integrationLatency }(flat=true)
</code></pre></div>
<p>You can see that the response code is called <code>status</code>.
2. To add the status as one of the dimensions for your metric, add the <code>status</code> field to the <code>by</code> parameter of your <code>maketimeseries</code> command.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>| makeTimeseries {
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a>
<a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a>
<a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a>
<a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a>latency = avg(integrationLatency, default:0)
<a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a>
<a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a>
<a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a>
<a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a>},
<a id="__codelineno-11-10" name="__codelineno-11-10" href="#__codelineno-11-10"></a>
<a id="__codelineno-11-11" name="__codelineno-11-11" href="#__codelineno-11-11"></a>
<a id="__codelineno-11-12" name="__codelineno-11-12" href="#__codelineno-11-12"></a>
<a id="__codelineno-11-13" name="__codelineno-11-13" href="#__codelineno-11-13"></a>by: { path, status },
<a id="__codelineno-11-14" name="__codelineno-11-14" href="#__codelineno-11-14"></a>
<a id="__codelineno-11-15" name="__codelineno-11-15" href="#__codelineno-11-15"></a>
<a id="__codelineno-11-16" name="__codelineno-11-16" href="#__codelineno-11-16"></a>
<a id="__codelineno-11-17" name="__codelineno-11-17" href="#__codelineno-11-17"></a>interval:1m
</code></pre></div>
<p>Your DQL query should look like this:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>fetch logs
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>
<a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a>
<a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a>
<a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a>| filter aws.log_group == &quot;/aws/apigateway/my-gateway-demo&quot;
<a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a>
<a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a>
<a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a>
<a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a>| parse content, &quot;JSON{ STRING:path, INT:status INT:integrationLatency }(flat=true)&quot;
<a id="__codelineno-12-10" name="__codelineno-12-10" href="#__codelineno-12-10"></a>
<a id="__codelineno-12-11" name="__codelineno-12-11" href="#__codelineno-12-11"></a>
<a id="__codelineno-12-12" name="__codelineno-12-12" href="#__codelineno-12-12"></a>
<a id="__codelineno-12-13" name="__codelineno-12-13" href="#__codelineno-12-13"></a>| makeTimeseries {
<a id="__codelineno-12-14" name="__codelineno-12-14" href="#__codelineno-12-14"></a>
<a id="__codelineno-12-15" name="__codelineno-12-15" href="#__codelineno-12-15"></a>
<a id="__codelineno-12-16" name="__codelineno-12-16" href="#__codelineno-12-16"></a>
<a id="__codelineno-12-17" name="__codelineno-12-17" href="#__codelineno-12-17"></a>latency = avg(integrationLatency, default:0)
<a id="__codelineno-12-18" name="__codelineno-12-18" href="#__codelineno-12-18"></a>
<a id="__codelineno-12-19" name="__codelineno-12-19" href="#__codelineno-12-19"></a>
<a id="__codelineno-12-20" name="__codelineno-12-20" href="#__codelineno-12-20"></a>
<a id="__codelineno-12-21" name="__codelineno-12-21" href="#__codelineno-12-21"></a>}, by: { path, status }, interval:1m
</code></pre></div>
<p>Example result viewed as a chart:</p>
<p><img alt="chart 2" src="https://dt-cdn.net/images/2025-01-27-15-07-19-1529-0f585fe086.png" /></p>
<p>It turns out that no successful responses are returned: requests take longer, and all responses return a "Server Error" (HTTP/500).</p>
<ol>
<li>Debug integration errors</li>
</ol>
<p>Follow the steps below to continue debugging integration errors.</p>
<ol>
<li>To analyze the error messages, extract an additional <strong>integrationErrorMessage</strong> field from the log record with a string matcher.</li>
</ol>
<p>DPL pattern used:</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>JSON{
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a>
<a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a>
<a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a>
<a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a>STRING:path,
<a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a>
<a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a>
<a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a>
<a id="__codelineno-13-9" name="__codelineno-13-9" href="#__codelineno-13-9"></a>INT:status,
<a id="__codelineno-13-10" name="__codelineno-13-10" href="#__codelineno-13-10"></a>
<a id="__codelineno-13-11" name="__codelineno-13-11" href="#__codelineno-13-11"></a>
<a id="__codelineno-13-12" name="__codelineno-13-12" href="#__codelineno-13-12"></a>
<a id="__codelineno-13-13" name="__codelineno-13-13" href="#__codelineno-13-13"></a>INT:integrationLatency,
<a id="__codelineno-13-14" name="__codelineno-13-14" href="#__codelineno-13-14"></a>
<a id="__codelineno-13-15" name="__codelineno-13-15" href="#__codelineno-13-15"></a>
<a id="__codelineno-13-16" name="__codelineno-13-16" href="#__codelineno-13-16"></a>
<a id="__codelineno-13-17" name="__codelineno-13-17" href="#__codelineno-13-17"></a>STRING:integrationErrorMessage
<a id="__codelineno-13-18" name="__codelineno-13-18" href="#__codelineno-13-18"></a>
<a id="__codelineno-13-19" name="__codelineno-13-19" href="#__codelineno-13-19"></a>
<a id="__codelineno-13-20" name="__codelineno-13-20" href="#__codelineno-13-20"></a>
<a id="__codelineno-13-21" name="__codelineno-13-21" href="#__codelineno-13-21"></a>}(flat=true)
</code></pre></div>
2. Add the following snippet to the DQL query to aggregate the error messages and sort them by count:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a>| summarize count(), by: { integrationErrorMessage }
<a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a>
<a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a>
<a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a>
<a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a>| sort `count()` desc
</code></pre></div>
<p>Your DQL query should look like this:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a>fetch logs
<a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a>
<a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a>
<a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a>
<a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a>| filter aws.log_group == &quot;/aws/apigateway/my-gateway-demo&quot;
<a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a>
<a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a>
<a id="__codelineno-15-8" name="__codelineno-15-8" href="#__codelineno-15-8"></a>
<a id="__codelineno-15-9" name="__codelineno-15-9" href="#__codelineno-15-9"></a>| parse content, &quot;JSON{ STRING:path, INT:status, INT:integrationLatency, STRING:integrationErrorMessage }(flat=true)&quot;
<a id="__codelineno-15-10" name="__codelineno-15-10" href="#__codelineno-15-10"></a>
<a id="__codelineno-15-11" name="__codelineno-15-11" href="#__codelineno-15-11"></a>
<a id="__codelineno-15-12" name="__codelineno-15-12" href="#__codelineno-15-12"></a>
<a id="__codelineno-15-13" name="__codelineno-15-13" href="#__codelineno-15-13"></a>| summarize count(), by: { integrationErrorMessage }
<a id="__codelineno-15-14" name="__codelineno-15-14" href="#__codelineno-15-14"></a>
<a id="__codelineno-15-15" name="__codelineno-15-15" href="#__codelineno-15-15"></a>
<a id="__codelineno-15-16" name="__codelineno-15-16" href="#__codelineno-15-16"></a>
<a id="__codelineno-15-17" name="__codelineno-15-17" href="#__codelineno-15-17"></a>| sort `count()` desc
</code></pre></div>
<p>A distinct timeout error message stands out from results: <code>The Lambda function returned the following error: RequestId: 01fe3839-4974-40d5-960a-173fcb5ec786 Error: Task timed out after 5.00 seconds. Check your Lambda function code and try again.</code>
3. Extract the <code>Error</code> portion from the log record without the request ID to compare this error message with the others.</p>
<p>DPL pattern used:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a>LD &#39;: RequestId: &#39; UUIDSTRING &#39; Error: &#39; LD:error
</code></pre></div>
<p>You now have two fields (<strong>error</strong> and <strong>integrationErrorMessage</strong>) that can contain the error message.
4. Add the following snippet to the DQL query to merge the two fields into one column with the <code>if</code> function and summarize based on that.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a>| fields error = if(isnull(error), integrationErrorMessage, else: error)
<a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a>
<a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a>
<a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a>
<a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a>| summarize count(), by: { error }
</code></pre></div>
<p>Your DQL query should look like this:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a>fetch logs
<a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a>
<a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a>
<a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a>
<a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a>| filter aws.log_group == &quot;/aws/apigateway/my-gateway-demo&quot;
<a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a>
<a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a>
<a id="__codelineno-18-8" name="__codelineno-18-8" href="#__codelineno-18-8"></a>
<a id="__codelineno-18-9" name="__codelineno-18-9" href="#__codelineno-18-9"></a>| parse content, &quot;JSON{ STRING:path, INT:status, INT:integrationLatency, STRING:integrationErrorMessage }(flat=true)&quot;
<a id="__codelineno-18-10" name="__codelineno-18-10" href="#__codelineno-18-10"></a>
<a id="__codelineno-18-11" name="__codelineno-18-11" href="#__codelineno-18-11"></a>
<a id="__codelineno-18-12" name="__codelineno-18-12" href="#__codelineno-18-12"></a>
<a id="__codelineno-18-13" name="__codelineno-18-13" href="#__codelineno-18-13"></a>| parse integrationErrorMessage, &quot;LD &#39;: RequestId: &#39; UUIDSTRING &#39; Error: &#39; LD:error&quot;
<a id="__codelineno-18-14" name="__codelineno-18-14" href="#__codelineno-18-14"></a>
<a id="__codelineno-18-15" name="__codelineno-18-15" href="#__codelineno-18-15"></a>
<a id="__codelineno-18-16" name="__codelineno-18-16" href="#__codelineno-18-16"></a>
<a id="__codelineno-18-17" name="__codelineno-18-17" href="#__codelineno-18-17"></a>| fields error = if(isnull(error), integrationErrorMessage, else: error)
<a id="__codelineno-18-18" name="__codelineno-18-18" href="#__codelineno-18-18"></a>
<a id="__codelineno-18-19" name="__codelineno-18-19" href="#__codelineno-18-19"></a>
<a id="__codelineno-18-20" name="__codelineno-18-20" href="#__codelineno-18-20"></a>
<a id="__codelineno-18-21" name="__codelineno-18-21" href="#__codelineno-18-21"></a>| summarize count(), by: { error }
</code></pre></div>
<p>Example results:</p>
<p><img alt="results" src="https://dt-cdn.net/images/2025-01-27-15-55-59-1538-7994d7382c.png" /></p>
<p>It turns out that timeout errors are the most frequent.
5. To see how the error messages distribute over the same period, create a metric based on the timeout errors as follows:</p>
<ul>
<li>Add a <a href="/docs/platform/grail/dynatrace-query-language/commands/filtering-commands#filterOut" title="DQL filter and search commands"><code>filterOut</code> command</a> to remove the successful events</li>
<li>Add the <code>timestamp</code> field to the <a href="/docs/platform/grail/dynatrace-query-language/commands/selection-and-modification-commands#fields" title="DQL selection and modification commands"><code>fields</code> command</a></li>
<li>Construct the <code>makeTimeseries</code> command to aggregate errors by count in one-minute interval.</li>
</ul>
<p>Your final query should look like this:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a>fetch logs
<a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a>
<a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a>
<a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a>
<a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a>| filter aws.log_group == &quot;/aws/apigateway/my-gateway-demo&quot;
<a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a>
<a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a>
<a id="__codelineno-19-8" name="__codelineno-19-8" href="#__codelineno-19-8"></a>
<a id="__codelineno-19-9" name="__codelineno-19-9" href="#__codelineno-19-9"></a>| parse content, &quot;JSON{ STRING:path, INT:status, INT:integrationLatency, STRING:integrationErrorMessage }(flat=true)&quot;
<a id="__codelineno-19-10" name="__codelineno-19-10" href="#__codelineno-19-10"></a>
<a id="__codelineno-19-11" name="__codelineno-19-11" href="#__codelineno-19-11"></a>
<a id="__codelineno-19-12" name="__codelineno-19-12" href="#__codelineno-19-12"></a>
<a id="__codelineno-19-13" name="__codelineno-19-13" href="#__codelineno-19-13"></a>| parse integrationErrorMessage, &quot;LD &#39;: RequestId: &#39; UUIDSTRING &#39; Error: &#39; LD:error&quot;
<a id="__codelineno-19-14" name="__codelineno-19-14" href="#__codelineno-19-14"></a>
<a id="__codelineno-19-15" name="__codelineno-19-15" href="#__codelineno-19-15"></a>
<a id="__codelineno-19-16" name="__codelineno-19-16" href="#__codelineno-19-16"></a>
<a id="__codelineno-19-17" name="__codelineno-19-17" href="#__codelineno-19-17"></a>| fields timestamp, error = if(isnull(error), integrationErrorMessage, else: error)
<a id="__codelineno-19-18" name="__codelineno-19-18" href="#__codelineno-19-18"></a>
<a id="__codelineno-19-19" name="__codelineno-19-19" href="#__codelineno-19-19"></a>
<a id="__codelineno-19-20" name="__codelineno-19-20" href="#__codelineno-19-20"></a>
<a id="__codelineno-19-21" name="__codelineno-19-21" href="#__codelineno-19-21"></a>| filterOut error == &quot;-&quot;
<a id="__codelineno-19-22" name="__codelineno-19-22" href="#__codelineno-19-22"></a>
<a id="__codelineno-19-23" name="__codelineno-19-23" href="#__codelineno-19-23"></a>
<a id="__codelineno-19-24" name="__codelineno-19-24" href="#__codelineno-19-24"></a>
<a id="__codelineno-19-25" name="__codelineno-19-25" href="#__codelineno-19-25"></a>| makeTimeseries count(default: 0), by: { error }, interval: 1m
</code></pre></div>
<p>Example result viewed as a chart:</p>
<p><img alt="chart 3" src="https://dt-cdn.net/images/2025-01-27-15-50-54-1509-00bad2a7dc.png" /></p>
<p>It turns out you're experiencing Lambda timeout problems, which are creating latency and server error issues in your API Gateway logs.</p>
<p>To investigate this further, you'd have to look into the Lambda function and see why you're experiencing this behavior precisely at those times. It can be that certain scheduled jobs are running, resources are locked or overloaded, or some other dependencies are causing these issues.</p>
<h2 id="related-topics">Related topics<a class="headerlink" href="#related-topics" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="/docs/secure/use-cases/analyze-aws-cloudtrail-logs-with-security-investigator" title="Analyze CloudTrail logs and find potential security issues with Dynatrace.">Analyze AWS CloudTrail logs with Investigations</a></li>
<li><a href="/docs/secure/use-cases/detect-threats-against-aws-secrets-with-security-investigator" title="Monitor and identify potential threats against your AWS Secrets with Dynatrace.">Detect threats against your AWS Secrets with Investigations</a></li>
<li><a href="/docs/secure/use-cases/threat-hunting" title="Use case scenario for threat hunting and forensics with Investigations.">Threat hunting and forensics</a></li>
<li><a href="/docs/secure/use-cases/operationalize-query-results" title="Build DQL queries from your query results faster and more conveniently with Dynatrace Investigations.">Operationalize DQL query results with Investigations</a></li>
<li><a href="/docs/secure/use-cases/resolve-incidents-faster-with-templates" title="Speed up your log-related investigations with Investigations templates.">Resolve incidents faster with Investigations templates</a></li>
</ul>
<hr />
<h2 id="source-analyze-aws-cloudtrail-logs-with-security-investigatormd">Source: analyze-aws-cloudtrail-logs-with-security-investigator.md<a class="headerlink" href="#source-analyze-aws-cloudtrail-logs-with-security-investigatormd" title="Permanent link">&para;</a></h2>
<hr />
<p>title: Analyze AWS CloudTrail logs with Investigations
source: https://www.dynatrace.com/docs/secure/use-cases/analyze-aws-cloudtrail-logs-with-security-investigator
scraped: 2026-02-16T09:29:14.631559</p>
<hr />
<h1 id="analyze-aws-cloudtrail-logs-with-investigations">Analyze AWS CloudTrail logs with Investigations<a class="headerlink" href="#analyze-aws-cloudtrail-logs-with-investigations" title="Permanent link">&para;</a></h1>
<h1 id="analyze-aws-cloudtrail-logs-with-investigations_1">Analyze AWS CloudTrail logs with Investigations<a class="headerlink" href="#analyze-aws-cloudtrail-logs-with-investigations_1" title="Permanent link">&para;</a></h1>
<ul>
<li>Latest Dynatrace</li>
<li>Tutorial</li>
<li>Published Nov 26, 2024</li>
</ul>
<p><a href="https://dt-url.net/ax63uwp">AWS CloudTrail√Ø¬ª¬ø</a> is an AWS service that helps you enable operational and risk auditing, governance, and compliance of your AWS account. Actions taken by a user, role, or an AWS service in an Amazon AWS environment are recorded as events in CloudTrail. Events include actions taken in the AWS Management Console, AWS Command Line Interface, and AWS SDKs and APIs.</p>
<p>In the following, you'll learn how <a href="/docs/secure/investigations" title="Combine Grail functionalities for evidence-driven investigations, including incident resolution, root cause analysis, and threat hunting."><img alt="Investigations" src="https://dt-cdn.net/images/security-investigator-256-93f6c187d9.png" title="Investigations" /> <strong>Investigations</strong></a> can help you</p>
<ul>
<li><a href="#sign-in">Monitor sign-in failures to AWS console</a></li>
<li><a href="#metrics">Create metrics for unauthorized API calls</a></li>
<li><a href="#monitor">Monitor AWS API throttling</a></li>
<li><a href="#keys">Detect externally generated keys in AWS KMS</a></li>
</ul>
<h2 id="target-audience_1">Target audience<a class="headerlink" href="#target-audience_1" title="Permanent link">&para;</a></h2>
<p>This article is intended for security engineers and site reliability engineers who are involved in maintaining and securing cloud applications in AWS.</p>
<h2 id="prerequisites_2">Prerequisites<a class="headerlink" href="#prerequisites_2" title="Permanent link">&para;</a></h2>
<ul>
<li>Store your CloudTrail logs to an S3 bucket or <a href="https://dt-url.net/mr03u6p">CloudWatch√Ø¬ª¬ø</a>.</li>
<li>
<p>Send CloudTrail logs to Dynatrace. There are two options to stream logs:</p>
</li>
<li>
<p><a href="https://dt-url.net/c703wc8">Amazon S3√Ø¬ª¬ø</a> Recommended</p>
</li>
<li><a href="/docs/ingest-from/amazon-web-services/integrate-with-aws/aws-logs-ingest/lma-stream-logs-with-firehose" title="Amazon Data Firehose integration allows ingest of cloud logs directly, without additional infrastructure needed, and at higher throughput.">Amazon Data Firehose</a></li>
<li>
<p>Knowledge of</p>
</li>
<li>
<p><a href="/docs/platform/grail/dynatrace-query-language" title="How to use Dynatrace Query Language.">Dynatrace Query Language</a> and <a href="/docs/platform/grail/dynatrace-query-language/dql-guide" title="Find out how DQL works and what are DQL key concepts.">how to use DQL queries</a></p>
</li>
<li><a href="/docs/platform/grail/dynatrace-pattern-language" title="Use Dynatrace Pattern Language to describe patterns using matchers.">Dynatrace Pattern Language</a></li>
</ul>
<h2 id="before-you-begin_1">Before you begin<a class="headerlink" href="#before-you-begin_1" title="Permanent link">&para;</a></h2>
<p>Follow the steps below to fetch the AWS CloudTrail logs from Grail using <img alt="Investigations" src="https://dt-cdn.net/images/security-investigator-256-93f6c187d9.png" title="Investigations" /> <strong>Investigations</strong> and prepare them for analysis.</p>
<ol>
<li>Fetch AWS CloudTrail logs from Grail</li>
</ol>
<p>Once your CloudTrail logs are ingested into Dynatrace, follow these steps to fetch the logs.</p>
<ol>
<li>Open <a href="/docs/secure/investigations" title="Combine Grail functionalities for evidence-driven investigations, including incident resolution, root cause analysis, and threat hunting."><img alt="Investigations" src="https://dt-cdn.net/images/security-investigator-256-93f6c187d9.png" title="Investigations" /> <strong>Investigations</strong></a>.</li>
<li>Select <img alt="Add" src="https://dt-cdn.net/images/dashboards-app-menu-plus-7e9b7c3547.svg" title="Add" /> <strong>Investigation</strong> to create an investigation scenario.</li>
<li>In the query input section, insert the DQL query below.</li>
</ol>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a>fetch logs, from: -30min
<a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a>
<a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a>
<a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a>
<a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a>| filter aws.service == &quot;cloudtrail&quot;
</code></pre></div>
4. Select <img alt="Run" src="https://dt-cdn.net/images/run-c2f8c2f63c.svg" title="Run" /> <strong>Run</strong> to display results.</p>
<p>The query will search for logs from the last 30 minutes, which have been forwarded from an AWS log group that contains the word <code>cloudtrail</code>.</p>
<p>If you know in which Grail bucket the CloudTrail logs are stored, use filters to specify the bucket to improve the query performance.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a>fetch logs, from: -30min
<a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a>
<a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a>
<a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a>
<a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a>| filter dt.system.bucket == &quot;my_aws_bucket&quot;
<a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a>
<a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a>
<a id="__codelineno-21-8" name="__codelineno-21-8" href="#__codelineno-21-8"></a>
<a id="__codelineno-21-9" name="__codelineno-21-9" href="#__codelineno-21-9"></a>| filter aws.service == &quot;cloudtrail&quot;
</code></pre></div>
<p>For details, see <a href="/docs/platform/grail/dynatrace-query-language/dql-best-practices" title="Best practices for using Dynatrace Query Language.">DQL best practices</a>.</p>
<p>The results table will be populated with the JSON-formatted events.
5. Right-click on an event and select <strong>View field details</strong> to see the JSON-formatted event in a structured way. This enables investigators to grasp the content of the event much faster.</p>
<p><img alt="results table" src="https://dt-cdn.net/images/image-20241109-145818-3100-3e65568b52.png" />
6. Navigate between events in the results table via the keyboard arrow keys or the navigation buttons in the upper part of the <strong>View field details</strong> window.</p>
<p><img alt="field details" src="https://dt-cdn.net/images/image-20241106-153049-1-2040-9f9e875bf6.png" /></p>
<ol>
<li>Prepare the data for analysis</li>
</ol>
<p>Follow the steps below to simplify log analysis, speed up investigations, and maintain the required precision for analytical tasks.</p>
<ol>
<li>Add to your DQL query the <a href="/docs/platform/grail/dynatrace-query-language/commands/extraction-and-parsing-commands" title="DQL extraction commands">parse command</a> to extract the required data from the log records into separate fields.</li>
<li>Add the <a href="/docs/platform/grail/dynatrace-pattern-language/log-processing-json-object" title="Explore DPL syntax for handling JSON Objects.">JSON matcher</a> to extract the JSON-formatted log content as a JSON object into a separate field called <code>event</code>.</li>
</ol>
<p>Your DQL query should look like this:</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a>fetch logs, from: -30min
<a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a>
<a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a>
<a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a>
<a id="__codelineno-22-5" name="__codelineno-22-5" href="#__codelineno-22-5"></a>| filter dt.system.bucket == &quot;my_aws_bucket&quot;
<a id="__codelineno-22-6" name="__codelineno-22-6" href="#__codelineno-22-6"></a>
<a id="__codelineno-22-7" name="__codelineno-22-7" href="#__codelineno-22-7"></a>
<a id="__codelineno-22-8" name="__codelineno-22-8" href="#__codelineno-22-8"></a>
<a id="__codelineno-22-9" name="__codelineno-22-9" href="#__codelineno-22-9"></a>| filter aws.service == &quot;cloudtrail&quot;
<a id="__codelineno-22-10" name="__codelineno-22-10" href="#__codelineno-22-10"></a>
<a id="__codelineno-22-11" name="__codelineno-22-11" href="#__codelineno-22-11"></a>
<a id="__codelineno-22-12" name="__codelineno-22-12" href="#__codelineno-22-12"></a>
<a id="__codelineno-22-13" name="__codelineno-22-13" href="#__codelineno-22-13"></a>| parse content, &quot;JSON:event&quot;
</code></pre></div>
3. Double-click on any record in the results table to view the object in the <strong>Record details</strong> view. Expand the JSON elements to navigate through the object faster and add filters based on its content.</p>
<p><img alt="Record details" src="https://dt-cdn.net/images/image-20241106-155245-1-2288-9851882d34.png" /></p>
<h2 id="get-started_1">Get started<a class="headerlink" href="#get-started_1" title="Permanent link">&para;</a></h2>
<p>The following are use cases demonstrating how to build the above query to analyze AWS CloudTrail logs with Dynatrace.</p>
<ol>
<li>Monitor sign-in failures to AWS console</li>
</ol>
<p>Failures in authentication logs can be an indication for a potential attack towards your infrastructure. A malicious user could try to enumerate usernames or passwords to gain access to your AWS environment and take control of your business.</p>
<p>To monitor sign-in failures to the AWS console using CloudTrail logs</p>
<ol>
<li>Add a filter statement to fetch only results with <code>signin.amazonaws.com</code> as the event source and <code>ConsoleLogin</code> as the event name.</li>
<li>Add a filter command for the <code>responseElements.ConsoleLogin</code> sub-element in the JSON object with the value <code>Failure</code> to see only failed login attempts.</li>
</ol>
<p>You can use the DQL snippet below.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a>| filter event[eventSource] == &quot;signin.amazonaws.com&quot;
<a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a>
<a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a>
<a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a>
<a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a>and event[eventName] == &quot;ConsoleLogin&quot;
<a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a>
<a id="__codelineno-23-7" name="__codelineno-23-7" href="#__codelineno-23-7"></a>
<a id="__codelineno-23-8" name="__codelineno-23-8" href="#__codelineno-23-8"></a>
<a id="__codelineno-23-9" name="__codelineno-23-9" href="#__codelineno-23-9"></a>and event[responseElements][ConsoleLogin] == &quot;Failure&quot;
</code></pre></div>
3. Add the <code>summarize</code> command with your chosen fields to have an aggregated overview of the events.</p>
<p>You can use the DQL snippet below.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a>| summarize event_count = count(), by: {
<a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a>
<a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a>
<a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a>
<a id="__codelineno-24-5" name="__codelineno-24-5" href="#__codelineno-24-5"></a>source  = event[sourceIPAddress],
<a id="__codelineno-24-6" name="__codelineno-24-6" href="#__codelineno-24-6"></a>
<a id="__codelineno-24-7" name="__codelineno-24-7" href="#__codelineno-24-7"></a>
<a id="__codelineno-24-8" name="__codelineno-24-8" href="#__codelineno-24-8"></a>
<a id="__codelineno-24-9" name="__codelineno-24-9" href="#__codelineno-24-9"></a>reason  = event[errorMessage],
<a id="__codelineno-24-10" name="__codelineno-24-10" href="#__codelineno-24-10"></a>
<a id="__codelineno-24-11" name="__codelineno-24-11" href="#__codelineno-24-11"></a>
<a id="__codelineno-24-12" name="__codelineno-24-12" href="#__codelineno-24-12"></a>
<a id="__codelineno-24-13" name="__codelineno-24-13" href="#__codelineno-24-13"></a>region  = event[awsRegion],
<a id="__codelineno-24-14" name="__codelineno-24-14" href="#__codelineno-24-14"></a>
<a id="__codelineno-24-15" name="__codelineno-24-15" href="#__codelineno-24-15"></a>
<a id="__codelineno-24-16" name="__codelineno-24-16" href="#__codelineno-24-16"></a>
<a id="__codelineno-24-17" name="__codelineno-24-17" href="#__codelineno-24-17"></a>userARN = event[userIdentity][arn],
<a id="__codelineno-24-18" name="__codelineno-24-18" href="#__codelineno-24-18"></a>
<a id="__codelineno-24-19" name="__codelineno-24-19" href="#__codelineno-24-19"></a>
<a id="__codelineno-24-20" name="__codelineno-24-20" href="#__codelineno-24-20"></a>
<a id="__codelineno-24-21" name="__codelineno-24-21" href="#__codelineno-24-21"></a>MFAUsed = event[additionalEventData][MFAUsed]
<a id="__codelineno-24-22" name="__codelineno-24-22" href="#__codelineno-24-22"></a>
<a id="__codelineno-24-23" name="__codelineno-24-23" href="#__codelineno-24-23"></a>
<a id="__codelineno-24-24" name="__codelineno-24-24" href="#__codelineno-24-24"></a>
<a id="__codelineno-24-25" name="__codelineno-24-25" href="#__codelineno-24-25"></a>}
</code></pre></div>
<p>Your final DQL query should look like this:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a>fetch logs, from: -30min
<a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a>
<a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a>
<a id="__codelineno-25-4" name="__codelineno-25-4" href="#__codelineno-25-4"></a>
<a id="__codelineno-25-5" name="__codelineno-25-5" href="#__codelineno-25-5"></a>| filter dt.system.bucket == &quot;my_aws_bucket&quot;
<a id="__codelineno-25-6" name="__codelineno-25-6" href="#__codelineno-25-6"></a>
<a id="__codelineno-25-7" name="__codelineno-25-7" href="#__codelineno-25-7"></a>
<a id="__codelineno-25-8" name="__codelineno-25-8" href="#__codelineno-25-8"></a>
<a id="__codelineno-25-9" name="__codelineno-25-9" href="#__codelineno-25-9"></a>| filter aws.service == &quot;cloudtrail&quot;
<a id="__codelineno-25-10" name="__codelineno-25-10" href="#__codelineno-25-10"></a>
<a id="__codelineno-25-11" name="__codelineno-25-11" href="#__codelineno-25-11"></a>
<a id="__codelineno-25-12" name="__codelineno-25-12" href="#__codelineno-25-12"></a>
<a id="__codelineno-25-13" name="__codelineno-25-13" href="#__codelineno-25-13"></a>| parse content, &quot;JSON:event&quot;
<a id="__codelineno-25-14" name="__codelineno-25-14" href="#__codelineno-25-14"></a>
<a id="__codelineno-25-15" name="__codelineno-25-15" href="#__codelineno-25-15"></a>
<a id="__codelineno-25-16" name="__codelineno-25-16" href="#__codelineno-25-16"></a>
<a id="__codelineno-25-17" name="__codelineno-25-17" href="#__codelineno-25-17"></a>| filter event[eventSource] == &quot;signin.amazonaws.com&quot;
<a id="__codelineno-25-18" name="__codelineno-25-18" href="#__codelineno-25-18"></a>
<a id="__codelineno-25-19" name="__codelineno-25-19" href="#__codelineno-25-19"></a>
<a id="__codelineno-25-20" name="__codelineno-25-20" href="#__codelineno-25-20"></a>
<a id="__codelineno-25-21" name="__codelineno-25-21" href="#__codelineno-25-21"></a>and event[eventName]   == &quot;ConsoleLogin&quot;
<a id="__codelineno-25-22" name="__codelineno-25-22" href="#__codelineno-25-22"></a>
<a id="__codelineno-25-23" name="__codelineno-25-23" href="#__codelineno-25-23"></a>
<a id="__codelineno-25-24" name="__codelineno-25-24" href="#__codelineno-25-24"></a>
<a id="__codelineno-25-25" name="__codelineno-25-25" href="#__codelineno-25-25"></a>and event[responseElements][ConsoleLogin] == &quot;Failure&quot;
<a id="__codelineno-25-26" name="__codelineno-25-26" href="#__codelineno-25-26"></a>
<a id="__codelineno-25-27" name="__codelineno-25-27" href="#__codelineno-25-27"></a>
<a id="__codelineno-25-28" name="__codelineno-25-28" href="#__codelineno-25-28"></a>
<a id="__codelineno-25-29" name="__codelineno-25-29" href="#__codelineno-25-29"></a>| summarize count(), by: {
<a id="__codelineno-25-30" name="__codelineno-25-30" href="#__codelineno-25-30"></a>
<a id="__codelineno-25-31" name="__codelineno-25-31" href="#__codelineno-25-31"></a>
<a id="__codelineno-25-32" name="__codelineno-25-32" href="#__codelineno-25-32"></a>
<a id="__codelineno-25-33" name="__codelineno-25-33" href="#__codelineno-25-33"></a>ipAddr  = event[sourceIPAddress],
<a id="__codelineno-25-34" name="__codelineno-25-34" href="#__codelineno-25-34"></a>
<a id="__codelineno-25-35" name="__codelineno-25-35" href="#__codelineno-25-35"></a>
<a id="__codelineno-25-36" name="__codelineno-25-36" href="#__codelineno-25-36"></a>
<a id="__codelineno-25-37" name="__codelineno-25-37" href="#__codelineno-25-37"></a>reason  = event[errorMessage],
<a id="__codelineno-25-38" name="__codelineno-25-38" href="#__codelineno-25-38"></a>
<a id="__codelineno-25-39" name="__codelineno-25-39" href="#__codelineno-25-39"></a>
<a id="__codelineno-25-40" name="__codelineno-25-40" href="#__codelineno-25-40"></a>
<a id="__codelineno-25-41" name="__codelineno-25-41" href="#__codelineno-25-41"></a>region  = event[awsRegion],
<a id="__codelineno-25-42" name="__codelineno-25-42" href="#__codelineno-25-42"></a>
<a id="__codelineno-25-43" name="__codelineno-25-43" href="#__codelineno-25-43"></a>
<a id="__codelineno-25-44" name="__codelineno-25-44" href="#__codelineno-25-44"></a>
<a id="__codelineno-25-45" name="__codelineno-25-45" href="#__codelineno-25-45"></a>userARN = event[userIdentity][arn],
<a id="__codelineno-25-46" name="__codelineno-25-46" href="#__codelineno-25-46"></a>
<a id="__codelineno-25-47" name="__codelineno-25-47" href="#__codelineno-25-47"></a>
<a id="__codelineno-25-48" name="__codelineno-25-48" href="#__codelineno-25-48"></a>
<a id="__codelineno-25-49" name="__codelineno-25-49" href="#__codelineno-25-49"></a>MFAUsed = event[additionalEventData][MFAUsed]
<a id="__codelineno-25-50" name="__codelineno-25-50" href="#__codelineno-25-50"></a>
<a id="__codelineno-25-51" name="__codelineno-25-51" href="#__codelineno-25-51"></a>
<a id="__codelineno-25-52" name="__codelineno-25-52" href="#__codelineno-25-52"></a>
<a id="__codelineno-25-53" name="__codelineno-25-53" href="#__codelineno-25-53"></a>}
</code></pre></div>
<ol>
<li>Create metrics for unauthorized API calls</li>
</ol>
<p>Unauthorized API calls can indicate a hacking attempt or a system malfunction. These kinds of anomalies should be investigated to prevent unexpected costs or system takeovers by malicious users.</p>
<p>To identify the "top targets" from the API list</p>
<ol>
<li>Create a filter to fetch only events, with an <code>AccessDenied</code> or <code>UnauthorizedOperation</code> error code.</li>
<li>Add the <a href="/docs/platform/grail/dynatrace-query-language/commands/aggregation-commands#makeTimeseries" title="DQL aggregation commands">makeTimeseries command</a> to convert your log results to metrics.</li>
<li>Add the <code>event[eventName]</code> value from the logs as a metrics dimension.</li>
<li>Sort the results to see only the top 10 APIs and limit the results to 10 records.</li>
</ol>
<p>Your DQL query should look like this:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a>fetch logs, from: -30min
<a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a>
<a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a>
<a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a>
<a id="__codelineno-26-5" name="__codelineno-26-5" href="#__codelineno-26-5"></a>| filter dt.system.bucket == &quot;my_aws_bucket&quot;
<a id="__codelineno-26-6" name="__codelineno-26-6" href="#__codelineno-26-6"></a>
<a id="__codelineno-26-7" name="__codelineno-26-7" href="#__codelineno-26-7"></a>
<a id="__codelineno-26-8" name="__codelineno-26-8" href="#__codelineno-26-8"></a>
<a id="__codelineno-26-9" name="__codelineno-26-9" href="#__codelineno-26-9"></a>| filter aws.service == &quot;cloudtrail&quot;
<a id="__codelineno-26-10" name="__codelineno-26-10" href="#__codelineno-26-10"></a>
<a id="__codelineno-26-11" name="__codelineno-26-11" href="#__codelineno-26-11"></a>
<a id="__codelineno-26-12" name="__codelineno-26-12" href="#__codelineno-26-12"></a>
<a id="__codelineno-26-13" name="__codelineno-26-13" href="#__codelineno-26-13"></a>| parse content, &quot;json:event&quot;
<a id="__codelineno-26-14" name="__codelineno-26-14" href="#__codelineno-26-14"></a>
<a id="__codelineno-26-15" name="__codelineno-26-15" href="#__codelineno-26-15"></a>
<a id="__codelineno-26-16" name="__codelineno-26-16" href="#__codelineno-26-16"></a>
<a id="__codelineno-26-17" name="__codelineno-26-17" href="#__codelineno-26-17"></a>| filter in(event[errorCode], { &quot;AccessDenied&quot;, &quot;UnauthorizedOperation&quot; })
<a id="__codelineno-26-18" name="__codelineno-26-18" href="#__codelineno-26-18"></a>
<a id="__codelineno-26-19" name="__codelineno-26-19" href="#__codelineno-26-19"></a>
<a id="__codelineno-26-20" name="__codelineno-26-20" href="#__codelineno-26-20"></a>
<a id="__codelineno-26-21" name="__codelineno-26-21" href="#__codelineno-26-21"></a>| makeTimeseries event_count = count(), by: { eventName = event[eventName] }
<a id="__codelineno-26-22" name="__codelineno-26-22" href="#__codelineno-26-22"></a>
<a id="__codelineno-26-23" name="__codelineno-26-23" href="#__codelineno-26-23"></a>
<a id="__codelineno-26-24" name="__codelineno-26-24" href="#__codelineno-26-24"></a>
<a id="__codelineno-26-25" name="__codelineno-26-25" href="#__codelineno-26-25"></a>| sort arrayAvg(event_count) desc
<a id="__codelineno-26-26" name="__codelineno-26-26" href="#__codelineno-26-26"></a>
<a id="__codelineno-26-27" name="__codelineno-26-27" href="#__codelineno-26-27"></a>
<a id="__codelineno-26-28" name="__codelineno-26-28" href="#__codelineno-26-28"></a>
<a id="__codelineno-26-29" name="__codelineno-26-29" href="#__codelineno-26-29"></a>| limit 10
</code></pre></div>
<p>For more granularity, you can add more dimensions to the <code>makeTimeseries</code> command.</p>
<p>For example, to see API call charts based on the user and the API endpoint, the summarization command would be as follows.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a>| makeTimeseries count(), by: {
<a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a>
<a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a>
<a id="__codelineno-27-4" name="__codelineno-27-4" href="#__codelineno-27-4"></a>
<a id="__codelineno-27-5" name="__codelineno-27-5" href="#__codelineno-27-5"></a>user      = event[userIdentity][arn],
<a id="__codelineno-27-6" name="__codelineno-27-6" href="#__codelineno-27-6"></a>
<a id="__codelineno-27-7" name="__codelineno-27-7" href="#__codelineno-27-7"></a>
<a id="__codelineno-27-8" name="__codelineno-27-8" href="#__codelineno-27-8"></a>
<a id="__codelineno-27-9" name="__codelineno-27-9" href="#__codelineno-27-9"></a>eventName = event[eventName]
<a id="__codelineno-27-10" name="__codelineno-27-10" href="#__codelineno-27-10"></a>
<a id="__codelineno-27-11" name="__codelineno-27-11" href="#__codelineno-27-11"></a>
<a id="__codelineno-27-12" name="__codelineno-27-12" href="#__codelineno-27-12"></a>
<a id="__codelineno-27-13" name="__codelineno-27-13" href="#__codelineno-27-13"></a>}
</code></pre></div>
<p>Example results visualized as a line chart:</p>
<p><img alt=" results visualized to a line-chart " src="https://dt-cdn.net/images/image-20241108-135013-2334-7d17f90671.png" /></p>
<ol>
<li>Monitor AWS API throttling</li>
</ol>
<p>Monitoring request counts towards APIs is important from the availability, cost, and security perspectives. A throttling API might indicate either a brute-force attack, a denial-of-service attack, or an ongoing data exfiltration by a malicious actor.</p>
<p>To monitor AWS API throttling from AWS CloudTrail logs in Dynatrace</p>
<ol>
<li>Create a filter to fetch only events with an error code <code>Client.RequestLimitExceeded</code>.</li>
<li>Add the <a href="/docs/platform/grail/dynatrace-query-language/commands/aggregation-commands#makeTimeseries" title="DQL aggregation commands">makeTimeseries command</a> to convert your log results to metrics.</li>
<li>Add the <code>event[eventName]</code> value from the logs as a metrics dimension.</li>
</ol>
<p>Your DQL query should look like this:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a>fetch logs, from: -30min
<a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a>
<a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a>
<a id="__codelineno-28-4" name="__codelineno-28-4" href="#__codelineno-28-4"></a>
<a id="__codelineno-28-5" name="__codelineno-28-5" href="#__codelineno-28-5"></a>| filter dt.system.bucket == &quot;my_aws_bucket&quot;
<a id="__codelineno-28-6" name="__codelineno-28-6" href="#__codelineno-28-6"></a>
<a id="__codelineno-28-7" name="__codelineno-28-7" href="#__codelineno-28-7"></a>
<a id="__codelineno-28-8" name="__codelineno-28-8" href="#__codelineno-28-8"></a>
<a id="__codelineno-28-9" name="__codelineno-28-9" href="#__codelineno-28-9"></a>| filter aws.service == &quot;cloudtrail&quot;
<a id="__codelineno-28-10" name="__codelineno-28-10" href="#__codelineno-28-10"></a>
<a id="__codelineno-28-11" name="__codelineno-28-11" href="#__codelineno-28-11"></a>
<a id="__codelineno-28-12" name="__codelineno-28-12" href="#__codelineno-28-12"></a>
<a id="__codelineno-28-13" name="__codelineno-28-13" href="#__codelineno-28-13"></a>| parse content, &quot;json:event&quot;
<a id="__codelineno-28-14" name="__codelineno-28-14" href="#__codelineno-28-14"></a>
<a id="__codelineno-28-15" name="__codelineno-28-15" href="#__codelineno-28-15"></a>
<a id="__codelineno-28-16" name="__codelineno-28-16" href="#__codelineno-28-16"></a>
<a id="__codelineno-28-17" name="__codelineno-28-17" href="#__codelineno-28-17"></a>| filter event[errorCode] == &quot;Client.RequestLimitExceeded&quot;
<a id="__codelineno-28-18" name="__codelineno-28-18" href="#__codelineno-28-18"></a>
<a id="__codelineno-28-19" name="__codelineno-28-19" href="#__codelineno-28-19"></a>
<a id="__codelineno-28-20" name="__codelineno-28-20" href="#__codelineno-28-20"></a>
<a id="__codelineno-28-21" name="__codelineno-28-21" href="#__codelineno-28-21"></a>| makeTimeseries count(), by: { eventName = event[eventName] }
</code></pre></div>
<ol>
<li>Detect externally generated keys in AWS KMS</li>
</ol>
<p>When creating a new key in <a href="https://dt-url.net/4g23uoc">AWS Key Management Service (KMS)√Ø¬ª¬ø</a>, you can choose the key material origin for the key: whether the keys are kept under AWS control or handled externally.</p>
<p>By default, key origin material is <code>AWS_KMS</code>, which means that KMS creates the key material.</p>
<p>When keys are handled externally, there√¢¬Ä¬ôs an increased risk that the keys might leak, thus endangering the data which is protected with the key: the key could leak from elsewhere and its location could be unknown.</p>
<p>To detect such key creations, where external key material was used</p>
<ol>
<li>Create a filter to fetch only events with the name <code>CreateKey</code>.</li>
<li>Add a statement to the filter to exclude all origins that begin with <code>AWS_</code>.</li>
</ol>
<p>Currently there are two options (<code>AWS_KMS</code> and <code>EXTERNAL</code>) so you could filter by <code>External</code> origin, but having the filtering out could be be more future-proof.</p>
<p>Your DQL query should look like this:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a>fetch logs, from: -30min
<a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a>
<a id="__codelineno-29-3" name="__codelineno-29-3" href="#__codelineno-29-3"></a>
<a id="__codelineno-29-4" name="__codelineno-29-4" href="#__codelineno-29-4"></a>
<a id="__codelineno-29-5" name="__codelineno-29-5" href="#__codelineno-29-5"></a>| filter dt.system.bucket == &quot;my_aws_bucket&quot;
<a id="__codelineno-29-6" name="__codelineno-29-6" href="#__codelineno-29-6"></a>
<a id="__codelineno-29-7" name="__codelineno-29-7" href="#__codelineno-29-7"></a>
<a id="__codelineno-29-8" name="__codelineno-29-8" href="#__codelineno-29-8"></a>
<a id="__codelineno-29-9" name="__codelineno-29-9" href="#__codelineno-29-9"></a>| filter aws.service == &quot;cloudtrail&quot;
<a id="__codelineno-29-10" name="__codelineno-29-10" href="#__codelineno-29-10"></a>
<a id="__codelineno-29-11" name="__codelineno-29-11" href="#__codelineno-29-11"></a>
<a id="__codelineno-29-12" name="__codelineno-29-12" href="#__codelineno-29-12"></a>
<a id="__codelineno-29-13" name="__codelineno-29-13" href="#__codelineno-29-13"></a>| parse content, &quot;json:event&quot;
<a id="__codelineno-29-14" name="__codelineno-29-14" href="#__codelineno-29-14"></a>
<a id="__codelineno-29-15" name="__codelineno-29-15" href="#__codelineno-29-15"></a>
<a id="__codelineno-29-16" name="__codelineno-29-16" href="#__codelineno-29-16"></a>
<a id="__codelineno-29-17" name="__codelineno-29-17" href="#__codelineno-29-17"></a>| filter event[eventName] == &quot;CreateKey&quot;
<a id="__codelineno-29-18" name="__codelineno-29-18" href="#__codelineno-29-18"></a>
<a id="__codelineno-29-19" name="__codelineno-29-19" href="#__codelineno-29-19"></a>
<a id="__codelineno-29-20" name="__codelineno-29-20" href="#__codelineno-29-20"></a>
<a id="__codelineno-29-21" name="__codelineno-29-21" href="#__codelineno-29-21"></a>| filterOut startsWith(event[requestParameters][origin], &quot;AWS_&quot;)
<a id="__codelineno-29-22" name="__codelineno-29-22" href="#__codelineno-29-22"></a>
<a id="__codelineno-29-23" name="__codelineno-29-23" href="#__codelineno-29-23"></a>
<a id="__codelineno-29-24" name="__codelineno-29-24" href="#__codelineno-29-24"></a>
<a id="__codelineno-29-25" name="__codelineno-29-25" href="#__codelineno-29-25"></a>| fields {
<a id="__codelineno-29-26" name="__codelineno-29-26" href="#__codelineno-29-26"></a>
<a id="__codelineno-29-27" name="__codelineno-29-27" href="#__codelineno-29-27"></a>
<a id="__codelineno-29-28" name="__codelineno-29-28" href="#__codelineno-29-28"></a>
<a id="__codelineno-29-29" name="__codelineno-29-29" href="#__codelineno-29-29"></a>eventName = event[eventName],
<a id="__codelineno-29-30" name="__codelineno-29-30" href="#__codelineno-29-30"></a>
<a id="__codelineno-29-31" name="__codelineno-29-31" href="#__codelineno-29-31"></a>
<a id="__codelineno-29-32" name="__codelineno-29-32" href="#__codelineno-29-32"></a>
<a id="__codelineno-29-33" name="__codelineno-29-33" href="#__codelineno-29-33"></a>origin    = event[requestParameters][origin],
<a id="__codelineno-29-34" name="__codelineno-29-34" href="#__codelineno-29-34"></a>
<a id="__codelineno-29-35" name="__codelineno-29-35" href="#__codelineno-29-35"></a>
<a id="__codelineno-29-36" name="__codelineno-29-36" href="#__codelineno-29-36"></a>
<a id="__codelineno-29-37" name="__codelineno-29-37" href="#__codelineno-29-37"></a>keyUsage  = event[responseElements][keyMetadata][keyUsage],
<a id="__codelineno-29-38" name="__codelineno-29-38" href="#__codelineno-29-38"></a>
<a id="__codelineno-29-39" name="__codelineno-29-39" href="#__codelineno-29-39"></a>
<a id="__codelineno-29-40" name="__codelineno-29-40" href="#__codelineno-29-40"></a>
<a id="__codelineno-29-41" name="__codelineno-29-41" href="#__codelineno-29-41"></a>region    = event[awsRegion],
<a id="__codelineno-29-42" name="__codelineno-29-42" href="#__codelineno-29-42"></a>
<a id="__codelineno-29-43" name="__codelineno-29-43" href="#__codelineno-29-43"></a>
<a id="__codelineno-29-44" name="__codelineno-29-44" href="#__codelineno-29-44"></a>
<a id="__codelineno-29-45" name="__codelineno-29-45" href="#__codelineno-29-45"></a>userARN   = event[userIdentity][arn],
<a id="__codelineno-29-46" name="__codelineno-29-46" href="#__codelineno-29-46"></a>
<a id="__codelineno-29-47" name="__codelineno-29-47" href="#__codelineno-29-47"></a>
<a id="__codelineno-29-48" name="__codelineno-29-48" href="#__codelineno-29-48"></a>
<a id="__codelineno-29-49" name="__codelineno-29-49" href="#__codelineno-29-49"></a>keyId     = event[responseElements][keyMetadata][keyId]
<a id="__codelineno-29-50" name="__codelineno-29-50" href="#__codelineno-29-50"></a>
<a id="__codelineno-29-51" name="__codelineno-29-51" href="#__codelineno-29-51"></a>
<a id="__codelineno-29-52" name="__codelineno-29-52" href="#__codelineno-29-52"></a>
<a id="__codelineno-29-53" name="__codelineno-29-53" href="#__codelineno-29-53"></a>}
</code></pre></div>
<p>As a result, you get a table that contains the following information:</p>
<ul>
<li><strong>eventName</strong>: CreateKey</li>
<li><strong>origin</strong>: EXTERNAL</li>
<li><strong>keyUsage</strong>: ENCRYPT_DECRYPT</li>
<li><strong>region</strong>: us-east-1</li>
<li><strong>userARN</strong>: username</li>
<li><strong>keyId</strong>: 123acb</li>
</ul>
<h2 id="summary">Summary<a class="headerlink" href="#summary" title="Permanent link">&para;</a></h2>
<p>These are some of the use cases that can be solved using CloudTrail logs and Dynatrace <img alt="Investigations" src="https://dt-cdn.net/images/security-investigator-256-93f6c187d9.png" title="Investigations" /> <strong>Investigations</strong>. These logs are an endless source of information that enables Security and DevOps Engineers to conduct different investigations on their AWS infrastructure.</p>
<h2 id="related-topics_1">Related topics<a class="headerlink" href="#related-topics_1" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="/docs/secure/use-cases/analyze-aws-api-gateway-access-logs-with-security-investigator" title="Monitor and identify errors in your Amazon API Gateway access logs with Dynatrace.">Analyze Amazon API Gateway access logs with Investigations</a></li>
<li><a href="/docs/secure/use-cases/detect-threats-against-aws-secrets-with-security-investigator" title="Monitor and identify potential threats against your AWS Secrets with Dynatrace.">Detect threats against your AWS Secrets with Investigations</a></li>
<li><a href="/docs/secure/use-cases/threat-hunting" title="Use case scenario for threat hunting and forensics with Investigations.">Threat hunting and forensics</a></li>
<li><a href="/docs/secure/use-cases/operationalize-query-results" title="Build DQL queries from your query results faster and more conveniently with Dynatrace Investigations.">Operationalize DQL query results with Investigations</a></li>
<li><a href="/docs/secure/use-cases/resolve-incidents-faster-with-templates" title="Speed up your log-related investigations with Investigations templates.">Resolve incidents faster with Investigations templates</a></li>
</ul>
<hr />
<h2 id="source-automate-and-orchestrate-security-findingsmd">Source: automate-and-orchestrate-security-findings.md<a class="headerlink" href="#source-automate-and-orchestrate-security-findingsmd" title="Permanent link">&para;</a></h2>
<hr />
<p>title: Automate and orchestrate security findings
source: https://www.dynatrace.com/docs/secure/use-cases/automate-and-orchestrate-security-findings
scraped: 2026-02-17T05:05:58.835235</p>
<hr />
<h1 id="automate-and-orchestrate-security-findings">Automate and orchestrate security findings<a class="headerlink" href="#automate-and-orchestrate-security-findings" title="Permanent link">&para;</a></h1>
<h1 id="automate-and-orchestrate-security-findings_1">Automate and orchestrate security findings<a class="headerlink" href="#automate-and-orchestrate-security-findings_1" title="Permanent link">&para;</a></h1>
<ul>
<li>Latest Dynatrace</li>
<li>Tutorial</li>
<li>Published Aug 30, 2024</li>
</ul>
<p>Prioritization and remediation of security findings require a lot of manual effort. With so many different security tools, efficiently orchestrating the findings and focusing on the critical ones becomes impossible.</p>
<p>While siloed products can provide localized automation, they often generate excessive noise. This means dev teams ultimately ignore alerts and tickets, and the security posture degrades.</p>
<p>In this context, you can</p>
<ul>
<li><a href="/docs/secure/threat-observability/security-events-ingest" title="Ingest external security data into Grail.">Ingest security findings</a> from various tools and map them to the <a href="https://dt-url.net/3q03pb0">Dynatrace Semantic Dictionary√Ø¬ª¬ø</a>.</li>
<li>Automate and orchestrate security findings across products and tools with our workflow automation samples, which you can further customize with the robust <a href="/docs/analyze-explore-automate/workflows" title="Automate IT processes with Dynatrace Workflows√¢¬Ä¬îreact to events, schedule tasks, and connect services.">Workflows</a> capabilities for your organization's orchestration processes.</li>
</ul>
<h2 id="target-audience_2">Target audience<a class="headerlink" href="#target-audience_2" title="Permanent link">&para;</a></h2>
<p>Security architects and managers who aim to streamline remediation processes and direct the development teams√¢¬Ä¬ô efforts towards effective remediation.</p>
<p>Key use cases include:</p>
<ul>
<li>Ticket creation for remediation of the discovered critical issues</li>
<li>Notification of the relevant stakeholders on the critical findings</li>
<li>Email reporting on the top findings</li>
</ul>
<h2 id="prerequisites_3">Prerequisites<a class="headerlink" href="#prerequisites_3" title="Permanent link">&para;</a></h2>
<p><a href="/docs/secure/threat-observability/security-events-ingest" title="Ingest external security data into Grail.">Ingest security findings</a> from your third-party product.</p>
<h2 id="get-started_2">Get started<a class="headerlink" href="#get-started_2" title="Permanent link">&para;</a></h2>
<ol>
<li>
<p>Download our <a href="https://dt-url.net/l403xh0">sample workflow from GitHub√Ø¬ª¬ø</a>.</p>
</li>
<li>
<p>For vulnerability findings, download these sample workflows instead:</p>
<ul>
<li><a href="https://dt-url.net/ko43qsm">Slack workflow sample√Ø¬ª¬ø</a></li>
<li><a href="https://dt-url.net/od23qa1">Jira workflow sample√Ø¬ª¬ø</a></li>
<li>
<p>For container vulnerability findings, download these sample workflows instead:</p>
</li>
<li>
<p><a href="https://dt-url.net/a643qqd">Slack workflow sample√Ø¬ª¬ø</a></p>
</li>
<li><a href="https://dt-url.net/l103p3t">Jira workflow sample√Ø¬ª¬ø</a></li>
</ul>
</li>
</ol>
<p>For some integrations, such as <a href="/docs/secure/threat-observability/security-events-ingest/ingest-aws-ecr-data" title="Ingest Amazon ECR container image vulnerability findings and scan events and analyze them in Dynatrace.">Amazon ECR</a> or <a href="/docs/secure/threat-observability/security-events-ingest/ingest-aws-security-hub" title="Ingest AWS Security Hub security findings and analyze them in Dynatrace.">AWS Security Hub</a>, workflow samples are available in the app in the <strong>Try our templates</strong> section (go to <strong>Settings (new)</strong> &gt; <strong>Connections</strong> and select the app).
2. Open <a href="/docs/analyze-explore-automate/workflows" title="Automate IT processes with Dynatrace Workflows√¢¬Ä¬îreact to events, schedule tasks, and connect services."><img alt="Workflows" src="https://dt-cdn.net/images/workflows-1024-b5708f3cf9.webp" title="Workflows" /> <strong>Workflows</strong></a>, select <img alt="Import" src="https://dt-cdn.net/images/dashboards-app-dashboards-page-import-6a06e645df.svg" title="Import" /> <strong>Upload</strong>, then select the downloaded file.</p>
<p>Example result:</p>
<p><img alt="email notification example" src="https://dt-cdn.net/images/image-54-1103-3883848f65.png" /></p>
<hr />
<h2 id="source-automated-threat-alert-triagingmd">Source: automated-threat-alert-triaging.md<a class="headerlink" href="#source-automated-threat-alert-triagingmd" title="Permanent link">&para;</a></h2>
<hr />
<p>title: Automated threat-alert triaging
source: https://www.dynatrace.com/docs/secure/use-cases/automated-threat-alert-triaging
scraped: 2026-02-17T05:08:40.300182</p>
<hr />
<h1 id="automated-threat-alert-triaging">Automated threat-alert triaging<a class="headerlink" href="#automated-threat-alert-triaging" title="Permanent link">&para;</a></h1>
<h1 id="automated-threat-alert-triaging_1">Automated threat-alert triaging<a class="headerlink" href="#automated-threat-alert-triaging_1" title="Permanent link">&para;</a></h1>
<ul>
<li>Latest Dynatrace</li>
<li>Tutorial</li>
<li>Updated on Jun 26, 2025</li>
</ul>
<p>Security teams face the challenge of sifting through massive amounts of security data to identify and respond to potential threats, prioritize alerts, and assess the severity of events. Lacking context in place, analysts spend valuable time sorting through the noise, switching between tools, and risking overlooking important information, which leads to delayed responses and inefficiencies in security operations.</p>
<p>The Dynatrace platform addresses this issue by providing security contextualization capabilities, such as threat intelligence enrichment. Various security findings in the Dynatrace platform contain observables, such as IP addresses. Those observables can now be enriched with reputation and other threat contexts, enabling you to</p>
<ul>
<li>Classify and prioritize alerts</li>
<li>Reduce the noise</li>
<li>Respond to threat alerts fast</li>
</ul>
<h2 id="target-audience_3">Target audience<a class="headerlink" href="#target-audience_3" title="Permanent link">&para;</a></h2>
<p>This article is intended for incident response teams that want to automate the triage of new detections supported by threat intelligence.</p>
<h2 id="scenario">Scenario<a class="headerlink" href="#scenario" title="Permanent link">&para;</a></h2>
<ul>
<li>A new security detection finding from <a href="https://aws.amazon.com/guardduty/">Amazon GuardDuty√Ø¬ª¬ø</a> is ingested into the Dynatrace platform.</li>
<li>The security team wants to be notified in Slack only about new critical detections from an actor whose IP address is classified as malicious by the <a href="https://www.abuseipdb.com/">AbuseIPDB√Ø¬ª¬ø</a> threat intelligence source.</li>
</ul>
<p>The same scenario can be applied to other supported integrations for enrichment and security data ingest.</p>
<h2 id="prerequisites_4">Prerequisites<a class="headerlink" href="#prerequisites_4" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="/docs/secure/threat-observability/security-events-ingest/ingest-amazon-guardduty" title="Ingest Amazon GuardDuty security findings and analyze them in Dynatrace.">Install and configure Amazon GuardDuty integration</a> (or any other <a href="/docs/secure/threat-observability/security-events-ingest#ingest" title="Ingest external security data into Grail.">supported data ingest integration</a>).</li>
<li><a href="/docs/secure/threat-observability/security-events-ingest/abuseipdb-enrich" title="Enrich threat observables with AbuseIPDB and analyze them in Dynatrace.">Install and configure the AbuseIPDB enrichment</a> (or any other <a href="/docs/secure/threat-observability/security-events-ingest#enrich" title="Ingest external security data into Grail.">supported enrichment integration</a>).</li>
<li>Users must have the <code>security-intelligence:enrichments:run</code> permission to run enrichments.</li>
</ul>
<h2 id="get-started_3">Get started<a class="headerlink" href="#get-started_3" title="Permanent link">&para;</a></h2>
<ol>
<li>Import workflow</li>
</ol>
<p>Import the sample workflow available as a template in the <strong>AbuseIPDB</strong> app.</p>
<ol>
<li>In Dynatrace, open <strong>Settings</strong> &gt; <strong>AbuseIPDB</strong>.</li>
<li>
<p>In <strong>Templates</strong>, select and import the sample workflow.</p>
</li>
<li>
<p>Enable enrichment</p>
</li>
</ol>
<p>To run the enrichment workflow action, you need to enable the <code>security-intelligence:enrichments:run</code> permission.</p>
<ol>
<li>Go to the settings menu  in the upper-right corner of <img alt="Workflows" src="https://dt-cdn.net/images/workflows-1024-b5708f3cf9.webp" title="Workflows" /> <strong>Workflows</strong> and select <strong>Authorization settings</strong>.</li>
<li>In <strong>Secondary permissions</strong>, search for and select the <code>security-intelligence:enrichments:run</code> permission.</li>
<li>
<p>Select <strong>Save</strong>.</p>
</li>
<li>
<p>Customize workflow</p>
</li>
</ol>
<p>Customize the DQL query action or the Slack notification message to your needs.</p>
<p><img alt="customize workflow" src="https://dt-cdn.net/images/image-20250602-114203-2544-00ee8d9d9a.png" /></p>
<ol>
<li>Test workflow</li>
</ol>
<p>Run the workflow to test it.</p>
<p>Example notification:</p>
<p><img alt="test workflow" src="https://dt-cdn.net/images/image-20250602-115603-977-1c24ffce39.png" /></p>
<ol>
<li>Save workflow</li>
</ol>
<p>Schedule and save the workflow to be triggered automatically.</p>
<hr />
<h2 id="source-detect-threats-against-aws-secrets-with-security-investigatormd">Source: detect-threats-against-aws-secrets-with-security-investigator.md<a class="headerlink" href="#source-detect-threats-against-aws-secrets-with-security-investigatormd" title="Permanent link">&para;</a></h2>
<hr />
<p>title: Detect threats against your AWS Secrets with Investigations
source: https://www.dynatrace.com/docs/secure/use-cases/detect-threats-against-aws-secrets-with-security-investigator
scraped: 2026-02-17T05:05:05.016229</p>
<hr />
<h1 id="detect-threats-against-your-aws-secrets-with-investigations">Detect threats against your AWS Secrets with Investigations<a class="headerlink" href="#detect-threats-against-your-aws-secrets-with-investigations" title="Permanent link">&para;</a></h1>
<h1 id="detect-threats-against-your-aws-secrets-with-investigations_1">Detect threats against your AWS Secrets with Investigations<a class="headerlink" href="#detect-threats-against-your-aws-secrets-with-investigations_1" title="Permanent link">&para;</a></h1>
<ul>
<li>Latest Dynatrace</li>
<li>Tutorial</li>
<li>Published Nov 26, 2024</li>
</ul>
<p>In today's digital landscape, protecting your cryptographic secrets in a cloud environment is more critical than ever. Secrets such as API keys, passwords, and encryption keys used in your applications are vital parts of your applications that, when leaked, could jeopardize your whole business. That's why analyzing threats against secrets is essential to ensure your data's integrity, confidentiality, and availability.</p>
<p>In the following, you'll learn how <a href="/docs/secure/investigations" title="Combine Grail functionalities for evidence-driven investigations, including incident resolution, root cause analysis, and threat hunting."><img alt="Investigations" src="https://dt-cdn.net/images/security-investigator-256-93f6c187d9.png" title="Investigations" /> <strong>Investigations</strong></a> can help you</p>
<ul>
<li><a href="#keys">Detect externally generated keys in AWS KMS</a></li>
<li><a href="#requests">Detect unprivileged requests trying to read Secrets</a></li>
<li><a href="#secrets">Detect requesting non-existing secrets</a></li>
</ul>
<h2 id="target-audience_4">Target audience<a class="headerlink" href="#target-audience_4" title="Permanent link">&para;</a></h2>
<p>This article is intended for security engineers and site reliability engineers who are involved in the maintenance and security of cloud applications in AWS.</p>
<h2 id="prerequisites_5">Prerequisites<a class="headerlink" href="#prerequisites_5" title="Permanent link">&para;</a></h2>
<ul>
<li>Store your CloudTrail logs to an S3 bucket or <a href="https://dt-url.net/mr03u6p">CloudWatch√Ø¬ª¬ø</a>.</li>
<li>
<p>Send CloudTrail logs to Dynatrace. There are two options to stream logs:</p>
</li>
<li>
<p><a href="https://dt-url.net/c703wc8">Amazon S3√Ø¬ª¬ø</a> Recommended</p>
</li>
<li><a href="/docs/ingest-from/amazon-web-services/integrate-with-aws/aws-logs-ingest/lma-stream-logs-with-firehose" title="Amazon Data Firehose integration allows ingest of cloud logs directly, without additional infrastructure needed, and at higher throughput.">Amazon Data Firehose</a></li>
<li>
<p>Knowledge of</p>
</li>
<li>
<p><a href="/docs/platform/grail/dynatrace-query-language" title="How to use Dynatrace Query Language.">Dynatrace Query Language</a> and <a href="/docs/platform/grail/dynatrace-query-language/dql-guide" title="Find out how DQL works and what are DQL key concepts.">how to use DQL queries</a></p>
</li>
<li><a href="/docs/platform/grail/dynatrace-pattern-language" title="Use Dynatrace Pattern Language to describe patterns using matchers.">Dynatrace Pattern Language</a></li>
</ul>
<h2 id="before-you-begin_2">Before you begin<a class="headerlink" href="#before-you-begin_2" title="Permanent link">&para;</a></h2>
<p>Follow the steps below to fetch the AWS CloudTrail logs from Grail using <img alt="Investigations" src="https://dt-cdn.net/images/security-investigator-256-93f6c187d9.png" title="Investigations" /> <strong>Investigations</strong> and prepare them for analysis.</p>
<ol>
<li>Fetch AWS CloudTrail logs from Grail</li>
</ol>
<p>Once your CloudTrail logs are ingested into Dynatrace, follow these steps to fetch the logs.</p>
<ol>
<li>Open <a href="/docs/secure/investigations" title="Combine Grail functionalities for evidence-driven investigations, including incident resolution, root cause analysis, and threat hunting."><img alt="Investigations" src="https://dt-cdn.net/images/security-investigator-256-93f6c187d9.png" title="Investigations" /> <strong>Investigations</strong></a>.</li>
<li>Select <img alt="Add" src="https://dt-cdn.net/images/dashboards-app-menu-plus-7e9b7c3547.svg" title="Add" /> <strong>Investigation</strong> to create an investigation scenario.</li>
<li>In the query input section, insert the DQL query below.</li>
</ol>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a>fetch logs, from: -30min
<a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a>
<a id="__codelineno-30-3" name="__codelineno-30-3" href="#__codelineno-30-3"></a>
<a id="__codelineno-30-4" name="__codelineno-30-4" href="#__codelineno-30-4"></a>
<a id="__codelineno-30-5" name="__codelineno-30-5" href="#__codelineno-30-5"></a>| filter aws.service == &quot;cloudtrail&quot;
</code></pre></div>
4. Select <img alt="Run" src="https://dt-cdn.net/images/run-c2f8c2f63c.svg" title="Run" /> <strong>Run</strong> to display results.</p>
<p>The query will search for logs from the last 30 minutes, which have been forwarded from an AWS log group that contains the word <code>cloudtrail</code>.</p>
<p>If you know in which Grail bucket the CloudTrail logs are stored, use filters to specify the bucket to improve the query performance.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a>fetch logs, from: -30min
<a id="__codelineno-31-2" name="__codelineno-31-2" href="#__codelineno-31-2"></a>
<a id="__codelineno-31-3" name="__codelineno-31-3" href="#__codelineno-31-3"></a>
<a id="__codelineno-31-4" name="__codelineno-31-4" href="#__codelineno-31-4"></a>
<a id="__codelineno-31-5" name="__codelineno-31-5" href="#__codelineno-31-5"></a>| filter dt.system.bucket == &quot;my_aws_bucket&quot;
<a id="__codelineno-31-6" name="__codelineno-31-6" href="#__codelineno-31-6"></a>
<a id="__codelineno-31-7" name="__codelineno-31-7" href="#__codelineno-31-7"></a>
<a id="__codelineno-31-8" name="__codelineno-31-8" href="#__codelineno-31-8"></a>
<a id="__codelineno-31-9" name="__codelineno-31-9" href="#__codelineno-31-9"></a>| filter aws.service == &quot;cloudtrail&quot;
</code></pre></div>
<p>For details, see <a href="/docs/platform/grail/dynatrace-query-language/dql-best-practices" title="Best practices for using Dynatrace Query Language.">DQL best practices</a>.</p>
<p>The results table will be populated with the JSON-formatted events.
5. Right-click on an event and select <strong>View field details</strong> to see the JSON-formatted event in a structured way. This enables investigators to grasp the content of the event much faster.</p>
<p><img alt="results table" src="https://dt-cdn.net/images/image-20241109-145818-3100-3e65568b52.png" />
6. Navigate between events in the results table via the keyboard arrow keys or the navigation buttons in the upper part of the <strong>View field details</strong> window.</p>
<p><img alt="field details" src="https://dt-cdn.net/images/image-20241106-153049-1-2040-9f9e875bf6.png" /></p>
<ol>
<li>Prepare the data for analysis</li>
</ol>
<p>Follow the steps below to simplify log analysis, speed up investigations, and maintain the required precision for analytical tasks.</p>
<ol>
<li>Add to your DQL query the <a href="/docs/platform/grail/dynatrace-query-language/commands/extraction-and-parsing-commands" title="DQL extraction commands">parse command</a> to extract the required data from the log records into separate fields.</li>
<li>Add the <a href="/docs/platform/grail/dynatrace-pattern-language/log-processing-json-object" title="Explore DPL syntax for handling JSON Objects.">JSON matcher</a> to extract the JSON-formatted log content as a JSON object into a separate field called <code>event</code>.</li>
</ol>
<p>Your DQL query should look like this:</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a>fetch logs, from: -30min
<a id="__codelineno-32-2" name="__codelineno-32-2" href="#__codelineno-32-2"></a>
<a id="__codelineno-32-3" name="__codelineno-32-3" href="#__codelineno-32-3"></a>
<a id="__codelineno-32-4" name="__codelineno-32-4" href="#__codelineno-32-4"></a>
<a id="__codelineno-32-5" name="__codelineno-32-5" href="#__codelineno-32-5"></a>| filter dt.system.bucket == &quot;my_aws_bucket&quot;
<a id="__codelineno-32-6" name="__codelineno-32-6" href="#__codelineno-32-6"></a>
<a id="__codelineno-32-7" name="__codelineno-32-7" href="#__codelineno-32-7"></a>
<a id="__codelineno-32-8" name="__codelineno-32-8" href="#__codelineno-32-8"></a>
<a id="__codelineno-32-9" name="__codelineno-32-9" href="#__codelineno-32-9"></a>| filter aws.service == &quot;cloudtrail&quot;
<a id="__codelineno-32-10" name="__codelineno-32-10" href="#__codelineno-32-10"></a>
<a id="__codelineno-32-11" name="__codelineno-32-11" href="#__codelineno-32-11"></a>
<a id="__codelineno-32-12" name="__codelineno-32-12" href="#__codelineno-32-12"></a>
<a id="__codelineno-32-13" name="__codelineno-32-13" href="#__codelineno-32-13"></a>| parse content, &quot;JSON:event&quot;
</code></pre></div>
3. Double-click on any record in the results table to view the object in the <strong>Record details</strong> view. Expand the JSON elements to navigate through the object faster and add filters based on its content.</p>
<p><img alt="Record details" src="https://dt-cdn.net/images/image-20241106-155245-1-2288-9851882d34.png" /></p>
<h2 id="get-started_4">Get started<a class="headerlink" href="#get-started_4" title="Permanent link">&para;</a></h2>
<p>The following are use cases demonstrating how to build the above query to analyze AWS Secrets with Dynatrace.</p>
<ol>
<li>Detect externally generated keys in AWS KMS</li>
</ol>
<p>When creating a new key in <a href="https://dt-url.net/4g23uoc">AWS Key Management Service (KMS)√Ø¬ª¬ø</a>, you can choose the key material origin for the key: whether the keys are kept under AWS control or handled externally.</p>
<p>By default, key origin material is <code>AWS_KMS</code>, which means that KMS creates the key material.</p>
<p>When keys are handled externally, there√¢¬Ä¬ôs an increased risk that the keys might leak, thus endangering the data that is protected with the key: the key could leak from elsewhere and its location could be unknown.</p>
<p>To detect key creations where external key material was used</p>
<ol>
<li>Create a filter to fetch only events with the name <code>CreateKey</code>.</li>
<li>Add a statement to the filter to exclude all origins that begin with <code>AWS_</code>.</li>
</ol>
<p>Currently, there are two options (<code>AWS_KMS</code> and <code>EXTERNAL</code>), so you could filter by <code>External</code> origin, but having the filtering out could be be more future-proof.</p>
<p>Your DQL query should look like this:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a>fetch logs, from: -30min
<a id="__codelineno-33-2" name="__codelineno-33-2" href="#__codelineno-33-2"></a>
<a id="__codelineno-33-3" name="__codelineno-33-3" href="#__codelineno-33-3"></a>
<a id="__codelineno-33-4" name="__codelineno-33-4" href="#__codelineno-33-4"></a>
<a id="__codelineno-33-5" name="__codelineno-33-5" href="#__codelineno-33-5"></a>| filter dt.system.bucket == &quot;my_aws_bucket&quot;
<a id="__codelineno-33-6" name="__codelineno-33-6" href="#__codelineno-33-6"></a>
<a id="__codelineno-33-7" name="__codelineno-33-7" href="#__codelineno-33-7"></a>
<a id="__codelineno-33-8" name="__codelineno-33-8" href="#__codelineno-33-8"></a>
<a id="__codelineno-33-9" name="__codelineno-33-9" href="#__codelineno-33-9"></a>| filter aws.service == &quot;cloudtrail&quot;
<a id="__codelineno-33-10" name="__codelineno-33-10" href="#__codelineno-33-10"></a>
<a id="__codelineno-33-11" name="__codelineno-33-11" href="#__codelineno-33-11"></a>
<a id="__codelineno-33-12" name="__codelineno-33-12" href="#__codelineno-33-12"></a>
<a id="__codelineno-33-13" name="__codelineno-33-13" href="#__codelineno-33-13"></a>| parse content, &quot;json:event&quot;
<a id="__codelineno-33-14" name="__codelineno-33-14" href="#__codelineno-33-14"></a>
<a id="__codelineno-33-15" name="__codelineno-33-15" href="#__codelineno-33-15"></a>
<a id="__codelineno-33-16" name="__codelineno-33-16" href="#__codelineno-33-16"></a>
<a id="__codelineno-33-17" name="__codelineno-33-17" href="#__codelineno-33-17"></a>| filter event[eventName] == &quot;CreateKey&quot;
<a id="__codelineno-33-18" name="__codelineno-33-18" href="#__codelineno-33-18"></a>
<a id="__codelineno-33-19" name="__codelineno-33-19" href="#__codelineno-33-19"></a>
<a id="__codelineno-33-20" name="__codelineno-33-20" href="#__codelineno-33-20"></a>
<a id="__codelineno-33-21" name="__codelineno-33-21" href="#__codelineno-33-21"></a>| filterOut startsWith(event[requestParameters][origin], &quot;AWS_&quot;)
<a id="__codelineno-33-22" name="__codelineno-33-22" href="#__codelineno-33-22"></a>
<a id="__codelineno-33-23" name="__codelineno-33-23" href="#__codelineno-33-23"></a>
<a id="__codelineno-33-24" name="__codelineno-33-24" href="#__codelineno-33-24"></a>
<a id="__codelineno-33-25" name="__codelineno-33-25" href="#__codelineno-33-25"></a>| fields {
<a id="__codelineno-33-26" name="__codelineno-33-26" href="#__codelineno-33-26"></a>
<a id="__codelineno-33-27" name="__codelineno-33-27" href="#__codelineno-33-27"></a>
<a id="__codelineno-33-28" name="__codelineno-33-28" href="#__codelineno-33-28"></a>
<a id="__codelineno-33-29" name="__codelineno-33-29" href="#__codelineno-33-29"></a>eventName = event[eventName],
<a id="__codelineno-33-30" name="__codelineno-33-30" href="#__codelineno-33-30"></a>
<a id="__codelineno-33-31" name="__codelineno-33-31" href="#__codelineno-33-31"></a>
<a id="__codelineno-33-32" name="__codelineno-33-32" href="#__codelineno-33-32"></a>
<a id="__codelineno-33-33" name="__codelineno-33-33" href="#__codelineno-33-33"></a>origin    = event[requestParameters][origin],
<a id="__codelineno-33-34" name="__codelineno-33-34" href="#__codelineno-33-34"></a>
<a id="__codelineno-33-35" name="__codelineno-33-35" href="#__codelineno-33-35"></a>
<a id="__codelineno-33-36" name="__codelineno-33-36" href="#__codelineno-33-36"></a>
<a id="__codelineno-33-37" name="__codelineno-33-37" href="#__codelineno-33-37"></a>keyUsage  = event[responseElements][keyMetadata][keyUsage],
<a id="__codelineno-33-38" name="__codelineno-33-38" href="#__codelineno-33-38"></a>
<a id="__codelineno-33-39" name="__codelineno-33-39" href="#__codelineno-33-39"></a>
<a id="__codelineno-33-40" name="__codelineno-33-40" href="#__codelineno-33-40"></a>
<a id="__codelineno-33-41" name="__codelineno-33-41" href="#__codelineno-33-41"></a>region    = event[awsRegion],
<a id="__codelineno-33-42" name="__codelineno-33-42" href="#__codelineno-33-42"></a>
<a id="__codelineno-33-43" name="__codelineno-33-43" href="#__codelineno-33-43"></a>
<a id="__codelineno-33-44" name="__codelineno-33-44" href="#__codelineno-33-44"></a>
<a id="__codelineno-33-45" name="__codelineno-33-45" href="#__codelineno-33-45"></a>userARN   = event[userIdentity][arn],
<a id="__codelineno-33-46" name="__codelineno-33-46" href="#__codelineno-33-46"></a>
<a id="__codelineno-33-47" name="__codelineno-33-47" href="#__codelineno-33-47"></a>
<a id="__codelineno-33-48" name="__codelineno-33-48" href="#__codelineno-33-48"></a>
<a id="__codelineno-33-49" name="__codelineno-33-49" href="#__codelineno-33-49"></a>keyId     = event[responseElements][keyMetadata][keyId]
<a id="__codelineno-33-50" name="__codelineno-33-50" href="#__codelineno-33-50"></a>
<a id="__codelineno-33-51" name="__codelineno-33-51" href="#__codelineno-33-51"></a>
<a id="__codelineno-33-52" name="__codelineno-33-52" href="#__codelineno-33-52"></a>
<a id="__codelineno-33-53" name="__codelineno-33-53" href="#__codelineno-33-53"></a>}
</code></pre></div>
<p>As a result, you get a table that contains the following information:</p>
<ul>
<li><strong>eventName</strong>: CreateKey</li>
<li><strong>origin</strong>: EXTERNAL</li>
<li><strong>keyUsage</strong>: ENCRYPT_DECRYPT</li>
<li><strong>region</strong>: us-east-1</li>
<li><strong>userARN</strong>: username</li>
<li>
<p><strong>keyId</strong>: 123acb</p>
</li>
<li>
<p>Detect unprivileged requests trying to read Secrets</p>
</li>
</ul>
<p>Unauthorized requests to read secrets is an indication of either a hacking attempt or a system misconfiguration. Unauthorized requests might mean that an attacker has compromised credentials from your system and is now trying to extract Secrets from your AWS account (but luckily without success).</p>
<p>In this use-case, we go through two scenarios that target different unprivileged access attempts to your secrets: <a href="#no-kms-privilege">requesting secrets without KMS privileges</a> and <a href="#unauthorized-secret">requesting unauthorized secrets</a>.</p>
<h4 id="requests-without-kms-privileges">Requests without KMS privileges<a class="headerlink" href="#requests-without-kms-privileges" title="Permanent link">&para;</a></h4>
<p>In case of missing KMS privileges, you can assume these accounts were not supposed to access any secrets in your environments. If this still happens, this is (either malicious or accidental) credential misuse or misconfiguration. Either way, this requires your attention.</p>
<p>To see if someone is trying to access such events in your CloudTrail logs</p>
<ol>
<li>Create a filter to fetch only <code>GetSecretValue</code> events and with an <code>AccessDenied</code> error code.</li>
<li>Add a new filtering condition to see only errors with an <code>Access to KMS is not allowed</code> message.</li>
<li>Aggregate the results by <code>sourceIPAddress</code>, <code>awsRegion</code>, and the <code>ARN</code> of the user of the unauthorized attempts.</li>
</ol>
<p>Your DQL query should look like this:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a>fetch logs, from: -30min
<a id="__codelineno-34-2" name="__codelineno-34-2" href="#__codelineno-34-2"></a>
<a id="__codelineno-34-3" name="__codelineno-34-3" href="#__codelineno-34-3"></a>
<a id="__codelineno-34-4" name="__codelineno-34-4" href="#__codelineno-34-4"></a>
<a id="__codelineno-34-5" name="__codelineno-34-5" href="#__codelineno-34-5"></a>| filter dt.system.bucket == &quot;my_aws_bucket&quot;
<a id="__codelineno-34-6" name="__codelineno-34-6" href="#__codelineno-34-6"></a>
<a id="__codelineno-34-7" name="__codelineno-34-7" href="#__codelineno-34-7"></a>
<a id="__codelineno-34-8" name="__codelineno-34-8" href="#__codelineno-34-8"></a>
<a id="__codelineno-34-9" name="__codelineno-34-9" href="#__codelineno-34-9"></a>| filter aws.service == &quot;cloudtrail&quot;
<a id="__codelineno-34-10" name="__codelineno-34-10" href="#__codelineno-34-10"></a>
<a id="__codelineno-34-11" name="__codelineno-34-11" href="#__codelineno-34-11"></a>
<a id="__codelineno-34-12" name="__codelineno-34-12" href="#__codelineno-34-12"></a>
<a id="__codelineno-34-13" name="__codelineno-34-13" href="#__codelineno-34-13"></a>| parse content, &quot;json:event&quot;
<a id="__codelineno-34-14" name="__codelineno-34-14" href="#__codelineno-34-14"></a>
<a id="__codelineno-34-15" name="__codelineno-34-15" href="#__codelineno-34-15"></a>
<a id="__codelineno-34-16" name="__codelineno-34-16" href="#__codelineno-34-16"></a>
<a id="__codelineno-34-17" name="__codelineno-34-17" href="#__codelineno-34-17"></a>| filter event[eventName] == &quot;GetSecretValue&quot;
<a id="__codelineno-34-18" name="__codelineno-34-18" href="#__codelineno-34-18"></a>
<a id="__codelineno-34-19" name="__codelineno-34-19" href="#__codelineno-34-19"></a>
<a id="__codelineno-34-20" name="__codelineno-34-20" href="#__codelineno-34-20"></a>
<a id="__codelineno-34-21" name="__codelineno-34-21" href="#__codelineno-34-21"></a>and event[errorCode] == &quot;AccessDenied&quot;
<a id="__codelineno-34-22" name="__codelineno-34-22" href="#__codelineno-34-22"></a>
<a id="__codelineno-34-23" name="__codelineno-34-23" href="#__codelineno-34-23"></a>
<a id="__codelineno-34-24" name="__codelineno-34-24" href="#__codelineno-34-24"></a>
<a id="__codelineno-34-25" name="__codelineno-34-25" href="#__codelineno-34-25"></a>and event[errorMessage] == &quot;Access to KMS is not allowed&quot;
<a id="__codelineno-34-26" name="__codelineno-34-26" href="#__codelineno-34-26"></a>
<a id="__codelineno-34-27" name="__codelineno-34-27" href="#__codelineno-34-27"></a>
<a id="__codelineno-34-28" name="__codelineno-34-28" href="#__codelineno-34-28"></a>
<a id="__codelineno-34-29" name="__codelineno-34-29" href="#__codelineno-34-29"></a>| summarize event_count = count(), by: {
<a id="__codelineno-34-30" name="__codelineno-34-30" href="#__codelineno-34-30"></a>
<a id="__codelineno-34-31" name="__codelineno-34-31" href="#__codelineno-34-31"></a>
<a id="__codelineno-34-32" name="__codelineno-34-32" href="#__codelineno-34-32"></a>
<a id="__codelineno-34-33" name="__codelineno-34-33" href="#__codelineno-34-33"></a>sourceIPAddress = event[sourceIPAddress],
<a id="__codelineno-34-34" name="__codelineno-34-34" href="#__codelineno-34-34"></a>
<a id="__codelineno-34-35" name="__codelineno-34-35" href="#__codelineno-34-35"></a>
<a id="__codelineno-34-36" name="__codelineno-34-36" href="#__codelineno-34-36"></a>
<a id="__codelineno-34-37" name="__codelineno-34-37" href="#__codelineno-34-37"></a>awsRegion = event[awsRegion],
<a id="__codelineno-34-38" name="__codelineno-34-38" href="#__codelineno-34-38"></a>
<a id="__codelineno-34-39" name="__codelineno-34-39" href="#__codelineno-34-39"></a>
<a id="__codelineno-34-40" name="__codelineno-34-40" href="#__codelineno-34-40"></a>
<a id="__codelineno-34-41" name="__codelineno-34-41" href="#__codelineno-34-41"></a>userARN = event[userIdentity][arn]
<a id="__codelineno-34-42" name="__codelineno-34-42" href="#__codelineno-34-42"></a>
<a id="__codelineno-34-43" name="__codelineno-34-43" href="#__codelineno-34-43"></a>
<a id="__codelineno-34-44" name="__codelineno-34-44" href="#__codelineno-34-44"></a>
<a id="__codelineno-34-45" name="__codelineno-34-45" href="#__codelineno-34-45"></a>}
</code></pre></div>
<p>If your query returns any results, they would look like this:</p>
<table>
<thead>
<tr>
<th><strong>sourceIPAddress</strong></th>
<th><strong>region</strong></th>
<th><strong>arn</strong></th>
<th><strong>event_count</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>1.2.3.4</td>
<td>us-east-1</td>
<td>username</td>
<td>3</td>
</tr>
</tbody>
</table>
<h4 id="unauthorized-secret-requests">Unauthorized Secret requests<a class="headerlink" href="#unauthorized-secret-requests" title="Permanent link">&para;</a></h4>
<p>In this case, the account is trying to load privileges to which it doesn√¢¬Ä¬ôt have access. The secret configuration might be incorrect, or the account might be being used for secrets it wasn√¢¬Ä¬ôt meant to be used for. The last possibility introduces a potential security threat if the intent is malicious.</p>
<p>To see if such events occur in your CloudTrail logs</p>
<ol>
<li>Create a filter to fetch only <code>GetSecretValue</code> events and with an <code>AccessDenied</code> error code.</li>
<li>If the requested secret doesn't exist or the user doesn't have access to it, the secret's ARN is mentioned in the error message. Parse out the <code>secretID</code> from the error message.</li>
<li>Show only the events where <code>secretID</code> is present.</li>
<li>Aggregate the results by <code>sourceIPAddress</code>, <code>awsRegion</code>, and the <code>userARN</code> of the user of the unauthorized attempts.</li>
</ol>
<p>Your DQL query should look like this:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a>fetch logs, from: -30min
<a id="__codelineno-35-2" name="__codelineno-35-2" href="#__codelineno-35-2"></a>
<a id="__codelineno-35-3" name="__codelineno-35-3" href="#__codelineno-35-3"></a>
<a id="__codelineno-35-4" name="__codelineno-35-4" href="#__codelineno-35-4"></a>
<a id="__codelineno-35-5" name="__codelineno-35-5" href="#__codelineno-35-5"></a>| filter dt.system.bucket == &quot;my_aws_bucket&quot;
<a id="__codelineno-35-6" name="__codelineno-35-6" href="#__codelineno-35-6"></a>
<a id="__codelineno-35-7" name="__codelineno-35-7" href="#__codelineno-35-7"></a>
<a id="__codelineno-35-8" name="__codelineno-35-8" href="#__codelineno-35-8"></a>
<a id="__codelineno-35-9" name="__codelineno-35-9" href="#__codelineno-35-9"></a>| filter aws.service == &quot;cloudtrail&quot;
<a id="__codelineno-35-10" name="__codelineno-35-10" href="#__codelineno-35-10"></a>
<a id="__codelineno-35-11" name="__codelineno-35-11" href="#__codelineno-35-11"></a>
<a id="__codelineno-35-12" name="__codelineno-35-12" href="#__codelineno-35-12"></a>
<a id="__codelineno-35-13" name="__codelineno-35-13" href="#__codelineno-35-13"></a>| parse content, &quot;json:event&quot;
<a id="__codelineno-35-14" name="__codelineno-35-14" href="#__codelineno-35-14"></a>
<a id="__codelineno-35-15" name="__codelineno-35-15" href="#__codelineno-35-15"></a>
<a id="__codelineno-35-16" name="__codelineno-35-16" href="#__codelineno-35-16"></a>
<a id="__codelineno-35-17" name="__codelineno-35-17" href="#__codelineno-35-17"></a>| filter event[eventName] == &quot;GetSecretValue&quot;
<a id="__codelineno-35-18" name="__codelineno-35-18" href="#__codelineno-35-18"></a>
<a id="__codelineno-35-19" name="__codelineno-35-19" href="#__codelineno-35-19"></a>
<a id="__codelineno-35-20" name="__codelineno-35-20" href="#__codelineno-35-20"></a>
<a id="__codelineno-35-21" name="__codelineno-35-21" href="#__codelineno-35-21"></a>and event[errorCode] == &quot;AccessDenied&quot;
<a id="__codelineno-35-22" name="__codelineno-35-22" href="#__codelineno-35-22"></a>
<a id="__codelineno-35-23" name="__codelineno-35-23" href="#__codelineno-35-23"></a>
<a id="__codelineno-35-24" name="__codelineno-35-24" href="#__codelineno-35-24"></a>
<a id="__codelineno-35-25" name="__codelineno-35-25" href="#__codelineno-35-25"></a>| parse event[errorMessage], &quot;LD &#39;:secret:&#39; STRING:secretId&quot;
<a id="__codelineno-35-26" name="__codelineno-35-26" href="#__codelineno-35-26"></a>
<a id="__codelineno-35-27" name="__codelineno-35-27" href="#__codelineno-35-27"></a>
<a id="__codelineno-35-28" name="__codelineno-35-28" href="#__codelineno-35-28"></a>
<a id="__codelineno-35-29" name="__codelineno-35-29" href="#__codelineno-35-29"></a>| filter isNotNull(secretId)
<a id="__codelineno-35-30" name="__codelineno-35-30" href="#__codelineno-35-30"></a>
<a id="__codelineno-35-31" name="__codelineno-35-31" href="#__codelineno-35-31"></a>
<a id="__codelineno-35-32" name="__codelineno-35-32" href="#__codelineno-35-32"></a>
<a id="__codelineno-35-33" name="__codelineno-35-33" href="#__codelineno-35-33"></a>| summarize count(), by: {
<a id="__codelineno-35-34" name="__codelineno-35-34" href="#__codelineno-35-34"></a>
<a id="__codelineno-35-35" name="__codelineno-35-35" href="#__codelineno-35-35"></a>
<a id="__codelineno-35-36" name="__codelineno-35-36" href="#__codelineno-35-36"></a>
<a id="__codelineno-35-37" name="__codelineno-35-37" href="#__codelineno-35-37"></a>sourceIPAddress = event[sourceIPAddress],
<a id="__codelineno-35-38" name="__codelineno-35-38" href="#__codelineno-35-38"></a>
<a id="__codelineno-35-39" name="__codelineno-35-39" href="#__codelineno-35-39"></a>
<a id="__codelineno-35-40" name="__codelineno-35-40" href="#__codelineno-35-40"></a>
<a id="__codelineno-35-41" name="__codelineno-35-41" href="#__codelineno-35-41"></a>awsRegion = event[awsRegion],
<a id="__codelineno-35-42" name="__codelineno-35-42" href="#__codelineno-35-42"></a>
<a id="__codelineno-35-43" name="__codelineno-35-43" href="#__codelineno-35-43"></a>
<a id="__codelineno-35-44" name="__codelineno-35-44" href="#__codelineno-35-44"></a>
<a id="__codelineno-35-45" name="__codelineno-35-45" href="#__codelineno-35-45"></a>userARN = event[userIdentity][arn],
<a id="__codelineno-35-46" name="__codelineno-35-46" href="#__codelineno-35-46"></a>
<a id="__codelineno-35-47" name="__codelineno-35-47" href="#__codelineno-35-47"></a>
<a id="__codelineno-35-48" name="__codelineno-35-48" href="#__codelineno-35-48"></a>
<a id="__codelineno-35-49" name="__codelineno-35-49" href="#__codelineno-35-49"></a>secretId
<a id="__codelineno-35-50" name="__codelineno-35-50" href="#__codelineno-35-50"></a>
<a id="__codelineno-35-51" name="__codelineno-35-51" href="#__codelineno-35-51"></a>
<a id="__codelineno-35-52" name="__codelineno-35-52" href="#__codelineno-35-52"></a>
<a id="__codelineno-35-53" name="__codelineno-35-53" href="#__codelineno-35-53"></a>}
</code></pre></div>
<p>If your query returns any results, they would look like this:</p>
<table>
<thead>
<tr>
<th><strong>sourceIPAddress</strong></th>
<th><strong>awsRegion</strong></th>
<th><strong>arn</strong></th>
<th><strong>secretId</strong></th>
<th><strong>event_count</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>1.2.3.4</td>
<td>us-east-1</td>
<td>username</td>
<td>123abc</td>
<td>3</td>
</tr>
</tbody>
</table>
<ol>
<li>Detect requesting non-existing secrets</li>
</ol>
<p>Requesting secrets that don't exist might indicate a security issue (for example, when someone is trying to enumerate your secrets to extract them and tries all kinds of secrets that might not exist) or an operational issue (secrets used by the service are no longer available, thus creating service issues).</p>
<p>To see if such events are present in your CloudTrail logs</p>
<ol>
<li>Create a filter to fetch the <code>GetSecretValue</code> events.</li>
<li>Append the filter conditions to fetch only events with a <code>ResourceNotFoundException</code> error message.</li>
<li>Aggregate the results by <code>sourceIPAddress</code>, <code>awsRegion</code>, and the <code>userARN</code> and collect the number of events and distinct secrets fetched by this user in the respective AWS region from the specific IP address.</li>
</ol>
<p>If you see a large number of distinct secrets being fetched from a single <code>userARN</code>, it might be a secret enumeration. If the number of different secrets is low, something has probably happened to the secret (a wrong set of privileges, the secret has been removed, or similar).</p>
<p>Your DQL query should look like this:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a>fetch logs, from: -30min
<a id="__codelineno-36-2" name="__codelineno-36-2" href="#__codelineno-36-2"></a>
<a id="__codelineno-36-3" name="__codelineno-36-3" href="#__codelineno-36-3"></a>
<a id="__codelineno-36-4" name="__codelineno-36-4" href="#__codelineno-36-4"></a>
<a id="__codelineno-36-5" name="__codelineno-36-5" href="#__codelineno-36-5"></a>| filter dt.system.bucket == &quot;my_aws_bucket&quot;
<a id="__codelineno-36-6" name="__codelineno-36-6" href="#__codelineno-36-6"></a>
<a id="__codelineno-36-7" name="__codelineno-36-7" href="#__codelineno-36-7"></a>
<a id="__codelineno-36-8" name="__codelineno-36-8" href="#__codelineno-36-8"></a>
<a id="__codelineno-36-9" name="__codelineno-36-9" href="#__codelineno-36-9"></a>| filter aws.service == &quot;cloudtrail&quot;
<a id="__codelineno-36-10" name="__codelineno-36-10" href="#__codelineno-36-10"></a>
<a id="__codelineno-36-11" name="__codelineno-36-11" href="#__codelineno-36-11"></a>
<a id="__codelineno-36-12" name="__codelineno-36-12" href="#__codelineno-36-12"></a>
<a id="__codelineno-36-13" name="__codelineno-36-13" href="#__codelineno-36-13"></a>| parse content, &quot;json:event&quot;
<a id="__codelineno-36-14" name="__codelineno-36-14" href="#__codelineno-36-14"></a>
<a id="__codelineno-36-15" name="__codelineno-36-15" href="#__codelineno-36-15"></a>
<a id="__codelineno-36-16" name="__codelineno-36-16" href="#__codelineno-36-16"></a>
<a id="__codelineno-36-17" name="__codelineno-36-17" href="#__codelineno-36-17"></a>| filter event[eventName] == &quot;GetSecretValue&quot;
<a id="__codelineno-36-18" name="__codelineno-36-18" href="#__codelineno-36-18"></a>
<a id="__codelineno-36-19" name="__codelineno-36-19" href="#__codelineno-36-19"></a>
<a id="__codelineno-36-20" name="__codelineno-36-20" href="#__codelineno-36-20"></a>
<a id="__codelineno-36-21" name="__codelineno-36-21" href="#__codelineno-36-21"></a>and event[errorCode] == &quot;ResourceNotFoundException&quot;
<a id="__codelineno-36-22" name="__codelineno-36-22" href="#__codelineno-36-22"></a>
<a id="__codelineno-36-23" name="__codelineno-36-23" href="#__codelineno-36-23"></a>
<a id="__codelineno-36-24" name="__codelineno-36-24" href="#__codelineno-36-24"></a>
<a id="__codelineno-36-25" name="__codelineno-36-25" href="#__codelineno-36-25"></a>| summarize {
<a id="__codelineno-36-26" name="__codelineno-36-26" href="#__codelineno-36-26"></a>
<a id="__codelineno-36-27" name="__codelineno-36-27" href="#__codelineno-36-27"></a>
<a id="__codelineno-36-28" name="__codelineno-36-28" href="#__codelineno-36-28"></a>
<a id="__codelineno-36-29" name="__codelineno-36-29" href="#__codelineno-36-29"></a>event_count = count(),
<a id="__codelineno-36-30" name="__codelineno-36-30" href="#__codelineno-36-30"></a>
<a id="__codelineno-36-31" name="__codelineno-36-31" href="#__codelineno-36-31"></a>
<a id="__codelineno-36-32" name="__codelineno-36-32" href="#__codelineno-36-32"></a>
<a id="__codelineno-36-33" name="__codelineno-36-33" href="#__codelineno-36-33"></a>distinct_secrets = countDistinct(event[requestParameters][secretId])
<a id="__codelineno-36-34" name="__codelineno-36-34" href="#__codelineno-36-34"></a>
<a id="__codelineno-36-35" name="__codelineno-36-35" href="#__codelineno-36-35"></a>
<a id="__codelineno-36-36" name="__codelineno-36-36" href="#__codelineno-36-36"></a>
<a id="__codelineno-36-37" name="__codelineno-36-37" href="#__codelineno-36-37"></a>}, by: {
<a id="__codelineno-36-38" name="__codelineno-36-38" href="#__codelineno-36-38"></a>
<a id="__codelineno-36-39" name="__codelineno-36-39" href="#__codelineno-36-39"></a>
<a id="__codelineno-36-40" name="__codelineno-36-40" href="#__codelineno-36-40"></a>
<a id="__codelineno-36-41" name="__codelineno-36-41" href="#__codelineno-36-41"></a>sourceIPAddress = event[sourceIPAddress],
<a id="__codelineno-36-42" name="__codelineno-36-42" href="#__codelineno-36-42"></a>
<a id="__codelineno-36-43" name="__codelineno-36-43" href="#__codelineno-36-43"></a>
<a id="__codelineno-36-44" name="__codelineno-36-44" href="#__codelineno-36-44"></a>
<a id="__codelineno-36-45" name="__codelineno-36-45" href="#__codelineno-36-45"></a>awsRegion = event[awsRegion],
<a id="__codelineno-36-46" name="__codelineno-36-46" href="#__codelineno-36-46"></a>
<a id="__codelineno-36-47" name="__codelineno-36-47" href="#__codelineno-36-47"></a>
<a id="__codelineno-36-48" name="__codelineno-36-48" href="#__codelineno-36-48"></a>
<a id="__codelineno-36-49" name="__codelineno-36-49" href="#__codelineno-36-49"></a>userARN   = event[userIdentity][arn]
<a id="__codelineno-36-50" name="__codelineno-36-50" href="#__codelineno-36-50"></a>
<a id="__codelineno-36-51" name="__codelineno-36-51" href="#__codelineno-36-51"></a>
<a id="__codelineno-36-52" name="__codelineno-36-52" href="#__codelineno-36-52"></a>
<a id="__codelineno-36-53" name="__codelineno-36-53" href="#__codelineno-36-53"></a>}
<a id="__codelineno-36-54" name="__codelineno-36-54" href="#__codelineno-36-54"></a>
<a id="__codelineno-36-55" name="__codelineno-36-55" href="#__codelineno-36-55"></a>
<a id="__codelineno-36-56" name="__codelineno-36-56" href="#__codelineno-36-56"></a>
<a id="__codelineno-36-57" name="__codelineno-36-57" href="#__codelineno-36-57"></a>| sort distinct_secrets desc
</code></pre></div>
<h2 id="related-topics_2">Related topics<a class="headerlink" href="#related-topics_2" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="/docs/secure/use-cases/threat-hunting" title="Use case scenario for threat hunting and forensics with Investigations.">Threat hunting and forensics</a></li>
<li><a href="/docs/secure/use-cases/analyze-aws-cloudtrail-logs-with-security-investigator" title="Analyze CloudTrail logs and find potential security issues with Dynatrace.">Analyze AWS CloudTrail logs with Investigations</a></li>
<li><a href="/docs/secure/use-cases/analyze-aws-api-gateway-access-logs-with-security-investigator" title="Monitor and identify errors in your Amazon API Gateway access logs with Dynatrace.">Analyze Amazon API Gateway access logs with Investigations</a></li>
<li><a href="/docs/secure/use-cases/resolve-incidents-faster-with-templates" title="Speed up your log-related investigations with Investigations templates.">Resolve incidents faster with Investigations templates</a></li>
<li><a href="/docs/secure/use-cases/operationalize-query-results" title="Build DQL queries from your query results faster and more conveniently with Dynatrace Investigations.">Operationalize DQL query results with Investigations</a></li>
</ul>
<hr />
<h2 id="source-detect-threats-cloud-native-workflowsmd">Source: detect-threats-cloud-native-workflows.md<a class="headerlink" href="#source-detect-threats-cloud-native-workflowsmd" title="Permanent link">&para;</a></h2>
<hr />
<p>title: Detect threats in cloud-native environments using workflows
source: https://www.dynatrace.com/docs/secure/use-cases/detect-threats-cloud-native-workflows
scraped: 2026-02-17T05:08:09.825265</p>
<hr />
<h1 id="detect-threats-in-cloud-native-environments-using-workflows">Detect threats in cloud-native environments using workflows<a class="headerlink" href="#detect-threats-in-cloud-native-environments-using-workflows" title="Permanent link">&para;</a></h1>
<h1 id="detect-threats-in-cloud-native-environments-using-workflows_1">Detect threats in cloud-native environments using workflows<a class="headerlink" href="#detect-threats-in-cloud-native-environments-using-workflows_1" title="Permanent link">&para;</a></h1>
<ul>
<li>Latest Dynatrace</li>
<li>Tutorial</li>
<li>Updated on Sep 10, 2025</li>
</ul>
<p>In this tutorial, you'll learn how to</p>
<ul>
<li>Continuously detect and respond to active threats within your cloud-native environment</li>
<li>Find attackers trying to exploit your applications before they can negatively affect your business</li>
<li>Easily and flexibly search through huge amounts of data to find signs of suspicious behavior</li>
</ul>
<h2 id="target-audience_5">Target audience<a class="headerlink" href="#target-audience_5" title="Permanent link">&para;</a></h2>
<p>This article is intended for</p>
<ul>
<li>DevOps, CloudOps, and SREs responsible for protecting workloads</li>
<li>Security analysts responsible for cloud-native environments</li>
</ul>
<h2 id="prerequisites_6">Prerequisites<a class="headerlink" href="#prerequisites_6" title="Permanent link">&para;</a></h2>
<ul>
<li>Set up ingestion of Kubernetes audit logs, for example, through <a href="/docs/ingest-from/amazon-web-services/integrate-with-aws/aws-logs-ingest/lma-stream-logs-with-firehose" title="Amazon Data Firehose integration allows ingest of cloud logs directly, without additional infrastructure needed, and at higher throughput.">Amazon Firehose</a>. Firehose can be used to ship logs from Amazon Elastic Kubernetes Service (EKS), but the provided template is compatible with any Kubernetes distribution.</li>
<li>Generate an access token with the <code>openpipeline.events_security</code> scope to allow us to ingest detection findings. To later access the token securely from within a workflow, store the token in the <a href="/docs/manage/credential-vault" title="Store and manage credentials in the credential vault.">credential vault</a>. For details, see <a href="/docs/dynatrace-api/basics/dynatrace-api-authentication" title="Find out how to get authenticated to use the Dynatrace API.">Dynatrace API - Tokens and authentication</a>.</li>
</ul>
<h2 id="get-started_5">Get started<a class="headerlink" href="#get-started_5" title="Permanent link">&para;</a></h2>
<p>After setting up log ingestion, you can start detecting threats.</p>
<ol>
<li>Set up scheduled DQL queries</li>
</ol>
<p>Use <img alt="Workflows" src="https://dt-cdn.net/images/workflows-1024-b5708f3cf9.webp" title="Workflows" /> <strong>Workflows</strong> to execute DQL queries regularly and look for suspicious behavior in your data.</p>
<ol>
<li>Import our <a href="https://dt-url.net/s9030m9">workflow template√Ø¬ª¬ø</a>.</li>
<li>For the <strong>execute_query</strong> step, adapt the DQL query to your needs.</li>
</ol>
<p>The template query aims to find possibly compromised service accounts within our Kubernetes cluster.</p>
<ul>
<li>You can tune it, adjust its logic or modify it completely to detect other potential threats.</li>
<li>You can find additional examples in the <a href="https://www.dynatrace.com/news/blog/threat-detection-cloud-native-kubernetes/">Dynatrace blog√Ø¬ª¬ø</a>.</li>
<li>
<p>For the <strong>ingest_findings</strong> step, go to <strong>Input</strong> &gt; <strong>Authentication</strong> and select the token previously stored in the credential vault.</p>
</li>
<li>
<p>Test the workflow</p>
</li>
</ul>
<p>To trigger a detection finding based on the query provided, execute the following commands in a Dynatrace-monitored Kubernetes cluster:</p>
<ol>
<li>Create a test service account:</li>
</ol>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a>kubectl create serviceaccount test-sa -n default
</code></pre></div>
2. Attempt unauthorized access (should trigger detection):</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-38-1" name="__codelineno-38-1" href="#__codelineno-38-1"></a>kubectl --as=system:serviceaccount:default:test-sa get secret -A
</code></pre></div>
<ol>
<li>Tune detection</li>
</ol>
<p>You can define exceptions to the rule by adding allowlisting criteria to the <strong>apply_allowlist</strong> step in the workflow.</p>
<p>A detection finding event will not be created if all attributes of an entry match those of any single allowlisted entry.</p>
<ul>
<li>Attribute comparison follows <code>AND</code> logic within an entry.</li>
<li>
<p>Allowlist evaluation uses <code>OR</code> logic across entries.</p>
</li>
<li>
<p>Triage and investigate</p>
</li>
</ul>
<p>Use <a href="/docs/secure/threats-and-exploits" title="Understand, triage, and investigate detection findings and alerts."><img alt="Threats &amp; Exploits" src="https://dt-cdn.net/images/attacks-512-b922840b12.png" title="Threats &amp; Exploits" /> <strong>Threats &amp; Exploits</strong></a> to examine and prioritize the detection findings created. The rich observability context provided in the detection finding enables fast analysis and confident assessment of the situation.</p>
<p><strong>Sample result</strong></p>
<p><img alt="sample result in threats and exploits app" src="https://dt-cdn.net/images/image-58-1667-0a98717d9c.png" /></p>
<h2 id="sample-workflows-for-threat-response">Sample workflows for threat response<a class="headerlink" href="#sample-workflows-for-threat-response" title="Permanent link">&para;</a></h2>
<p>Dynatrace provides ready-to-use workflow templates that automatically trigger on new Kubernetes threat detection findings and send notifications via <a href="/docs/analyze-explore-automate/workflows/actions/slack#workflow" title="Send messages to Slack Workspaces">Slack</a>, <a href="/docs/analyze-explore-automate/workflows/actions/microsoft-teams#use" title="Send messages to Microsoft Teams">Microsoft Teams</a>, or <a href="/docs/analyze-explore-automate/workflows/actions/email" title="Automate sending out-of-the-box emails based on the events and schedules defined for your workflows.">Email</a>.
Use these as starting points to build your own automated response workflows:</p>
<ul>
<li><a href="https://dt-url.net/l9430ds">Instant notification for critical Kubernetes detection findings√Ø¬ª¬ø</a>: Triggers on high or critical findings and alerts the responsible team.</li>
<li><a href="https://dt-url.net/hs2301e">Threat detection notification sender√Ø¬ª¬ø</a>: A reusable sub-workflow for centralized notification delivery.</li>
</ul>
<p>These templates show how to enrich findings with <a href="/docs/deliver/ownership" title="Map team ownership to monitored entities for better collaboration, task assignment, incident and vulnerability response, and service-level management.">ownership</a> context and integrate real-time alerting into your response workflows.</p>
<h2 id="conclusion">Conclusion<a class="headerlink" href="#conclusion" title="Permanent link">&para;</a></h2>
<p>Workflows enable precise threat detection and response aligned with your environment√¢¬Ä¬ôs context. Features like flexible scheduling, DQL-based filtering, allowlisting, ownership tagging, and notification integration allow for rapid, low-noise detection. The included blueprint offers a modular starting point that can be fine-tuned or extended to meet specific operational needs.</p>
<hr />
<h2 id="source-discover-coverage-gaps-in-security-scansmd">Source: discover-coverage-gaps-in-security-scans.md<a class="headerlink" href="#source-discover-coverage-gaps-in-security-scansmd" title="Permanent link">&para;</a></h2>
<hr />
<p>title: Discover coverage gaps in security findings
source: https://www.dynatrace.com/docs/secure/use-cases/discover-coverage-gaps-in-security-scans
scraped: 2026-02-17T05:02:03.008320</p>
<hr />
<h1 id="discover-coverage-gaps-in-security-findings">Discover coverage gaps in security findings<a class="headerlink" href="#discover-coverage-gaps-in-security-findings" title="Permanent link">&para;</a></h1>
<h1 id="discover-coverage-gaps-in-security-findings_1">Discover coverage gaps in security findings<a class="headerlink" href="#discover-coverage-gaps-in-security-findings_1" title="Permanent link">&para;</a></h1>
<ul>
<li>Latest Dynatrace</li>
<li>Tutorial</li>
<li>Updated on Sep 30, 2025</li>
</ul>
<p>During the Software Development Lifecycle (SDLC), multiple tools scan various artifacts as they progress through the development stages. An artifact like a container image reaches the deployment stage and eventually represents your running applications. At this point, you want to be sure the artifacts went through the proper security scanning procedures and didn't skip any essential validation.</p>
<p>Gaining complete visibility of the validation cycle isn't easy, as the scanning products used by different teams silo.</p>
<p>In this context, you can</p>
<ul>
<li>Aggregate the security scans for the deployed and running artifacts.</li>
<li>Gain complete visibility into the security validations those artifacts went through before reaching your production environment.</li>
<li>Discover gaps in your security procedures and remediate them before they become a real risk.</li>
<li>Visualize security findings across the products and tools with our dashboard samples, which can also be a good foundation for tailoring further visual customization to meet your organization's posture analysis and reporting requirements.</li>
</ul>
<h2 id="target-audience_6">Target audience<a class="headerlink" href="#target-audience_6" title="Permanent link">&para;</a></h2>
<p>Security architects and managers responsible for keeping the security scan procedures aligned with the security standards.</p>
<p>Key use cases include:</p>
<ul>
<li>Gaining an overview of the performed security assessments</li>
<li>Identifying coverage gaps</li>
<li>Identifying top contributing products and their ROI</li>
</ul>
<h2 id="prerequisites_7">Prerequisites<a class="headerlink" href="#prerequisites_7" title="Permanent link">&para;</a></h2>
<p><a href="/docs/secure/threat-observability/security-events-ingest" title="Ingest external security data into Grail.">Ingest security findings</a> from your third-party product.</p>
<h2 id="get-started_6">Get started<a class="headerlink" href="#get-started_6" title="Permanent link">&para;</a></h2>
<ol>
<li>
<p>Visualize</p>
</li>
<li>
<p>Open <a href="/docs/analyze-explore-automate/dashboards-and-notebooks/dashboards-new" title="Create interactive, customizable views to visualize, analyze, and share your observability data in real time."><img alt="Dashboards" src="https://dt-cdn.net/images/dashboards-512-b1f1e9690b.png" title="Dashboards" /> <strong>Dashboards</strong></a> and go to <strong>Ready-made</strong>.</p>
</li>
<li>Search for and select <strong>Security product coverage</strong> for the desired integration.</li>
</ol>
<p>Example result:</p>
<p><img alt="dashboard sample result" src="https://dt-cdn.net/images/2025-05-07-13-27-38-1905-24ee0d41ed.png" /></p>
<ol>
<li>Analyze</li>
</ol>
<p>Open <a href="/docs/analyze-explore-automate/dashboards-and-notebooks/notebooks" title="Analyze, visualize, and share insights from your observability data√¢¬Ä¬îall in one collaborative, customizable workspace."><img alt="Notebooks" src="https://dt-cdn.net/images/notebooks-768-046137830a.webp" title="Notebooks" /> <strong>Notebooks</strong></a> to <a href="/docs/platform/grail/dynatrace-query-language" title="How to use Dynatrace Query Language.">query</a> security findings, using the data format in <a href="https://dt-url.net/3q03pb0">Semantic Dictionary√Ø¬ª¬ø</a>.</p>
<p>For a better understanding of how to build your queries, see <a href="/docs/secure/threat-observability/dql-examples#ingested" title="DQL examples for security data powered by Grail.">DQL query examples for ingested events</a>.</p>
<hr />
<h2 id="source-ingest-and-process-custom-security-findingsmd">Source: ingest-and-process-custom-security-findings.md<a class="headerlink" href="#source-ingest-and-process-custom-security-findingsmd" title="Permanent link">&para;</a></h2>
<hr />
<p>title: Ingest and process custom security findings
source: https://www.dynatrace.com/docs/secure/use-cases/ingest-and-process-custom-security-findings
scraped: 2026-02-16T21:21:57.999124</p>
<hr />
<h1 id="ingest-and-process-custom-security-findings">Ingest and process custom security findings<a class="headerlink" href="#ingest-and-process-custom-security-findings" title="Permanent link">&para;</a></h1>
<h1 id="ingest-and-process-custom-security-findings_1">Ingest and process custom security findings<a class="headerlink" href="#ingest-and-process-custom-security-findings_1" title="Permanent link">&para;</a></h1>
<ul>
<li>Latest Dynatrace</li>
<li>Tutorial</li>
<li>Updated on Jun 17, 2025</li>
</ul>
<p>In the following, you'll learn how to ingest and process custom security data while pushing the data from a third-party tool to Dynatrace, using the OpenPipeline ingest API for security events.</p>
<h2 id="target-audience_7">Target audience<a class="headerlink" href="#target-audience_7" title="Permanent link">&para;</a></h2>
<p>Security practitioners aiming to analyze, visualize, and automate custom security data with Dynatrace.</p>
<h2 id="scenario_1">Scenario<a class="headerlink" href="#scenario_1" title="Permanent link">&para;</a></h2>
<p>You're a security architect who uses Dynatrace to monitor the health of applications and services. As part of Software Development Lifecycle (SDLC) security practices, you need to ensure that developers scan container images before deploying them into production.</p>
<p>To achieve this, you want to</p>
<ol>
<li>Ingest your container scan findings to Dynatrace continuously.</li>
<li>Connect the findings to the monitored production containers.</li>
<li>Create automatic Jira tickets to the dev-owners of the containers if there are missing security scans for the corresponding container images.</li>
</ol>
<p>This article covers the first part: ingesting custom security findings and mapping them to Dynatrace Semantic Dictionary for security vulnerability findings.</p>
<p>Sample input for security findings - Trivy JSON scan report</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-39-1" name="__codelineno-39-1" href="#__codelineno-39-1"></a>{
<a id="__codelineno-39-2" name="__codelineno-39-2" href="#__codelineno-39-2"></a>
<a id="__codelineno-39-3" name="__codelineno-39-3" href="#__codelineno-39-3"></a>
<a id="__codelineno-39-4" name="__codelineno-39-4" href="#__codelineno-39-4"></a>
<a id="__codelineno-39-5" name="__codelineno-39-5" href="#__codelineno-39-5"></a>&quot;SchemaVersion&quot;: 2,
<a id="__codelineno-39-6" name="__codelineno-39-6" href="#__codelineno-39-6"></a>
<a id="__codelineno-39-7" name="__codelineno-39-7" href="#__codelineno-39-7"></a>
<a id="__codelineno-39-8" name="__codelineno-39-8" href="#__codelineno-39-8"></a>
<a id="__codelineno-39-9" name="__codelineno-39-9" href="#__codelineno-39-9"></a>&quot;CreatedAt&quot;: &quot;2021-08-25T12:20:30.000000005Z&quot;,
<a id="__codelineno-39-10" name="__codelineno-39-10" href="#__codelineno-39-10"></a>
<a id="__codelineno-39-11" name="__codelineno-39-11" href="#__codelineno-39-11"></a>
<a id="__codelineno-39-12" name="__codelineno-39-12" href="#__codelineno-39-12"></a>
<a id="__codelineno-39-13" name="__codelineno-39-13" href="#__codelineno-39-13"></a>&quot;ArtifactName&quot;: &quot;testdata/fixtures/images/alpine-39.tar.gz&quot;,
<a id="__codelineno-39-14" name="__codelineno-39-14" href="#__codelineno-39-14"></a>
<a id="__codelineno-39-15" name="__codelineno-39-15" href="#__codelineno-39-15"></a>
<a id="__codelineno-39-16" name="__codelineno-39-16" href="#__codelineno-39-16"></a>
<a id="__codelineno-39-17" name="__codelineno-39-17" href="#__codelineno-39-17"></a>&quot;ArtifactType&quot;: &quot;container_image&quot;,
<a id="__codelineno-39-18" name="__codelineno-39-18" href="#__codelineno-39-18"></a>
<a id="__codelineno-39-19" name="__codelineno-39-19" href="#__codelineno-39-19"></a>
<a id="__codelineno-39-20" name="__codelineno-39-20" href="#__codelineno-39-20"></a>
<a id="__codelineno-39-21" name="__codelineno-39-21" href="#__codelineno-39-21"></a>&quot;Metadata&quot;: {
<a id="__codelineno-39-22" name="__codelineno-39-22" href="#__codelineno-39-22"></a>
<a id="__codelineno-39-23" name="__codelineno-39-23" href="#__codelineno-39-23"></a>
<a id="__codelineno-39-24" name="__codelineno-39-24" href="#__codelineno-39-24"></a>
<a id="__codelineno-39-25" name="__codelineno-39-25" href="#__codelineno-39-25"></a>&quot;OS&quot;: {
<a id="__codelineno-39-26" name="__codelineno-39-26" href="#__codelineno-39-26"></a>
<a id="__codelineno-39-27" name="__codelineno-39-27" href="#__codelineno-39-27"></a>
<a id="__codelineno-39-28" name="__codelineno-39-28" href="#__codelineno-39-28"></a>
<a id="__codelineno-39-29" name="__codelineno-39-29" href="#__codelineno-39-29"></a>&quot;Family&quot;: &quot;alpine&quot;,
<a id="__codelineno-39-30" name="__codelineno-39-30" href="#__codelineno-39-30"></a>
<a id="__codelineno-39-31" name="__codelineno-39-31" href="#__codelineno-39-31"></a>
<a id="__codelineno-39-32" name="__codelineno-39-32" href="#__codelineno-39-32"></a>
<a id="__codelineno-39-33" name="__codelineno-39-33" href="#__codelineno-39-33"></a>&quot;Name&quot;: &quot;3.9.4&quot;,
<a id="__codelineno-39-34" name="__codelineno-39-34" href="#__codelineno-39-34"></a>
<a id="__codelineno-39-35" name="__codelineno-39-35" href="#__codelineno-39-35"></a>
<a id="__codelineno-39-36" name="__codelineno-39-36" href="#__codelineno-39-36"></a>
<a id="__codelineno-39-37" name="__codelineno-39-37" href="#__codelineno-39-37"></a>&quot;EOSL&quot;: true
<a id="__codelineno-39-38" name="__codelineno-39-38" href="#__codelineno-39-38"></a>
<a id="__codelineno-39-39" name="__codelineno-39-39" href="#__codelineno-39-39"></a>
<a id="__codelineno-39-40" name="__codelineno-39-40" href="#__codelineno-39-40"></a>
<a id="__codelineno-39-41" name="__codelineno-39-41" href="#__codelineno-39-41"></a>},
<a id="__codelineno-39-42" name="__codelineno-39-42" href="#__codelineno-39-42"></a>
<a id="__codelineno-39-43" name="__codelineno-39-43" href="#__codelineno-39-43"></a>
<a id="__codelineno-39-44" name="__codelineno-39-44" href="#__codelineno-39-44"></a>
<a id="__codelineno-39-45" name="__codelineno-39-45" href="#__codelineno-39-45"></a>&quot;ImageID&quot;: &quot;sha256:055936d3920576da37aa9bc460d70c5f212028bda1c08c0879aedf03d7a66ea1&quot;,
<a id="__codelineno-39-46" name="__codelineno-39-46" href="#__codelineno-39-46"></a>
<a id="__codelineno-39-47" name="__codelineno-39-47" href="#__codelineno-39-47"></a>
<a id="__codelineno-39-48" name="__codelineno-39-48" href="#__codelineno-39-48"></a>
<a id="__codelineno-39-49" name="__codelineno-39-49" href="#__codelineno-39-49"></a>&quot;DiffIDs&quot;: [
<a id="__codelineno-39-50" name="__codelineno-39-50" href="#__codelineno-39-50"></a>
<a id="__codelineno-39-51" name="__codelineno-39-51" href="#__codelineno-39-51"></a>
<a id="__codelineno-39-52" name="__codelineno-39-52" href="#__codelineno-39-52"></a>
<a id="__codelineno-39-53" name="__codelineno-39-53" href="#__codelineno-39-53"></a>&quot;sha256:f1b5933fe4b5f49bbe8258745cf396afe07e625bdab3168e364daf7c956b6b81&quot;
<a id="__codelineno-39-54" name="__codelineno-39-54" href="#__codelineno-39-54"></a>
<a id="__codelineno-39-55" name="__codelineno-39-55" href="#__codelineno-39-55"></a>
<a id="__codelineno-39-56" name="__codelineno-39-56" href="#__codelineno-39-56"></a>
<a id="__codelineno-39-57" name="__codelineno-39-57" href="#__codelineno-39-57"></a>],
<a id="__codelineno-39-58" name="__codelineno-39-58" href="#__codelineno-39-58"></a>
<a id="__codelineno-39-59" name="__codelineno-39-59" href="#__codelineno-39-59"></a>
<a id="__codelineno-39-60" name="__codelineno-39-60" href="#__codelineno-39-60"></a>
<a id="__codelineno-39-61" name="__codelineno-39-61" href="#__codelineno-39-61"></a>&quot;ImageConfig&quot;: {
<a id="__codelineno-39-62" name="__codelineno-39-62" href="#__codelineno-39-62"></a>
<a id="__codelineno-39-63" name="__codelineno-39-63" href="#__codelineno-39-63"></a>
<a id="__codelineno-39-64" name="__codelineno-39-64" href="#__codelineno-39-64"></a>
<a id="__codelineno-39-65" name="__codelineno-39-65" href="#__codelineno-39-65"></a>&quot;architecture&quot;: &quot;amd64&quot;,
<a id="__codelineno-39-66" name="__codelineno-39-66" href="#__codelineno-39-66"></a>
<a id="__codelineno-39-67" name="__codelineno-39-67" href="#__codelineno-39-67"></a>
<a id="__codelineno-39-68" name="__codelineno-39-68" href="#__codelineno-39-68"></a>
<a id="__codelineno-39-69" name="__codelineno-39-69" href="#__codelineno-39-69"></a>&quot;container&quot;: &quot;c10d36fa368a7ea673683682666758adf35efe98e10989505f4f566b5b18538f&quot;,
<a id="__codelineno-39-70" name="__codelineno-39-70" href="#__codelineno-39-70"></a>
<a id="__codelineno-39-71" name="__codelineno-39-71" href="#__codelineno-39-71"></a>
<a id="__codelineno-39-72" name="__codelineno-39-72" href="#__codelineno-39-72"></a>
<a id="__codelineno-39-73" name="__codelineno-39-73" href="#__codelineno-39-73"></a>&quot;created&quot;: &quot;2019-05-11T00:07:03.510395965Z&quot;,
<a id="__codelineno-39-74" name="__codelineno-39-74" href="#__codelineno-39-74"></a>
<a id="__codelineno-39-75" name="__codelineno-39-75" href="#__codelineno-39-75"></a>
<a id="__codelineno-39-76" name="__codelineno-39-76" href="#__codelineno-39-76"></a>
<a id="__codelineno-39-77" name="__codelineno-39-77" href="#__codelineno-39-77"></a>&quot;docker_version&quot;: &quot;18.06.1-ce&quot;,
<a id="__codelineno-39-78" name="__codelineno-39-78" href="#__codelineno-39-78"></a>
<a id="__codelineno-39-79" name="__codelineno-39-79" href="#__codelineno-39-79"></a>
<a id="__codelineno-39-80" name="__codelineno-39-80" href="#__codelineno-39-80"></a>
<a id="__codelineno-39-81" name="__codelineno-39-81" href="#__codelineno-39-81"></a>&quot;history&quot;: [
<a id="__codelineno-39-82" name="__codelineno-39-82" href="#__codelineno-39-82"></a>
<a id="__codelineno-39-83" name="__codelineno-39-83" href="#__codelineno-39-83"></a>
<a id="__codelineno-39-84" name="__codelineno-39-84" href="#__codelineno-39-84"></a>
<a id="__codelineno-39-85" name="__codelineno-39-85" href="#__codelineno-39-85"></a>{
<a id="__codelineno-39-86" name="__codelineno-39-86" href="#__codelineno-39-86"></a>
<a id="__codelineno-39-87" name="__codelineno-39-87" href="#__codelineno-39-87"></a>
<a id="__codelineno-39-88" name="__codelineno-39-88" href="#__codelineno-39-88"></a>
<a id="__codelineno-39-89" name="__codelineno-39-89" href="#__codelineno-39-89"></a>&quot;created&quot;: &quot;2019-05-11T00:07:03.358250803Z&quot;,
<a id="__codelineno-39-90" name="__codelineno-39-90" href="#__codelineno-39-90"></a>
<a id="__codelineno-39-91" name="__codelineno-39-91" href="#__codelineno-39-91"></a>
<a id="__codelineno-39-92" name="__codelineno-39-92" href="#__codelineno-39-92"></a>
<a id="__codelineno-39-93" name="__codelineno-39-93" href="#__codelineno-39-93"></a>&quot;created_by&quot;: &quot;/bin/sh -c #(nop) ADD file:a86aea1f3a7d68f6ae03397b99ea77f2e9ee901c5c59e59f76f93adbb4035913 in / &quot;
<a id="__codelineno-39-94" name="__codelineno-39-94" href="#__codelineno-39-94"></a>
<a id="__codelineno-39-95" name="__codelineno-39-95" href="#__codelineno-39-95"></a>
<a id="__codelineno-39-96" name="__codelineno-39-96" href="#__codelineno-39-96"></a>
<a id="__codelineno-39-97" name="__codelineno-39-97" href="#__codelineno-39-97"></a>},
<a id="__codelineno-39-98" name="__codelineno-39-98" href="#__codelineno-39-98"></a>
<a id="__codelineno-39-99" name="__codelineno-39-99" href="#__codelineno-39-99"></a>
<a id="__codelineno-39-100" name="__codelineno-39-100" href="#__codelineno-39-100"></a>
<a id="__codelineno-39-101" name="__codelineno-39-101" href="#__codelineno-39-101"></a>{
<a id="__codelineno-39-102" name="__codelineno-39-102" href="#__codelineno-39-102"></a>
<a id="__codelineno-39-103" name="__codelineno-39-103" href="#__codelineno-39-103"></a>
<a id="__codelineno-39-104" name="__codelineno-39-104" href="#__codelineno-39-104"></a>
<a id="__codelineno-39-105" name="__codelineno-39-105" href="#__codelineno-39-105"></a>&quot;created&quot;: &quot;2019-05-11T00:07:03.510395965Z&quot;,
<a id="__codelineno-39-106" name="__codelineno-39-106" href="#__codelineno-39-106"></a>
<a id="__codelineno-39-107" name="__codelineno-39-107" href="#__codelineno-39-107"></a>
<a id="__codelineno-39-108" name="__codelineno-39-108" href="#__codelineno-39-108"></a>
<a id="__codelineno-39-109" name="__codelineno-39-109" href="#__codelineno-39-109"></a>&quot;created_by&quot;: &quot;/bin/sh -c #(nop)  CMD [\&quot;/bin/sh\&quot;]&quot;,
<a id="__codelineno-39-110" name="__codelineno-39-110" href="#__codelineno-39-110"></a>
<a id="__codelineno-39-111" name="__codelineno-39-111" href="#__codelineno-39-111"></a>
<a id="__codelineno-39-112" name="__codelineno-39-112" href="#__codelineno-39-112"></a>
<a id="__codelineno-39-113" name="__codelineno-39-113" href="#__codelineno-39-113"></a>&quot;empty_layer&quot;: true
<a id="__codelineno-39-114" name="__codelineno-39-114" href="#__codelineno-39-114"></a>
<a id="__codelineno-39-115" name="__codelineno-39-115" href="#__codelineno-39-115"></a>
<a id="__codelineno-39-116" name="__codelineno-39-116" href="#__codelineno-39-116"></a>
<a id="__codelineno-39-117" name="__codelineno-39-117" href="#__codelineno-39-117"></a>}
<a id="__codelineno-39-118" name="__codelineno-39-118" href="#__codelineno-39-118"></a>
<a id="__codelineno-39-119" name="__codelineno-39-119" href="#__codelineno-39-119"></a>
<a id="__codelineno-39-120" name="__codelineno-39-120" href="#__codelineno-39-120"></a>
<a id="__codelineno-39-121" name="__codelineno-39-121" href="#__codelineno-39-121"></a>],
<a id="__codelineno-39-122" name="__codelineno-39-122" href="#__codelineno-39-122"></a>
<a id="__codelineno-39-123" name="__codelineno-39-123" href="#__codelineno-39-123"></a>
<a id="__codelineno-39-124" name="__codelineno-39-124" href="#__codelineno-39-124"></a>
<a id="__codelineno-39-125" name="__codelineno-39-125" href="#__codelineno-39-125"></a>&quot;os&quot;: &quot;linux&quot;,
<a id="__codelineno-39-126" name="__codelineno-39-126" href="#__codelineno-39-126"></a>
<a id="__codelineno-39-127" name="__codelineno-39-127" href="#__codelineno-39-127"></a>
<a id="__codelineno-39-128" name="__codelineno-39-128" href="#__codelineno-39-128"></a>
<a id="__codelineno-39-129" name="__codelineno-39-129" href="#__codelineno-39-129"></a>&quot;rootfs&quot;: {
<a id="__codelineno-39-130" name="__codelineno-39-130" href="#__codelineno-39-130"></a>
<a id="__codelineno-39-131" name="__codelineno-39-131" href="#__codelineno-39-131"></a>
<a id="__codelineno-39-132" name="__codelineno-39-132" href="#__codelineno-39-132"></a>
<a id="__codelineno-39-133" name="__codelineno-39-133" href="#__codelineno-39-133"></a>&quot;type&quot;: &quot;layers&quot;,
<a id="__codelineno-39-134" name="__codelineno-39-134" href="#__codelineno-39-134"></a>
<a id="__codelineno-39-135" name="__codelineno-39-135" href="#__codelineno-39-135"></a>
<a id="__codelineno-39-136" name="__codelineno-39-136" href="#__codelineno-39-136"></a>
<a id="__codelineno-39-137" name="__codelineno-39-137" href="#__codelineno-39-137"></a>&quot;diff_ids&quot;: [
<a id="__codelineno-39-138" name="__codelineno-39-138" href="#__codelineno-39-138"></a>
<a id="__codelineno-39-139" name="__codelineno-39-139" href="#__codelineno-39-139"></a>
<a id="__codelineno-39-140" name="__codelineno-39-140" href="#__codelineno-39-140"></a>
<a id="__codelineno-39-141" name="__codelineno-39-141" href="#__codelineno-39-141"></a>&quot;sha256:f1b5933fe4b5f49bbe8258745cf396afe07e625bdab3168e364daf7c956b6b81&quot;
<a id="__codelineno-39-142" name="__codelineno-39-142" href="#__codelineno-39-142"></a>
<a id="__codelineno-39-143" name="__codelineno-39-143" href="#__codelineno-39-143"></a>
<a id="__codelineno-39-144" name="__codelineno-39-144" href="#__codelineno-39-144"></a>
<a id="__codelineno-39-145" name="__codelineno-39-145" href="#__codelineno-39-145"></a>]
<a id="__codelineno-39-146" name="__codelineno-39-146" href="#__codelineno-39-146"></a>
<a id="__codelineno-39-147" name="__codelineno-39-147" href="#__codelineno-39-147"></a>
<a id="__codelineno-39-148" name="__codelineno-39-148" href="#__codelineno-39-148"></a>
<a id="__codelineno-39-149" name="__codelineno-39-149" href="#__codelineno-39-149"></a>},
<a id="__codelineno-39-150" name="__codelineno-39-150" href="#__codelineno-39-150"></a>
<a id="__codelineno-39-151" name="__codelineno-39-151" href="#__codelineno-39-151"></a>
<a id="__codelineno-39-152" name="__codelineno-39-152" href="#__codelineno-39-152"></a>
<a id="__codelineno-39-153" name="__codelineno-39-153" href="#__codelineno-39-153"></a>&quot;config&quot;: {
<a id="__codelineno-39-154" name="__codelineno-39-154" href="#__codelineno-39-154"></a>
<a id="__codelineno-39-155" name="__codelineno-39-155" href="#__codelineno-39-155"></a>
<a id="__codelineno-39-156" name="__codelineno-39-156" href="#__codelineno-39-156"></a>
<a id="__codelineno-39-157" name="__codelineno-39-157" href="#__codelineno-39-157"></a>&quot;Cmd&quot;: [
<a id="__codelineno-39-158" name="__codelineno-39-158" href="#__codelineno-39-158"></a>
<a id="__codelineno-39-159" name="__codelineno-39-159" href="#__codelineno-39-159"></a>
<a id="__codelineno-39-160" name="__codelineno-39-160" href="#__codelineno-39-160"></a>
<a id="__codelineno-39-161" name="__codelineno-39-161" href="#__codelineno-39-161"></a>&quot;/bin/sh&quot;
<a id="__codelineno-39-162" name="__codelineno-39-162" href="#__codelineno-39-162"></a>
<a id="__codelineno-39-163" name="__codelineno-39-163" href="#__codelineno-39-163"></a>
<a id="__codelineno-39-164" name="__codelineno-39-164" href="#__codelineno-39-164"></a>
<a id="__codelineno-39-165" name="__codelineno-39-165" href="#__codelineno-39-165"></a>],
<a id="__codelineno-39-166" name="__codelineno-39-166" href="#__codelineno-39-166"></a>
<a id="__codelineno-39-167" name="__codelineno-39-167" href="#__codelineno-39-167"></a>
<a id="__codelineno-39-168" name="__codelineno-39-168" href="#__codelineno-39-168"></a>
<a id="__codelineno-39-169" name="__codelineno-39-169" href="#__codelineno-39-169"></a>&quot;Env&quot;: [
<a id="__codelineno-39-170" name="__codelineno-39-170" href="#__codelineno-39-170"></a>
<a id="__codelineno-39-171" name="__codelineno-39-171" href="#__codelineno-39-171"></a>
<a id="__codelineno-39-172" name="__codelineno-39-172" href="#__codelineno-39-172"></a>
<a id="__codelineno-39-173" name="__codelineno-39-173" href="#__codelineno-39-173"></a>&quot;PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin&quot;
<a id="__codelineno-39-174" name="__codelineno-39-174" href="#__codelineno-39-174"></a>
<a id="__codelineno-39-175" name="__codelineno-39-175" href="#__codelineno-39-175"></a>
<a id="__codelineno-39-176" name="__codelineno-39-176" href="#__codelineno-39-176"></a>
<a id="__codelineno-39-177" name="__codelineno-39-177" href="#__codelineno-39-177"></a>],
<a id="__codelineno-39-178" name="__codelineno-39-178" href="#__codelineno-39-178"></a>
<a id="__codelineno-39-179" name="__codelineno-39-179" href="#__codelineno-39-179"></a>
<a id="__codelineno-39-180" name="__codelineno-39-180" href="#__codelineno-39-180"></a>
<a id="__codelineno-39-181" name="__codelineno-39-181" href="#__codelineno-39-181"></a>&quot;Image&quot;: &quot;sha256:09f2bbe58e774849d74dc1391c2e01731896c745c4aba1ecf69a283bdb4b537a&quot;,
<a id="__codelineno-39-182" name="__codelineno-39-182" href="#__codelineno-39-182"></a>
<a id="__codelineno-39-183" name="__codelineno-39-183" href="#__codelineno-39-183"></a>
<a id="__codelineno-39-184" name="__codelineno-39-184" href="#__codelineno-39-184"></a>
<a id="__codelineno-39-185" name="__codelineno-39-185" href="#__codelineno-39-185"></a>&quot;ArgsEscaped&quot;: true
<a id="__codelineno-39-186" name="__codelineno-39-186" href="#__codelineno-39-186"></a>
<a id="__codelineno-39-187" name="__codelineno-39-187" href="#__codelineno-39-187"></a>
<a id="__codelineno-39-188" name="__codelineno-39-188" href="#__codelineno-39-188"></a>
<a id="__codelineno-39-189" name="__codelineno-39-189" href="#__codelineno-39-189"></a>}
<a id="__codelineno-39-190" name="__codelineno-39-190" href="#__codelineno-39-190"></a>
<a id="__codelineno-39-191" name="__codelineno-39-191" href="#__codelineno-39-191"></a>
<a id="__codelineno-39-192" name="__codelineno-39-192" href="#__codelineno-39-192"></a>
<a id="__codelineno-39-193" name="__codelineno-39-193" href="#__codelineno-39-193"></a>}
<a id="__codelineno-39-194" name="__codelineno-39-194" href="#__codelineno-39-194"></a>
<a id="__codelineno-39-195" name="__codelineno-39-195" href="#__codelineno-39-195"></a>
<a id="__codelineno-39-196" name="__codelineno-39-196" href="#__codelineno-39-196"></a>
<a id="__codelineno-39-197" name="__codelineno-39-197" href="#__codelineno-39-197"></a>},
<a id="__codelineno-39-198" name="__codelineno-39-198" href="#__codelineno-39-198"></a>
<a id="__codelineno-39-199" name="__codelineno-39-199" href="#__codelineno-39-199"></a>
<a id="__codelineno-39-200" name="__codelineno-39-200" href="#__codelineno-39-200"></a>
<a id="__codelineno-39-201" name="__codelineno-39-201" href="#__codelineno-39-201"></a>&quot;Results&quot;: [
<a id="__codelineno-39-202" name="__codelineno-39-202" href="#__codelineno-39-202"></a>
<a id="__codelineno-39-203" name="__codelineno-39-203" href="#__codelineno-39-203"></a>
<a id="__codelineno-39-204" name="__codelineno-39-204" href="#__codelineno-39-204"></a>
<a id="__codelineno-39-205" name="__codelineno-39-205" href="#__codelineno-39-205"></a>{
<a id="__codelineno-39-206" name="__codelineno-39-206" href="#__codelineno-39-206"></a>
<a id="__codelineno-39-207" name="__codelineno-39-207" href="#__codelineno-39-207"></a>
<a id="__codelineno-39-208" name="__codelineno-39-208" href="#__codelineno-39-208"></a>
<a id="__codelineno-39-209" name="__codelineno-39-209" href="#__codelineno-39-209"></a>&quot;Target&quot;: &quot;testdata/fixtures/images/alpine-39.tar.gz (alpine 3.9.4)&quot;,
<a id="__codelineno-39-210" name="__codelineno-39-210" href="#__codelineno-39-210"></a>
<a id="__codelineno-39-211" name="__codelineno-39-211" href="#__codelineno-39-211"></a>
<a id="__codelineno-39-212" name="__codelineno-39-212" href="#__codelineno-39-212"></a>
<a id="__codelineno-39-213" name="__codelineno-39-213" href="#__codelineno-39-213"></a>&quot;Class&quot;: &quot;os-pkgs&quot;,
<a id="__codelineno-39-214" name="__codelineno-39-214" href="#__codelineno-39-214"></a>
<a id="__codelineno-39-215" name="__codelineno-39-215" href="#__codelineno-39-215"></a>
<a id="__codelineno-39-216" name="__codelineno-39-216" href="#__codelineno-39-216"></a>
<a id="__codelineno-39-217" name="__codelineno-39-217" href="#__codelineno-39-217"></a>&quot;Type&quot;: &quot;alpine&quot;,
<a id="__codelineno-39-218" name="__codelineno-39-218" href="#__codelineno-39-218"></a>
<a id="__codelineno-39-219" name="__codelineno-39-219" href="#__codelineno-39-219"></a>
<a id="__codelineno-39-220" name="__codelineno-39-220" href="#__codelineno-39-220"></a>
<a id="__codelineno-39-221" name="__codelineno-39-221" href="#__codelineno-39-221"></a>&quot;Vulnerabilities&quot;: [
<a id="__codelineno-39-222" name="__codelineno-39-222" href="#__codelineno-39-222"></a>
<a id="__codelineno-39-223" name="__codelineno-39-223" href="#__codelineno-39-223"></a>
<a id="__codelineno-39-224" name="__codelineno-39-224" href="#__codelineno-39-224"></a>
<a id="__codelineno-39-225" name="__codelineno-39-225" href="#__codelineno-39-225"></a>{
<a id="__codelineno-39-226" name="__codelineno-39-226" href="#__codelineno-39-226"></a>
<a id="__codelineno-39-227" name="__codelineno-39-227" href="#__codelineno-39-227"></a>
<a id="__codelineno-39-228" name="__codelineno-39-228" href="#__codelineno-39-228"></a>
<a id="__codelineno-39-229" name="__codelineno-39-229" href="#__codelineno-39-229"></a>&quot;VulnerabilityID&quot;: &quot;CVE-2019-14697&quot;,
<a id="__codelineno-39-230" name="__codelineno-39-230" href="#__codelineno-39-230"></a>
<a id="__codelineno-39-231" name="__codelineno-39-231" href="#__codelineno-39-231"></a>
<a id="__codelineno-39-232" name="__codelineno-39-232" href="#__codelineno-39-232"></a>
<a id="__codelineno-39-233" name="__codelineno-39-233" href="#__codelineno-39-233"></a>&quot;PkgID&quot;: &quot;musl@1.1.20-r4&quot;,
<a id="__codelineno-39-234" name="__codelineno-39-234" href="#__codelineno-39-234"></a>
<a id="__codelineno-39-235" name="__codelineno-39-235" href="#__codelineno-39-235"></a>
<a id="__codelineno-39-236" name="__codelineno-39-236" href="#__codelineno-39-236"></a>
<a id="__codelineno-39-237" name="__codelineno-39-237" href="#__codelineno-39-237"></a>&quot;PkgName&quot;: &quot;musl&quot;,
<a id="__codelineno-39-238" name="__codelineno-39-238" href="#__codelineno-39-238"></a>
<a id="__codelineno-39-239" name="__codelineno-39-239" href="#__codelineno-39-239"></a>
<a id="__codelineno-39-240" name="__codelineno-39-240" href="#__codelineno-39-240"></a>
<a id="__codelineno-39-241" name="__codelineno-39-241" href="#__codelineno-39-241"></a>&quot;PkgIdentifier&quot;: {
<a id="__codelineno-39-242" name="__codelineno-39-242" href="#__codelineno-39-242"></a>
<a id="__codelineno-39-243" name="__codelineno-39-243" href="#__codelineno-39-243"></a>
<a id="__codelineno-39-244" name="__codelineno-39-244" href="#__codelineno-39-244"></a>
<a id="__codelineno-39-245" name="__codelineno-39-245" href="#__codelineno-39-245"></a>&quot;PURL&quot;: &quot;pkg:apk/alpine/musl@1.1.20-r4?arch=x86_64\u0026distro=3.9.4&quot;,
<a id="__codelineno-39-246" name="__codelineno-39-246" href="#__codelineno-39-246"></a>
<a id="__codelineno-39-247" name="__codelineno-39-247" href="#__codelineno-39-247"></a>
<a id="__codelineno-39-248" name="__codelineno-39-248" href="#__codelineno-39-248"></a>
<a id="__codelineno-39-249" name="__codelineno-39-249" href="#__codelineno-39-249"></a>&quot;UID&quot;: &quot;d6abd271e71d3ce2&quot;
<a id="__codelineno-39-250" name="__codelineno-39-250" href="#__codelineno-39-250"></a>
<a id="__codelineno-39-251" name="__codelineno-39-251" href="#__codelineno-39-251"></a>
<a id="__codelineno-39-252" name="__codelineno-39-252" href="#__codelineno-39-252"></a>
<a id="__codelineno-39-253" name="__codelineno-39-253" href="#__codelineno-39-253"></a>},
<a id="__codelineno-39-254" name="__codelineno-39-254" href="#__codelineno-39-254"></a>
<a id="__codelineno-39-255" name="__codelineno-39-255" href="#__codelineno-39-255"></a>
<a id="__codelineno-39-256" name="__codelineno-39-256" href="#__codelineno-39-256"></a>
<a id="__codelineno-39-257" name="__codelineno-39-257" href="#__codelineno-39-257"></a>&quot;InstalledVersion&quot;: &quot;1.1.20-r4&quot;,
<a id="__codelineno-39-258" name="__codelineno-39-258" href="#__codelineno-39-258"></a>
<a id="__codelineno-39-259" name="__codelineno-39-259" href="#__codelineno-39-259"></a>
<a id="__codelineno-39-260" name="__codelineno-39-260" href="#__codelineno-39-260"></a>
<a id="__codelineno-39-261" name="__codelineno-39-261" href="#__codelineno-39-261"></a>&quot;FixedVersion&quot;: &quot;1.1.20-r5&quot;,
<a id="__codelineno-39-262" name="__codelineno-39-262" href="#__codelineno-39-262"></a>
<a id="__codelineno-39-263" name="__codelineno-39-263" href="#__codelineno-39-263"></a>
<a id="__codelineno-39-264" name="__codelineno-39-264" href="#__codelineno-39-264"></a>
<a id="__codelineno-39-265" name="__codelineno-39-265" href="#__codelineno-39-265"></a>&quot;Status&quot;: &quot;fixed&quot;,
<a id="__codelineno-39-266" name="__codelineno-39-266" href="#__codelineno-39-266"></a>
<a id="__codelineno-39-267" name="__codelineno-39-267" href="#__codelineno-39-267"></a>
<a id="__codelineno-39-268" name="__codelineno-39-268" href="#__codelineno-39-268"></a>
<a id="__codelineno-39-269" name="__codelineno-39-269" href="#__codelineno-39-269"></a>&quot;Layer&quot;: {
<a id="__codelineno-39-270" name="__codelineno-39-270" href="#__codelineno-39-270"></a>
<a id="__codelineno-39-271" name="__codelineno-39-271" href="#__codelineno-39-271"></a>
<a id="__codelineno-39-272" name="__codelineno-39-272" href="#__codelineno-39-272"></a>
<a id="__codelineno-39-273" name="__codelineno-39-273" href="#__codelineno-39-273"></a>&quot;Digest&quot;: &quot;sha256:e7c96db7181be991f19a9fb6975cdbbd73c65f4a2681348e63a141a2192a5f10&quot;,
<a id="__codelineno-39-274" name="__codelineno-39-274" href="#__codelineno-39-274"></a>
<a id="__codelineno-39-275" name="__codelineno-39-275" href="#__codelineno-39-275"></a>
<a id="__codelineno-39-276" name="__codelineno-39-276" href="#__codelineno-39-276"></a>
<a id="__codelineno-39-277" name="__codelineno-39-277" href="#__codelineno-39-277"></a>&quot;DiffID&quot;: &quot;sha256:f1b5933fe4b5f49bbe8258745cf396afe07e625bdab3168e364daf7c956b6b81&quot;
<a id="__codelineno-39-278" name="__codelineno-39-278" href="#__codelineno-39-278"></a>
<a id="__codelineno-39-279" name="__codelineno-39-279" href="#__codelineno-39-279"></a>
<a id="__codelineno-39-280" name="__codelineno-39-280" href="#__codelineno-39-280"></a>
<a id="__codelineno-39-281" name="__codelineno-39-281" href="#__codelineno-39-281"></a>},
<a id="__codelineno-39-282" name="__codelineno-39-282" href="#__codelineno-39-282"></a>
<a id="__codelineno-39-283" name="__codelineno-39-283" href="#__codelineno-39-283"></a>
<a id="__codelineno-39-284" name="__codelineno-39-284" href="#__codelineno-39-284"></a>
<a id="__codelineno-39-285" name="__codelineno-39-285" href="#__codelineno-39-285"></a>&quot;SeveritySource&quot;: &quot;nvd&quot;,
<a id="__codelineno-39-286" name="__codelineno-39-286" href="#__codelineno-39-286"></a>
<a id="__codelineno-39-287" name="__codelineno-39-287" href="#__codelineno-39-287"></a>
<a id="__codelineno-39-288" name="__codelineno-39-288" href="#__codelineno-39-288"></a>
<a id="__codelineno-39-289" name="__codelineno-39-289" href="#__codelineno-39-289"></a>&quot;PrimaryURL&quot;: &quot;https://avd.aquasec.com/nvd/cve-2019-14697&quot;,
<a id="__codelineno-39-290" name="__codelineno-39-290" href="#__codelineno-39-290"></a>
<a id="__codelineno-39-291" name="__codelineno-39-291" href="#__codelineno-39-291"></a>
<a id="__codelineno-39-292" name="__codelineno-39-292" href="#__codelineno-39-292"></a>
<a id="__codelineno-39-293" name="__codelineno-39-293" href="#__codelineno-39-293"></a>&quot;DataSource&quot;: {
<a id="__codelineno-39-294" name="__codelineno-39-294" href="#__codelineno-39-294"></a>
<a id="__codelineno-39-295" name="__codelineno-39-295" href="#__codelineno-39-295"></a>
<a id="__codelineno-39-296" name="__codelineno-39-296" href="#__codelineno-39-296"></a>
<a id="__codelineno-39-297" name="__codelineno-39-297" href="#__codelineno-39-297"></a>&quot;ID&quot;: &quot;alpine&quot;,
<a id="__codelineno-39-298" name="__codelineno-39-298" href="#__codelineno-39-298"></a>
<a id="__codelineno-39-299" name="__codelineno-39-299" href="#__codelineno-39-299"></a>
<a id="__codelineno-39-300" name="__codelineno-39-300" href="#__codelineno-39-300"></a>
<a id="__codelineno-39-301" name="__codelineno-39-301" href="#__codelineno-39-301"></a>&quot;Name&quot;: &quot;Alpine Secdb&quot;,
<a id="__codelineno-39-302" name="__codelineno-39-302" href="#__codelineno-39-302"></a>
<a id="__codelineno-39-303" name="__codelineno-39-303" href="#__codelineno-39-303"></a>
<a id="__codelineno-39-304" name="__codelineno-39-304" href="#__codelineno-39-304"></a>
<a id="__codelineno-39-305" name="__codelineno-39-305" href="#__codelineno-39-305"></a>&quot;URL&quot;: &quot;https://secdb.alpinelinux.org/&quot;
<a id="__codelineno-39-306" name="__codelineno-39-306" href="#__codelineno-39-306"></a>
<a id="__codelineno-39-307" name="__codelineno-39-307" href="#__codelineno-39-307"></a>
<a id="__codelineno-39-308" name="__codelineno-39-308" href="#__codelineno-39-308"></a>
<a id="__codelineno-39-309" name="__codelineno-39-309" href="#__codelineno-39-309"></a>},
<a id="__codelineno-39-310" name="__codelineno-39-310" href="#__codelineno-39-310"></a>
<a id="__codelineno-39-311" name="__codelineno-39-311" href="#__codelineno-39-311"></a>
<a id="__codelineno-39-312" name="__codelineno-39-312" href="#__codelineno-39-312"></a>
<a id="__codelineno-39-313" name="__codelineno-39-313" href="#__codelineno-39-313"></a>&quot;Description&quot;: &quot;musl libc through 1.1.23 has an x87 floating-point stack adjustment imbalance, related to the math/i386/ directory. In some cases, use of this library could introduce out-of-bounds writes that are not present in an application&#39;s source code.&quot;,
<a id="__codelineno-39-314" name="__codelineno-39-314" href="#__codelineno-39-314"></a>
<a id="__codelineno-39-315" name="__codelineno-39-315" href="#__codelineno-39-315"></a>
<a id="__codelineno-39-316" name="__codelineno-39-316" href="#__codelineno-39-316"></a>
<a id="__codelineno-39-317" name="__codelineno-39-317" href="#__codelineno-39-317"></a>&quot;Severity&quot;: &quot;CRITICAL&quot;,
<a id="__codelineno-39-318" name="__codelineno-39-318" href="#__codelineno-39-318"></a>
<a id="__codelineno-39-319" name="__codelineno-39-319" href="#__codelineno-39-319"></a>
<a id="__codelineno-39-320" name="__codelineno-39-320" href="#__codelineno-39-320"></a>
<a id="__codelineno-39-321" name="__codelineno-39-321" href="#__codelineno-39-321"></a>&quot;CweIDs&quot;: [
<a id="__codelineno-39-322" name="__codelineno-39-322" href="#__codelineno-39-322"></a>
<a id="__codelineno-39-323" name="__codelineno-39-323" href="#__codelineno-39-323"></a>
<a id="__codelineno-39-324" name="__codelineno-39-324" href="#__codelineno-39-324"></a>
<a id="__codelineno-39-325" name="__codelineno-39-325" href="#__codelineno-39-325"></a>&quot;CWE-787&quot;
<a id="__codelineno-39-326" name="__codelineno-39-326" href="#__codelineno-39-326"></a>
<a id="__codelineno-39-327" name="__codelineno-39-327" href="#__codelineno-39-327"></a>
<a id="__codelineno-39-328" name="__codelineno-39-328" href="#__codelineno-39-328"></a>
<a id="__codelineno-39-329" name="__codelineno-39-329" href="#__codelineno-39-329"></a>],
<a id="__codelineno-39-330" name="__codelineno-39-330" href="#__codelineno-39-330"></a>
<a id="__codelineno-39-331" name="__codelineno-39-331" href="#__codelineno-39-331"></a>
<a id="__codelineno-39-332" name="__codelineno-39-332" href="#__codelineno-39-332"></a>
<a id="__codelineno-39-333" name="__codelineno-39-333" href="#__codelineno-39-333"></a>&quot;VendorSeverity&quot;: {
<a id="__codelineno-39-334" name="__codelineno-39-334" href="#__codelineno-39-334"></a>
<a id="__codelineno-39-335" name="__codelineno-39-335" href="#__codelineno-39-335"></a>
<a id="__codelineno-39-336" name="__codelineno-39-336" href="#__codelineno-39-336"></a>
<a id="__codelineno-39-337" name="__codelineno-39-337" href="#__codelineno-39-337"></a>&quot;nvd&quot;: 4
<a id="__codelineno-39-338" name="__codelineno-39-338" href="#__codelineno-39-338"></a>
<a id="__codelineno-39-339" name="__codelineno-39-339" href="#__codelineno-39-339"></a>
<a id="__codelineno-39-340" name="__codelineno-39-340" href="#__codelineno-39-340"></a>
<a id="__codelineno-39-341" name="__codelineno-39-341" href="#__codelineno-39-341"></a>},
<a id="__codelineno-39-342" name="__codelineno-39-342" href="#__codelineno-39-342"></a>
<a id="__codelineno-39-343" name="__codelineno-39-343" href="#__codelineno-39-343"></a>
<a id="__codelineno-39-344" name="__codelineno-39-344" href="#__codelineno-39-344"></a>
<a id="__codelineno-39-345" name="__codelineno-39-345" href="#__codelineno-39-345"></a>&quot;CVSS&quot;: {
<a id="__codelineno-39-346" name="__codelineno-39-346" href="#__codelineno-39-346"></a>
<a id="__codelineno-39-347" name="__codelineno-39-347" href="#__codelineno-39-347"></a>
<a id="__codelineno-39-348" name="__codelineno-39-348" href="#__codelineno-39-348"></a>
<a id="__codelineno-39-349" name="__codelineno-39-349" href="#__codelineno-39-349"></a>&quot;nvd&quot;: {
<a id="__codelineno-39-350" name="__codelineno-39-350" href="#__codelineno-39-350"></a>
<a id="__codelineno-39-351" name="__codelineno-39-351" href="#__codelineno-39-351"></a>
<a id="__codelineno-39-352" name="__codelineno-39-352" href="#__codelineno-39-352"></a>
<a id="__codelineno-39-353" name="__codelineno-39-353" href="#__codelineno-39-353"></a>&quot;V2Vector&quot;: &quot;AV:N/AC:L/Au:N/C:P/I:P/A:P&quot;,
<a id="__codelineno-39-354" name="__codelineno-39-354" href="#__codelineno-39-354"></a>
<a id="__codelineno-39-355" name="__codelineno-39-355" href="#__codelineno-39-355"></a>
<a id="__codelineno-39-356" name="__codelineno-39-356" href="#__codelineno-39-356"></a>
<a id="__codelineno-39-357" name="__codelineno-39-357" href="#__codelineno-39-357"></a>&quot;V3Vector&quot;: &quot;CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H&quot;,
<a id="__codelineno-39-358" name="__codelineno-39-358" href="#__codelineno-39-358"></a>
<a id="__codelineno-39-359" name="__codelineno-39-359" href="#__codelineno-39-359"></a>
<a id="__codelineno-39-360" name="__codelineno-39-360" href="#__codelineno-39-360"></a>
<a id="__codelineno-39-361" name="__codelineno-39-361" href="#__codelineno-39-361"></a>&quot;V2Score&quot;: 7.5,
<a id="__codelineno-39-362" name="__codelineno-39-362" href="#__codelineno-39-362"></a>
<a id="__codelineno-39-363" name="__codelineno-39-363" href="#__codelineno-39-363"></a>
<a id="__codelineno-39-364" name="__codelineno-39-364" href="#__codelineno-39-364"></a>
<a id="__codelineno-39-365" name="__codelineno-39-365" href="#__codelineno-39-365"></a>&quot;V3Score&quot;: 9.8
<a id="__codelineno-39-366" name="__codelineno-39-366" href="#__codelineno-39-366"></a>
<a id="__codelineno-39-367" name="__codelineno-39-367" href="#__codelineno-39-367"></a>
<a id="__codelineno-39-368" name="__codelineno-39-368" href="#__codelineno-39-368"></a>
<a id="__codelineno-39-369" name="__codelineno-39-369" href="#__codelineno-39-369"></a>}
<a id="__codelineno-39-370" name="__codelineno-39-370" href="#__codelineno-39-370"></a>
<a id="__codelineno-39-371" name="__codelineno-39-371" href="#__codelineno-39-371"></a>
<a id="__codelineno-39-372" name="__codelineno-39-372" href="#__codelineno-39-372"></a>
<a id="__codelineno-39-373" name="__codelineno-39-373" href="#__codelineno-39-373"></a>},
<a id="__codelineno-39-374" name="__codelineno-39-374" href="#__codelineno-39-374"></a>
<a id="__codelineno-39-375" name="__codelineno-39-375" href="#__codelineno-39-375"></a>
<a id="__codelineno-39-376" name="__codelineno-39-376" href="#__codelineno-39-376"></a>
<a id="__codelineno-39-377" name="__codelineno-39-377" href="#__codelineno-39-377"></a>&quot;References&quot;: [
<a id="__codelineno-39-378" name="__codelineno-39-378" href="#__codelineno-39-378"></a>
<a id="__codelineno-39-379" name="__codelineno-39-379" href="#__codelineno-39-379"></a>
<a id="__codelineno-39-380" name="__codelineno-39-380" href="#__codelineno-39-380"></a>
<a id="__codelineno-39-381" name="__codelineno-39-381" href="#__codelineno-39-381"></a>&quot;http://www.openwall.com/lists/oss-security/2019/08/06/4&quot;,
<a id="__codelineno-39-382" name="__codelineno-39-382" href="#__codelineno-39-382"></a>
<a id="__codelineno-39-383" name="__codelineno-39-383" href="#__codelineno-39-383"></a>
<a id="__codelineno-39-384" name="__codelineno-39-384" href="#__codelineno-39-384"></a>
<a id="__codelineno-39-385" name="__codelineno-39-385" href="#__codelineno-39-385"></a>&quot;https://security.gentoo.org/glsa/202003-13&quot;,
<a id="__codelineno-39-386" name="__codelineno-39-386" href="#__codelineno-39-386"></a>
<a id="__codelineno-39-387" name="__codelineno-39-387" href="#__codelineno-39-387"></a>
<a id="__codelineno-39-388" name="__codelineno-39-388" href="#__codelineno-39-388"></a>
<a id="__codelineno-39-389" name="__codelineno-39-389" href="#__codelineno-39-389"></a>&quot;https://www.openwall.com/lists/musl/2019/08/06/1&quot;
<a id="__codelineno-39-390" name="__codelineno-39-390" href="#__codelineno-39-390"></a>
<a id="__codelineno-39-391" name="__codelineno-39-391" href="#__codelineno-39-391"></a>
<a id="__codelineno-39-392" name="__codelineno-39-392" href="#__codelineno-39-392"></a>
<a id="__codelineno-39-393" name="__codelineno-39-393" href="#__codelineno-39-393"></a>],
<a id="__codelineno-39-394" name="__codelineno-39-394" href="#__codelineno-39-394"></a>
<a id="__codelineno-39-395" name="__codelineno-39-395" href="#__codelineno-39-395"></a>
<a id="__codelineno-39-396" name="__codelineno-39-396" href="#__codelineno-39-396"></a>
<a id="__codelineno-39-397" name="__codelineno-39-397" href="#__codelineno-39-397"></a>&quot;PublishedDate&quot;: &quot;2019-08-06T16:15:00Z&quot;,
<a id="__codelineno-39-398" name="__codelineno-39-398" href="#__codelineno-39-398"></a>
<a id="__codelineno-39-399" name="__codelineno-39-399" href="#__codelineno-39-399"></a>
<a id="__codelineno-39-400" name="__codelineno-39-400" href="#__codelineno-39-400"></a>
<a id="__codelineno-39-401" name="__codelineno-39-401" href="#__codelineno-39-401"></a>&quot;LastModifiedDate&quot;: &quot;2020-03-14T19:15:00Z&quot;
<a id="__codelineno-39-402" name="__codelineno-39-402" href="#__codelineno-39-402"></a>
<a id="__codelineno-39-403" name="__codelineno-39-403" href="#__codelineno-39-403"></a>
<a id="__codelineno-39-404" name="__codelineno-39-404" href="#__codelineno-39-404"></a>
<a id="__codelineno-39-405" name="__codelineno-39-405" href="#__codelineno-39-405"></a>},
<a id="__codelineno-39-406" name="__codelineno-39-406" href="#__codelineno-39-406"></a>
<a id="__codelineno-39-407" name="__codelineno-39-407" href="#__codelineno-39-407"></a>
<a id="__codelineno-39-408" name="__codelineno-39-408" href="#__codelineno-39-408"></a>
<a id="__codelineno-39-409" name="__codelineno-39-409" href="#__codelineno-39-409"></a>{
<a id="__codelineno-39-410" name="__codelineno-39-410" href="#__codelineno-39-410"></a>
<a id="__codelineno-39-411" name="__codelineno-39-411" href="#__codelineno-39-411"></a>
<a id="__codelineno-39-412" name="__codelineno-39-412" href="#__codelineno-39-412"></a>
<a id="__codelineno-39-413" name="__codelineno-39-413" href="#__codelineno-39-413"></a>&quot;VulnerabilityID&quot;: &quot;CVE-2019-14697&quot;,
<a id="__codelineno-39-414" name="__codelineno-39-414" href="#__codelineno-39-414"></a>
<a id="__codelineno-39-415" name="__codelineno-39-415" href="#__codelineno-39-415"></a>
<a id="__codelineno-39-416" name="__codelineno-39-416" href="#__codelineno-39-416"></a>
<a id="__codelineno-39-417" name="__codelineno-39-417" href="#__codelineno-39-417"></a>&quot;PkgID&quot;: &quot;musl-utils@1.1.20-r4&quot;,
<a id="__codelineno-39-418" name="__codelineno-39-418" href="#__codelineno-39-418"></a>
<a id="__codelineno-39-419" name="__codelineno-39-419" href="#__codelineno-39-419"></a>
<a id="__codelineno-39-420" name="__codelineno-39-420" href="#__codelineno-39-420"></a>
<a id="__codelineno-39-421" name="__codelineno-39-421" href="#__codelineno-39-421"></a>&quot;PkgName&quot;: &quot;musl-utils&quot;,
<a id="__codelineno-39-422" name="__codelineno-39-422" href="#__codelineno-39-422"></a>
<a id="__codelineno-39-423" name="__codelineno-39-423" href="#__codelineno-39-423"></a>
<a id="__codelineno-39-424" name="__codelineno-39-424" href="#__codelineno-39-424"></a>
<a id="__codelineno-39-425" name="__codelineno-39-425" href="#__codelineno-39-425"></a>&quot;PkgIdentifier&quot;: {
<a id="__codelineno-39-426" name="__codelineno-39-426" href="#__codelineno-39-426"></a>
<a id="__codelineno-39-427" name="__codelineno-39-427" href="#__codelineno-39-427"></a>
<a id="__codelineno-39-428" name="__codelineno-39-428" href="#__codelineno-39-428"></a>
<a id="__codelineno-39-429" name="__codelineno-39-429" href="#__codelineno-39-429"></a>&quot;PURL&quot;: &quot;pkg:apk/alpine/musl-utils@1.1.20-r4?arch=x86_64\u0026distro=3.9.4&quot;,
<a id="__codelineno-39-430" name="__codelineno-39-430" href="#__codelineno-39-430"></a>
<a id="__codelineno-39-431" name="__codelineno-39-431" href="#__codelineno-39-431"></a>
<a id="__codelineno-39-432" name="__codelineno-39-432" href="#__codelineno-39-432"></a>
<a id="__codelineno-39-433" name="__codelineno-39-433" href="#__codelineno-39-433"></a>&quot;UID&quot;: &quot;8c341199f4077fc8&quot;
<a id="__codelineno-39-434" name="__codelineno-39-434" href="#__codelineno-39-434"></a>
<a id="__codelineno-39-435" name="__codelineno-39-435" href="#__codelineno-39-435"></a>
<a id="__codelineno-39-436" name="__codelineno-39-436" href="#__codelineno-39-436"></a>
<a id="__codelineno-39-437" name="__codelineno-39-437" href="#__codelineno-39-437"></a>},
<a id="__codelineno-39-438" name="__codelineno-39-438" href="#__codelineno-39-438"></a>
<a id="__codelineno-39-439" name="__codelineno-39-439" href="#__codelineno-39-439"></a>
<a id="__codelineno-39-440" name="__codelineno-39-440" href="#__codelineno-39-440"></a>
<a id="__codelineno-39-441" name="__codelineno-39-441" href="#__codelineno-39-441"></a>&quot;InstalledVersion&quot;: &quot;1.1.20-r4&quot;,
<a id="__codelineno-39-442" name="__codelineno-39-442" href="#__codelineno-39-442"></a>
<a id="__codelineno-39-443" name="__codelineno-39-443" href="#__codelineno-39-443"></a>
<a id="__codelineno-39-444" name="__codelineno-39-444" href="#__codelineno-39-444"></a>
<a id="__codelineno-39-445" name="__codelineno-39-445" href="#__codelineno-39-445"></a>&quot;FixedVersion&quot;: &quot;1.1.20-r5&quot;,
<a id="__codelineno-39-446" name="__codelineno-39-446" href="#__codelineno-39-446"></a>
<a id="__codelineno-39-447" name="__codelineno-39-447" href="#__codelineno-39-447"></a>
<a id="__codelineno-39-448" name="__codelineno-39-448" href="#__codelineno-39-448"></a>
<a id="__codelineno-39-449" name="__codelineno-39-449" href="#__codelineno-39-449"></a>&quot;Status&quot;: &quot;fixed&quot;,
<a id="__codelineno-39-450" name="__codelineno-39-450" href="#__codelineno-39-450"></a>
<a id="__codelineno-39-451" name="__codelineno-39-451" href="#__codelineno-39-451"></a>
<a id="__codelineno-39-452" name="__codelineno-39-452" href="#__codelineno-39-452"></a>
<a id="__codelineno-39-453" name="__codelineno-39-453" href="#__codelineno-39-453"></a>&quot;Layer&quot;: {
<a id="__codelineno-39-454" name="__codelineno-39-454" href="#__codelineno-39-454"></a>
<a id="__codelineno-39-455" name="__codelineno-39-455" href="#__codelineno-39-455"></a>
<a id="__codelineno-39-456" name="__codelineno-39-456" href="#__codelineno-39-456"></a>
<a id="__codelineno-39-457" name="__codelineno-39-457" href="#__codelineno-39-457"></a>&quot;Digest&quot;: &quot;sha256:e7c96db7181be991f19a9fb6975cdbbd73c65f4a2681348e63a141a2192a5f10&quot;,
<a id="__codelineno-39-458" name="__codelineno-39-458" href="#__codelineno-39-458"></a>
<a id="__codelineno-39-459" name="__codelineno-39-459" href="#__codelineno-39-459"></a>
<a id="__codelineno-39-460" name="__codelineno-39-460" href="#__codelineno-39-460"></a>
<a id="__codelineno-39-461" name="__codelineno-39-461" href="#__codelineno-39-461"></a>&quot;DiffID&quot;: &quot;sha256:f1b5933fe4b5f49bbe8258745cf396afe07e625bdab3168e364daf7c956b6b81&quot;
<a id="__codelineno-39-462" name="__codelineno-39-462" href="#__codelineno-39-462"></a>
<a id="__codelineno-39-463" name="__codelineno-39-463" href="#__codelineno-39-463"></a>
<a id="__codelineno-39-464" name="__codelineno-39-464" href="#__codelineno-39-464"></a>
<a id="__codelineno-39-465" name="__codelineno-39-465" href="#__codelineno-39-465"></a>},
<a id="__codelineno-39-466" name="__codelineno-39-466" href="#__codelineno-39-466"></a>
<a id="__codelineno-39-467" name="__codelineno-39-467" href="#__codelineno-39-467"></a>
<a id="__codelineno-39-468" name="__codelineno-39-468" href="#__codelineno-39-468"></a>
<a id="__codelineno-39-469" name="__codelineno-39-469" href="#__codelineno-39-469"></a>&quot;SeveritySource&quot;: &quot;nvd&quot;,
<a id="__codelineno-39-470" name="__codelineno-39-470" href="#__codelineno-39-470"></a>
<a id="__codelineno-39-471" name="__codelineno-39-471" href="#__codelineno-39-471"></a>
<a id="__codelineno-39-472" name="__codelineno-39-472" href="#__codelineno-39-472"></a>
<a id="__codelineno-39-473" name="__codelineno-39-473" href="#__codelineno-39-473"></a>&quot;PrimaryURL&quot;: &quot;https://avd.aquasec.com/nvd/cve-2019-14697&quot;,
<a id="__codelineno-39-474" name="__codelineno-39-474" href="#__codelineno-39-474"></a>
<a id="__codelineno-39-475" name="__codelineno-39-475" href="#__codelineno-39-475"></a>
<a id="__codelineno-39-476" name="__codelineno-39-476" href="#__codelineno-39-476"></a>
<a id="__codelineno-39-477" name="__codelineno-39-477" href="#__codelineno-39-477"></a>&quot;DataSource&quot;: {
<a id="__codelineno-39-478" name="__codelineno-39-478" href="#__codelineno-39-478"></a>
<a id="__codelineno-39-479" name="__codelineno-39-479" href="#__codelineno-39-479"></a>
<a id="__codelineno-39-480" name="__codelineno-39-480" href="#__codelineno-39-480"></a>
<a id="__codelineno-39-481" name="__codelineno-39-481" href="#__codelineno-39-481"></a>&quot;ID&quot;: &quot;alpine&quot;,
<a id="__codelineno-39-482" name="__codelineno-39-482" href="#__codelineno-39-482"></a>
<a id="__codelineno-39-483" name="__codelineno-39-483" href="#__codelineno-39-483"></a>
<a id="__codelineno-39-484" name="__codelineno-39-484" href="#__codelineno-39-484"></a>
<a id="__codelineno-39-485" name="__codelineno-39-485" href="#__codelineno-39-485"></a>&quot;Name&quot;: &quot;Alpine Secdb&quot;,
<a id="__codelineno-39-486" name="__codelineno-39-486" href="#__codelineno-39-486"></a>
<a id="__codelineno-39-487" name="__codelineno-39-487" href="#__codelineno-39-487"></a>
<a id="__codelineno-39-488" name="__codelineno-39-488" href="#__codelineno-39-488"></a>
<a id="__codelineno-39-489" name="__codelineno-39-489" href="#__codelineno-39-489"></a>&quot;URL&quot;: &quot;https://secdb.alpinelinux.org/&quot;
<a id="__codelineno-39-490" name="__codelineno-39-490" href="#__codelineno-39-490"></a>
<a id="__codelineno-39-491" name="__codelineno-39-491" href="#__codelineno-39-491"></a>
<a id="__codelineno-39-492" name="__codelineno-39-492" href="#__codelineno-39-492"></a>
<a id="__codelineno-39-493" name="__codelineno-39-493" href="#__codelineno-39-493"></a>},
<a id="__codelineno-39-494" name="__codelineno-39-494" href="#__codelineno-39-494"></a>
<a id="__codelineno-39-495" name="__codelineno-39-495" href="#__codelineno-39-495"></a>
<a id="__codelineno-39-496" name="__codelineno-39-496" href="#__codelineno-39-496"></a>
<a id="__codelineno-39-497" name="__codelineno-39-497" href="#__codelineno-39-497"></a>&quot;Description&quot;: &quot;musl libc through 1.1.23 has an x87 floating-point stack adjustment imbalance, related to the math/i386/ directory. In some cases, use of this library could introduce out-of-bounds writes that are not present in an application&#39;s source code.&quot;,
<a id="__codelineno-39-498" name="__codelineno-39-498" href="#__codelineno-39-498"></a>
<a id="__codelineno-39-499" name="__codelineno-39-499" href="#__codelineno-39-499"></a>
<a id="__codelineno-39-500" name="__codelineno-39-500" href="#__codelineno-39-500"></a>
<a id="__codelineno-39-501" name="__codelineno-39-501" href="#__codelineno-39-501"></a>&quot;Severity&quot;: &quot;CRITICAL&quot;,
<a id="__codelineno-39-502" name="__codelineno-39-502" href="#__codelineno-39-502"></a>
<a id="__codelineno-39-503" name="__codelineno-39-503" href="#__codelineno-39-503"></a>
<a id="__codelineno-39-504" name="__codelineno-39-504" href="#__codelineno-39-504"></a>
<a id="__codelineno-39-505" name="__codelineno-39-505" href="#__codelineno-39-505"></a>&quot;CweIDs&quot;: [
<a id="__codelineno-39-506" name="__codelineno-39-506" href="#__codelineno-39-506"></a>
<a id="__codelineno-39-507" name="__codelineno-39-507" href="#__codelineno-39-507"></a>
<a id="__codelineno-39-508" name="__codelineno-39-508" href="#__codelineno-39-508"></a>
<a id="__codelineno-39-509" name="__codelineno-39-509" href="#__codelineno-39-509"></a>&quot;CWE-787&quot;
<a id="__codelineno-39-510" name="__codelineno-39-510" href="#__codelineno-39-510"></a>
<a id="__codelineno-39-511" name="__codelineno-39-511" href="#__codelineno-39-511"></a>
<a id="__codelineno-39-512" name="__codelineno-39-512" href="#__codelineno-39-512"></a>
<a id="__codelineno-39-513" name="__codelineno-39-513" href="#__codelineno-39-513"></a>],
<a id="__codelineno-39-514" name="__codelineno-39-514" href="#__codelineno-39-514"></a>
<a id="__codelineno-39-515" name="__codelineno-39-515" href="#__codelineno-39-515"></a>
<a id="__codelineno-39-516" name="__codelineno-39-516" href="#__codelineno-39-516"></a>
<a id="__codelineno-39-517" name="__codelineno-39-517" href="#__codelineno-39-517"></a>&quot;VendorSeverity&quot;: {
<a id="__codelineno-39-518" name="__codelineno-39-518" href="#__codelineno-39-518"></a>
<a id="__codelineno-39-519" name="__codelineno-39-519" href="#__codelineno-39-519"></a>
<a id="__codelineno-39-520" name="__codelineno-39-520" href="#__codelineno-39-520"></a>
<a id="__codelineno-39-521" name="__codelineno-39-521" href="#__codelineno-39-521"></a>&quot;nvd&quot;: 4
<a id="__codelineno-39-522" name="__codelineno-39-522" href="#__codelineno-39-522"></a>
<a id="__codelineno-39-523" name="__codelineno-39-523" href="#__codelineno-39-523"></a>
<a id="__codelineno-39-524" name="__codelineno-39-524" href="#__codelineno-39-524"></a>
<a id="__codelineno-39-525" name="__codelineno-39-525" href="#__codelineno-39-525"></a>},
<a id="__codelineno-39-526" name="__codelineno-39-526" href="#__codelineno-39-526"></a>
<a id="__codelineno-39-527" name="__codelineno-39-527" href="#__codelineno-39-527"></a>
<a id="__codelineno-39-528" name="__codelineno-39-528" href="#__codelineno-39-528"></a>
<a id="__codelineno-39-529" name="__codelineno-39-529" href="#__codelineno-39-529"></a>&quot;CVSS&quot;: {
<a id="__codelineno-39-530" name="__codelineno-39-530" href="#__codelineno-39-530"></a>
<a id="__codelineno-39-531" name="__codelineno-39-531" href="#__codelineno-39-531"></a>
<a id="__codelineno-39-532" name="__codelineno-39-532" href="#__codelineno-39-532"></a>
<a id="__codelineno-39-533" name="__codelineno-39-533" href="#__codelineno-39-533"></a>&quot;nvd&quot;: {
<a id="__codelineno-39-534" name="__codelineno-39-534" href="#__codelineno-39-534"></a>
<a id="__codelineno-39-535" name="__codelineno-39-535" href="#__codelineno-39-535"></a>
<a id="__codelineno-39-536" name="__codelineno-39-536" href="#__codelineno-39-536"></a>
<a id="__codelineno-39-537" name="__codelineno-39-537" href="#__codelineno-39-537"></a>&quot;V2Vector&quot;: &quot;AV:N/AC:L/Au:N/C:P/I:P/A:P&quot;,
<a id="__codelineno-39-538" name="__codelineno-39-538" href="#__codelineno-39-538"></a>
<a id="__codelineno-39-539" name="__codelineno-39-539" href="#__codelineno-39-539"></a>
<a id="__codelineno-39-540" name="__codelineno-39-540" href="#__codelineno-39-540"></a>
<a id="__codelineno-39-541" name="__codelineno-39-541" href="#__codelineno-39-541"></a>&quot;V3Vector&quot;: &quot;CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H&quot;,
<a id="__codelineno-39-542" name="__codelineno-39-542" href="#__codelineno-39-542"></a>
<a id="__codelineno-39-543" name="__codelineno-39-543" href="#__codelineno-39-543"></a>
<a id="__codelineno-39-544" name="__codelineno-39-544" href="#__codelineno-39-544"></a>
<a id="__codelineno-39-545" name="__codelineno-39-545" href="#__codelineno-39-545"></a>&quot;V2Score&quot;: 7.5,
<a id="__codelineno-39-546" name="__codelineno-39-546" href="#__codelineno-39-546"></a>
<a id="__codelineno-39-547" name="__codelineno-39-547" href="#__codelineno-39-547"></a>
<a id="__codelineno-39-548" name="__codelineno-39-548" href="#__codelineno-39-548"></a>
<a id="__codelineno-39-549" name="__codelineno-39-549" href="#__codelineno-39-549"></a>&quot;V3Score&quot;: 9.8
<a id="__codelineno-39-550" name="__codelineno-39-550" href="#__codelineno-39-550"></a>
<a id="__codelineno-39-551" name="__codelineno-39-551" href="#__codelineno-39-551"></a>
<a id="__codelineno-39-552" name="__codelineno-39-552" href="#__codelineno-39-552"></a>
<a id="__codelineno-39-553" name="__codelineno-39-553" href="#__codelineno-39-553"></a>}
<a id="__codelineno-39-554" name="__codelineno-39-554" href="#__codelineno-39-554"></a>
<a id="__codelineno-39-555" name="__codelineno-39-555" href="#__codelineno-39-555"></a>
<a id="__codelineno-39-556" name="__codelineno-39-556" href="#__codelineno-39-556"></a>
<a id="__codelineno-39-557" name="__codelineno-39-557" href="#__codelineno-39-557"></a>},
<a id="__codelineno-39-558" name="__codelineno-39-558" href="#__codelineno-39-558"></a>
<a id="__codelineno-39-559" name="__codelineno-39-559" href="#__codelineno-39-559"></a>
<a id="__codelineno-39-560" name="__codelineno-39-560" href="#__codelineno-39-560"></a>
<a id="__codelineno-39-561" name="__codelineno-39-561" href="#__codelineno-39-561"></a>&quot;References&quot;: [
<a id="__codelineno-39-562" name="__codelineno-39-562" href="#__codelineno-39-562"></a>
<a id="__codelineno-39-563" name="__codelineno-39-563" href="#__codelineno-39-563"></a>
<a id="__codelineno-39-564" name="__codelineno-39-564" href="#__codelineno-39-564"></a>
<a id="__codelineno-39-565" name="__codelineno-39-565" href="#__codelineno-39-565"></a>&quot;http://www.openwall.com/lists/oss-security/2019/08/06/4&quot;,
<a id="__codelineno-39-566" name="__codelineno-39-566" href="#__codelineno-39-566"></a>
<a id="__codelineno-39-567" name="__codelineno-39-567" href="#__codelineno-39-567"></a>
<a id="__codelineno-39-568" name="__codelineno-39-568" href="#__codelineno-39-568"></a>
<a id="__codelineno-39-569" name="__codelineno-39-569" href="#__codelineno-39-569"></a>&quot;https://security.gentoo.org/glsa/202003-13&quot;,
<a id="__codelineno-39-570" name="__codelineno-39-570" href="#__codelineno-39-570"></a>
<a id="__codelineno-39-571" name="__codelineno-39-571" href="#__codelineno-39-571"></a>
<a id="__codelineno-39-572" name="__codelineno-39-572" href="#__codelineno-39-572"></a>
<a id="__codelineno-39-573" name="__codelineno-39-573" href="#__codelineno-39-573"></a>&quot;https://www.openwall.com/lists/musl/2019/08/06/1&quot;
<a id="__codelineno-39-574" name="__codelineno-39-574" href="#__codelineno-39-574"></a>
<a id="__codelineno-39-575" name="__codelineno-39-575" href="#__codelineno-39-575"></a>
<a id="__codelineno-39-576" name="__codelineno-39-576" href="#__codelineno-39-576"></a>
<a id="__codelineno-39-577" name="__codelineno-39-577" href="#__codelineno-39-577"></a>],
<a id="__codelineno-39-578" name="__codelineno-39-578" href="#__codelineno-39-578"></a>
<a id="__codelineno-39-579" name="__codelineno-39-579" href="#__codelineno-39-579"></a>
<a id="__codelineno-39-580" name="__codelineno-39-580" href="#__codelineno-39-580"></a>
<a id="__codelineno-39-581" name="__codelineno-39-581" href="#__codelineno-39-581"></a>&quot;PublishedDate&quot;: &quot;2019-08-06T16:15:00Z&quot;,
<a id="__codelineno-39-582" name="__codelineno-39-582" href="#__codelineno-39-582"></a>
<a id="__codelineno-39-583" name="__codelineno-39-583" href="#__codelineno-39-583"></a>
<a id="__codelineno-39-584" name="__codelineno-39-584" href="#__codelineno-39-584"></a>
<a id="__codelineno-39-585" name="__codelineno-39-585" href="#__codelineno-39-585"></a>&quot;LastModifiedDate&quot;: &quot;2020-03-14T19:15:00Z&quot;
<a id="__codelineno-39-586" name="__codelineno-39-586" href="#__codelineno-39-586"></a>
<a id="__codelineno-39-587" name="__codelineno-39-587" href="#__codelineno-39-587"></a>
<a id="__codelineno-39-588" name="__codelineno-39-588" href="#__codelineno-39-588"></a>
<a id="__codelineno-39-589" name="__codelineno-39-589" href="#__codelineno-39-589"></a>}
<a id="__codelineno-39-590" name="__codelineno-39-590" href="#__codelineno-39-590"></a>
<a id="__codelineno-39-591" name="__codelineno-39-591" href="#__codelineno-39-591"></a>
<a id="__codelineno-39-592" name="__codelineno-39-592" href="#__codelineno-39-592"></a>
<a id="__codelineno-39-593" name="__codelineno-39-593" href="#__codelineno-39-593"></a>]
<a id="__codelineno-39-594" name="__codelineno-39-594" href="#__codelineno-39-594"></a>
<a id="__codelineno-39-595" name="__codelineno-39-595" href="#__codelineno-39-595"></a>
<a id="__codelineno-39-596" name="__codelineno-39-596" href="#__codelineno-39-596"></a>
<a id="__codelineno-39-597" name="__codelineno-39-597" href="#__codelineno-39-597"></a>}
<a id="__codelineno-39-598" name="__codelineno-39-598" href="#__codelineno-39-598"></a>
<a id="__codelineno-39-599" name="__codelineno-39-599" href="#__codelineno-39-599"></a>
<a id="__codelineno-39-600" name="__codelineno-39-600" href="#__codelineno-39-600"></a>
<a id="__codelineno-39-601" name="__codelineno-39-601" href="#__codelineno-39-601"></a>]
<a id="__codelineno-39-602" name="__codelineno-39-602" href="#__codelineno-39-602"></a>
<a id="__codelineno-39-603" name="__codelineno-39-603" href="#__codelineno-39-603"></a>
<a id="__codelineno-39-604" name="__codelineno-39-604" href="#__codelineno-39-604"></a>
<a id="__codelineno-39-605" name="__codelineno-39-605" href="#__codelineno-39-605"></a>}
</code></pre></div>
<h2 id="prerequisites_8">Prerequisites<a class="headerlink" href="#prerequisites_8" title="Permanent link">&para;</a></h2>
<ul>
<li>Your <a href="/docs/ingest-from/setup-on-k8s/deployment" title="Deploy Dynatrace Operator on Kubernetes">containers are deployed in Kubernetes and monitored by Dynatrace</a></li>
<li>Corresponding container images are scanned by a third-party tool (in this case, Trivy)</li>
</ul>
<h3 id="permissions">Permissions<a class="headerlink" href="#permissions" title="Permanent link">&para;</a></h3>
<p>To add new sources and pipeline processing to OpenPipeline, you need both permissions below.</p>
<ul>
<li><code>openpipeline:configurations:read</code></li>
<li><code>openpipeline:configurations:write</code></li>
</ul>
<p>To learn how to set up the permissions, see <a href="/docs/platform/grail/organize-data/assign-permissions-in-grail" title="Find out how to assign permissions to buckets and tables in Grail.">Permissions in Grail</a>.</p>
<h2 id="get-started_7">Get started<a class="headerlink" href="#get-started_7" title="Permanent link">&para;</a></h2>
<p>For instructions on ingesting any type of event, see <a href="/docs/platform/openpipeline/getting-started/how-to-ingestion" title="How to ingest data for a configuration scope in OpenPipeline.">How to ingest data (events)</a>.</p>
<ol>
<li>
<p>Configure endpoint in Dynatrace</p>
</li>
<li>
<p>Open <strong>OpenPipeline</strong>.</p>
</li>
<li>Go to <strong>Events</strong> &gt; <strong>Security events</strong> &gt; <strong>Ingest sources</strong>.</li>
<li>
<p>You have two ingest options:</p>
</li>
<li>
<p>Recommended Option 1 - Use the builtin security events endpoint Copy the URL of the builtin security events endpoint.</p>
<p><img alt="copy URL of builtin security events endpoint" src="https://dt-cdn.net/images/2024-08-28-19-48-19-1855-96c02de135.png" />
   * Option 2 - Create a custom endpoint Select  <strong>Source</strong> to <a href="/docs/platform/openpipeline/getting-started/tutorial-configure-processing#ingest" title="Configure ingest sources, routes, and processing for your data in OpenPipeline.">create a custom ingest source</a>, then copy its URL.</p>
</li>
</ol>
<p>For more information about the ingest options, see <a href="/docs/secure/threat-observability/security-events-ingest" title="Ingest external security data into Grail.">Security events ingest</a>.
4. Generate an <a href="/docs/manage/identity-access-management/access-tokens-and-oauth-clients/access-tokens/personal-access-token" title="Learn the concept of a personal access token and its scopes.">access token</a> with the required scope according to your ingest option selected in step 3.</p>
<p>For details on the required scopes, see <a href="/docs/secure/threat-observability/security-events-ingest/ingest-custom-data#start" title="Ingest security events from custom third-party products via API.">Get started</a>.</p>
<ol>
<li>Feed data into Grail</li>
</ol>
<p>Use the ingest endpoint URL and access token generated previously to configure the third-party product.</p>
<p>To work granularly later with the security findings ingested to Grail, aggregated reports should be broken into and ingested as individual findings.</p>
<p>In this case, we modified events before ingestion to include only a single container image, vulnerability, and vulnerable library.</p>
<p>Sample ingested event with a single vulnerability finding</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-40-1" name="__codelineno-40-1" href="#__codelineno-40-1"></a>{
<a id="__codelineno-40-2" name="__codelineno-40-2" href="#__codelineno-40-2"></a>
<a id="__codelineno-40-3" name="__codelineno-40-3" href="#__codelineno-40-3"></a>
<a id="__codelineno-40-4" name="__codelineno-40-4" href="#__codelineno-40-4"></a>
<a id="__codelineno-40-5" name="__codelineno-40-5" href="#__codelineno-40-5"></a>&quot;SchemaVersion&quot;: 2,
<a id="__codelineno-40-6" name="__codelineno-40-6" href="#__codelineno-40-6"></a>
<a id="__codelineno-40-7" name="__codelineno-40-7" href="#__codelineno-40-7"></a>
<a id="__codelineno-40-8" name="__codelineno-40-8" href="#__codelineno-40-8"></a>
<a id="__codelineno-40-9" name="__codelineno-40-9" href="#__codelineno-40-9"></a>&quot;CreatedAt&quot;: &quot;2021-08-25T12:20:30.000000005Z&quot;,
<a id="__codelineno-40-10" name="__codelineno-40-10" href="#__codelineno-40-10"></a>
<a id="__codelineno-40-11" name="__codelineno-40-11" href="#__codelineno-40-11"></a>
<a id="__codelineno-40-12" name="__codelineno-40-12" href="#__codelineno-40-12"></a>
<a id="__codelineno-40-13" name="__codelineno-40-13" href="#__codelineno-40-13"></a>&quot;ArtifactName&quot;: &quot;testdata/fixtures/images/alpine-39.tar.gz&quot;,
<a id="__codelineno-40-14" name="__codelineno-40-14" href="#__codelineno-40-14"></a>
<a id="__codelineno-40-15" name="__codelineno-40-15" href="#__codelineno-40-15"></a>
<a id="__codelineno-40-16" name="__codelineno-40-16" href="#__codelineno-40-16"></a>
<a id="__codelineno-40-17" name="__codelineno-40-17" href="#__codelineno-40-17"></a>&quot;ArtifactType&quot;: &quot;container_image&quot;,
<a id="__codelineno-40-18" name="__codelineno-40-18" href="#__codelineno-40-18"></a>
<a id="__codelineno-40-19" name="__codelineno-40-19" href="#__codelineno-40-19"></a>
<a id="__codelineno-40-20" name="__codelineno-40-20" href="#__codelineno-40-20"></a>
<a id="__codelineno-40-21" name="__codelineno-40-21" href="#__codelineno-40-21"></a>&quot;Metadata&quot;: {
<a id="__codelineno-40-22" name="__codelineno-40-22" href="#__codelineno-40-22"></a>
<a id="__codelineno-40-23" name="__codelineno-40-23" href="#__codelineno-40-23"></a>
<a id="__codelineno-40-24" name="__codelineno-40-24" href="#__codelineno-40-24"></a>
<a id="__codelineno-40-25" name="__codelineno-40-25" href="#__codelineno-40-25"></a>&quot;OS&quot;: {
<a id="__codelineno-40-26" name="__codelineno-40-26" href="#__codelineno-40-26"></a>
<a id="__codelineno-40-27" name="__codelineno-40-27" href="#__codelineno-40-27"></a>
<a id="__codelineno-40-28" name="__codelineno-40-28" href="#__codelineno-40-28"></a>
<a id="__codelineno-40-29" name="__codelineno-40-29" href="#__codelineno-40-29"></a>&quot;Family&quot;: &quot;alpine&quot;,
<a id="__codelineno-40-30" name="__codelineno-40-30" href="#__codelineno-40-30"></a>
<a id="__codelineno-40-31" name="__codelineno-40-31" href="#__codelineno-40-31"></a>
<a id="__codelineno-40-32" name="__codelineno-40-32" href="#__codelineno-40-32"></a>
<a id="__codelineno-40-33" name="__codelineno-40-33" href="#__codelineno-40-33"></a>&quot;Name&quot;: &quot;3.9.4&quot;,
<a id="__codelineno-40-34" name="__codelineno-40-34" href="#__codelineno-40-34"></a>
<a id="__codelineno-40-35" name="__codelineno-40-35" href="#__codelineno-40-35"></a>
<a id="__codelineno-40-36" name="__codelineno-40-36" href="#__codelineno-40-36"></a>
<a id="__codelineno-40-37" name="__codelineno-40-37" href="#__codelineno-40-37"></a>&quot;EOSL&quot;: true
<a id="__codelineno-40-38" name="__codelineno-40-38" href="#__codelineno-40-38"></a>
<a id="__codelineno-40-39" name="__codelineno-40-39" href="#__codelineno-40-39"></a>
<a id="__codelineno-40-40" name="__codelineno-40-40" href="#__codelineno-40-40"></a>
<a id="__codelineno-40-41" name="__codelineno-40-41" href="#__codelineno-40-41"></a>},
<a id="__codelineno-40-42" name="__codelineno-40-42" href="#__codelineno-40-42"></a>
<a id="__codelineno-40-43" name="__codelineno-40-43" href="#__codelineno-40-43"></a>
<a id="__codelineno-40-44" name="__codelineno-40-44" href="#__codelineno-40-44"></a>
<a id="__codelineno-40-45" name="__codelineno-40-45" href="#__codelineno-40-45"></a>&quot;ImageID&quot;: &quot;sha256:055936d3920576da37aa9bc460d70c5f212028bda1c08c0879aedf03d7a66ea1&quot;,
<a id="__codelineno-40-46" name="__codelineno-40-46" href="#__codelineno-40-46"></a>
<a id="__codelineno-40-47" name="__codelineno-40-47" href="#__codelineno-40-47"></a>
<a id="__codelineno-40-48" name="__codelineno-40-48" href="#__codelineno-40-48"></a>
<a id="__codelineno-40-49" name="__codelineno-40-49" href="#__codelineno-40-49"></a>&quot;DiffIDs&quot;: [
<a id="__codelineno-40-50" name="__codelineno-40-50" href="#__codelineno-40-50"></a>
<a id="__codelineno-40-51" name="__codelineno-40-51" href="#__codelineno-40-51"></a>
<a id="__codelineno-40-52" name="__codelineno-40-52" href="#__codelineno-40-52"></a>
<a id="__codelineno-40-53" name="__codelineno-40-53" href="#__codelineno-40-53"></a>&quot;sha256:f1b5933fe4b5f49bbe8258745cf396afe07e625bdab3168e364daf7c956b6b81&quot;
<a id="__codelineno-40-54" name="__codelineno-40-54" href="#__codelineno-40-54"></a>
<a id="__codelineno-40-55" name="__codelineno-40-55" href="#__codelineno-40-55"></a>
<a id="__codelineno-40-56" name="__codelineno-40-56" href="#__codelineno-40-56"></a>
<a id="__codelineno-40-57" name="__codelineno-40-57" href="#__codelineno-40-57"></a>],
<a id="__codelineno-40-58" name="__codelineno-40-58" href="#__codelineno-40-58"></a>
<a id="__codelineno-40-59" name="__codelineno-40-59" href="#__codelineno-40-59"></a>
<a id="__codelineno-40-60" name="__codelineno-40-60" href="#__codelineno-40-60"></a>
<a id="__codelineno-40-61" name="__codelineno-40-61" href="#__codelineno-40-61"></a>&quot;ImageConfig&quot;: {
<a id="__codelineno-40-62" name="__codelineno-40-62" href="#__codelineno-40-62"></a>
<a id="__codelineno-40-63" name="__codelineno-40-63" href="#__codelineno-40-63"></a>
<a id="__codelineno-40-64" name="__codelineno-40-64" href="#__codelineno-40-64"></a>
<a id="__codelineno-40-65" name="__codelineno-40-65" href="#__codelineno-40-65"></a>&quot;architecture&quot;: &quot;amd64&quot;,
<a id="__codelineno-40-66" name="__codelineno-40-66" href="#__codelineno-40-66"></a>
<a id="__codelineno-40-67" name="__codelineno-40-67" href="#__codelineno-40-67"></a>
<a id="__codelineno-40-68" name="__codelineno-40-68" href="#__codelineno-40-68"></a>
<a id="__codelineno-40-69" name="__codelineno-40-69" href="#__codelineno-40-69"></a>&quot;container&quot;: &quot;c10d36fa368a7ea673683682666758adf35efe98e10989505f4f566b5b18538f&quot;,
<a id="__codelineno-40-70" name="__codelineno-40-70" href="#__codelineno-40-70"></a>
<a id="__codelineno-40-71" name="__codelineno-40-71" href="#__codelineno-40-71"></a>
<a id="__codelineno-40-72" name="__codelineno-40-72" href="#__codelineno-40-72"></a>
<a id="__codelineno-40-73" name="__codelineno-40-73" href="#__codelineno-40-73"></a>&quot;created&quot;: &quot;2019-05-11T00:07:03.510395965Z&quot;,
<a id="__codelineno-40-74" name="__codelineno-40-74" href="#__codelineno-40-74"></a>
<a id="__codelineno-40-75" name="__codelineno-40-75" href="#__codelineno-40-75"></a>
<a id="__codelineno-40-76" name="__codelineno-40-76" href="#__codelineno-40-76"></a>
<a id="__codelineno-40-77" name="__codelineno-40-77" href="#__codelineno-40-77"></a>&quot;docker_version&quot;: &quot;18.06.1-ce&quot;,
<a id="__codelineno-40-78" name="__codelineno-40-78" href="#__codelineno-40-78"></a>
<a id="__codelineno-40-79" name="__codelineno-40-79" href="#__codelineno-40-79"></a>
<a id="__codelineno-40-80" name="__codelineno-40-80" href="#__codelineno-40-80"></a>
<a id="__codelineno-40-81" name="__codelineno-40-81" href="#__codelineno-40-81"></a>&quot;history&quot;: [
<a id="__codelineno-40-82" name="__codelineno-40-82" href="#__codelineno-40-82"></a>
<a id="__codelineno-40-83" name="__codelineno-40-83" href="#__codelineno-40-83"></a>
<a id="__codelineno-40-84" name="__codelineno-40-84" href="#__codelineno-40-84"></a>
<a id="__codelineno-40-85" name="__codelineno-40-85" href="#__codelineno-40-85"></a>{
<a id="__codelineno-40-86" name="__codelineno-40-86" href="#__codelineno-40-86"></a>
<a id="__codelineno-40-87" name="__codelineno-40-87" href="#__codelineno-40-87"></a>
<a id="__codelineno-40-88" name="__codelineno-40-88" href="#__codelineno-40-88"></a>
<a id="__codelineno-40-89" name="__codelineno-40-89" href="#__codelineno-40-89"></a>&quot;created&quot;: &quot;2019-05-11T00:07:03.358250803Z&quot;,
<a id="__codelineno-40-90" name="__codelineno-40-90" href="#__codelineno-40-90"></a>
<a id="__codelineno-40-91" name="__codelineno-40-91" href="#__codelineno-40-91"></a>
<a id="__codelineno-40-92" name="__codelineno-40-92" href="#__codelineno-40-92"></a>
<a id="__codelineno-40-93" name="__codelineno-40-93" href="#__codelineno-40-93"></a>&quot;created_by&quot;: &quot;/bin/sh -c #(nop) ADD file:a86aea1f3a7d68f6ae03397b99ea77f2e9ee901c5c59e59f76f93adbb4035913 in / &quot;
<a id="__codelineno-40-94" name="__codelineno-40-94" href="#__codelineno-40-94"></a>
<a id="__codelineno-40-95" name="__codelineno-40-95" href="#__codelineno-40-95"></a>
<a id="__codelineno-40-96" name="__codelineno-40-96" href="#__codelineno-40-96"></a>
<a id="__codelineno-40-97" name="__codelineno-40-97" href="#__codelineno-40-97"></a>},
<a id="__codelineno-40-98" name="__codelineno-40-98" href="#__codelineno-40-98"></a>
<a id="__codelineno-40-99" name="__codelineno-40-99" href="#__codelineno-40-99"></a>
<a id="__codelineno-40-100" name="__codelineno-40-100" href="#__codelineno-40-100"></a>
<a id="__codelineno-40-101" name="__codelineno-40-101" href="#__codelineno-40-101"></a>{
<a id="__codelineno-40-102" name="__codelineno-40-102" href="#__codelineno-40-102"></a>
<a id="__codelineno-40-103" name="__codelineno-40-103" href="#__codelineno-40-103"></a>
<a id="__codelineno-40-104" name="__codelineno-40-104" href="#__codelineno-40-104"></a>
<a id="__codelineno-40-105" name="__codelineno-40-105" href="#__codelineno-40-105"></a>&quot;created&quot;: &quot;2019-05-11T00:07:03.510395965Z&quot;,
<a id="__codelineno-40-106" name="__codelineno-40-106" href="#__codelineno-40-106"></a>
<a id="__codelineno-40-107" name="__codelineno-40-107" href="#__codelineno-40-107"></a>
<a id="__codelineno-40-108" name="__codelineno-40-108" href="#__codelineno-40-108"></a>
<a id="__codelineno-40-109" name="__codelineno-40-109" href="#__codelineno-40-109"></a>&quot;created_by&quot;: &quot;/bin/sh -c #(nop)  CMD [\&quot;/bin/sh\&quot;]&quot;,
<a id="__codelineno-40-110" name="__codelineno-40-110" href="#__codelineno-40-110"></a>
<a id="__codelineno-40-111" name="__codelineno-40-111" href="#__codelineno-40-111"></a>
<a id="__codelineno-40-112" name="__codelineno-40-112" href="#__codelineno-40-112"></a>
<a id="__codelineno-40-113" name="__codelineno-40-113" href="#__codelineno-40-113"></a>&quot;empty_layer&quot;: true
<a id="__codelineno-40-114" name="__codelineno-40-114" href="#__codelineno-40-114"></a>
<a id="__codelineno-40-115" name="__codelineno-40-115" href="#__codelineno-40-115"></a>
<a id="__codelineno-40-116" name="__codelineno-40-116" href="#__codelineno-40-116"></a>
<a id="__codelineno-40-117" name="__codelineno-40-117" href="#__codelineno-40-117"></a>}
<a id="__codelineno-40-118" name="__codelineno-40-118" href="#__codelineno-40-118"></a>
<a id="__codelineno-40-119" name="__codelineno-40-119" href="#__codelineno-40-119"></a>
<a id="__codelineno-40-120" name="__codelineno-40-120" href="#__codelineno-40-120"></a>
<a id="__codelineno-40-121" name="__codelineno-40-121" href="#__codelineno-40-121"></a>],
<a id="__codelineno-40-122" name="__codelineno-40-122" href="#__codelineno-40-122"></a>
<a id="__codelineno-40-123" name="__codelineno-40-123" href="#__codelineno-40-123"></a>
<a id="__codelineno-40-124" name="__codelineno-40-124" href="#__codelineno-40-124"></a>
<a id="__codelineno-40-125" name="__codelineno-40-125" href="#__codelineno-40-125"></a>&quot;os&quot;: &quot;linux&quot;,
<a id="__codelineno-40-126" name="__codelineno-40-126" href="#__codelineno-40-126"></a>
<a id="__codelineno-40-127" name="__codelineno-40-127" href="#__codelineno-40-127"></a>
<a id="__codelineno-40-128" name="__codelineno-40-128" href="#__codelineno-40-128"></a>
<a id="__codelineno-40-129" name="__codelineno-40-129" href="#__codelineno-40-129"></a>&quot;rootfs&quot;: {
<a id="__codelineno-40-130" name="__codelineno-40-130" href="#__codelineno-40-130"></a>
<a id="__codelineno-40-131" name="__codelineno-40-131" href="#__codelineno-40-131"></a>
<a id="__codelineno-40-132" name="__codelineno-40-132" href="#__codelineno-40-132"></a>
<a id="__codelineno-40-133" name="__codelineno-40-133" href="#__codelineno-40-133"></a>&quot;type&quot;: &quot;layers&quot;,
<a id="__codelineno-40-134" name="__codelineno-40-134" href="#__codelineno-40-134"></a>
<a id="__codelineno-40-135" name="__codelineno-40-135" href="#__codelineno-40-135"></a>
<a id="__codelineno-40-136" name="__codelineno-40-136" href="#__codelineno-40-136"></a>
<a id="__codelineno-40-137" name="__codelineno-40-137" href="#__codelineno-40-137"></a>&quot;diff_ids&quot;: [
<a id="__codelineno-40-138" name="__codelineno-40-138" href="#__codelineno-40-138"></a>
<a id="__codelineno-40-139" name="__codelineno-40-139" href="#__codelineno-40-139"></a>
<a id="__codelineno-40-140" name="__codelineno-40-140" href="#__codelineno-40-140"></a>
<a id="__codelineno-40-141" name="__codelineno-40-141" href="#__codelineno-40-141"></a>&quot;sha256:f1b5933fe4b5f49bbe8258745cf396afe07e625bdab3168e364daf7c956b6b81&quot;
<a id="__codelineno-40-142" name="__codelineno-40-142" href="#__codelineno-40-142"></a>
<a id="__codelineno-40-143" name="__codelineno-40-143" href="#__codelineno-40-143"></a>
<a id="__codelineno-40-144" name="__codelineno-40-144" href="#__codelineno-40-144"></a>
<a id="__codelineno-40-145" name="__codelineno-40-145" href="#__codelineno-40-145"></a>]
<a id="__codelineno-40-146" name="__codelineno-40-146" href="#__codelineno-40-146"></a>
<a id="__codelineno-40-147" name="__codelineno-40-147" href="#__codelineno-40-147"></a>
<a id="__codelineno-40-148" name="__codelineno-40-148" href="#__codelineno-40-148"></a>
<a id="__codelineno-40-149" name="__codelineno-40-149" href="#__codelineno-40-149"></a>},
<a id="__codelineno-40-150" name="__codelineno-40-150" href="#__codelineno-40-150"></a>
<a id="__codelineno-40-151" name="__codelineno-40-151" href="#__codelineno-40-151"></a>
<a id="__codelineno-40-152" name="__codelineno-40-152" href="#__codelineno-40-152"></a>
<a id="__codelineno-40-153" name="__codelineno-40-153" href="#__codelineno-40-153"></a>&quot;config&quot;: {
<a id="__codelineno-40-154" name="__codelineno-40-154" href="#__codelineno-40-154"></a>
<a id="__codelineno-40-155" name="__codelineno-40-155" href="#__codelineno-40-155"></a>
<a id="__codelineno-40-156" name="__codelineno-40-156" href="#__codelineno-40-156"></a>
<a id="__codelineno-40-157" name="__codelineno-40-157" href="#__codelineno-40-157"></a>&quot;Cmd&quot;: [
<a id="__codelineno-40-158" name="__codelineno-40-158" href="#__codelineno-40-158"></a>
<a id="__codelineno-40-159" name="__codelineno-40-159" href="#__codelineno-40-159"></a>
<a id="__codelineno-40-160" name="__codelineno-40-160" href="#__codelineno-40-160"></a>
<a id="__codelineno-40-161" name="__codelineno-40-161" href="#__codelineno-40-161"></a>&quot;/bin/sh&quot;
<a id="__codelineno-40-162" name="__codelineno-40-162" href="#__codelineno-40-162"></a>
<a id="__codelineno-40-163" name="__codelineno-40-163" href="#__codelineno-40-163"></a>
<a id="__codelineno-40-164" name="__codelineno-40-164" href="#__codelineno-40-164"></a>
<a id="__codelineno-40-165" name="__codelineno-40-165" href="#__codelineno-40-165"></a>],
<a id="__codelineno-40-166" name="__codelineno-40-166" href="#__codelineno-40-166"></a>
<a id="__codelineno-40-167" name="__codelineno-40-167" href="#__codelineno-40-167"></a>
<a id="__codelineno-40-168" name="__codelineno-40-168" href="#__codelineno-40-168"></a>
<a id="__codelineno-40-169" name="__codelineno-40-169" href="#__codelineno-40-169"></a>&quot;Env&quot;: [
<a id="__codelineno-40-170" name="__codelineno-40-170" href="#__codelineno-40-170"></a>
<a id="__codelineno-40-171" name="__codelineno-40-171" href="#__codelineno-40-171"></a>
<a id="__codelineno-40-172" name="__codelineno-40-172" href="#__codelineno-40-172"></a>
<a id="__codelineno-40-173" name="__codelineno-40-173" href="#__codelineno-40-173"></a>&quot;PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin&quot;
<a id="__codelineno-40-174" name="__codelineno-40-174" href="#__codelineno-40-174"></a>
<a id="__codelineno-40-175" name="__codelineno-40-175" href="#__codelineno-40-175"></a>
<a id="__codelineno-40-176" name="__codelineno-40-176" href="#__codelineno-40-176"></a>
<a id="__codelineno-40-177" name="__codelineno-40-177" href="#__codelineno-40-177"></a>],
<a id="__codelineno-40-178" name="__codelineno-40-178" href="#__codelineno-40-178"></a>
<a id="__codelineno-40-179" name="__codelineno-40-179" href="#__codelineno-40-179"></a>
<a id="__codelineno-40-180" name="__codelineno-40-180" href="#__codelineno-40-180"></a>
<a id="__codelineno-40-181" name="__codelineno-40-181" href="#__codelineno-40-181"></a>&quot;Image&quot;: &quot;sha256:09f2bbe58e774849d74dc1391c2e01731896c745c4aba1ecf69a283bdb4b537a&quot;,
<a id="__codelineno-40-182" name="__codelineno-40-182" href="#__codelineno-40-182"></a>
<a id="__codelineno-40-183" name="__codelineno-40-183" href="#__codelineno-40-183"></a>
<a id="__codelineno-40-184" name="__codelineno-40-184" href="#__codelineno-40-184"></a>
<a id="__codelineno-40-185" name="__codelineno-40-185" href="#__codelineno-40-185"></a>&quot;ArgsEscaped&quot;: true
<a id="__codelineno-40-186" name="__codelineno-40-186" href="#__codelineno-40-186"></a>
<a id="__codelineno-40-187" name="__codelineno-40-187" href="#__codelineno-40-187"></a>
<a id="__codelineno-40-188" name="__codelineno-40-188" href="#__codelineno-40-188"></a>
<a id="__codelineno-40-189" name="__codelineno-40-189" href="#__codelineno-40-189"></a>}
<a id="__codelineno-40-190" name="__codelineno-40-190" href="#__codelineno-40-190"></a>
<a id="__codelineno-40-191" name="__codelineno-40-191" href="#__codelineno-40-191"></a>
<a id="__codelineno-40-192" name="__codelineno-40-192" href="#__codelineno-40-192"></a>
<a id="__codelineno-40-193" name="__codelineno-40-193" href="#__codelineno-40-193"></a>}
<a id="__codelineno-40-194" name="__codelineno-40-194" href="#__codelineno-40-194"></a>
<a id="__codelineno-40-195" name="__codelineno-40-195" href="#__codelineno-40-195"></a>
<a id="__codelineno-40-196" name="__codelineno-40-196" href="#__codelineno-40-196"></a>
<a id="__codelineno-40-197" name="__codelineno-40-197" href="#__codelineno-40-197"></a>},
<a id="__codelineno-40-198" name="__codelineno-40-198" href="#__codelineno-40-198"></a>
<a id="__codelineno-40-199" name="__codelineno-40-199" href="#__codelineno-40-199"></a>
<a id="__codelineno-40-200" name="__codelineno-40-200" href="#__codelineno-40-200"></a>
<a id="__codelineno-40-201" name="__codelineno-40-201" href="#__codelineno-40-201"></a>&quot;Results&quot;: [
<a id="__codelineno-40-202" name="__codelineno-40-202" href="#__codelineno-40-202"></a>
<a id="__codelineno-40-203" name="__codelineno-40-203" href="#__codelineno-40-203"></a>
<a id="__codelineno-40-204" name="__codelineno-40-204" href="#__codelineno-40-204"></a>
<a id="__codelineno-40-205" name="__codelineno-40-205" href="#__codelineno-40-205"></a>{
<a id="__codelineno-40-206" name="__codelineno-40-206" href="#__codelineno-40-206"></a>
<a id="__codelineno-40-207" name="__codelineno-40-207" href="#__codelineno-40-207"></a>
<a id="__codelineno-40-208" name="__codelineno-40-208" href="#__codelineno-40-208"></a>
<a id="__codelineno-40-209" name="__codelineno-40-209" href="#__codelineno-40-209"></a>&quot;Target&quot;: &quot;testdata/fixtures/images/alpine-39.tar.gz (alpine 3.9.4)&quot;,
<a id="__codelineno-40-210" name="__codelineno-40-210" href="#__codelineno-40-210"></a>
<a id="__codelineno-40-211" name="__codelineno-40-211" href="#__codelineno-40-211"></a>
<a id="__codelineno-40-212" name="__codelineno-40-212" href="#__codelineno-40-212"></a>
<a id="__codelineno-40-213" name="__codelineno-40-213" href="#__codelineno-40-213"></a>&quot;Class&quot;: &quot;os-pkgs&quot;,
<a id="__codelineno-40-214" name="__codelineno-40-214" href="#__codelineno-40-214"></a>
<a id="__codelineno-40-215" name="__codelineno-40-215" href="#__codelineno-40-215"></a>
<a id="__codelineno-40-216" name="__codelineno-40-216" href="#__codelineno-40-216"></a>
<a id="__codelineno-40-217" name="__codelineno-40-217" href="#__codelineno-40-217"></a>&quot;Type&quot;: &quot;alpine&quot;,
<a id="__codelineno-40-218" name="__codelineno-40-218" href="#__codelineno-40-218"></a>
<a id="__codelineno-40-219" name="__codelineno-40-219" href="#__codelineno-40-219"></a>
<a id="__codelineno-40-220" name="__codelineno-40-220" href="#__codelineno-40-220"></a>
<a id="__codelineno-40-221" name="__codelineno-40-221" href="#__codelineno-40-221"></a>&quot;Vulnerabilities&quot;: [
<a id="__codelineno-40-222" name="__codelineno-40-222" href="#__codelineno-40-222"></a>
<a id="__codelineno-40-223" name="__codelineno-40-223" href="#__codelineno-40-223"></a>
<a id="__codelineno-40-224" name="__codelineno-40-224" href="#__codelineno-40-224"></a>
<a id="__codelineno-40-225" name="__codelineno-40-225" href="#__codelineno-40-225"></a>{
<a id="__codelineno-40-226" name="__codelineno-40-226" href="#__codelineno-40-226"></a>
<a id="__codelineno-40-227" name="__codelineno-40-227" href="#__codelineno-40-227"></a>
<a id="__codelineno-40-228" name="__codelineno-40-228" href="#__codelineno-40-228"></a>
<a id="__codelineno-40-229" name="__codelineno-40-229" href="#__codelineno-40-229"></a>&quot;VulnerabilityID&quot;: &quot;CVE-2019-14697&quot;,
<a id="__codelineno-40-230" name="__codelineno-40-230" href="#__codelineno-40-230"></a>
<a id="__codelineno-40-231" name="__codelineno-40-231" href="#__codelineno-40-231"></a>
<a id="__codelineno-40-232" name="__codelineno-40-232" href="#__codelineno-40-232"></a>
<a id="__codelineno-40-233" name="__codelineno-40-233" href="#__codelineno-40-233"></a>&quot;PkgID&quot;: &quot;musl@1.1.20-r4&quot;,
<a id="__codelineno-40-234" name="__codelineno-40-234" href="#__codelineno-40-234"></a>
<a id="__codelineno-40-235" name="__codelineno-40-235" href="#__codelineno-40-235"></a>
<a id="__codelineno-40-236" name="__codelineno-40-236" href="#__codelineno-40-236"></a>
<a id="__codelineno-40-237" name="__codelineno-40-237" href="#__codelineno-40-237"></a>&quot;PkgName&quot;: &quot;musl&quot;,
<a id="__codelineno-40-238" name="__codelineno-40-238" href="#__codelineno-40-238"></a>
<a id="__codelineno-40-239" name="__codelineno-40-239" href="#__codelineno-40-239"></a>
<a id="__codelineno-40-240" name="__codelineno-40-240" href="#__codelineno-40-240"></a>
<a id="__codelineno-40-241" name="__codelineno-40-241" href="#__codelineno-40-241"></a>&quot;PkgIdentifier&quot;: {
<a id="__codelineno-40-242" name="__codelineno-40-242" href="#__codelineno-40-242"></a>
<a id="__codelineno-40-243" name="__codelineno-40-243" href="#__codelineno-40-243"></a>
<a id="__codelineno-40-244" name="__codelineno-40-244" href="#__codelineno-40-244"></a>
<a id="__codelineno-40-245" name="__codelineno-40-245" href="#__codelineno-40-245"></a>&quot;PURL&quot;: &quot;pkg:apk/alpine/musl@1.1.20-r4?arch=x86_64\u0026distro=3.9.4&quot;,
<a id="__codelineno-40-246" name="__codelineno-40-246" href="#__codelineno-40-246"></a>
<a id="__codelineno-40-247" name="__codelineno-40-247" href="#__codelineno-40-247"></a>
<a id="__codelineno-40-248" name="__codelineno-40-248" href="#__codelineno-40-248"></a>
<a id="__codelineno-40-249" name="__codelineno-40-249" href="#__codelineno-40-249"></a>&quot;UID&quot;: &quot;d6abd271e71d3ce2&quot;
<a id="__codelineno-40-250" name="__codelineno-40-250" href="#__codelineno-40-250"></a>
<a id="__codelineno-40-251" name="__codelineno-40-251" href="#__codelineno-40-251"></a>
<a id="__codelineno-40-252" name="__codelineno-40-252" href="#__codelineno-40-252"></a>
<a id="__codelineno-40-253" name="__codelineno-40-253" href="#__codelineno-40-253"></a>},
<a id="__codelineno-40-254" name="__codelineno-40-254" href="#__codelineno-40-254"></a>
<a id="__codelineno-40-255" name="__codelineno-40-255" href="#__codelineno-40-255"></a>
<a id="__codelineno-40-256" name="__codelineno-40-256" href="#__codelineno-40-256"></a>
<a id="__codelineno-40-257" name="__codelineno-40-257" href="#__codelineno-40-257"></a>&quot;InstalledVersion&quot;: &quot;1.1.20-r4&quot;,
<a id="__codelineno-40-258" name="__codelineno-40-258" href="#__codelineno-40-258"></a>
<a id="__codelineno-40-259" name="__codelineno-40-259" href="#__codelineno-40-259"></a>
<a id="__codelineno-40-260" name="__codelineno-40-260" href="#__codelineno-40-260"></a>
<a id="__codelineno-40-261" name="__codelineno-40-261" href="#__codelineno-40-261"></a>&quot;FixedVersion&quot;: &quot;1.1.20-r5&quot;,
<a id="__codelineno-40-262" name="__codelineno-40-262" href="#__codelineno-40-262"></a>
<a id="__codelineno-40-263" name="__codelineno-40-263" href="#__codelineno-40-263"></a>
<a id="__codelineno-40-264" name="__codelineno-40-264" href="#__codelineno-40-264"></a>
<a id="__codelineno-40-265" name="__codelineno-40-265" href="#__codelineno-40-265"></a>&quot;Status&quot;: &quot;fixed&quot;,
<a id="__codelineno-40-266" name="__codelineno-40-266" href="#__codelineno-40-266"></a>
<a id="__codelineno-40-267" name="__codelineno-40-267" href="#__codelineno-40-267"></a>
<a id="__codelineno-40-268" name="__codelineno-40-268" href="#__codelineno-40-268"></a>
<a id="__codelineno-40-269" name="__codelineno-40-269" href="#__codelineno-40-269"></a>&quot;Layer&quot;: {
<a id="__codelineno-40-270" name="__codelineno-40-270" href="#__codelineno-40-270"></a>
<a id="__codelineno-40-271" name="__codelineno-40-271" href="#__codelineno-40-271"></a>
<a id="__codelineno-40-272" name="__codelineno-40-272" href="#__codelineno-40-272"></a>
<a id="__codelineno-40-273" name="__codelineno-40-273" href="#__codelineno-40-273"></a>&quot;Digest&quot;: &quot;sha256:e7c96db7181be991f19a9fb6975cdbbd73c65f4a2681348e63a141a2192a5f10&quot;,
<a id="__codelineno-40-274" name="__codelineno-40-274" href="#__codelineno-40-274"></a>
<a id="__codelineno-40-275" name="__codelineno-40-275" href="#__codelineno-40-275"></a>
<a id="__codelineno-40-276" name="__codelineno-40-276" href="#__codelineno-40-276"></a>
<a id="__codelineno-40-277" name="__codelineno-40-277" href="#__codelineno-40-277"></a>&quot;DiffID&quot;: &quot;sha256:f1b5933fe4b5f49bbe8258745cf396afe07e625bdab3168e364daf7c956b6b81&quot;
<a id="__codelineno-40-278" name="__codelineno-40-278" href="#__codelineno-40-278"></a>
<a id="__codelineno-40-279" name="__codelineno-40-279" href="#__codelineno-40-279"></a>
<a id="__codelineno-40-280" name="__codelineno-40-280" href="#__codelineno-40-280"></a>
<a id="__codelineno-40-281" name="__codelineno-40-281" href="#__codelineno-40-281"></a>},
<a id="__codelineno-40-282" name="__codelineno-40-282" href="#__codelineno-40-282"></a>
<a id="__codelineno-40-283" name="__codelineno-40-283" href="#__codelineno-40-283"></a>
<a id="__codelineno-40-284" name="__codelineno-40-284" href="#__codelineno-40-284"></a>
<a id="__codelineno-40-285" name="__codelineno-40-285" href="#__codelineno-40-285"></a>&quot;SeveritySource&quot;: &quot;nvd&quot;,
<a id="__codelineno-40-286" name="__codelineno-40-286" href="#__codelineno-40-286"></a>
<a id="__codelineno-40-287" name="__codelineno-40-287" href="#__codelineno-40-287"></a>
<a id="__codelineno-40-288" name="__codelineno-40-288" href="#__codelineno-40-288"></a>
<a id="__codelineno-40-289" name="__codelineno-40-289" href="#__codelineno-40-289"></a>&quot;PrimaryURL&quot;: &quot;https://avd.aquasec.com/nvd/cve-2019-14697&quot;,
<a id="__codelineno-40-290" name="__codelineno-40-290" href="#__codelineno-40-290"></a>
<a id="__codelineno-40-291" name="__codelineno-40-291" href="#__codelineno-40-291"></a>
<a id="__codelineno-40-292" name="__codelineno-40-292" href="#__codelineno-40-292"></a>
<a id="__codelineno-40-293" name="__codelineno-40-293" href="#__codelineno-40-293"></a>&quot;DataSource&quot;: {
<a id="__codelineno-40-294" name="__codelineno-40-294" href="#__codelineno-40-294"></a>
<a id="__codelineno-40-295" name="__codelineno-40-295" href="#__codelineno-40-295"></a>
<a id="__codelineno-40-296" name="__codelineno-40-296" href="#__codelineno-40-296"></a>
<a id="__codelineno-40-297" name="__codelineno-40-297" href="#__codelineno-40-297"></a>&quot;ID&quot;: &quot;alpine&quot;,
<a id="__codelineno-40-298" name="__codelineno-40-298" href="#__codelineno-40-298"></a>
<a id="__codelineno-40-299" name="__codelineno-40-299" href="#__codelineno-40-299"></a>
<a id="__codelineno-40-300" name="__codelineno-40-300" href="#__codelineno-40-300"></a>
<a id="__codelineno-40-301" name="__codelineno-40-301" href="#__codelineno-40-301"></a>&quot;Name&quot;: &quot;Alpine Secdb&quot;,
<a id="__codelineno-40-302" name="__codelineno-40-302" href="#__codelineno-40-302"></a>
<a id="__codelineno-40-303" name="__codelineno-40-303" href="#__codelineno-40-303"></a>
<a id="__codelineno-40-304" name="__codelineno-40-304" href="#__codelineno-40-304"></a>
<a id="__codelineno-40-305" name="__codelineno-40-305" href="#__codelineno-40-305"></a>&quot;URL&quot;: &quot;https://secdb.alpinelinux.org/&quot;
<a id="__codelineno-40-306" name="__codelineno-40-306" href="#__codelineno-40-306"></a>
<a id="__codelineno-40-307" name="__codelineno-40-307" href="#__codelineno-40-307"></a>
<a id="__codelineno-40-308" name="__codelineno-40-308" href="#__codelineno-40-308"></a>
<a id="__codelineno-40-309" name="__codelineno-40-309" href="#__codelineno-40-309"></a>},
<a id="__codelineno-40-310" name="__codelineno-40-310" href="#__codelineno-40-310"></a>
<a id="__codelineno-40-311" name="__codelineno-40-311" href="#__codelineno-40-311"></a>
<a id="__codelineno-40-312" name="__codelineno-40-312" href="#__codelineno-40-312"></a>
<a id="__codelineno-40-313" name="__codelineno-40-313" href="#__codelineno-40-313"></a>&quot;Description&quot;: &quot;musl libc through 1.1.23 has an x87 floating-point stack adjustment imbalance, related to the math/i386/ directory. In some cases, use of this library could introduce out-of-bounds writes that are not present in an application&#39;s source code.&quot;,
<a id="__codelineno-40-314" name="__codelineno-40-314" href="#__codelineno-40-314"></a>
<a id="__codelineno-40-315" name="__codelineno-40-315" href="#__codelineno-40-315"></a>
<a id="__codelineno-40-316" name="__codelineno-40-316" href="#__codelineno-40-316"></a>
<a id="__codelineno-40-317" name="__codelineno-40-317" href="#__codelineno-40-317"></a>&quot;Severity&quot;: &quot;CRITICAL&quot;,
<a id="__codelineno-40-318" name="__codelineno-40-318" href="#__codelineno-40-318"></a>
<a id="__codelineno-40-319" name="__codelineno-40-319" href="#__codelineno-40-319"></a>
<a id="__codelineno-40-320" name="__codelineno-40-320" href="#__codelineno-40-320"></a>
<a id="__codelineno-40-321" name="__codelineno-40-321" href="#__codelineno-40-321"></a>&quot;CweIDs&quot;: [
<a id="__codelineno-40-322" name="__codelineno-40-322" href="#__codelineno-40-322"></a>
<a id="__codelineno-40-323" name="__codelineno-40-323" href="#__codelineno-40-323"></a>
<a id="__codelineno-40-324" name="__codelineno-40-324" href="#__codelineno-40-324"></a>
<a id="__codelineno-40-325" name="__codelineno-40-325" href="#__codelineno-40-325"></a>&quot;CWE-787&quot;
<a id="__codelineno-40-326" name="__codelineno-40-326" href="#__codelineno-40-326"></a>
<a id="__codelineno-40-327" name="__codelineno-40-327" href="#__codelineno-40-327"></a>
<a id="__codelineno-40-328" name="__codelineno-40-328" href="#__codelineno-40-328"></a>
<a id="__codelineno-40-329" name="__codelineno-40-329" href="#__codelineno-40-329"></a>],
<a id="__codelineno-40-330" name="__codelineno-40-330" href="#__codelineno-40-330"></a>
<a id="__codelineno-40-331" name="__codelineno-40-331" href="#__codelineno-40-331"></a>
<a id="__codelineno-40-332" name="__codelineno-40-332" href="#__codelineno-40-332"></a>
<a id="__codelineno-40-333" name="__codelineno-40-333" href="#__codelineno-40-333"></a>&quot;VendorSeverity&quot;: {
<a id="__codelineno-40-334" name="__codelineno-40-334" href="#__codelineno-40-334"></a>
<a id="__codelineno-40-335" name="__codelineno-40-335" href="#__codelineno-40-335"></a>
<a id="__codelineno-40-336" name="__codelineno-40-336" href="#__codelineno-40-336"></a>
<a id="__codelineno-40-337" name="__codelineno-40-337" href="#__codelineno-40-337"></a>&quot;nvd&quot;: 4
<a id="__codelineno-40-338" name="__codelineno-40-338" href="#__codelineno-40-338"></a>
<a id="__codelineno-40-339" name="__codelineno-40-339" href="#__codelineno-40-339"></a>
<a id="__codelineno-40-340" name="__codelineno-40-340" href="#__codelineno-40-340"></a>
<a id="__codelineno-40-341" name="__codelineno-40-341" href="#__codelineno-40-341"></a>},
<a id="__codelineno-40-342" name="__codelineno-40-342" href="#__codelineno-40-342"></a>
<a id="__codelineno-40-343" name="__codelineno-40-343" href="#__codelineno-40-343"></a>
<a id="__codelineno-40-344" name="__codelineno-40-344" href="#__codelineno-40-344"></a>
<a id="__codelineno-40-345" name="__codelineno-40-345" href="#__codelineno-40-345"></a>&quot;CVSS&quot;: {
<a id="__codelineno-40-346" name="__codelineno-40-346" href="#__codelineno-40-346"></a>
<a id="__codelineno-40-347" name="__codelineno-40-347" href="#__codelineno-40-347"></a>
<a id="__codelineno-40-348" name="__codelineno-40-348" href="#__codelineno-40-348"></a>
<a id="__codelineno-40-349" name="__codelineno-40-349" href="#__codelineno-40-349"></a>&quot;nvd&quot;: {
<a id="__codelineno-40-350" name="__codelineno-40-350" href="#__codelineno-40-350"></a>
<a id="__codelineno-40-351" name="__codelineno-40-351" href="#__codelineno-40-351"></a>
<a id="__codelineno-40-352" name="__codelineno-40-352" href="#__codelineno-40-352"></a>
<a id="__codelineno-40-353" name="__codelineno-40-353" href="#__codelineno-40-353"></a>&quot;V2Vector&quot;: &quot;AV:N/AC:L/Au:N/C:P/I:P/A:P&quot;,
<a id="__codelineno-40-354" name="__codelineno-40-354" href="#__codelineno-40-354"></a>
<a id="__codelineno-40-355" name="__codelineno-40-355" href="#__codelineno-40-355"></a>
<a id="__codelineno-40-356" name="__codelineno-40-356" href="#__codelineno-40-356"></a>
<a id="__codelineno-40-357" name="__codelineno-40-357" href="#__codelineno-40-357"></a>&quot;V3Vector&quot;: &quot;CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H&quot;,
<a id="__codelineno-40-358" name="__codelineno-40-358" href="#__codelineno-40-358"></a>
<a id="__codelineno-40-359" name="__codelineno-40-359" href="#__codelineno-40-359"></a>
<a id="__codelineno-40-360" name="__codelineno-40-360" href="#__codelineno-40-360"></a>
<a id="__codelineno-40-361" name="__codelineno-40-361" href="#__codelineno-40-361"></a>&quot;V2Score&quot;: 7.5,
<a id="__codelineno-40-362" name="__codelineno-40-362" href="#__codelineno-40-362"></a>
<a id="__codelineno-40-363" name="__codelineno-40-363" href="#__codelineno-40-363"></a>
<a id="__codelineno-40-364" name="__codelineno-40-364" href="#__codelineno-40-364"></a>
<a id="__codelineno-40-365" name="__codelineno-40-365" href="#__codelineno-40-365"></a>&quot;V3Score&quot;: 9.8
<a id="__codelineno-40-366" name="__codelineno-40-366" href="#__codelineno-40-366"></a>
<a id="__codelineno-40-367" name="__codelineno-40-367" href="#__codelineno-40-367"></a>
<a id="__codelineno-40-368" name="__codelineno-40-368" href="#__codelineno-40-368"></a>
<a id="__codelineno-40-369" name="__codelineno-40-369" href="#__codelineno-40-369"></a>}
<a id="__codelineno-40-370" name="__codelineno-40-370" href="#__codelineno-40-370"></a>
<a id="__codelineno-40-371" name="__codelineno-40-371" href="#__codelineno-40-371"></a>
<a id="__codelineno-40-372" name="__codelineno-40-372" href="#__codelineno-40-372"></a>
<a id="__codelineno-40-373" name="__codelineno-40-373" href="#__codelineno-40-373"></a>},
<a id="__codelineno-40-374" name="__codelineno-40-374" href="#__codelineno-40-374"></a>
<a id="__codelineno-40-375" name="__codelineno-40-375" href="#__codelineno-40-375"></a>
<a id="__codelineno-40-376" name="__codelineno-40-376" href="#__codelineno-40-376"></a>
<a id="__codelineno-40-377" name="__codelineno-40-377" href="#__codelineno-40-377"></a>&quot;References&quot;: [
<a id="__codelineno-40-378" name="__codelineno-40-378" href="#__codelineno-40-378"></a>
<a id="__codelineno-40-379" name="__codelineno-40-379" href="#__codelineno-40-379"></a>
<a id="__codelineno-40-380" name="__codelineno-40-380" href="#__codelineno-40-380"></a>
<a id="__codelineno-40-381" name="__codelineno-40-381" href="#__codelineno-40-381"></a>&quot;http://www.openwall.com/lists/oss-security/2019/08/06/4&quot;,
<a id="__codelineno-40-382" name="__codelineno-40-382" href="#__codelineno-40-382"></a>
<a id="__codelineno-40-383" name="__codelineno-40-383" href="#__codelineno-40-383"></a>
<a id="__codelineno-40-384" name="__codelineno-40-384" href="#__codelineno-40-384"></a>
<a id="__codelineno-40-385" name="__codelineno-40-385" href="#__codelineno-40-385"></a>&quot;https://security.gentoo.org/glsa/202003-13&quot;,
<a id="__codelineno-40-386" name="__codelineno-40-386" href="#__codelineno-40-386"></a>
<a id="__codelineno-40-387" name="__codelineno-40-387" href="#__codelineno-40-387"></a>
<a id="__codelineno-40-388" name="__codelineno-40-388" href="#__codelineno-40-388"></a>
<a id="__codelineno-40-389" name="__codelineno-40-389" href="#__codelineno-40-389"></a>&quot;https://www.openwall.com/lists/musl/2019/08/06/1&quot;
<a id="__codelineno-40-390" name="__codelineno-40-390" href="#__codelineno-40-390"></a>
<a id="__codelineno-40-391" name="__codelineno-40-391" href="#__codelineno-40-391"></a>
<a id="__codelineno-40-392" name="__codelineno-40-392" href="#__codelineno-40-392"></a>
<a id="__codelineno-40-393" name="__codelineno-40-393" href="#__codelineno-40-393"></a>],
<a id="__codelineno-40-394" name="__codelineno-40-394" href="#__codelineno-40-394"></a>
<a id="__codelineno-40-395" name="__codelineno-40-395" href="#__codelineno-40-395"></a>
<a id="__codelineno-40-396" name="__codelineno-40-396" href="#__codelineno-40-396"></a>
<a id="__codelineno-40-397" name="__codelineno-40-397" href="#__codelineno-40-397"></a>&quot;PublishedDate&quot;: &quot;2019-08-06T16:15:00Z&quot;,
<a id="__codelineno-40-398" name="__codelineno-40-398" href="#__codelineno-40-398"></a>
<a id="__codelineno-40-399" name="__codelineno-40-399" href="#__codelineno-40-399"></a>
<a id="__codelineno-40-400" name="__codelineno-40-400" href="#__codelineno-40-400"></a>
<a id="__codelineno-40-401" name="__codelineno-40-401" href="#__codelineno-40-401"></a>&quot;LastModifiedDate&quot;: &quot;2020-03-14T19:15:00Z&quot;
<a id="__codelineno-40-402" name="__codelineno-40-402" href="#__codelineno-40-402"></a>
<a id="__codelineno-40-403" name="__codelineno-40-403" href="#__codelineno-40-403"></a>
<a id="__codelineno-40-404" name="__codelineno-40-404" href="#__codelineno-40-404"></a>
<a id="__codelineno-40-405" name="__codelineno-40-405" href="#__codelineno-40-405"></a>}
<a id="__codelineno-40-406" name="__codelineno-40-406" href="#__codelineno-40-406"></a>
<a id="__codelineno-40-407" name="__codelineno-40-407" href="#__codelineno-40-407"></a>
<a id="__codelineno-40-408" name="__codelineno-40-408" href="#__codelineno-40-408"></a>
<a id="__codelineno-40-409" name="__codelineno-40-409" href="#__codelineno-40-409"></a>]
<a id="__codelineno-40-410" name="__codelineno-40-410" href="#__codelineno-40-410"></a>
<a id="__codelineno-40-411" name="__codelineno-40-411" href="#__codelineno-40-411"></a>
<a id="__codelineno-40-412" name="__codelineno-40-412" href="#__codelineno-40-412"></a>
<a id="__codelineno-40-413" name="__codelineno-40-413" href="#__codelineno-40-413"></a>}
<a id="__codelineno-40-414" name="__codelineno-40-414" href="#__codelineno-40-414"></a>
<a id="__codelineno-40-415" name="__codelineno-40-415" href="#__codelineno-40-415"></a>
<a id="__codelineno-40-416" name="__codelineno-40-416" href="#__codelineno-40-416"></a>
<a id="__codelineno-40-417" name="__codelineno-40-417" href="#__codelineno-40-417"></a>]
<a id="__codelineno-40-418" name="__codelineno-40-418" href="#__codelineno-40-418"></a>
<a id="__codelineno-40-419" name="__codelineno-40-419" href="#__codelineno-40-419"></a>
<a id="__codelineno-40-420" name="__codelineno-40-420" href="#__codelineno-40-420"></a>
<a id="__codelineno-40-421" name="__codelineno-40-421" href="#__codelineno-40-421"></a>}
</code></pre></div>
<ol>
<li>Validate data in Notebooks</li>
</ol>
<p>To validate data, open <a href="/docs/analyze-explore-automate/dashboards-and-notebooks/notebooks" title="Analyze, visualize, and share insights from your observability data√¢¬Ä¬îall in one collaborative, customizable workspace."><img alt="Notebooks" src="https://dt-cdn.net/images/notebooks-768-046137830a.webp" title="Notebooks" /> <strong>Notebooks</strong></a> and query the security events.</p>
<p>Sample DQL query:</p>
<p>This query has been updated to align with the new Grail security events table. For the complete list of updates and actions needed to accomplish the migration, follow the steps in the <a href="/docs/secure/threat-observability/migration" title="Understand the changes in the new Grail security table and learn how to migrate to it.">Grail security table migration guide</a>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-41-1" name="__codelineno-41-1" href="#__codelineno-41-1"></a>fetch security.events
<a id="__codelineno-41-2" name="__codelineno-41-2" href="#__codelineno-41-2"></a>
<a id="__codelineno-41-3" name="__codelineno-41-3" href="#__codelineno-41-3"></a>
<a id="__codelineno-41-4" name="__codelineno-41-4" href="#__codelineno-41-4"></a>
<a id="__codelineno-41-5" name="__codelineno-41-5" href="#__codelineno-41-5"></a>| filter dt.system.bucket == &quot;default_securityevents&quot;
<a id="__codelineno-41-6" name="__codelineno-41-6" href="#__codelineno-41-6"></a>
<a id="__codelineno-41-7" name="__codelineno-41-7" href="#__codelineno-41-7"></a>
<a id="__codelineno-41-8" name="__codelineno-41-8" href="#__codelineno-41-8"></a>
<a id="__codelineno-41-9" name="__codelineno-41-9" href="#__codelineno-41-9"></a>| sort timestamp desc
</code></pre></div>
<p>To clearly distinguish ingested data from other ingested events, you can add filters for the attributes you expect there.</p>
<p>Example:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-42-1" name="__codelineno-42-1" href="#__codelineno-42-1"></a>| filter SchemaVersion == 2 AND ArtifactType == &quot;container_image&quot;
</code></pre></div>
<p>The query result should include the ingested event in the original format with a few enriched fields, such as <code>timestamp</code> and <code>event.kind</code>.</p>
<p>Sample query result</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-43-1" name="__codelineno-43-1" href="#__codelineno-43-1"></a>{
<a id="__codelineno-43-2" name="__codelineno-43-2" href="#__codelineno-43-2"></a>
<a id="__codelineno-43-3" name="__codelineno-43-3" href="#__codelineno-43-3"></a>
<a id="__codelineno-43-4" name="__codelineno-43-4" href="#__codelineno-43-4"></a>
<a id="__codelineno-43-5" name="__codelineno-43-5" href="#__codelineno-43-5"></a>// enriched fields
<a id="__codelineno-43-6" name="__codelineno-43-6" href="#__codelineno-43-6"></a>
<a id="__codelineno-43-7" name="__codelineno-43-7" href="#__codelineno-43-7"></a>
<a id="__codelineno-43-8" name="__codelineno-43-8" href="#__codelineno-43-8"></a>
<a id="__codelineno-43-9" name="__codelineno-43-9" href="#__codelineno-43-9"></a>&quot;timestamp&quot;: &quot;2024-08-02T14:38:53.854000000Z&quot;,
<a id="__codelineno-43-10" name="__codelineno-43-10" href="#__codelineno-43-10"></a>
<a id="__codelineno-43-11" name="__codelineno-43-11" href="#__codelineno-43-11"></a>
<a id="__codelineno-43-12" name="__codelineno-43-12" href="#__codelineno-43-12"></a>
<a id="__codelineno-43-13" name="__codelineno-43-13" href="#__codelineno-43-13"></a>&quot;event.kind&quot;: &quot;SECURITY_EVENT&quot;,
<a id="__codelineno-43-14" name="__codelineno-43-14" href="#__codelineno-43-14"></a>
<a id="__codelineno-43-15" name="__codelineno-43-15" href="#__codelineno-43-15"></a>
<a id="__codelineno-43-16" name="__codelineno-43-16" href="#__codelineno-43-16"></a>
<a id="__codelineno-43-17" name="__codelineno-43-17" href="#__codelineno-43-17"></a>// original fields
<a id="__codelineno-43-18" name="__codelineno-43-18" href="#__codelineno-43-18"></a>
<a id="__codelineno-43-19" name="__codelineno-43-19" href="#__codelineno-43-19"></a>
<a id="__codelineno-43-20" name="__codelineno-43-20" href="#__codelineno-43-20"></a>
<a id="__codelineno-43-21" name="__codelineno-43-21" href="#__codelineno-43-21"></a>&quot;SchemaVersion&quot;: 2,
<a id="__codelineno-43-22" name="__codelineno-43-22" href="#__codelineno-43-22"></a>
<a id="__codelineno-43-23" name="__codelineno-43-23" href="#__codelineno-43-23"></a>
<a id="__codelineno-43-24" name="__codelineno-43-24" href="#__codelineno-43-24"></a>
<a id="__codelineno-43-25" name="__codelineno-43-25" href="#__codelineno-43-25"></a>&quot;Results&quot;: [
<a id="__codelineno-43-26" name="__codelineno-43-26" href="#__codelineno-43-26"></a>
<a id="__codelineno-43-27" name="__codelineno-43-27" href="#__codelineno-43-27"></a>
<a id="__codelineno-43-28" name="__codelineno-43-28" href="#__codelineno-43-28"></a>
<a id="__codelineno-43-29" name="__codelineno-43-29" href="#__codelineno-43-29"></a>&quot;{\&quot;Target\&quot;:\&quot;testdata/fixtures/images/alpine-39.tar.gz (alpine 3.9.4)\&quot;,\&quot;Class\&quot;:\&quot;os-pkgs\&quot;,\&quot;Type\&quot;:\&quot;alpine\&quot;,\&quot;Vulnerabilities\&quot;:[{\&quot;VulnerabilityID\&quot;:\&quot;CVE-2019-14697\&quot;,\&quot;PkgID\&quot;:\&quot;musl@1.1.20-r4\&quot;,\&quot;PkgName\&quot;:\&quot;musl\&quot;,\&quot;PkgIdentifier\&quot;:{\&quot;PURL\&quot;:\&quot;pkg:apk/alpine/musl@1.1.20-r4?arch=x86_64&amp;distro=3.9.4\&quot;,\&quot;UID\&quot;:\&quot;d6abd271e71d3ce2\&quot;},\&quot;InstalledVersion\&quot;:\&quot;1.1.20-r4\&quot;,\&quot;FixedVersion\&quot;:\&quot;1.1.20-r5\&quot;,\&quot;Status\&quot;:\&quot;fixed\&quot;,\&quot;Layer\&quot;:{\&quot;Digest\&quot;:\&quot;sha256:e7c96db7181be991f19a9fb6975cdbbd73c65f4a2681348e63a141a2192a5f10\&quot;,\&quot;DiffID\&quot;:\&quot;sha256:f1b5933fe4b5f49bbe8258745cf396afe07e625bdab3168e364daf7c956b6b81\&quot;},\&quot;SeveritySource\&quot;:\&quot;nvd\&quot;,\&quot;PrimaryURL\&quot;:\&quot;https://avd.aquasec.com/nvd/cve-2019-14697\&quot;,\&quot;DataSource\&quot;:{\&quot;ID\&quot;:\&quot;alpine\&quot;,\&quot;Name\&quot;:\&quot;Alpine Secdb\&quot;,\&quot;URL\&quot;:\&quot;https://secdb.alpinelinux.org/\&quot;},\&quot;Description\&quot;:\&quot;musl libc through 1.1.23 has an x87 floating-point stack adjustment imbalance, related to the math/i386/ directory. In some cases, use of this library could introduce out-of-bounds writes that are not present in an application&#39;s source code.\&quot;,\&quot;Severity\&quot;:\&quot;CRITICAL\&quot;,\&quot;CweIDs\&quot;:[\&quot;CWE-787\&quot;],\&quot;VendorSeverity\&quot;:{\&quot;nvd\&quot;:4},\&quot;CVSS\&quot;:{\&quot;nvd\&quot;:{\&quot;V2Vector\&quot;:\&quot;AV:N/AC:L/Au:N/C:P/I:P/A:P\&quot;,\&quot;V3Vector\&quot;:\&quot;CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H\&quot;,\&quot;V2Score\&quot;:7.5,\&quot;V3Score\&quot;:9.8}},\&quot;References\&quot;:[\&quot;http://www.openwall.com/lists/oss-security/2019/08/06/4\&quot;,\&quot;https://security.gentoo.org/glsa/202003-13\&quot;,\&quot;https://www.openwall.com/lists/musl/2019/08/06/1\&quot;],\&quot;PublishedDate\&quot;:\&quot;2019-08-06T16:15:00Z\&quot;,\&quot;LastModifiedDate\&quot;:\&quot;2020-03-14T19:15:00Z\&quot;}]}&quot;
<a id="__codelineno-43-30" name="__codelineno-43-30" href="#__codelineno-43-30"></a>
<a id="__codelineno-43-31" name="__codelineno-43-31" href="#__codelineno-43-31"></a>
<a id="__codelineno-43-32" name="__codelineno-43-32" href="#__codelineno-43-32"></a>
<a id="__codelineno-43-33" name="__codelineno-43-33" href="#__codelineno-43-33"></a>],
<a id="__codelineno-43-34" name="__codelineno-43-34" href="#__codelineno-43-34"></a>
<a id="__codelineno-43-35" name="__codelineno-43-35" href="#__codelineno-43-35"></a>
<a id="__codelineno-43-36" name="__codelineno-43-36" href="#__codelineno-43-36"></a>
<a id="__codelineno-43-37" name="__codelineno-43-37" href="#__codelineno-43-37"></a>&quot;ArtifactType&quot;: &quot;container_image&quot;,
<a id="__codelineno-43-38" name="__codelineno-43-38" href="#__codelineno-43-38"></a>
<a id="__codelineno-43-39" name="__codelineno-43-39" href="#__codelineno-43-39"></a>
<a id="__codelineno-43-40" name="__codelineno-43-40" href="#__codelineno-43-40"></a>
<a id="__codelineno-43-41" name="__codelineno-43-41" href="#__codelineno-43-41"></a>&quot;CreatedAt&quot;: &quot;2021-08-25T12:20:30.000000005Z&quot;,
<a id="__codelineno-43-42" name="__codelineno-43-42" href="#__codelineno-43-42"></a>
<a id="__codelineno-43-43" name="__codelineno-43-43" href="#__codelineno-43-43"></a>
<a id="__codelineno-43-44" name="__codelineno-43-44" href="#__codelineno-43-44"></a>
<a id="__codelineno-43-45" name="__codelineno-43-45" href="#__codelineno-43-45"></a>&quot;Metadata&quot;: &quot;{\&quot;OS\&quot;:{\&quot;Family\&quot;:\&quot;alpine\&quot;,\&quot;Name\&quot;:\&quot;3.9.4\&quot;,\&quot;EOSL\&quot;:true},\&quot;ImageID\&quot;:\&quot;sha256:055936d3920576da37aa9bc460d70c5f212028bda1c08c0879aedf03d7a66ea1\&quot;,\&quot;DiffIDs\&quot;:[\&quot;sha256:f1b5933fe4b5f49bbe8258745cf396afe07e625bdab3168e364daf7c956b6b81\&quot;],\&quot;ImageConfig\&quot;:{\&quot;architecture\&quot;:\&quot;amd64\&quot;,\&quot;container\&quot;:\&quot;c10d36fa368a7ea673683682666758adf35efe98e10989505f4f566b5b18538f\&quot;,\&quot;created\&quot;:\&quot;2019-05-11T00:07:03.510395965Z\&quot;,\&quot;docker_version\&quot;:\&quot;18.06.1-ce\&quot;,\&quot;history\&quot;:[{\&quot;created\&quot;:\&quot;2019-05-11T00:07:03.358250803Z\&quot;,\&quot;created_by\&quot;:\&quot;/bin/sh -c #(nop) ADD file:a86aea1f3a7d68f6ae03397b99ea77f2e9ee901c5c59e59f76f93adbb4035913 in / \&quot;},{\&quot;created\&quot;:\&quot;2019-05-11T00:07:03.510395965Z\&quot;,\&quot;created_by\&quot;:\&quot;/bin/sh -c #(nop)  CMD [\\\&quot;/bin/sh\\\&quot;]\&quot;,\&quot;empty_layer\&quot;:true}],\&quot;os\&quot;:\&quot;linux\&quot;,\&quot;rootfs\&quot;:{\&quot;type\&quot;:\&quot;layers\&quot;,\&quot;diff_ids\&quot;:[\&quot;sha256:f1b5933fe4b5f49bbe8258745cf396afe07e625bdab3168e364daf7c956b6b81\&quot;]},\&quot;config\&quot;:{\&quot;Cmd\&quot;:[\&quot;/bin/sh\&quot;],\&quot;Env\&quot;:[\&quot;PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\&quot;],\&quot;Image\&quot;:\&quot;sha256:09f2bbe58e774849d74dc1391c2e01731896c745c4aba1ecf69a283bdb4b537a\&quot;,\&quot;ArgsEscaped\&quot;:true}}}&quot;,
<a id="__codelineno-43-46" name="__codelineno-43-46" href="#__codelineno-43-46"></a>
<a id="__codelineno-43-47" name="__codelineno-43-47" href="#__codelineno-43-47"></a>
<a id="__codelineno-43-48" name="__codelineno-43-48" href="#__codelineno-43-48"></a>
<a id="__codelineno-43-49" name="__codelineno-43-49" href="#__codelineno-43-49"></a>&quot;ArtifactName&quot;: &quot;testdata/fixtures/images/alpine-39.tar.gz&quot;
<a id="__codelineno-43-50" name="__codelineno-43-50" href="#__codelineno-43-50"></a>
<a id="__codelineno-43-51" name="__codelineno-43-51" href="#__codelineno-43-51"></a>
<a id="__codelineno-43-52" name="__codelineno-43-52" href="#__codelineno-43-52"></a>
<a id="__codelineno-43-53" name="__codelineno-43-53" href="#__codelineno-43-53"></a>}
</code></pre></div>
<p>In the current case, format isn't supported and data isn't mapped. If Dynatrace supports the format, it automatically maps it to the <a href="https://dt-url.net/3q03pb0">Semantic Dictionary conventions√Ø¬ª¬ø</a>.</p>
<ol>
<li>Map data to Dynatrace Semantic Dictionary</li>
</ol>
<p>In simple cases, you can work with ingested events in their original format. However, this becomes difficult in more complex cases, as</p>
<ul>
<li>There are many nested fields</li>
<li>You can't access findings from various tools and products uniformly</li>
<li>Some fields are added to classify the findings correctly, and others are mapped to the conventions</li>
</ul>
<p>In such complex cases, you need to manually map the ingested data to the Dynatrace Semantic Dictionary. When data is mapped, the original data persists alongside the mapped one, which allows you to benefit from the vendor-specific data in your analysis and automation or as an additional context.</p>
<ol>
<li>In <strong>OpenPipeline</strong>, select <strong>Pipelines</strong> &gt;  <strong>Pipeline</strong> to <a href="/docs/platform/openpipeline/getting-started/tutorial-configure-processing#process" title="Configure ingest sources, routes, and processing for your data in OpenPipeline.">create a custom pipeline</a>, and name it, for example, "Custom security findings".</li>
<li>
<p>Add a <a href="/docs/platform/openpipeline/concepts/processing#processor" title="Learn the core concepts of Dynatrace OpenPipeline processing.">processor</a> of type <strong>DQL</strong> to your pipeline and configure it to parse the fields required by the <a href="https://dt-url.net/3q03pb0">Semantic Dictionary√Ø¬ª¬ø</a> (in our case, we want to map the vulnerability findings' basic fields and, as an extension, container image details). Enter the following data:</p>
</li>
<li>
<p>Processor name: For example, "Map Trivy fields"</p>
</li>
<li>Matching condition: <code>SchemaVersion == 2 AND ArtifactType == "container_image"</code> (this way, the mapping will be attempted only for the relevant events)</li>
<li>DQL processor definition (in the mapping, we assume that the result and vulnerability arrays already include single items):</li>
</ol>
<p>Sample DQL processor definition</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-44-1" name="__codelineno-44-1" href="#__codelineno-44-1"></a>fieldsAdd event.type=&quot;VULNERABILITY_FINDING&quot;,
<a id="__codelineno-44-2" name="__codelineno-44-2" href="#__codelineno-44-2"></a>
<a id="__codelineno-44-3" name="__codelineno-44-3" href="#__codelineno-44-3"></a>
<a id="__codelineno-44-4" name="__codelineno-44-4" href="#__codelineno-44-4"></a>
<a id="__codelineno-44-5" name="__codelineno-44-5" href="#__codelineno-44-5"></a>event.provider=&quot;Trivy&quot;
<a id="__codelineno-44-6" name="__codelineno-44-6" href="#__codelineno-44-6"></a>
<a id="__codelineno-44-7" name="__codelineno-44-7" href="#__codelineno-44-7"></a>
<a id="__codelineno-44-8" name="__codelineno-44-8" href="#__codelineno-44-8"></a>
<a id="__codelineno-44-9" name="__codelineno-44-9" href="#__codelineno-44-9"></a>| parse Results[0], &quot;&quot;&quot;json:result&quot;&quot;&quot;
<a id="__codelineno-44-10" name="__codelineno-44-10" href="#__codelineno-44-10"></a>
<a id="__codelineno-44-11" name="__codelineno-44-11" href="#__codelineno-44-11"></a>
<a id="__codelineno-44-12" name="__codelineno-44-12" href="#__codelineno-44-12"></a>
<a id="__codelineno-44-13" name="__codelineno-44-13" href="#__codelineno-44-13"></a>| fieldsAdd vulnerability=result[Vulnerabilities][0]
<a id="__codelineno-44-14" name="__codelineno-44-14" href="#__codelineno-44-14"></a>
<a id="__codelineno-44-15" name="__codelineno-44-15" href="#__codelineno-44-15"></a>
<a id="__codelineno-44-16" name="__codelineno-44-16" href="#__codelineno-44-16"></a>
<a id="__codelineno-44-17" name="__codelineno-44-17" href="#__codelineno-44-17"></a>| parse vulnerability, &quot;&quot;&quot;json:vulnerability&quot;&quot;&quot;
<a id="__codelineno-44-18" name="__codelineno-44-18" href="#__codelineno-44-18"></a>
<a id="__codelineno-44-19" name="__codelineno-44-19" href="#__codelineno-44-19"></a>
<a id="__codelineno-44-20" name="__codelineno-44-20" href="#__codelineno-44-20"></a>
<a id="__codelineno-44-21" name="__codelineno-44-21" href="#__codelineno-44-21"></a>| parse Metadata, &quot;&quot;&quot;json:metadata&quot;&quot;&quot;
<a id="__codelineno-44-22" name="__codelineno-44-22" href="#__codelineno-44-22"></a>
<a id="__codelineno-44-23" name="__codelineno-44-23" href="#__codelineno-44-23"></a>
<a id="__codelineno-44-24" name="__codelineno-44-24" href="#__codelineno-44-24"></a>
<a id="__codelineno-44-25" name="__codelineno-44-25" href="#__codelineno-44-25"></a>| fieldsAdd
<a id="__codelineno-44-26" name="__codelineno-44-26" href="#__codelineno-44-26"></a>
<a id="__codelineno-44-27" name="__codelineno-44-27" href="#__codelineno-44-27"></a>
<a id="__codelineno-44-28" name="__codelineno-44-28" href="#__codelineno-44-28"></a>
<a id="__codelineno-44-29" name="__codelineno-44-29" href="#__codelineno-44-29"></a>finding.id=concat(ArtifactName,&quot;/&quot;,metadata[ImageID],&quot;/&quot;,vulnerability[PkgID]),
<a id="__codelineno-44-30" name="__codelineno-44-30" href="#__codelineno-44-30"></a>
<a id="__codelineno-44-31" name="__codelineno-44-31" href="#__codelineno-44-31"></a>
<a id="__codelineno-44-32" name="__codelineno-44-32" href="#__codelineno-44-32"></a>
<a id="__codelineno-44-33" name="__codelineno-44-33" href="#__codelineno-44-33"></a>finding.time.created=toTimestamp(CreatedAt),
<a id="__codelineno-44-34" name="__codelineno-44-34" href="#__codelineno-44-34"></a>
<a id="__codelineno-44-35" name="__codelineno-44-35" href="#__codelineno-44-35"></a>
<a id="__codelineno-44-36" name="__codelineno-44-36" href="#__codelineno-44-36"></a>
<a id="__codelineno-44-37" name="__codelineno-44-37" href="#__codelineno-44-37"></a>finding.severity=vulnerability[Severity]
<a id="__codelineno-44-38" name="__codelineno-44-38" href="#__codelineno-44-38"></a>
<a id="__codelineno-44-39" name="__codelineno-44-39" href="#__codelineno-44-39"></a>
<a id="__codelineno-44-40" name="__codelineno-44-40" href="#__codelineno-44-40"></a>
<a id="__codelineno-44-41" name="__codelineno-44-41" href="#__codelineno-44-41"></a>| fieldsAdd
<a id="__codelineno-44-42" name="__codelineno-44-42" href="#__codelineno-44-42"></a>
<a id="__codelineno-44-43" name="__codelineno-44-43" href="#__codelineno-44-43"></a>
<a id="__codelineno-44-44" name="__codelineno-44-44" href="#__codelineno-44-44"></a>
<a id="__codelineno-44-45" name="__codelineno-44-45" href="#__codelineno-44-45"></a>dt.security.risk.level=if(vulnerability[Severity]==&quot;UNKNOWN&quot;,&quot;NOT_AVAILABLE&quot;,else:vulnerability[Severity]),
<a id="__codelineno-44-46" name="__codelineno-44-46" href="#__codelineno-44-46"></a>
<a id="__codelineno-44-47" name="__codelineno-44-47" href="#__codelineno-44-47"></a>
<a id="__codelineno-44-48" name="__codelineno-44-48" href="#__codelineno-44-48"></a>
<a id="__codelineno-44-49" name="__codelineno-44-49" href="#__codelineno-44-49"></a>dt.security.risk.score=if(vulnerability[Severity]==&quot;CRITICAL&quot;,10,else:
<a id="__codelineno-44-50" name="__codelineno-44-50" href="#__codelineno-44-50"></a>
<a id="__codelineno-44-51" name="__codelineno-44-51" href="#__codelineno-44-51"></a>
<a id="__codelineno-44-52" name="__codelineno-44-52" href="#__codelineno-44-52"></a>
<a id="__codelineno-44-53" name="__codelineno-44-53" href="#__codelineno-44-53"></a>if(vulnerability[Severity]==&quot;HIGH&quot;,8,else:
<a id="__codelineno-44-54" name="__codelineno-44-54" href="#__codelineno-44-54"></a>
<a id="__codelineno-44-55" name="__codelineno-44-55" href="#__codelineno-44-55"></a>
<a id="__codelineno-44-56" name="__codelineno-44-56" href="#__codelineno-44-56"></a>
<a id="__codelineno-44-57" name="__codelineno-44-57" href="#__codelineno-44-57"></a>if(vulnerability[Severity]==&quot;MEDIUM&quot;,6,else:
<a id="__codelineno-44-58" name="__codelineno-44-58" href="#__codelineno-44-58"></a>
<a id="__codelineno-44-59" name="__codelineno-44-59" href="#__codelineno-44-59"></a>
<a id="__codelineno-44-60" name="__codelineno-44-60" href="#__codelineno-44-60"></a>
<a id="__codelineno-44-61" name="__codelineno-44-61" href="#__codelineno-44-61"></a>if(vulnerability[Severity]==&quot;LOW&quot;,3,else:0))))
<a id="__codelineno-44-62" name="__codelineno-44-62" href="#__codelineno-44-62"></a>
<a id="__codelineno-44-63" name="__codelineno-44-63" href="#__codelineno-44-63"></a>
<a id="__codelineno-44-64" name="__codelineno-44-64" href="#__codelineno-44-64"></a>
<a id="__codelineno-44-65" name="__codelineno-44-65" href="#__codelineno-44-65"></a>| fieldsAdd
<a id="__codelineno-44-66" name="__codelineno-44-66" href="#__codelineno-44-66"></a>
<a id="__codelineno-44-67" name="__codelineno-44-67" href="#__codelineno-44-67"></a>
<a id="__codelineno-44-68" name="__codelineno-44-68" href="#__codelineno-44-68"></a>
<a id="__codelineno-44-69" name="__codelineno-44-69" href="#__codelineno-44-69"></a>object.id=concat(ArtifactName,&quot;/&quot;,metadata[ImageID]),
<a id="__codelineno-44-70" name="__codelineno-44-70" href="#__codelineno-44-70"></a>
<a id="__codelineno-44-71" name="__codelineno-44-71" href="#__codelineno-44-71"></a>
<a id="__codelineno-44-72" name="__codelineno-44-72" href="#__codelineno-44-72"></a>
<a id="__codelineno-44-73" name="__codelineno-44-73" href="#__codelineno-44-73"></a>object.type=&quot;CONTAINER_IMAGE&quot;,
<a id="__codelineno-44-74" name="__codelineno-44-74" href="#__codelineno-44-74"></a>
<a id="__codelineno-44-75" name="__codelineno-44-75" href="#__codelineno-44-75"></a>
<a id="__codelineno-44-76" name="__codelineno-44-76" href="#__codelineno-44-76"></a>
<a id="__codelineno-44-77" name="__codelineno-44-77" href="#__codelineno-44-77"></a>object.name=ArtifactName
<a id="__codelineno-44-78" name="__codelineno-44-78" href="#__codelineno-44-78"></a>
<a id="__codelineno-44-79" name="__codelineno-44-79" href="#__codelineno-44-79"></a>
<a id="__codelineno-44-80" name="__codelineno-44-80" href="#__codelineno-44-80"></a>
<a id="__codelineno-44-81" name="__codelineno-44-81" href="#__codelineno-44-81"></a>| fieldsAdd
<a id="__codelineno-44-82" name="__codelineno-44-82" href="#__codelineno-44-82"></a>
<a id="__codelineno-44-83" name="__codelineno-44-83" href="#__codelineno-44-83"></a>
<a id="__codelineno-44-84" name="__codelineno-44-84" href="#__codelineno-44-84"></a>
<a id="__codelineno-44-85" name="__codelineno-44-85" href="#__codelineno-44-85"></a>vulnerability.id=vulnerability[VulnerabilityID],
<a id="__codelineno-44-86" name="__codelineno-44-86" href="#__codelineno-44-86"></a>
<a id="__codelineno-44-87" name="__codelineno-44-87" href="#__codelineno-44-87"></a>
<a id="__codelineno-44-88" name="__codelineno-44-88" href="#__codelineno-44-88"></a>
<a id="__codelineno-44-89" name="__codelineno-44-89" href="#__codelineno-44-89"></a>vulnerability.description=coalesce(vulnerability[Description],vulnerability[VulnerabilityID]),
<a id="__codelineno-44-90" name="__codelineno-44-90" href="#__codelineno-44-90"></a>
<a id="__codelineno-44-91" name="__codelineno-44-91" href="#__codelineno-44-91"></a>
<a id="__codelineno-44-92" name="__codelineno-44-92" href="#__codelineno-44-92"></a>
<a id="__codelineno-44-93" name="__codelineno-44-93" href="#__codelineno-44-93"></a>vulnerability.title=coalesce(vulnerability[Title],vulnerability[VulnerabilityID])
<a id="__codelineno-44-94" name="__codelineno-44-94" href="#__codelineno-44-94"></a>
<a id="__codelineno-44-95" name="__codelineno-44-95" href="#__codelineno-44-95"></a>
<a id="__codelineno-44-96" name="__codelineno-44-96" href="#__codelineno-44-96"></a>
<a id="__codelineno-44-97" name="__codelineno-44-97" href="#__codelineno-44-97"></a>| fieldsAdd
<a id="__codelineno-44-98" name="__codelineno-44-98" href="#__codelineno-44-98"></a>
<a id="__codelineno-44-99" name="__codelineno-44-99" href="#__codelineno-44-99"></a>
<a id="__codelineno-44-100" name="__codelineno-44-100" href="#__codelineno-44-100"></a>
<a id="__codelineno-44-101" name="__codelineno-44-101" href="#__codelineno-44-101"></a>component.name=vulnerability[PkgName],
<a id="__codelineno-44-102" name="__codelineno-44-102" href="#__codelineno-44-102"></a>
<a id="__codelineno-44-103" name="__codelineno-44-103" href="#__codelineno-44-103"></a>
<a id="__codelineno-44-104" name="__codelineno-44-104" href="#__codelineno-44-104"></a>
<a id="__codelineno-44-105" name="__codelineno-44-105" href="#__codelineno-44-105"></a>component.version=vulnerability[InstalledVersion]
<a id="__codelineno-44-106" name="__codelineno-44-106" href="#__codelineno-44-106"></a>
<a id="__codelineno-44-107" name="__codelineno-44-107" href="#__codelineno-44-107"></a>
<a id="__codelineno-44-108" name="__codelineno-44-108" href="#__codelineno-44-108"></a>
<a id="__codelineno-44-109" name="__codelineno-44-109" href="#__codelineno-44-109"></a>| fieldsAdd
<a id="__codelineno-44-110" name="__codelineno-44-110" href="#__codelineno-44-110"></a>
<a id="__codelineno-44-111" name="__codelineno-44-111" href="#__codelineno-44-111"></a>
<a id="__codelineno-44-112" name="__codelineno-44-112" href="#__codelineno-44-112"></a>
<a id="__codelineno-44-113" name="__codelineno-44-113" href="#__codelineno-44-113"></a>container_image.digest=vulnerability[Layer][Digest]
<a id="__codelineno-44-114" name="__codelineno-44-114" href="#__codelineno-44-114"></a>
<a id="__codelineno-44-115" name="__codelineno-44-115" href="#__codelineno-44-115"></a>
<a id="__codelineno-44-116" name="__codelineno-44-116" href="#__codelineno-44-116"></a>
<a id="__codelineno-44-117" name="__codelineno-44-117" href="#__codelineno-44-117"></a>| fieldsAdd artifact=splitString(ArtifactName,&quot;:&quot;)
<a id="__codelineno-44-118" name="__codelineno-44-118" href="#__codelineno-44-118"></a>
<a id="__codelineno-44-119" name="__codelineno-44-119" href="#__codelineno-44-119"></a>
<a id="__codelineno-44-120" name="__codelineno-44-120" href="#__codelineno-44-120"></a>
<a id="__codelineno-44-121" name="__codelineno-44-121" href="#__codelineno-44-121"></a>| fieldsAdd container_image.repository=artifact[0],
<a id="__codelineno-44-122" name="__codelineno-44-122" href="#__codelineno-44-122"></a>
<a id="__codelineno-44-123" name="__codelineno-44-123" href="#__codelineno-44-123"></a>
<a id="__codelineno-44-124" name="__codelineno-44-124" href="#__codelineno-44-124"></a>
<a id="__codelineno-44-125" name="__codelineno-44-125" href="#__codelineno-44-125"></a>container_image.tags=artifact[1]
<a id="__codelineno-44-126" name="__codelineno-44-126" href="#__codelineno-44-126"></a>
<a id="__codelineno-44-127" name="__codelineno-44-127" href="#__codelineno-44-127"></a>
<a id="__codelineno-44-128" name="__codelineno-44-128" href="#__codelineno-44-128"></a>
<a id="__codelineno-44-129" name="__codelineno-44-129" href="#__codelineno-44-129"></a>| fieldsRemove vulnerability, Metadata, artifact
</code></pre></div>
<p><img alt="config dql processor" src="https://dt-cdn.net/images/2024-11-01-10-41-25-1694-e7c83279aa.png" /></p>
<p>Sample mapped result</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-45-1" name="__codelineno-45-1" href="#__codelineno-45-1"></a>&quot;timestamp&quot;: &quot;2024-10-31T09:58:21.141000000Z&quot;,
<a id="__codelineno-45-2" name="__codelineno-45-2" href="#__codelineno-45-2"></a>
<a id="__codelineno-45-3" name="__codelineno-45-3" href="#__codelineno-45-3"></a>
<a id="__codelineno-45-4" name="__codelineno-45-4" href="#__codelineno-45-4"></a>
<a id="__codelineno-45-5" name="__codelineno-45-5" href="#__codelineno-45-5"></a>&quot;event.provider&quot;: &quot;Trivy&quot;,
<a id="__codelineno-45-6" name="__codelineno-45-6" href="#__codelineno-45-6"></a>
<a id="__codelineno-45-7" name="__codelineno-45-7" href="#__codelineno-45-7"></a>
<a id="__codelineno-45-8" name="__codelineno-45-8" href="#__codelineno-45-8"></a>
<a id="__codelineno-45-9" name="__codelineno-45-9" href="#__codelineno-45-9"></a>&quot;event.type&quot;: &quot;VULNERABILITY_FINDING&quot;,
<a id="__codelineno-45-10" name="__codelineno-45-10" href="#__codelineno-45-10"></a>
<a id="__codelineno-45-11" name="__codelineno-45-11" href="#__codelineno-45-11"></a>
<a id="__codelineno-45-12" name="__codelineno-45-12" href="#__codelineno-45-12"></a>
<a id="__codelineno-45-13" name="__codelineno-45-13" href="#__codelineno-45-13"></a>&quot;dt.security.risk.score&quot;: 10,
<a id="__codelineno-45-14" name="__codelineno-45-14" href="#__codelineno-45-14"></a>
<a id="__codelineno-45-15" name="__codelineno-45-15" href="#__codelineno-45-15"></a>
<a id="__codelineno-45-16" name="__codelineno-45-16" href="#__codelineno-45-16"></a>
<a id="__codelineno-45-17" name="__codelineno-45-17" href="#__codelineno-45-17"></a>&quot;dt.security.risk.level&quot;: &quot;CRITICAL&quot;,
<a id="__codelineno-45-18" name="__codelineno-45-18" href="#__codelineno-45-18"></a>
<a id="__codelineno-45-19" name="__codelineno-45-19" href="#__codelineno-45-19"></a>
<a id="__codelineno-45-20" name="__codelineno-45-20" href="#__codelineno-45-20"></a>
<a id="__codelineno-45-21" name="__codelineno-45-21" href="#__codelineno-45-21"></a>&quot;finding.id&quot;: &quot;testdata/fixtures/images/alpine-39.tar.gz/sha256:055936d3920576da37aa9bc460d70c5f212028bda1c08c0879aedf03d7a66ea1/musl@1.1.20-r4&quot;,
<a id="__codelineno-45-22" name="__codelineno-45-22" href="#__codelineno-45-22"></a>
<a id="__codelineno-45-23" name="__codelineno-45-23" href="#__codelineno-45-23"></a>
<a id="__codelineno-45-24" name="__codelineno-45-24" href="#__codelineno-45-24"></a>
<a id="__codelineno-45-25" name="__codelineno-45-25" href="#__codelineno-45-25"></a>&quot;finding.time.created&quot;: &quot;2021-08-25T12:20:30.000000005Z&quot;,
<a id="__codelineno-45-26" name="__codelineno-45-26" href="#__codelineno-45-26"></a>
<a id="__codelineno-45-27" name="__codelineno-45-27" href="#__codelineno-45-27"></a>
<a id="__codelineno-45-28" name="__codelineno-45-28" href="#__codelineno-45-28"></a>
<a id="__codelineno-45-29" name="__codelineno-45-29" href="#__codelineno-45-29"></a>&quot;finding.severity&quot;: &quot;CRITICAL&quot;,
<a id="__codelineno-45-30" name="__codelineno-45-30" href="#__codelineno-45-30"></a>
<a id="__codelineno-45-31" name="__codelineno-45-31" href="#__codelineno-45-31"></a>
<a id="__codelineno-45-32" name="__codelineno-45-32" href="#__codelineno-45-32"></a>
<a id="__codelineno-45-33" name="__codelineno-45-33" href="#__codelineno-45-33"></a>&quot;object.id&quot;: &quot;testdata/fixtures/images/alpine-39.tar.gz/sha256:055936d3920576da37aa9bc460d70c5f212028bda1c08c0879aedf03d7a66ea1&quot;,
<a id="__codelineno-45-34" name="__codelineno-45-34" href="#__codelineno-45-34"></a>
<a id="__codelineno-45-35" name="__codelineno-45-35" href="#__codelineno-45-35"></a>
<a id="__codelineno-45-36" name="__codelineno-45-36" href="#__codelineno-45-36"></a>
<a id="__codelineno-45-37" name="__codelineno-45-37" href="#__codelineno-45-37"></a>&quot;object.type&quot;: &quot;CONTAINER_IMAGE&quot;,
<a id="__codelineno-45-38" name="__codelineno-45-38" href="#__codelineno-45-38"></a>
<a id="__codelineno-45-39" name="__codelineno-45-39" href="#__codelineno-45-39"></a>
<a id="__codelineno-45-40" name="__codelineno-45-40" href="#__codelineno-45-40"></a>
<a id="__codelineno-45-41" name="__codelineno-45-41" href="#__codelineno-45-41"></a>&quot;object.name&quot;: &quot;testdata/fixtures/images/alpine-39.tar.gz&quot;,
<a id="__codelineno-45-42" name="__codelineno-45-42" href="#__codelineno-45-42"></a>
<a id="__codelineno-45-43" name="__codelineno-45-43" href="#__codelineno-45-43"></a>
<a id="__codelineno-45-44" name="__codelineno-45-44" href="#__codelineno-45-44"></a>
<a id="__codelineno-45-45" name="__codelineno-45-45" href="#__codelineno-45-45"></a>&quot;vulnerability.id&quot;: &quot;CVE-2019-14697&quot;,
<a id="__codelineno-45-46" name="__codelineno-45-46" href="#__codelineno-45-46"></a>
<a id="__codelineno-45-47" name="__codelineno-45-47" href="#__codelineno-45-47"></a>
<a id="__codelineno-45-48" name="__codelineno-45-48" href="#__codelineno-45-48"></a>
<a id="__codelineno-45-49" name="__codelineno-45-49" href="#__codelineno-45-49"></a>&quot;vulnerability.title&quot;: &quot;CVE-2019-14697&quot;,
<a id="__codelineno-45-50" name="__codelineno-45-50" href="#__codelineno-45-50"></a>
<a id="__codelineno-45-51" name="__codelineno-45-51" href="#__codelineno-45-51"></a>
<a id="__codelineno-45-52" name="__codelineno-45-52" href="#__codelineno-45-52"></a>
<a id="__codelineno-45-53" name="__codelineno-45-53" href="#__codelineno-45-53"></a>&quot;vulnerability.description&quot;: &quot;musl libc through 1.1.23 has an x87 floating-point stack adjustment imbalance, related to the math/i386/ directory. In some cases, use of this library could introduce out-of-bounds writes that are not present in an application&#39;s source code.&quot;
<a id="__codelineno-45-54" name="__codelineno-45-54" href="#__codelineno-45-54"></a>
<a id="__codelineno-45-55" name="__codelineno-45-55" href="#__codelineno-45-55"></a>
<a id="__codelineno-45-56" name="__codelineno-45-56" href="#__codelineno-45-56"></a>
<a id="__codelineno-45-57" name="__codelineno-45-57" href="#__codelineno-45-57"></a>&quot;component.name&quot;: &quot;musl&quot;,
<a id="__codelineno-45-58" name="__codelineno-45-58" href="#__codelineno-45-58"></a>
<a id="__codelineno-45-59" name="__codelineno-45-59" href="#__codelineno-45-59"></a>
<a id="__codelineno-45-60" name="__codelineno-45-60" href="#__codelineno-45-60"></a>
<a id="__codelineno-45-61" name="__codelineno-45-61" href="#__codelineno-45-61"></a>&quot;component.version&quot;: &quot;1.1.20-r4&quot;,
<a id="__codelineno-45-62" name="__codelineno-45-62" href="#__codelineno-45-62"></a>
<a id="__codelineno-45-63" name="__codelineno-45-63" href="#__codelineno-45-63"></a>
<a id="__codelineno-45-64" name="__codelineno-45-64" href="#__codelineno-45-64"></a>
<a id="__codelineno-45-65" name="__codelineno-45-65" href="#__codelineno-45-65"></a>&quot;container_image.digest&quot;: &quot;sha256:e7c96db7181be991f19a9fb6975cdbbd73c65f4a2681348e63a141a2192a5f10&quot;,
<a id="__codelineno-45-66" name="__codelineno-45-66" href="#__codelineno-45-66"></a>
<a id="__codelineno-45-67" name="__codelineno-45-67" href="#__codelineno-45-67"></a>
<a id="__codelineno-45-68" name="__codelineno-45-68" href="#__codelineno-45-68"></a>
<a id="__codelineno-45-69" name="__codelineno-45-69" href="#__codelineno-45-69"></a>&quot;container_image.tags&quot;: null,
<a id="__codelineno-45-70" name="__codelineno-45-70" href="#__codelineno-45-70"></a>
<a id="__codelineno-45-71" name="__codelineno-45-71" href="#__codelineno-45-71"></a>
<a id="__codelineno-45-72" name="__codelineno-45-72" href="#__codelineno-45-72"></a>
<a id="__codelineno-45-73" name="__codelineno-45-73" href="#__codelineno-45-73"></a>&quot;container_image.repository&quot;: &quot;testdata/fixtures/images/alpine-39.tar.gz&quot;,
<a id="__codelineno-45-74" name="__codelineno-45-74" href="#__codelineno-45-74"></a>
<a id="__codelineno-45-75" name="__codelineno-45-75" href="#__codelineno-45-75"></a>
<a id="__codelineno-45-76" name="__codelineno-45-76" href="#__codelineno-45-76"></a>
<a id="__codelineno-45-77" name="__codelineno-45-77" href="#__codelineno-45-77"></a>&quot;metadata&quot;: &quot;{\&quot;OS\&quot;:{\&quot;Family\&quot;:\&quot;alpine\&quot;, \&quot;Name\&quot;:\&quot;3.9.4\&quot;, \&quot;EOSL\&quot;:true}, \&quot;ImageID\&quot;:\&quot;sha256:055936d3920576da37aa9bc460d70c5f212028bda1c08c0879aedf03d7a66ea1\&quot;, \&quot;DiffIDs\&quot;:[\&quot;sha256:f1b5933fe4b5f49bbe8258745cf396afe07e625bdab3168e364daf7c956b6b81\&quot;], \&quot;ImageConfig\&quot;:{\&quot;architecture\&quot;:\&quot;amd64\&quot;, \&quot;container\&quot;:\&quot;c10d36fa368a7ea673683682666758adf35efe98e10989505f4f566b5b18538f\&quot;, \&quot;created\&quot;:\&quot;2019-05-11T00:07:03.510395965Z\&quot;, \&quot;docker_version\&quot;:\&quot;18.06.1-ce\&quot;, \&quot;history\&quot;:[{\&quot;created\&quot;:\&quot;2019-05-11T00:07:03.358250803Z\&quot;, \&quot;created_by\&quot;:\&quot;/bin/sh -c #(nop) ADD file:a86aea1f3a7d68f6ae03397b99ea77f2e9ee901c5c59e59f76f93adbb4035913 in / \&quot;}, {\&quot;created\&quot;:\&quot;2019-05-11T00:07:03.510395965Z\&quot;, \&quot;created_by\&quot;:\&quot;/bin/sh -c #(nop)  CMD [\\\&quot;/bin/sh\\\&quot;]\&quot;, \&quot;empty_layer\&quot;:true}], \&quot;os\&quot;:\&quot;linux\&quot;, \&quot;rootfs\&quot;:{\&quot;type\&quot;:\&quot;layers\&quot;, \&quot;diff_ids\&quot;:[\&quot;sha256:f1b5933fe4b5f49bbe8258745cf396afe07e625bdab3168e364daf7c956b6b81\&quot;]}, \&quot;config\&quot;:{\&quot;Cmd\&quot;:[\&quot;/bin/sh\&quot;], \&quot;Env\&quot;:[\&quot;PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\&quot;], \&quot;Image\&quot;:\&quot;sha256:09f2bbe58e774849d74dc1391c2e01731896c745c4aba1ecf69a283bdb4b537a\&quot;, \&quot;ArgsEscaped\&quot;:true}}}&quot;,
<a id="__codelineno-45-78" name="__codelineno-45-78" href="#__codelineno-45-78"></a>
<a id="__codelineno-45-79" name="__codelineno-45-79" href="#__codelineno-45-79"></a>
<a id="__codelineno-45-80" name="__codelineno-45-80" href="#__codelineno-45-80"></a>
<a id="__codelineno-45-81" name="__codelineno-45-81" href="#__codelineno-45-81"></a>&quot;CreatedAt&quot;: &quot;2021-08-25T12:20:30.000000005Z&quot;,
<a id="__codelineno-45-82" name="__codelineno-45-82" href="#__codelineno-45-82"></a>
<a id="__codelineno-45-83" name="__codelineno-45-83" href="#__codelineno-45-83"></a>
<a id="__codelineno-45-84" name="__codelineno-45-84" href="#__codelineno-45-84"></a>
<a id="__codelineno-45-85" name="__codelineno-45-85" href="#__codelineno-45-85"></a>&quot;result&quot;: &quot;{\&quot;Target\&quot;:\&quot;testdata/fixtures/images/alpine-39.tar.gz (alpine 3.9.4)\&quot;, \&quot;Class\&quot;:\&quot;os-pkgs\&quot;, \&quot;Type\&quot;:\&quot;alpine\&quot;, \&quot;Vulnerabilities\&quot;:[{\&quot;VulnerabilityID\&quot;:\&quot;CVE-2019-14697\&quot;, \&quot;PkgID\&quot;:\&quot;musl@1.1.20-r4\&quot;, \&quot;PkgName\&quot;:\&quot;musl\&quot;, \&quot;PkgIdentifier\&quot;:{\&quot;PURL\&quot;:\&quot;pkg:apk/alpine/musl@1.1.20-r4?arch=x86_64&amp;distro=3.9.4\&quot;, \&quot;UID\&quot;:\&quot;d6abd271e71d3ce2\&quot;}, \&quot;InstalledVersion\&quot;:\&quot;1.1.20-r4\&quot;, \&quot;FixedVersion\&quot;:\&quot;1.1.20-r5\&quot;, \&quot;Status\&quot;:\&quot;fixed\&quot;, \&quot;Layer\&quot;:{\&quot;Digest\&quot;:\&quot;sha256:e7c96db7181be991f19a9fb6975cdbbd73c65f4a2681348e63a141a2192a5f10\&quot;, \&quot;DiffID\&quot;:\&quot;sha256:f1b5933fe4b5f49bbe8258745cf396afe07e625bdab3168e364daf7c956b6b81\&quot;}, \&quot;SeveritySource\&quot;:\&quot;nvd\&quot;, \&quot;PrimaryURL\&quot;:\&quot;https://avd.aquasec.com/nvd/cve-2019-14697\&quot;, \&quot;DataSource\&quot;:{\&quot;ID\&quot;:\&quot;alpine\&quot;, \&quot;Name\&quot;:\&quot;Alpine Secdb\&quot;, \&quot;URL\&quot;:\&quot;https://secdb.alpinelinux.org/\&quot;}, \&quot;Description\&quot;:\&quot;musl libc through 1.1.23 has an x87 floating-point stack adjustment imbalance, related to the math/i386/ directory. In some cases, use of this library could introduce out-of-bounds writes that are not present in an application\\&#39;s source code.\&quot;, \&quot;Severity\&quot;:\&quot;CRITICAL\&quot;, \&quot;CweIDs\&quot;:[\&quot;CWE-787\&quot;], \&quot;VendorSeverity\&quot;:{\&quot;nvd\&quot;:4}, \&quot;CVSS\&quot;:{\&quot;nvd\&quot;:{\&quot;V2Vector\&quot;:\&quot;AV:N/AC:L/Au:N/C:P/I:P/A:P\&quot;, \&quot;V3Vector\&quot;:\&quot;CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H\&quot;, \&quot;V2Score\&quot;:7.5, \&quot;V3Score\&quot;:9.8}}, \&quot;References\&quot;:[\&quot;http://www.openwall.com/lists/oss-security/2019/08/06/4\&quot;, \&quot;https://security.gentoo.org/glsa/202003-13\&quot;, \&quot;https://www.openwall.com/lists/musl/2019/08/06/1\&quot;], \&quot;PublishedDate\&quot;:\&quot;2019-08-06T16:15:00Z\&quot;, \&quot;LastModifiedDate\&quot;:\&quot;2020-03-14T19:15:00Z\&quot;}]}&quot;,
<a id="__codelineno-45-86" name="__codelineno-45-86" href="#__codelineno-45-86"></a>
<a id="__codelineno-45-87" name="__codelineno-45-87" href="#__codelineno-45-87"></a>
<a id="__codelineno-45-88" name="__codelineno-45-88" href="#__codelineno-45-88"></a>
<a id="__codelineno-45-89" name="__codelineno-45-89" href="#__codelineno-45-89"></a>&quot;SchemaVersion&quot;: 2,
<a id="__codelineno-45-90" name="__codelineno-45-90" href="#__codelineno-45-90"></a>
<a id="__codelineno-45-91" name="__codelineno-45-91" href="#__codelineno-45-91"></a>
<a id="__codelineno-45-92" name="__codelineno-45-92" href="#__codelineno-45-92"></a>
<a id="__codelineno-45-93" name="__codelineno-45-93" href="#__codelineno-45-93"></a>&quot;ArtifactName&quot;: &quot;testdata/fixtures/images/alpine-39.tar.gz&quot;,
<a id="__codelineno-45-94" name="__codelineno-45-94" href="#__codelineno-45-94"></a>
<a id="__codelineno-45-95" name="__codelineno-45-95" href="#__codelineno-45-95"></a>
<a id="__codelineno-45-96" name="__codelineno-45-96" href="#__codelineno-45-96"></a>
<a id="__codelineno-45-97" name="__codelineno-45-97" href="#__codelineno-45-97"></a>&quot;Results&quot;: [
<a id="__codelineno-45-98" name="__codelineno-45-98" href="#__codelineno-45-98"></a>
<a id="__codelineno-45-99" name="__codelineno-45-99" href="#__codelineno-45-99"></a>
<a id="__codelineno-45-100" name="__codelineno-45-100" href="#__codelineno-45-100"></a>
<a id="__codelineno-45-101" name="__codelineno-45-101" href="#__codelineno-45-101"></a>&quot;{\&quot;Target\&quot;:\&quot;testdata/fixtures/images/alpine-39.tar.gz (alpine 3.9.4)\&quot;,\&quot;Class\&quot;:\&quot;os-pkgs\&quot;,\&quot;Type\&quot;:\&quot;alpine\&quot;,\&quot;Vulnerabilities\&quot;:[{\&quot;VulnerabilityID\&quot;:\&quot;CVE-2019-14697\&quot;,\&quot;PkgID\&quot;:\&quot;musl@1.1.20-r4\&quot;,\&quot;PkgName\&quot;:\&quot;musl\&quot;,\&quot;PkgIdentifier\&quot;:{\&quot;PURL\&quot;:\&quot;pkg:apk/alpine/musl@1.1.20-r4?arch=x86_64&amp;distro=3.9.4\&quot;,\&quot;UID\&quot;:\&quot;d6abd271e71d3ce2\&quot;},\&quot;InstalledVersion\&quot;:\&quot;1.1.20-r4\&quot;,\&quot;FixedVersion\&quot;:\&quot;1.1.20-r5\&quot;,\&quot;Status\&quot;:\&quot;fixed\&quot;,\&quot;Layer\&quot;:{\&quot;Digest\&quot;:\&quot;sha256:e7c96db7181be991f19a9fb6975cdbbd73c65f4a2681348e63a141a2192a5f10\&quot;,\&quot;DiffID\&quot;:\&quot;sha256:f1b5933fe4b5f49bbe8258745cf396afe07e625bdab3168e364daf7c956b6b81\&quot;},\&quot;SeveritySource\&quot;:\&quot;nvd\&quot;,\&quot;PrimaryURL\&quot;:\&quot;https://avd.aquasec.com/nvd/cve-2019-14697\&quot;,\&quot;DataSource\&quot;:{\&quot;ID\&quot;:\&quot;alpine\&quot;,\&quot;Name\&quot;:\&quot;Alpine Secdb\&quot;,\&quot;URL\&quot;:\&quot;https://secdb.alpinelinux.org/\&quot;},\&quot;Description\&quot;:\&quot;musl libc through 1.1.23 has an x87 floating-point stack adjustment imbalance, related to the math/i386/ directory. In some cases, use of this library could introduce out-of-bounds writes that are not present in an application&#39;s source code.\&quot;,\&quot;Severity\&quot;:\&quot;CRITICAL\&quot;,\&quot;CweIDs\&quot;:[\&quot;CWE-787\&quot;],\&quot;VendorSeverity\&quot;:{\&quot;nvd\&quot;:4},\&quot;CVSS\&quot;:{\&quot;nvd\&quot;:{\&quot;V2Vector\&quot;:\&quot;AV:N/AC:L/Au:N/C:P/I:P/A:P\&quot;,\&quot;V3Vector\&quot;:\&quot;CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H\&quot;,\&quot;V2Score\&quot;:7.5,\&quot;V3Score\&quot;:9.8}},\&quot;References\&quot;:[\&quot;http://www.openwall.com/lists/oss-security/2019/08/06/4\&quot;,\&quot;https://security.gentoo.org/glsa/202003-13\&quot;,\&quot;https://www.openwall.com/lists/musl/2019/08/06/1\&quot;],\&quot;PublishedDate\&quot;:\&quot;2019-08-06T16:15:00Z\&quot;,\&quot;LastModifiedDate\&quot;:\&quot;2020-03-14T19:15:00Z\&quot;}]}&quot;
<a id="__codelineno-45-102" name="__codelineno-45-102" href="#__codelineno-45-102"></a>
<a id="__codelineno-45-103" name="__codelineno-45-103" href="#__codelineno-45-103"></a>
<a id="__codelineno-45-104" name="__codelineno-45-104" href="#__codelineno-45-104"></a>
<a id="__codelineno-45-105" name="__codelineno-45-105" href="#__codelineno-45-105"></a>],
<a id="__codelineno-45-106" name="__codelineno-45-106" href="#__codelineno-45-106"></a>
<a id="__codelineno-45-107" name="__codelineno-45-107" href="#__codelineno-45-107"></a>
<a id="__codelineno-45-108" name="__codelineno-45-108" href="#__codelineno-45-108"></a>
<a id="__codelineno-45-109" name="__codelineno-45-109" href="#__codelineno-45-109"></a>&quot;ArtifactType&quot;: &quot;container_image&quot;
</code></pre></div>
3. Select <strong>Dynamic routing</strong> &gt;  <strong>Dynamic route</strong> to <a href="/docs/platform/openpipeline/getting-started/tutorial-configure-processing#route" title="Configure ingest sources, routes, and processing for your data in OpenPipeline.">add a dynamic routing</a> to the new pipeline. Enter the following data:</p>
<ul>
<li>Dynamic route name: For example, "Custom event"</li>
<li>Matching condition: <code>SchemaVersion == 2 AND ArtifactType == "container_image"</code></li>
<li>Select the pipeline to which the dynamic routing will apply (in our case, <code>Custom security findings</code>)</li>
</ul>
<p><img alt="add dynamic routing" src="https://dt-cdn.net/images/2024-08-28-23-04-46-576-9e042f6845.png" /></p>
<p>For details on dynamic routing, see <a href="/docs/platform/openpipeline/concepts/data-flow#routing" title="Learn how data flows in Dynatrace Platform, from ingestion to storage, via Dynatrace OpenPipeline.">Routing</a>.</p>
<h2 id="next-steps">Next steps<a class="headerlink" href="#next-steps" title="Permanent link">&para;</a></h2>
<p>Now you can use the data to</p>
<ul>
<li><a href="/docs/secure/use-cases/visualize-and-analyze-security-findings" title="Visualize, prioritize, and analyze ingested security findings.">Visualize container vulnerability findings with a sample dashboard</a></li>
<li><a href="/docs/secure/use-cases/automate-and-orchestrate-security-findings" title="Regularly check for critical security findings and get automatic Jira tickets or Slack alerts.">Automate Jira ticket creation and Slack notifications with sample workflows</a></li>
</ul>
<hr />
<h2 id="source-instant-intrusion-responsemd">Source: instant-intrusion-response.md<a class="headerlink" href="#source-instant-intrusion-responsemd" title="Permanent link">&para;</a></h2>
<hr />
<p>title: Instant Intrusion Response
source: https://www.dynatrace.com/docs/secure/use-cases/instant-intrusion-response
scraped: 2026-02-16T21:31:22.722941</p>
<hr />
<h1 id="instant-intrusion-response">Instant Intrusion Response<a class="headerlink" href="#instant-intrusion-response" title="Permanent link">&para;</a></h1>
<h1 id="instant-intrusion-response_1">Instant Intrusion Response<a class="headerlink" href="#instant-intrusion-response_1" title="Permanent link">&para;</a></h1>
<ul>
<li>Latest Dynatrace</li>
<li>Tutorial</li>
<li>Updated on Jan 28, 2026</li>
</ul>
<p>Time is crucial when dealing with security incidents. This page shows how you can use Dynatrace to speed up your incident response in two phases:</p>
<ul>
<li>When an attack is detected, Dynatrace can automate the notification and analysis for you, so that the right teams are informed and receive actionable information to start working on the issue.</li>
<li>When investigating an issue, each new discovery guides the next steps in the incident response. Through Grail√¢¬Ä¬ôs schemaless queries, Dynatrace allows you to remain flexible in this time-critical process.</li>
</ul>
<h2 id="target-audience_8">Target audience<a class="headerlink" href="#target-audience_8" title="Permanent link">&para;</a></h2>
<p>This page is intended for Security teams analyzing security incidents, such as the Incident Response team.</p>
<h2 id="scenario_2">Scenario<a class="headerlink" href="#scenario_2" title="Permanent link">&para;</a></h2>
<p>In the following, we address a scenario in which identifying an attack, researching the scope, determining the responsible entity owners, and remediating the attack takes hours, sometimes even days.</p>
<ul>
<li>Tools like AWS GuardDuty trigger events on suspicious activity independently.</li>
<li>Handling the incoming load while increasing security strength is impossible.</li>
<li>All correlation and collaboration are manual, resulting in frustration about the silos.</li>
<li>Several internal integration tools, hard to manage, have been built; they are helpful, but aren't providing solid and safe automation.</li>
<li>A typical suspicious incident takes days to escalate and qualify.</li>
</ul>
<h3 id="request">Request<a class="headerlink" href="#request" title="Permanent link">&para;</a></h3>
<p>The team wants to quickly</p>
<ul>
<li>Identify when a possible attack is happening.</li>
<li>Research the scope and determine what is affected: for example, whether the attack affects only a single isolated, non-production system or threatens a critical part of the environment.</li>
<li>Determine the responsible entity owners.</li>
<li>Remediate the attack.</li>
</ul>
<h3 id="goals">Goals<a class="headerlink" href="#goals" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Efficiency</strong>: The team should be able to respond much faster to attacks.</li>
<li><strong>Flexibility</strong>: The team should have more flexibility in their response to security incidents.</li>
</ul>
<h3 id="result">Result<a class="headerlink" href="#result" title="Permanent link">&para;</a></h3>
<p>Combining the Dynatrace automation capabilities with insights into security-related data, our solution helps security teams react and respond faster to attacks. The team automatically scans all ingested logs for patterns that might indicate possible attacks. Because each attack is different, they make use of schemaless queries with instant responses to quickly identify the scope of an attack, thus reducing the required time from days to minutes.</p>
<h2 id="how-it-works">How it works<a class="headerlink" href="#how-it-works" title="Permanent link">&para;</a></h2>
<h3 id="context">Context<a class="headerlink" href="#context" title="Permanent link">&para;</a></h3>
<p>Logs from your <a href="/docs/discover-dynatrace/get-started/monitoring-environment" title="Understand and learn how to work with monitoring environments.">Dynatrace-monitored environment</a> are ingested into <a href="/docs/platform/grail" title="Insights on what and how you can query Dynatrace data.">Grail</a> via <a href="/docs/analyze-explore-automate/logs" title="Log Management and Analytics provides a unified approach to controlling and studying your log data in Dynatrace.">log ingestion</a>. When an attack is detected, a Dynatrace problem is created.</p>
<h3 id="1-intrusion-notification-automation">1. Intrusion notification automation<a class="headerlink" href="#1-intrusion-notification-automation" title="Permanent link">&para;</a></h3>
<p>A workflow is automatically triggered by this type of problem. The workflow collects, processes, and enriches the data with context, and converts the resulting information into notifications on your desired channels.</p>
<p>For an example of how you can set up an attack notification automation, see <a href="#workflow">Intrusion notification automation</a>.</p>
<h3 id="2-instant-queries">2. Instant queries<a class="headerlink" href="#2-instant-queries" title="Permanent link">&para;</a></h3>
<p>Based on the information received, you can immediately respond to discoveries and perform further investigations by running a sequence of DQL queries in <img alt="Notebooks" src="https://dt-cdn.net/images/notebooks-768-046137830a.webp" title="Notebooks" /> <strong>Notebooks</strong> tailored to the attack type.</p>
<p>For details, see <a href="#notebook">Instant queries</a>.</p>
<h2 id="prerequisites_9">Prerequisites<a class="headerlink" href="#prerequisites_9" title="Permanent link">&para;</a></h2>
<ul>
<li>Dynatrace version 1.283+</li>
<li><a href="/docs/analyze-explore-automate/logs" title="Log Management and Analytics provides a unified approach to controlling and studying your log data in Dynatrace.">Set up log ingestion</a> (ingests security incidents into Grail).</li>
<li><a href="/docs/deliver/ownership/ownership-teams" title="Define teams with team identifiers, descriptions, responsibilities, and routing information for entity ownership.">Set up ownership teams</a> (allows the workflow to assign security incidents based on ownership of the affected entity).</li>
<li><a href="/docs/analyze-explore-automate/workflows/actions/jira" title="Automate creating, transitioning, commenting, and assigning Jira issues on the events and schedules defined for your workflows.">Set up Jira Connector</a> (allows the workflow to convert resulting findings into Jira tickets).</li>
<li><a href="/docs/analyze-explore-automate/workflows/actions/slack" title="Send messages to Slack Workspaces">Set up Slack Connector</a> (allows the workflow to send resulting findings to Slack channels).</li>
</ul>
<p>While the current scenario uses Slack and Jira as notification channels, other integrations are also available. For details, see <a href="/docs/analyze-explore-automate/workflows/actions" title="Use Dynatrace ready-made actions for your workflows and integrate Dynatrace with third-party systems.">Workflows integrations</a>.
* Basic knowledge of how to</p>
<ul>
<li><a href="/docs/platform/grail/dynatrace-query-language/dql-reference" title="Dynatrace Query Language syntax reference.">Use Dynatrace Query Language (DQL)</a></li>
<li><a href="/docs/analyze-explore-automate/workflows/quickstart" title="Build and run your first workflow.">Create workflows</a></li>
<li>
<p>Make sure the following permissions are enabled.</p>
</li>
<li>
<p><strong>Grail</strong>: <code>storage:logs:read</code>. For instructions, see <a href="/docs/platform/grail/organize-data/assign-permissions-in-grail" title="Find out how to assign permissions to buckets and tables in Grail.">Assign permissions in Grail</a>.</p>
</li>
<li>
<p><img alt="Workflows" src="https://dt-cdn.net/images/workflows-1024-b5708f3cf9.webp" title="Workflows" /> <strong>Workflows</strong>: Permissions to access, view, write, and execute workflows. For details, see <a href="/docs/analyze-explore-automate/workflows#authorization" title="Automate IT processes with Dynatrace Workflows√¢¬Ä¬îreact to events, schedule tasks, and connect services.">Authorization</a>.</p>
<p>To access permissions, go to the <strong>Settings</strong> menu in the upper-right corner of <img alt="Workflows" src="https://dt-cdn.net/images/workflows-1024-b5708f3cf9.webp" title="Workflows" /> <strong>Workflows</strong> and select <strong>Authorization settings</strong>.</p>
</li>
</ul>
<h2 id="1-intrusion-notification-automation_1">1. Intrusion notification automation<a class="headerlink" href="#1-intrusion-notification-automation_1" title="Permanent link">&para;</a></h2>
<p>The following example illustrates how you can implement an attack notification automation using <a href="/docs/analyze-explore-automate/workflows" title="Automate IT processes with Dynatrace Workflows√¢¬Ä¬îreact to events, schedule tasks, and connect services."><img alt="Workflows" src="https://dt-cdn.net/images/workflows-1024-b5708f3cf9.webp" title="Workflows" /> <strong>Workflows</strong></a>. You can customize the workflow according to your needs.</p>
<ol>
<li>Set the trigger</li>
</ol>
<p>The automation needs to be triggered whenever an attack occurs.</p>
<p>In the <strong>Select trigger</strong> section, select and configure <strong>Davis Problem trigger</strong>. For details, see <a href="/docs/analyze-explore-automate/workflows/building#trigger" title="Create and edit workflows in Dynatrace Workflows.">Create workflows in Dynatrace Workflows: Trigger</a>.</p>
<p>Show me the relevant workflow task sequence</p>
<p><img alt="Set the trigger" src="https://dt-cdn.net/images/trigger-1700-3001e4f912.png" /></p>
<ol>
<li>Determine ownership</li>
</ol>
<p>Route notifications to the team responsible for the affected entities.</p>
<p>Select the <strong>Get owners</strong> action to create and configure this task. For details, see <a href="/docs/deliver/ownership-app#get-owners" title="It provides custom actions to define workflows integrating entity owners and their contact information.">Ownership app: <strong><code>get_owners</code></strong></a>.</p>
<p>Show me the relevant workflow task sequence</p>
<p><img alt="Set ownership" src="https://dt-cdn.net/images/set-owners-1700-f719d66bac.png" /></p>
<ol>
<li>Set up notification variables</li>
</ol>
<p>Configure variables such as default values for Slack and Jira fields, that will be used in later steps in the notification process.</p>
<p>Select the <strong>Run JavaScript</strong> action to create and configure these tasks. For details, see <a href="/docs/analyze-explore-automate/workflows#concept-action" title="Automate IT processes with Dynatrace Workflows√¢¬Ä¬îreact to events, schedule tasks, and connect services.">Introduction to workflows: Action</a>.</p>
<p>Show me the relevant workflow task sequences</p>
<p><img alt="Define notification channels" src="https://dt-cdn.net/images/channels-1700-83943a78ba.png" /></p>
<ol>
<li>
<p>Collect data and enrich with context</p>
</li>
<li>
<p>Query third-party services. For example:</p>
</li>
<li>
<p>Perform a WHOIS lookup to find details about the attacker's IP address.</p>
</li>
<li>Verify the IP reputation using a third-party service such as AbuseIPDB.</li>
</ol>
<p>Select the <strong>HTTP Request</strong> action to create and configure these tasks. For details, see <a href="/docs/analyze-explore-automate/workflows#concept-action" title="Automate IT processes with Dynatrace Workflows√¢¬Ä¬îreact to events, schedule tasks, and connect services.">Introduction to workflows: Action</a>.
* Query Dynatrace. For example:</p>
<ul>
<li>Determine whether there were any successful logins from the attacker's IP address.</li>
<li>Find out additional traffic information from the attacker's IP address.</li>
</ul>
<p>Select the <strong>Execute DQL Query</strong> action to create and configure these tasks. For details, see <a href="/docs/analyze-explore-automate/workflows#concept-action" title="Automate IT processes with Dynatrace Workflows√¢¬Ä¬îreact to events, schedule tasks, and connect services.">Introduction to workflows: Action</a>.</p>
<p>Show me the relevant workflow task sequences</p>
<p><img alt="Collect and enrich data" src="https://dt-cdn.net/images/collect-data-1700-2cf1aad6c7.png" /></p>
<ol>
<li>Extract successful requests</li>
</ol>
<p>Extract the successful requests from the total requests collected.</p>
<p>Select the <strong>Run JavaScript</strong> action to create and configure this task. For details, see <a href="/docs/analyze-explore-automate/workflows#concept-action" title="Automate IT processes with Dynatrace Workflows√¢¬Ä¬îreact to events, schedule tasks, and connect services.">Introduction to workflows: Action</a>.</p>
<p>Show me the relevant workflow task sequence</p>
<p><img alt="Extract successful requests" src="https://dt-cdn.net/images/extract-successful-1700-7d72549785.png" /></p>
<ol>
<li>Replay against target</li>
</ol>
<p>Replay the successful requests against the target entity to look for indicators of compromise. Custom code steps allow you to automate complex logic that you want to run for each detected attack. Depending on the detected attack and the affected systems, you might want to replay the attacks for more detailed analysis.</p>
<p>Select the <strong>Run JavaScript</strong> action to create and configure this task. For details, see <a href="/docs/analyze-explore-automate/workflows#concept-action" title="Automate IT processes with Dynatrace Workflows√¢¬Ä¬îreact to events, schedule tasks, and connect services.">Introduction to workflows: Action</a>.</p>
<p>Show me the relevant workflow task sequence</p>
<p><img alt="Replay against target" src="https://dt-cdn.net/images/replay-against-target-1700-dca61b334e.png" /></p>
<ol>
<li>
<p>Send notifications</p>
</li>
<li>
<p>Notify the responsible team on Slack.</p>
</li>
</ol>
<p>Select the <strong>Send message</strong> action to create and configure this task. For details, see <a href="/docs/analyze-explore-automate/workflows/actions/slack#workflow" title="Send messages to Slack Workspaces">Use Workflows with Slack</a>.
* Create a Jira ticket for the entity owner containing the collected information.</p>
<p>Select the <strong>Create issue</strong> action to create and configure this task. For details, see <a href="/docs/analyze-explore-automate/workflows/actions/jira#workflow" title="Automate creating, transitioning, commenting, and assigning Jira issues on the events and schedules defined for your workflows.">Create Jira issues with workflows</a>.</p>
<p>Show me the relevant workflow task sequences</p>
<p><img alt="Send notifications" src="https://dt-cdn.net/images/send-notifications-1700-52548fa8bb.png" /></p>
<h2 id="2-instant-queries_1">2. Instant queries<a class="headerlink" href="#2-instant-queries_1" title="Permanent link">&para;</a></h2>
<p>After receiving the notification, the security team can immediately respond to discoveries and instantly run additional DQL queries in <a href="/docs/analyze-explore-automate/dashboards-and-notebooks/notebooks" title="Analyze, visualize, and share insights from your observability data√¢¬Ä¬îall in one collaborative, customizable workspace."><img alt="Notebooks" src="https://dt-cdn.net/images/notebooks-768-046137830a.webp" title="Notebooks" /> <strong>Notebooks</strong></a> without knowing beforehand where the information they're looking for is. In an emergency situation, this is crucial, as a speedy response can ensure that the attack can be contained.</p>
<p>The following are some examples of how you can query Grail in case of a web attack.</p>
<h3 id="logs-from-the-attacker-ip-address">Logs from the attacker IP address<a class="headerlink" href="#logs-from-the-attacker-ip-address" title="Permanent link">&para;</a></h3>
<p>Query example:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-46-1" name="__codelineno-46-1" href="#__codelineno-46-1"></a>fetch logs, scanLimitGBytes:-1
<a id="__codelineno-46-2" name="__codelineno-46-2" href="#__codelineno-46-2"></a>
<a id="__codelineno-46-3" name="__codelineno-46-3" href="#__codelineno-46-3"></a>
<a id="__codelineno-46-4" name="__codelineno-46-4" href="#__codelineno-46-4"></a>
<a id="__codelineno-46-5" name="__codelineno-46-5" href="#__codelineno-46-5"></a>| filter log.source == &quot;/var/log/nginx/access.log&quot;
<a id="__codelineno-46-6" name="__codelineno-46-6" href="#__codelineno-46-6"></a>
<a id="__codelineno-46-7" name="__codelineno-46-7" href="#__codelineno-46-7"></a>
<a id="__codelineno-46-8" name="__codelineno-46-8" href="#__codelineno-46-8"></a>
<a id="__codelineno-46-9" name="__codelineno-46-9" href="#__codelineno-46-9"></a>| filter net.peer.ip == &quot;&lt;&lt;IP ADDRESS&gt;&gt;&quot;
<a id="__codelineno-46-10" name="__codelineno-46-10" href="#__codelineno-46-10"></a>
<a id="__codelineno-46-11" name="__codelineno-46-11" href="#__codelineno-46-11"></a>
<a id="__codelineno-46-12" name="__codelineno-46-12" href="#__codelineno-46-12"></a>
<a id="__codelineno-46-13" name="__codelineno-46-13" href="#__codelineno-46-13"></a>| sort timestamp desc
</code></pre></div>
<h3 id="successful-web-requests-from-the-attacker-ip-address">Successful web requests from the attacker IP address<a class="headerlink" href="#successful-web-requests-from-the-attacker-ip-address" title="Permanent link">&para;</a></h3>
<p>Query example:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-47-1" name="__codelineno-47-1" href="#__codelineno-47-1"></a>fetch logs, scanLimitGBytes:-1
<a id="__codelineno-47-2" name="__codelineno-47-2" href="#__codelineno-47-2"></a>
<a id="__codelineno-47-3" name="__codelineno-47-3" href="#__codelineno-47-3"></a>
<a id="__codelineno-47-4" name="__codelineno-47-4" href="#__codelineno-47-4"></a>
<a id="__codelineno-47-5" name="__codelineno-47-5" href="#__codelineno-47-5"></a>| filter log.source == &quot;/var/log/nginx/access.log&quot;
<a id="__codelineno-47-6" name="__codelineno-47-6" href="#__codelineno-47-6"></a>
<a id="__codelineno-47-7" name="__codelineno-47-7" href="#__codelineno-47-7"></a>
<a id="__codelineno-47-8" name="__codelineno-47-8" href="#__codelineno-47-8"></a>
<a id="__codelineno-47-9" name="__codelineno-47-9" href="#__codelineno-47-9"></a>| filter net.peer.ip == &quot;&lt;&lt;IP Address&gt;&gt;&quot;
<a id="__codelineno-47-10" name="__codelineno-47-10" href="#__codelineno-47-10"></a>
<a id="__codelineno-47-11" name="__codelineno-47-11" href="#__codelineno-47-11"></a>
<a id="__codelineno-47-12" name="__codelineno-47-12" href="#__codelineno-47-12"></a>
<a id="__codelineno-47-13" name="__codelineno-47-13" href="#__codelineno-47-13"></a>| filter http.status_code == &quot;200&quot;
<a id="__codelineno-47-14" name="__codelineno-47-14" href="#__codelineno-47-14"></a>
<a id="__codelineno-47-15" name="__codelineno-47-15" href="#__codelineno-47-15"></a>
<a id="__codelineno-47-16" name="__codelineno-47-16" href="#__codelineno-47-16"></a>
<a id="__codelineno-47-17" name="__codelineno-47-17" href="#__codelineno-47-17"></a>| sort timestamp desc
</code></pre></div>
<h3 id="status-codes-and-response-codes-overview">Status codes and response codes overview<a class="headerlink" href="#status-codes-and-response-codes-overview" title="Permanent link">&para;</a></h3>
<p>Query example:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-48-1" name="__codelineno-48-1" href="#__codelineno-48-1"></a>fetch logs, scanLimitGBytes:-1
<a id="__codelineno-48-2" name="__codelineno-48-2" href="#__codelineno-48-2"></a>
<a id="__codelineno-48-3" name="__codelineno-48-3" href="#__codelineno-48-3"></a>
<a id="__codelineno-48-4" name="__codelineno-48-4" href="#__codelineno-48-4"></a>
<a id="__codelineno-48-5" name="__codelineno-48-5" href="#__codelineno-48-5"></a>| filter log.source == &quot;/var/log/nginx/access.log&quot;
<a id="__codelineno-48-6" name="__codelineno-48-6" href="#__codelineno-48-6"></a>
<a id="__codelineno-48-7" name="__codelineno-48-7" href="#__codelineno-48-7"></a>
<a id="__codelineno-48-8" name="__codelineno-48-8" href="#__codelineno-48-8"></a>
<a id="__codelineno-48-9" name="__codelineno-48-9" href="#__codelineno-48-9"></a>| filter net.peer.ip == &quot;&lt;&lt;IP Address&gt;&gt;&quot;
<a id="__codelineno-48-10" name="__codelineno-48-10" href="#__codelineno-48-10"></a>
<a id="__codelineno-48-11" name="__codelineno-48-11" href="#__codelineno-48-11"></a>
<a id="__codelineno-48-12" name="__codelineno-48-12" href="#__codelineno-48-12"></a>
<a id="__codelineno-48-13" name="__codelineno-48-13" href="#__codelineno-48-13"></a>| summarize requests=count(), by:{http.status_code, http.user_agent}
<a id="__codelineno-48-14" name="__codelineno-48-14" href="#__codelineno-48-14"></a>
<a id="__codelineno-48-15" name="__codelineno-48-15" href="#__codelineno-48-15"></a>
<a id="__codelineno-48-16" name="__codelineno-48-16" href="#__codelineno-48-16"></a>
<a id="__codelineno-48-17" name="__codelineno-48-17" href="#__codelineno-48-17"></a>| sort http.status_code
</code></pre></div>
<h3 id="payloads-used-by-the-attacker-ip-address">Payloads used by the attacker IP address<a class="headerlink" href="#payloads-used-by-the-attacker-ip-address" title="Permanent link">&para;</a></h3>
<p>Query example:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-49-1" name="__codelineno-49-1" href="#__codelineno-49-1"></a>fetch logs, scanLimitGBytes:-1
<a id="__codelineno-49-2" name="__codelineno-49-2" href="#__codelineno-49-2"></a>
<a id="__codelineno-49-3" name="__codelineno-49-3" href="#__codelineno-49-3"></a>
<a id="__codelineno-49-4" name="__codelineno-49-4" href="#__codelineno-49-4"></a>
<a id="__codelineno-49-5" name="__codelineno-49-5" href="#__codelineno-49-5"></a>| filter log.source == &quot;/var/log/nginx/access.log&quot;
<a id="__codelineno-49-6" name="__codelineno-49-6" href="#__codelineno-49-6"></a>
<a id="__codelineno-49-7" name="__codelineno-49-7" href="#__codelineno-49-7"></a>
<a id="__codelineno-49-8" name="__codelineno-49-8" href="#__codelineno-49-8"></a>
<a id="__codelineno-49-9" name="__codelineno-49-9" href="#__codelineno-49-9"></a>// Successful requests only
<a id="__codelineno-49-10" name="__codelineno-49-10" href="#__codelineno-49-10"></a>
<a id="__codelineno-49-11" name="__codelineno-49-11" href="#__codelineno-49-11"></a>
<a id="__codelineno-49-12" name="__codelineno-49-12" href="#__codelineno-49-12"></a>
<a id="__codelineno-49-13" name="__codelineno-49-13" href="#__codelineno-49-13"></a>| filter http.status_code == &quot;200&quot;
<a id="__codelineno-49-14" name="__codelineno-49-14" href="#__codelineno-49-14"></a>
<a id="__codelineno-49-15" name="__codelineno-49-15" href="#__codelineno-49-15"></a>
<a id="__codelineno-49-16" name="__codelineno-49-16" href="#__codelineno-49-16"></a>
<a id="__codelineno-49-17" name="__codelineno-49-17" href="#__codelineno-49-17"></a>| filter net.peer.ip == &quot;&lt;&lt;IP Address&gt;&gt;&quot;
<a id="__codelineno-49-18" name="__codelineno-49-18" href="#__codelineno-49-18"></a>
<a id="__codelineno-49-19" name="__codelineno-49-19" href="#__codelineno-49-19"></a>
<a id="__codelineno-49-20" name="__codelineno-49-20" href="#__codelineno-49-20"></a>
<a id="__codelineno-49-21" name="__codelineno-49-21" href="#__codelineno-49-21"></a>| summarize requests=count(), by:{http.target}
<a id="__codelineno-49-22" name="__codelineno-49-22" href="#__codelineno-49-22"></a>
<a id="__codelineno-49-23" name="__codelineno-49-23" href="#__codelineno-49-23"></a>
<a id="__codelineno-49-24" name="__codelineno-49-24" href="#__codelineno-49-24"></a>
<a id="__codelineno-49-25" name="__codelineno-49-25" href="#__codelineno-49-25"></a>| sort requests DESC
</code></pre></div>
<h3 id="successful-requests-from-a-given-ip-address-sorted-by-response-size">Successful requests from a given IP address sorted by response size<a class="headerlink" href="#successful-requests-from-a-given-ip-address-sorted-by-response-size" title="Permanent link">&para;</a></h3>
<p>Query example:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-50-1" name="__codelineno-50-1" href="#__codelineno-50-1"></a>fetch logs, scanLimitGBytes:-1
<a id="__codelineno-50-2" name="__codelineno-50-2" href="#__codelineno-50-2"></a>
<a id="__codelineno-50-3" name="__codelineno-50-3" href="#__codelineno-50-3"></a>
<a id="__codelineno-50-4" name="__codelineno-50-4" href="#__codelineno-50-4"></a>
<a id="__codelineno-50-5" name="__codelineno-50-5" href="#__codelineno-50-5"></a>| filter log.source == &quot;/var/log/nginx/access.log&quot;
<a id="__codelineno-50-6" name="__codelineno-50-6" href="#__codelineno-50-6"></a>
<a id="__codelineno-50-7" name="__codelineno-50-7" href="#__codelineno-50-7"></a>
<a id="__codelineno-50-8" name="__codelineno-50-8" href="#__codelineno-50-8"></a>
<a id="__codelineno-50-9" name="__codelineno-50-9" href="#__codelineno-50-9"></a>| fields timestamp, net.peer.ip, http.target, http.status_code, http.response_content_length, http.user_agent
<a id="__codelineno-50-10" name="__codelineno-50-10" href="#__codelineno-50-10"></a>
<a id="__codelineno-50-11" name="__codelineno-50-11" href="#__codelineno-50-11"></a>
<a id="__codelineno-50-12" name="__codelineno-50-12" href="#__codelineno-50-12"></a>
<a id="__codelineno-50-13" name="__codelineno-50-13" href="#__codelineno-50-13"></a>| filter http.status_code == &quot;200&quot;
<a id="__codelineno-50-14" name="__codelineno-50-14" href="#__codelineno-50-14"></a>
<a id="__codelineno-50-15" name="__codelineno-50-15" href="#__codelineno-50-15"></a>
<a id="__codelineno-50-16" name="__codelineno-50-16" href="#__codelineno-50-16"></a>
<a id="__codelineno-50-17" name="__codelineno-50-17" href="#__codelineno-50-17"></a>// Filter for a specific IP address
<a id="__codelineno-50-18" name="__codelineno-50-18" href="#__codelineno-50-18"></a>
<a id="__codelineno-50-19" name="__codelineno-50-19" href="#__codelineno-50-19"></a>
<a id="__codelineno-50-20" name="__codelineno-50-20" href="#__codelineno-50-20"></a>
<a id="__codelineno-50-21" name="__codelineno-50-21" href="#__codelineno-50-21"></a>| filter net.peer.ip == &quot;&lt;&lt;IP Address&gt;&gt;&quot;
<a id="__codelineno-50-22" name="__codelineno-50-22" href="#__codelineno-50-22"></a>
<a id="__codelineno-50-23" name="__codelineno-50-23" href="#__codelineno-50-23"></a>
<a id="__codelineno-50-24" name="__codelineno-50-24" href="#__codelineno-50-24"></a>
<a id="__codelineno-50-25" name="__codelineno-50-25" href="#__codelineno-50-25"></a>| sort toLong(http.response_content_length) DESC
</code></pre></div>
<h3 id="payloads-in-access-logs-both-successful-and-not-successful">Payloads in access logs (both successful and not successful)<a class="headerlink" href="#payloads-in-access-logs-both-successful-and-not-successful" title="Permanent link">&para;</a></h3>
<p>Query example:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-51-1" name="__codelineno-51-1" href="#__codelineno-51-1"></a>fetch logs, scanLimitGBytes:-1
<a id="__codelineno-51-2" name="__codelineno-51-2" href="#__codelineno-51-2"></a>
<a id="__codelineno-51-3" name="__codelineno-51-3" href="#__codelineno-51-3"></a>
<a id="__codelineno-51-4" name="__codelineno-51-4" href="#__codelineno-51-4"></a>
<a id="__codelineno-51-5" name="__codelineno-51-5" href="#__codelineno-51-5"></a>| filter log.source == &quot;/var/log/nginx/access.log&quot;
<a id="__codelineno-51-6" name="__codelineno-51-6" href="#__codelineno-51-6"></a>
<a id="__codelineno-51-7" name="__codelineno-51-7" href="#__codelineno-51-7"></a>
<a id="__codelineno-51-8" name="__codelineno-51-8" href="#__codelineno-51-8"></a>
<a id="__codelineno-51-9" name="__codelineno-51-9" href="#__codelineno-51-9"></a>| fields payload = &quot;&lt;&lt;PAYLOAD&gt;&gt;&quot;, timestamp, net.peer.ip, http.method, http.target, http.status_code, http.request.header.referrer, http.response_content_length, http.user_agent, content
<a id="__codelineno-51-10" name="__codelineno-51-10" href="#__codelineno-51-10"></a>
<a id="__codelineno-51-11" name="__codelineno-51-11" href="#__codelineno-51-11"></a>
<a id="__codelineno-51-12" name="__codelineno-51-12" href="#__codelineno-51-12"></a>
<a id="__codelineno-51-13" name="__codelineno-51-13" href="#__codelineno-51-13"></a>| filter contains(content, payload)
</code></pre></div>
<h3 id="successful-sso-logins-from-the-attacker-ip-address">Successful SSO logins from the attacker IP address<a class="headerlink" href="#successful-sso-logins-from-the-attacker-ip-address" title="Permanent link">&para;</a></h3>
<p>Query example:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-52-1" name="__codelineno-52-1" href="#__codelineno-52-1"></a>fetch logs, scanLimitGBytes: -1
<a id="__codelineno-52-2" name="__codelineno-52-2" href="#__codelineno-52-2"></a>
<a id="__codelineno-52-3" name="__codelineno-52-3" href="#__codelineno-52-3"></a>
<a id="__codelineno-52-4" name="__codelineno-52-4" href="#__codelineno-52-4"></a>
<a id="__codelineno-52-5" name="__codelineno-52-5" href="#__codelineno-52-5"></a>// Search for logins
<a id="__codelineno-52-6" name="__codelineno-52-6" href="#__codelineno-52-6"></a>
<a id="__codelineno-52-7" name="__codelineno-52-7" href="#__codelineno-52-7"></a>
<a id="__codelineno-52-8" name="__codelineno-52-8" href="#__codelineno-52-8"></a>
<a id="__codelineno-52-9" name="__codelineno-52-9" href="#__codelineno-52-9"></a>| filter log.source == &quot;/var/log/sso.log&quot;
<a id="__codelineno-52-10" name="__codelineno-52-10" href="#__codelineno-52-10"></a>
<a id="__codelineno-52-11" name="__codelineno-52-11" href="#__codelineno-52-11"></a>
<a id="__codelineno-52-12" name="__codelineno-52-12" href="#__codelineno-52-12"></a>
<a id="__codelineno-52-13" name="__codelineno-52-13" href="#__codelineno-52-13"></a>// Search for successful logins from a given IP address
<a id="__codelineno-52-14" name="__codelineno-52-14" href="#__codelineno-52-14"></a>
<a id="__codelineno-52-15" name="__codelineno-52-15" href="#__codelineno-52-15"></a>
<a id="__codelineno-52-16" name="__codelineno-52-16" href="#__codelineno-52-16"></a>
<a id="__codelineno-52-17" name="__codelineno-52-17" href="#__codelineno-52-17"></a>| filter contains(content, &quot;user login successful&quot;) and contains(content, &quot;&lt;&lt;IP address&gt;&gt;&quot;)
<a id="__codelineno-52-18" name="__codelineno-52-18" href="#__codelineno-52-18"></a>
<a id="__codelineno-52-19" name="__codelineno-52-19" href="#__codelineno-52-19"></a>
<a id="__codelineno-52-20" name="__codelineno-52-20" href="#__codelineno-52-20"></a>
<a id="__codelineno-52-21" name="__codelineno-52-21" href="#__codelineno-52-21"></a>| sort timestamp desc
</code></pre></div>
<h3 id="which-environments-the-attacker-has-logged-into">Which environments the attacker has logged into<a class="headerlink" href="#which-environments-the-attacker-has-logged-into" title="Permanent link">&para;</a></h3>
<p>Query example:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-53-1" name="__codelineno-53-1" href="#__codelineno-53-1"></a>fetch logs, scanLimitGBytes: -1
<a id="__codelineno-53-2" name="__codelineno-53-2" href="#__codelineno-53-2"></a>
<a id="__codelineno-53-3" name="__codelineno-53-3" href="#__codelineno-53-3"></a>
<a id="__codelineno-53-4" name="__codelineno-53-4" href="#__codelineno-53-4"></a>
<a id="__codelineno-53-5" name="__codelineno-53-5" href="#__codelineno-53-5"></a>// Search for logins
<a id="__codelineno-53-6" name="__codelineno-53-6" href="#__codelineno-53-6"></a>
<a id="__codelineno-53-7" name="__codelineno-53-7" href="#__codelineno-53-7"></a>
<a id="__codelineno-53-8" name="__codelineno-53-8" href="#__codelineno-53-8"></a>
<a id="__codelineno-53-9" name="__codelineno-53-9" href="#__codelineno-53-9"></a>| filter log.source == &quot;/var/log/sso.log&quot;
<a id="__codelineno-53-10" name="__codelineno-53-10" href="#__codelineno-53-10"></a>
<a id="__codelineno-53-11" name="__codelineno-53-11" href="#__codelineno-53-11"></a>
<a id="__codelineno-53-12" name="__codelineno-53-12" href="#__codelineno-53-12"></a>
<a id="__codelineno-53-13" name="__codelineno-53-13" href="#__codelineno-53-13"></a>// Search for logins from a given account id
<a id="__codelineno-53-14" name="__codelineno-53-14" href="#__codelineno-53-14"></a>
<a id="__codelineno-53-15" name="__codelineno-53-15" href="#__codelineno-53-15"></a>
<a id="__codelineno-53-16" name="__codelineno-53-16" href="#__codelineno-53-16"></a>
<a id="__codelineno-53-17" name="__codelineno-53-17" href="#__codelineno-53-17"></a>| filter contains(content, &quot;&lt;&lt;Account ID&gt;&gt;&quot;) and contains(content, &quot;tenant: &quot;)
<a id="__codelineno-53-18" name="__codelineno-53-18" href="#__codelineno-53-18"></a>
<a id="__codelineno-53-19" name="__codelineno-53-19" href="#__codelineno-53-19"></a>
<a id="__codelineno-53-20" name="__codelineno-53-20" href="#__codelineno-53-20"></a>
<a id="__codelineno-53-21" name="__codelineno-53-21" href="#__codelineno-53-21"></a>| sort timestamp desc
</code></pre></div>
<h2 id="stay-ahead-of-threats">Stay ahead of threats<a class="headerlink" href="#stay-ahead-of-threats" title="Permanent link">&para;</a></h2>
<p>You can use the above instructions as building blocks to automate common steps in your incidents process. These can help you respond faster to security incidents, thus reducing their impact.</p>
<h2 id="further-reading">Further reading<a class="headerlink" href="#further-reading" title="Permanent link">&para;</a></h2>
<p><a href="/docs/analyze-explore-automate/logs/logs-on-grail-examples" title="Explore basic Log Management and Analytics examples of how to use log data in Dynatrace powered by Grail.">Log on Grail examples</a></p>
<p><a href="/docs/dynatrace-intelligence/use-cases/davis-dql-examples" title="Build powerful health dashboards by slicing and dicing of Dynatrace Intelligence reported problems and events using DQL.">Dynatrace Intelligence DQL examples</a></p>
<p><a href="/docs/secure/threat-observability/dql-examples" title="DQL examples for security data powered by Grail.">DQL examples for security-related data</a></p>
<hr />
<h2 id="source-monitor-sign-in-activitymd">Source: monitor-sign-in-activity.md<a class="headerlink" href="#source-monitor-sign-in-activitymd" title="Permanent link">&para;</a></h2>
<hr />
<p>title: Monitor suspicious sign-in activity with Dynatrace
source: https://www.dynatrace.com/docs/secure/use-cases/monitor-sign-in-activity
scraped: 2026-02-16T21:21:54.858021</p>
<hr />
<h1 id="monitor-suspicious-sign-in-activity-with-dynatrace">Monitor suspicious sign-in activity with Dynatrace<a class="headerlink" href="#monitor-suspicious-sign-in-activity-with-dynatrace" title="Permanent link">&para;</a></h1>
<h1 id="monitor-suspicious-sign-in-activity-with-dynatrace_1">Monitor suspicious sign-in activity with Dynatrace<a class="headerlink" href="#monitor-suspicious-sign-in-activity-with-dynatrace_1" title="Permanent link">&para;</a></h1>
<ul>
<li>Latest Dynatrace</li>
<li>Tutorial</li>
<li>Updated on Jan 28, 2026</li>
</ul>
<p>As organizations embrace cloud technologies, monitoring sign-in logs is crucial for detecting anomalies, investigating suspicious activities, and ensuring regulatory compliance. Real-time visibility into login behavior helps rapidly address security risks, protect user identities, and safeguard critical resources. It also provides actionable insights into compromised accounts, malicious insiders, and user behavior patterns, aiding strategic decisions on access management, device policies, and application usage.</p>
<p>While the following scenario focuses on Microsoft Entra ID logs as an example, the described approach is universally applicable to any cloud, access, or identity provider integrated with Dynatrace. This is made possible through Semantic Dictionary and the standardized data mapping to the defined <a href="/docs/semantic-dictionary/model/log" title="Get to know the Semantic Dictionary models related to Log Analytics.">semantic model</a>.</p>
<p>As long as sign-in logs from a supported identity provider are ingested into Dynatrace, you can follow the steps outlined below to monitor these logs effectively.</p>
<h2 id="target-audience_9">Target audience<a class="headerlink" href="#target-audience_9" title="Permanent link">&para;</a></h2>
<p>Security administrators and security teams responsible for safeguarding their organization√¢¬Ä¬ôs cloud environment and user activity.</p>
<h2 id="scenario_3">Scenario<a class="headerlink" href="#scenario_3" title="Permanent link">&para;</a></h2>
<p>Your organization relies on Microsoft Entra ID as a centralized identity provider, granting users single-sign-on (SSO) access to various company applications and services.
Microsoft Entra ID sign-in logs are forwarded to Dynatrace and stored in Grail to gain deeper visibility into user activity, creating a unified data hub for monitoring and analysis.</p>
<p>As a security administrator, your responsibility is to</p>
<ul>
<li>Safeguard user identities belonging to your organization</li>
<li>Monitor user access and track patterns to spot unusual behavior quickly</li>
<li>Identify and investigate potential threats or anomalous sign-in events</li>
<li>Start incident response activities promptly to minimize damage if a user account gets compromised</li>
</ul>
<h3 id="goals_1">Goals<a class="headerlink" href="#goals_1" title="Permanent link">&para;</a></h3>
<ul>
<li>Achieve comprehensive visibility over the cloud environment and user activity through a single pane of glass.</li>
<li>Demonstrate how to monitor Microsoft Entra ID sign-in logs and user activity to detect potential security issues and anomalous behaviors.</li>
</ul>
<h2 id="prerequisites_10">Prerequisites<a class="headerlink" href="#prerequisites_10" title="Permanent link">&para;</a></h2>
<ul>
<li>Knowledge of <a href="/docs/platform/grail/dynatrace-query-language" title="How to use Dynatrace Query Language.">Dynatrace Query Language</a> and <a href="/docs/platform/grail/dynatrace-query-language/dql-guide" title="Find out how DQL works and what are DQL key concepts.">how to use DQL queries</a>.</li>
<li>
<p>Send Microsoft Entra ID sign-in logs to Dynatrace. There are two options to stream logs:</p>
</li>
<li>
<p><a href="/docs/ingest-from/microsoft-azure-services/azure-platform/azure-native-integration" title="Set and configure your Dynatrace SaaS environment using Azure Marketplace.">Azure Native Dynatrace Service</a></p>
</li>
<li><a href="/docs/ingest-from/microsoft-azure-services/azure-integrations/set-up-log-forwarder-azure" title="Use Azure log forwarding to ingest Azure logs.">Azure Log Forwarder</a></li>
<li>Follow the instructions in <a href="/docs/platform/openpipeline/use-cases/tutorial-technology-processor#pipeline" title="Set up a processing pipeline to structure technology-specific logs according to Dynatrace Semantic Dictionary.">Create a pipeline for processing</a> to configure the OpenPipeline environment. Select <strong>Azure Entra ID Audit Logs</strong> as the built-in processor.</li>
</ul>
<h2 id="get-started_8">Get started<a class="headerlink" href="#get-started_8" title="Permanent link">&para;</a></h2>
<ol>
<li>Import dashboard</li>
</ol>
<p>Use our sample dashboard to view user sign-in activities within your cloud environments.</p>
<ol>
<li>Download the <a href="https://dt-url.net/ur03wvb">sample dashboard from GitHub√Ø¬ª¬ø</a>.</li>
<li>
<p>Open <a href="/docs/analyze-explore-automate/dashboards-and-notebooks/dashboards-new" title="Create interactive, customizable views to visualize, analyze, and share your observability data in real time."><img alt="Dashboards" src="https://dt-cdn.net/images/dashboards-512-b1f1e9690b.png" title="Dashboards" /> <strong>Dashboards</strong></a>, select <img alt="Import" src="https://dt-cdn.net/images/dashboards-app-dashboards-page-import-6a06e645df.svg" title="Import" /> <strong>Upload</strong>, then select the downloaded file.</p>
</li>
<li>
<p>Set up filters</p>
</li>
<li>
<p>In <strong>Product</strong>, filter for <code>Azure</code> to display Microsoft Entra ID sign-in logs coming from the connected Azure environment.</p>
</li>
<li>Use the timeframe selector to narrow down your investigation to relevant incidents, identify trends or anomalies within that window, and efficiently monitor user activities or suspicious behavior during critical times.</li>
</ol>
<p><img alt="filtering" src="https://dt-cdn.net/images/2025-03-26-18-28-55-1865-3328587bcd.png" />
3. To fine-tune your investigation, consider setting up additional filters. For example:</p>
<ul>
<li><strong>User</strong>, to analyze individual sign-in trends, devices, and locations for specific users, helping you to identify unusual access patterns or targeted attacks.</li>
<li><strong>User IP address</strong>, to investigate activities from particular IP addresses, detecting repeated failed sign-ins or unusual access origins.</li>
<li><strong>Device OS</strong>, to track the operating systems used during sign-ins, helping you to spot outdated or unauthorized devices.</li>
<li><strong>Country</strong>, to examine sign-ins by geographic location to detect access from unexpected or restricted regions.</li>
<li><strong>Target service</strong>, to identify which services or applications are being accessed, useful for monitoring sensitive resources.</li>
<li><strong>Result code</strong>, to review the outcomes of sign-in attempts to detect anomalies, such as excessive failed attempts indicating potential brute-force attacks.</li>
<li>
<p><strong>Client application</strong>, to determine which applications are being used to sign in, useful for identifying unauthorized or suspicious app usage.</p>
</li>
<li>
<p>Review activity and trends</p>
</li>
</ul>
<p>In the <strong>Sign-in activity monitoring</strong> section, you can</p>
<ul>
<li>Analyze sign-in trends</li>
<li>Identify peak activity periods</li>
<li>Investigate access patterns by location or IP address</li>
</ul>
<p>This enables you to gain a clear understanding of user distribution and quickly spot irregular activities from unexpected regions, helping you enhance security and respond to potential risks effectively.</p>
<p><img alt="An overview dashboard example" src="https://dt-cdn.net/images/image-50-2540-6620ffd45d.png" /></p>
<p>Run query</p>
<p>You can reproduce the <strong>Sign-in activity outcomes over time</strong> chart in <a href="/docs/secure/investigations" title="Combine Grail functionalities for evidence-driven investigations, including incident resolution, root cause analysis, and threat hunting."><img alt="Investigations" src="https://dt-cdn.net/images/security-investigator-256-93f6c187d9.png" title="Investigations" /> <strong>Investigations</strong></a> or <a href="/docs/analyze-explore-automate/dashboards-and-notebooks/notebooks" title="Analyze, visualize, and share insights from your observability data√¢¬Ä¬îall in one collaborative, customizable workspace."><img alt="Notebooks" src="https://dt-cdn.net/images/notebooks-768-046137830a.webp" title="Notebooks" /> <strong>Notebooks</strong></a> with the following DQL snippet:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-54-1" name="__codelineno-54-1" href="#__codelineno-54-1"></a>fetch logs
<a id="__codelineno-54-2" name="__codelineno-54-2" href="#__codelineno-54-2"></a>
<a id="__codelineno-54-3" name="__codelineno-54-3" href="#__codelineno-54-3"></a>
<a id="__codelineno-54-4" name="__codelineno-54-4" href="#__codelineno-54-4"></a>
<a id="__codelineno-54-5" name="__codelineno-54-5" href="#__codelineno-54-5"></a>| filter isNotNull(audit.action) and isNotNull(authentication.is_multifactor)
<a id="__codelineno-54-6" name="__codelineno-54-6" href="#__codelineno-54-6"></a>
<a id="__codelineno-54-7" name="__codelineno-54-7" href="#__codelineno-54-7"></a>
<a id="__codelineno-54-8" name="__codelineno-54-8" href="#__codelineno-54-8"></a>
<a id="__codelineno-54-9" name="__codelineno-54-9" href="#__codelineno-54-9"></a>| makeTimeseries {
<a id="__codelineno-54-10" name="__codelineno-54-10" href="#__codelineno-54-10"></a>
<a id="__codelineno-54-11" name="__codelineno-54-11" href="#__codelineno-54-11"></a>
<a id="__codelineno-54-12" name="__codelineno-54-12" href="#__codelineno-54-12"></a>
<a id="__codelineno-54-13" name="__codelineno-54-13" href="#__codelineno-54-13"></a>Success = countIf(audit.result==&quot;Succeeded&quot;, default:0),
<a id="__codelineno-54-14" name="__codelineno-54-14" href="#__codelineno-54-14"></a>
<a id="__codelineno-54-15" name="__codelineno-54-15" href="#__codelineno-54-15"></a>
<a id="__codelineno-54-16" name="__codelineno-54-16" href="#__codelineno-54-16"></a>
<a id="__codelineno-54-17" name="__codelineno-54-17" href="#__codelineno-54-17"></a>Failure = countIf(audit.result!=&quot;Succeeded&quot;, default:0)
<a id="__codelineno-54-18" name="__codelineno-54-18" href="#__codelineno-54-18"></a>
<a id="__codelineno-54-19" name="__codelineno-54-19" href="#__codelineno-54-19"></a>
<a id="__codelineno-54-20" name="__codelineno-54-20" href="#__codelineno-54-20"></a>
<a id="__codelineno-54-21" name="__codelineno-54-21" href="#__codelineno-54-21"></a>}, time:audit.time
</code></pre></div>
<ol>
<li>Drill down</li>
</ol>
<p>In the <strong>Top sign-in activity breakdown</strong> section, you can explore detailed insights into user and IP-based sign-in activities.</p>
<p><strong>Example 1</strong>: In <strong>Top 10 sign-in users</strong>, you can identify</p>
<ul>
<li>Anomalies such as account lockouts or potential brute-force attacks</li>
<li>Users with the highest number of sign-in attempts, categorized by successful and failed attempts</li>
<li>Users with the most failed attempts, with associated IP addresses and client applications</li>
</ul>
<p><img alt="sign-in users" src="https://dt-cdn.net/images/2025-03-26-14-46-19-1359-17c6e4d12e.png" /></p>
<p>Run query</p>
<p>Top 10 sign-in users</p>
<p>Top 10 users by failed sign-in attempts</p>
<p>You can reproduce the <strong>Top 10 sign-in users</strong> chart in <a href="/docs/secure/investigations" title="Combine Grail functionalities for evidence-driven investigations, including incident resolution, root cause analysis, and threat hunting."><img alt="Investigations" src="https://dt-cdn.net/images/security-investigator-256-93f6c187d9.png" title="Investigations" /> <strong>Investigations</strong></a> or <a href="/docs/analyze-explore-automate/dashboards-and-notebooks/notebooks" title="Analyze, visualize, and share insights from your observability data√¢¬Ä¬îall in one collaborative, customizable workspace."><img alt="Notebooks" src="https://dt-cdn.net/images/notebooks-768-046137830a.webp" title="Notebooks" /> <strong>Notebooks</strong></a> with the following DQL snippet:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-55-1" name="__codelineno-55-1" href="#__codelineno-55-1"></a>fetch logs
<a id="__codelineno-55-2" name="__codelineno-55-2" href="#__codelineno-55-2"></a>
<a id="__codelineno-55-3" name="__codelineno-55-3" href="#__codelineno-55-3"></a>
<a id="__codelineno-55-4" name="__codelineno-55-4" href="#__codelineno-55-4"></a>
<a id="__codelineno-55-5" name="__codelineno-55-5" href="#__codelineno-55-5"></a>| filter isNotNull(audit.action) and isNotNull(authentication.is_multifactor)
<a id="__codelineno-55-6" name="__codelineno-55-6" href="#__codelineno-55-6"></a>
<a id="__codelineno-55-7" name="__codelineno-55-7" href="#__codelineno-55-7"></a>
<a id="__codelineno-55-8" name="__codelineno-55-8" href="#__codelineno-55-8"></a>
<a id="__codelineno-55-9" name="__codelineno-55-9" href="#__codelineno-55-9"></a>| summarize {
<a id="__codelineno-55-10" name="__codelineno-55-10" href="#__codelineno-55-10"></a>
<a id="__codelineno-55-11" name="__codelineno-55-11" href="#__codelineno-55-11"></a>
<a id="__codelineno-55-12" name="__codelineno-55-12" href="#__codelineno-55-12"></a>
<a id="__codelineno-55-13" name="__codelineno-55-13" href="#__codelineno-55-13"></a>Success = countIf(audit.result==&quot;Succeeded&quot; or isNull(result.code)),
<a id="__codelineno-55-14" name="__codelineno-55-14" href="#__codelineno-55-14"></a>
<a id="__codelineno-55-15" name="__codelineno-55-15" href="#__codelineno-55-15"></a>
<a id="__codelineno-55-16" name="__codelineno-55-16" href="#__codelineno-55-16"></a>
<a id="__codelineno-55-17" name="__codelineno-55-17" href="#__codelineno-55-17"></a>Failure = countIf(audit.result!=&quot;Succeeded&quot;, by:{User=audit.identity
<a id="__codelineno-55-18" name="__codelineno-55-18" href="#__codelineno-55-18"></a>
<a id="__codelineno-55-19" name="__codelineno-55-19" href="#__codelineno-55-19"></a>
<a id="__codelineno-55-20" name="__codelineno-55-20" href="#__codelineno-55-20"></a>
<a id="__codelineno-55-21" name="__codelineno-55-21" href="#__codelineno-55-21"></a>}
<a id="__codelineno-55-22" name="__codelineno-55-22" href="#__codelineno-55-22"></a>
<a id="__codelineno-55-23" name="__codelineno-55-23" href="#__codelineno-55-23"></a>
<a id="__codelineno-55-24" name="__codelineno-55-24" href="#__codelineno-55-24"></a>
<a id="__codelineno-55-25" name="__codelineno-55-25" href="#__codelineno-55-25"></a>| sort Success+Failure desc
<a id="__codelineno-55-26" name="__codelineno-55-26" href="#__codelineno-55-26"></a>
<a id="__codelineno-55-27" name="__codelineno-55-27" href="#__codelineno-55-27"></a>
<a id="__codelineno-55-28" name="__codelineno-55-28" href="#__codelineno-55-28"></a>
<a id="__codelineno-55-29" name="__codelineno-55-29" href="#__codelineno-55-29"></a>| limit 10
</code></pre></div>
<p>You can reproduce the <strong>Top 10 users by failed sign-in attempts</strong> table in <a href="/docs/secure/investigations" title="Combine Grail functionalities for evidence-driven investigations, including incident resolution, root cause analysis, and threat hunting."><img alt="Investigations" src="https://dt-cdn.net/images/security-investigator-256-93f6c187d9.png" title="Investigations" /> <strong>Investigations</strong></a> or <a href="/docs/analyze-explore-automate/dashboards-and-notebooks/notebooks" title="Analyze, visualize, and share insights from your observability data√¢¬Ä¬îall in one collaborative, customizable workspace."><img alt="Notebooks" src="https://dt-cdn.net/images/notebooks-768-046137830a.webp" title="Notebooks" /> <strong>Notebooks</strong></a> with the following DQL snippet:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-56-1" name="__codelineno-56-1" href="#__codelineno-56-1"></a>fetch logs
<a id="__codelineno-56-2" name="__codelineno-56-2" href="#__codelineno-56-2"></a>
<a id="__codelineno-56-3" name="__codelineno-56-3" href="#__codelineno-56-3"></a>
<a id="__codelineno-56-4" name="__codelineno-56-4" href="#__codelineno-56-4"></a>
<a id="__codelineno-56-5" name="__codelineno-56-5" href="#__codelineno-56-5"></a>| filter isNotNull(audit.action) and isNotNull(authentication.is_multifactor)
<a id="__codelineno-56-6" name="__codelineno-56-6" href="#__codelineno-56-6"></a>
<a id="__codelineno-56-7" name="__codelineno-56-7" href="#__codelineno-56-7"></a>
<a id="__codelineno-56-8" name="__codelineno-56-8" href="#__codelineno-56-8"></a>
<a id="__codelineno-56-9" name="__codelineno-56-9" href="#__codelineno-56-9"></a>and audit.result!=&quot;Succeeded&quot;
<a id="__codelineno-56-10" name="__codelineno-56-10" href="#__codelineno-56-10"></a>
<a id="__codelineno-56-11" name="__codelineno-56-11" href="#__codelineno-56-11"></a>
<a id="__codelineno-56-12" name="__codelineno-56-12" href="#__codelineno-56-12"></a>
<a id="__codelineno-56-13" name="__codelineno-56-13" href="#__codelineno-56-13"></a>| summarize {
<a id="__codelineno-56-14" name="__codelineno-56-14" href="#__codelineno-56-14"></a>
<a id="__codelineno-56-15" name="__codelineno-56-15" href="#__codelineno-56-15"></a>
<a id="__codelineno-56-16" name="__codelineno-56-16" href="#__codelineno-56-16"></a>
<a id="__codelineno-56-17" name="__codelineno-56-17" href="#__codelineno-56-17"></a>Failures = count(),
<a id="__codelineno-56-18" name="__codelineno-56-18" href="#__codelineno-56-18"></a>
<a id="__codelineno-56-19" name="__codelineno-56-19" href="#__codelineno-56-19"></a>
<a id="__codelineno-56-20" name="__codelineno-56-20" href="#__codelineno-56-20"></a>
<a id="__codelineno-56-21" name="__codelineno-56-21" href="#__codelineno-56-21"></a>`Client applications` = collectDistinct(client.app.name),
<a id="__codelineno-56-22" name="__codelineno-56-22" href="#__codelineno-56-22"></a>
<a id="__codelineno-56-23" name="__codelineno-56-23" href="#__codelineno-56-23"></a>
<a id="__codelineno-56-24" name="__codelineno-56-24" href="#__codelineno-56-24"></a>
<a id="__codelineno-56-25" name="__codelineno-56-25" href="#__codelineno-56-25"></a>`IPs` = collectDistinct(client.ip)
<a id="__codelineno-56-26" name="__codelineno-56-26" href="#__codelineno-56-26"></a>
<a id="__codelineno-56-27" name="__codelineno-56-27" href="#__codelineno-56-27"></a>
<a id="__codelineno-56-28" name="__codelineno-56-28" href="#__codelineno-56-28"></a>
<a id="__codelineno-56-29" name="__codelineno-56-29" href="#__codelineno-56-29"></a>}, by:{User=audit.identity}
<a id="__codelineno-56-30" name="__codelineno-56-30" href="#__codelineno-56-30"></a>
<a id="__codelineno-56-31" name="__codelineno-56-31" href="#__codelineno-56-31"></a>
<a id="__codelineno-56-32" name="__codelineno-56-32" href="#__codelineno-56-32"></a>
<a id="__codelineno-56-33" name="__codelineno-56-33" href="#__codelineno-56-33"></a>| sort Failures desc
<a id="__codelineno-56-34" name="__codelineno-56-34" href="#__codelineno-56-34"></a>
<a id="__codelineno-56-35" name="__codelineno-56-35" href="#__codelineno-56-35"></a>
<a id="__codelineno-56-36" name="__codelineno-56-36" href="#__codelineno-56-36"></a>
<a id="__codelineno-56-37" name="__codelineno-56-37" href="#__codelineno-56-37"></a>| limit 10
</code></pre></div>
<p><strong>Example 2</strong>: In <strong>Top 10 sign-in IPs</strong>, you can</p>
<ul>
<li>Uncover unusual patterns which may indicate malicious activity, such as repeated failed attempts from a single IP or multiple users accessing from the same IP</li>
<li>View rankings of IP addresses with the most sign-in attempts, along with those linked to multiple users or services</li>
</ul>
<p><img alt="sign-in-ip" src="https://dt-cdn.net/images/2025-03-26-17-26-56-1644-34f2135bb6.png" /></p>
<p>Run query</p>
<p>Top 10 sign-in IPs</p>
<p>Top 10 addresses by failed sign-in attempts</p>
<p>You can reproduce the <strong>Top 10 sign-in IPs</strong> chart in <a href="/docs/secure/investigations" title="Combine Grail functionalities for evidence-driven investigations, including incident resolution, root cause analysis, and threat hunting."><img alt="Investigations" src="https://dt-cdn.net/images/security-investigator-256-93f6c187d9.png" title="Investigations" /> <strong>Investigations</strong></a> or <a href="/docs/analyze-explore-automate/dashboards-and-notebooks/notebooks" title="Analyze, visualize, and share insights from your observability data√¢¬Ä¬îall in one collaborative, customizable workspace."><img alt="Notebooks" src="https://dt-cdn.net/images/notebooks-768-046137830a.webp" title="Notebooks" /> <strong>Notebooks</strong></a> with the following DQL snippet:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-57-1" name="__codelineno-57-1" href="#__codelineno-57-1"></a>fetch logs
<a id="__codelineno-57-2" name="__codelineno-57-2" href="#__codelineno-57-2"></a>
<a id="__codelineno-57-3" name="__codelineno-57-3" href="#__codelineno-57-3"></a>
<a id="__codelineno-57-4" name="__codelineno-57-4" href="#__codelineno-57-4"></a>
<a id="__codelineno-57-5" name="__codelineno-57-5" href="#__codelineno-57-5"></a>| filter isNotNull(audit.action) and isNotNull(authentication.is_multifactor)
<a id="__codelineno-57-6" name="__codelineno-57-6" href="#__codelineno-57-6"></a>
<a id="__codelineno-57-7" name="__codelineno-57-7" href="#__codelineno-57-7"></a>
<a id="__codelineno-57-8" name="__codelineno-57-8" href="#__codelineno-57-8"></a>
<a id="__codelineno-57-9" name="__codelineno-57-9" href="#__codelineno-57-9"></a>| summarize {
<a id="__codelineno-57-10" name="__codelineno-57-10" href="#__codelineno-57-10"></a>
<a id="__codelineno-57-11" name="__codelineno-57-11" href="#__codelineno-57-11"></a>
<a id="__codelineno-57-12" name="__codelineno-57-12" href="#__codelineno-57-12"></a>
<a id="__codelineno-57-13" name="__codelineno-57-13" href="#__codelineno-57-13"></a>Success = countIf(audit.result==&quot;Succeeded&quot; or isNull(result.code)),
<a id="__codelineno-57-14" name="__codelineno-57-14" href="#__codelineno-57-14"></a>
<a id="__codelineno-57-15" name="__codelineno-57-15" href="#__codelineno-57-15"></a>
<a id="__codelineno-57-16" name="__codelineno-57-16" href="#__codelineno-57-16"></a>
<a id="__codelineno-57-17" name="__codelineno-57-17" href="#__codelineno-57-17"></a>Failure = countIf(audit.result!=&quot;Succeeded&quot;)
<a id="__codelineno-57-18" name="__codelineno-57-18" href="#__codelineno-57-18"></a>
<a id="__codelineno-57-19" name="__codelineno-57-19" href="#__codelineno-57-19"></a>
<a id="__codelineno-57-20" name="__codelineno-57-20" href="#__codelineno-57-20"></a>
<a id="__codelineno-57-21" name="__codelineno-57-21" href="#__codelineno-57-21"></a>}, by:{IP=client.ip}
<a id="__codelineno-57-22" name="__codelineno-57-22" href="#__codelineno-57-22"></a>
<a id="__codelineno-57-23" name="__codelineno-57-23" href="#__codelineno-57-23"></a>
<a id="__codelineno-57-24" name="__codelineno-57-24" href="#__codelineno-57-24"></a>
<a id="__codelineno-57-25" name="__codelineno-57-25" href="#__codelineno-57-25"></a>| sort Success+Failure desc
<a id="__codelineno-57-26" name="__codelineno-57-26" href="#__codelineno-57-26"></a>
<a id="__codelineno-57-27" name="__codelineno-57-27" href="#__codelineno-57-27"></a>
<a id="__codelineno-57-28" name="__codelineno-57-28" href="#__codelineno-57-28"></a>
<a id="__codelineno-57-29" name="__codelineno-57-29" href="#__codelineno-57-29"></a>| limit 10
</code></pre></div>
<p>You can reproduce the <strong>Top 10 addresses by failed sign-in attempts</strong> table in <a href="/docs/secure/investigations" title="Combine Grail functionalities for evidence-driven investigations, including incident resolution, root cause analysis, and threat hunting."><img alt="Investigations" src="https://dt-cdn.net/images/security-investigator-256-93f6c187d9.png" title="Investigations" /> <strong>Investigations</strong></a> or <a href="/docs/analyze-explore-automate/dashboards-and-notebooks/notebooks" title="Analyze, visualize, and share insights from your observability data√¢¬Ä¬îall in one collaborative, customizable workspace."><img alt="Notebooks" src="https://dt-cdn.net/images/notebooks-768-046137830a.webp" title="Notebooks" /> <strong>Notebooks</strong></a> with the following DQL snippet:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-58-1" name="__codelineno-58-1" href="#__codelineno-58-1"></a>fetch logs
<a id="__codelineno-58-2" name="__codelineno-58-2" href="#__codelineno-58-2"></a>
<a id="__codelineno-58-3" name="__codelineno-58-3" href="#__codelineno-58-3"></a>
<a id="__codelineno-58-4" name="__codelineno-58-4" href="#__codelineno-58-4"></a>
<a id="__codelineno-58-5" name="__codelineno-58-5" href="#__codelineno-58-5"></a>| filter isNotNull(audit.action) and isNotNull(authentication.is_multifactor)
<a id="__codelineno-58-6" name="__codelineno-58-6" href="#__codelineno-58-6"></a>
<a id="__codelineno-58-7" name="__codelineno-58-7" href="#__codelineno-58-7"></a>
<a id="__codelineno-58-8" name="__codelineno-58-8" href="#__codelineno-58-8"></a>
<a id="__codelineno-58-9" name="__codelineno-58-9" href="#__codelineno-58-9"></a>and audit.result!=&quot;Succeeded&quot;
<a id="__codelineno-58-10" name="__codelineno-58-10" href="#__codelineno-58-10"></a>
<a id="__codelineno-58-11" name="__codelineno-58-11" href="#__codelineno-58-11"></a>
<a id="__codelineno-58-12" name="__codelineno-58-12" href="#__codelineno-58-12"></a>
<a id="__codelineno-58-13" name="__codelineno-58-13" href="#__codelineno-58-13"></a>| summarize {
<a id="__codelineno-58-14" name="__codelineno-58-14" href="#__codelineno-58-14"></a>
<a id="__codelineno-58-15" name="__codelineno-58-15" href="#__codelineno-58-15"></a>
<a id="__codelineno-58-16" name="__codelineno-58-16" href="#__codelineno-58-16"></a>
<a id="__codelineno-58-17" name="__codelineno-58-17" href="#__codelineno-58-17"></a>Failures = count(), Users = collectDistinct(audit.identity),
<a id="__codelineno-58-18" name="__codelineno-58-18" href="#__codelineno-58-18"></a>
<a id="__codelineno-58-19" name="__codelineno-58-19" href="#__codelineno-58-19"></a>
<a id="__codelineno-58-20" name="__codelineno-58-20" href="#__codelineno-58-20"></a>
<a id="__codelineno-58-21" name="__codelineno-58-21" href="#__codelineno-58-21"></a>`Target services` = collectDistinct(client.app.name)
<a id="__codelineno-58-22" name="__codelineno-58-22" href="#__codelineno-58-22"></a>
<a id="__codelineno-58-23" name="__codelineno-58-23" href="#__codelineno-58-23"></a>
<a id="__codelineno-58-24" name="__codelineno-58-24" href="#__codelineno-58-24"></a>
<a id="__codelineno-58-25" name="__codelineno-58-25" href="#__codelineno-58-25"></a>}, by:{`Client IP`=client.ip, City=actor.geo.city.name}
<a id="__codelineno-58-26" name="__codelineno-58-26" href="#__codelineno-58-26"></a>
<a id="__codelineno-58-27" name="__codelineno-58-27" href="#__codelineno-58-27"></a>
<a id="__codelineno-58-28" name="__codelineno-58-28" href="#__codelineno-58-28"></a>
<a id="__codelineno-58-29" name="__codelineno-58-29" href="#__codelineno-58-29"></a>| sort Failures desc
<a id="__codelineno-58-30" name="__codelineno-58-30" href="#__codelineno-58-30"></a>
<a id="__codelineno-58-31" name="__codelineno-58-31" href="#__codelineno-58-31"></a>
<a id="__codelineno-58-32" name="__codelineno-58-32" href="#__codelineno-58-32"></a>
<a id="__codelineno-58-33" name="__codelineno-58-33" href="#__codelineno-58-33"></a>| limit 10
</code></pre></div>
<ol>
<li>Analyze data</li>
</ol>
<p>Dynatrace Intelligence automatically identifies anomalous trends and deviations in sign-in logs, significantly enhancing your organization's ability to detect potential threats swiftly. Dynatrace Intelligence continuously analyzes user sign-in patterns, providing proactive alerts when anomalies are detected.</p>
<p>To detect anomalous peaks within the observed sign-in logs with Davis</p>
<ol>
<li>Select any of the time-based charts, then select <strong>Open with</strong>.</li>
</ol>
<p><img alt="davis02" src="https://dt-cdn.net/images/sssssss-1102-25711b87e5.png" />
2. Select <strong>Notebooks</strong>.
3. In the notebook document that opens, select <strong>Options</strong>.
4. In the <strong>Options</strong> panel, select <strong>Analyze and alert</strong> and activate the analyzer.
5. Select an analyzer and configure its parameters.
6. Select <strong>Run analysis</strong>.</p>
<p>For example, you can select an auto-adaptive threshold to apply a dynamic approach based on the past sign-in trends.</p>
<p><img alt="An example of AI data analysis in the Notebooks app." src="https://dt-cdn.net/images/2025-03-27-12-52-08-1920-d8b53c4e4a-1444-3573714c33.png" /></p>
<h2 id="summary_1">Summary<a class="headerlink" href="#summary_1" title="Permanent link">&para;</a></h2>
<p>Monitoring sign-in activities in cloud environments is essential for detecting anomalies, protecting critical resources, and ensuring compliance. Integrating sign-in logs into the Dynatrace platform centralizes visibility into user access patterns. By analyzing metrics like top users, IP addresses, client applications, and locations, security teams can swiftly identify suspicious behavior and address potential threats. The dashboard√¢¬Ä¬ôs filtering options allow targeted investigations, enhancing threat detection and accelerating incident response.</p>
<hr />
<h2 id="source-notification-automationmd">Source: notification-automation.md<a class="headerlink" href="#source-notification-automationmd" title="Permanent link">&para;</a></h2>
<hr />
<p>title: CSPM Notification Automation
source: https://www.dynatrace.com/docs/secure/use-cases/notification-automation
scraped: 2026-02-16T21:21:53.475448</p>
<hr />
<h1 id="cspm-notification-automation">CSPM Notification Automation<a class="headerlink" href="#cspm-notification-automation" title="Permanent link">&para;</a></h1>
<h1 id="cspm-notification-automation_1">CSPM Notification Automation<a class="headerlink" href="#cspm-notification-automation_1" title="Permanent link">&para;</a></h1>
<ul>
<li>Latest Dynatrace</li>
<li>Tutorial</li>
<li>Updated on Jan 31, 2024</li>
</ul>
<p>Early Adopter</p>
<p>Hyperscalers provide offerings such as <a href="https://dt-url.net/5l239zz">AWS Security Hub√Ø¬ª¬ø</a>, through which security-related events give insights into potential threats. These events must be triaged, analyzed, and remediated by the owners of the affected resources, and reaching hundreds of thousands of such alerts is common.</p>
<ul>
<li>The volume of these events currently means that not all can get the attention they deserve.</li>
<li>Because ownership of resources is distributed, significant coordination and administrative effort is required to ensure that all events are acted upon.</li>
</ul>
<p>Dynatrace addresses these concerns and improves your cloud security posture management (CSPM) by introducing an automation workflow that filters security findings stored in Grail and triggers alerts only for the events that matter.</p>
<h2 id="target-audience_10">Target audience<a class="headerlink" href="#target-audience_10" title="Permanent link">&para;</a></h2>
<p>This page is intended for Security teams analyzing security findings.</p>
<h2 id="scenario_4">Scenario<a class="headerlink" href="#scenario_4" title="Permanent link">&para;</a></h2>
<p>In the following, we address a scenario in which 400,000 AWS alerts are issued daily.</p>
<p>Manually dealing with all of them is simply infeasible. The Security team therefore has to focus only on high-priority events and has built custom tooling to partially automate Jira ticket creation.</p>
<ul>
<li>Within a year, nearly 1,100 security tickets have been manually created from those events.</li>
<li>Investigating those tickets has involved about 300 people gathering additional information to analyze the situation.</li>
</ul>
<p>Effort is sometimes invested in vain, and alerts turn out to be irrelevant, but the resource owner must always cross-check the resolution with the Security team. Ensuring that all are followed up on requires a significant coordination effort, leaving less time for actual security work.</p>
<h3 id="request_1">Request<a class="headerlink" href="#request_1" title="Permanent link">&para;</a></h3>
<ul>
<li>The team wants to be able to explore all data but receive notifications (tickets) only for critical or high events and only for certain relevant AWS accounts.</li>
<li>Notifications should include the alert type, full context, relevant details, and remediation advice to enable understanding, actionability, and operationalization.</li>
<li>Only the account owner should be informed of the issue (tickets should be automatically assigned to him).</li>
<li>The team doesn't want to be spammed with multiple notifications for the same issue, so there shouldn't be any duplicate tickets.</li>
</ul>
<h3 id="goal">Goal<a class="headerlink" href="#goal" title="Permanent link">&para;</a></h3>
<p><strong>Efficiency</strong>: The team should be able to act on everything that matters immediately.</p>
<h3 id="result_1">Result<a class="headerlink" href="#result_1" title="Permanent link">&para;</a></h3>
<p><strong>Dynatrace CSPM Notification Automation</strong> is a tool designed to answer the Security team's pain and improve their efficiency significantly. It allows the team to continue monitoring events without being burdened with alerts; they can now focus only on what matters and requires their security expertise.</p>
<p>More concretely, from a total of 400,000 alerts per day, of which just 40,000 are relevant, with Dynatrace CSPM Notification Automation, only a couple of Jira tickets are now created daily, just for the relevant issues.</p>
<h2 id="how-it-works_1">How it works<a class="headerlink" href="#how-it-works_1" title="Permanent link">&para;</a></h2>
<p>Dynatrace CSPM Notification Automation consists of two stages.</p>
<ol>
<li>(Prerequisite) AWS security findings from <a href="https://dt-url.net/5l239zz">AWS Security Hub√Ø¬ª¬ø</a>
   are ingested into <a href="/docs/platform/grail" title="Insights on what and how you can query Dynatrace data.">Grail</a> by means of <a href="/docs/analyze-explore-automate/logs/lma-log-ingestion/lma-cloud-provider-log-forwarding#aws-log-forwarding" title="Configure AWS, Azure and Google Cloud log forwarding to stream log data to Dynatrace using API.">Dynatrace log ingestion</a>.</li>
<li>(Actual automation) A predefined <a href="/docs/analyze-explore-automate/workflows" title="Automate IT processes with Dynatrace Workflows√¢¬Ä¬îreact to events, schedule tasks, and connect services.">workflow</a> orchestrates the processes of querying, filtering, and grouping data and converts the resulting findings into Jira tickets for remediation. See <a href="#start">Get started</a> for the workflow steps.</li>
</ol>
<p><img alt="How CSPM automation works" src="https://dt-cdn.net/images/2024-01-31-15-04-14-470-834fcfc1a2.png" /></p>
<h2 id="prerequisites_11">Prerequisites<a class="headerlink" href="#prerequisites_11" title="Permanent link">&para;</a></h2>
<p>See below for the <a href="#aws">AWS</a> and <a href="#dt">Dynatrace</a> requirements.</p>
<h3 id="aws-requirements">AWS requirements<a class="headerlink" href="#aws-requirements" title="Permanent link">&para;</a></h3>
<ul>
<li><a href="https://dt-url.net/ng439wv">Set up AWS accounts√Ø¬ª¬ø</a> for which you want to receive notifications.</li>
<li><a href="https://dt-url.net/uh639rl">Set up AWS Security Hub√Ø¬ª¬ø</a> (collects AWS security findings).</li>
</ul>
<h3 id="dynatrace-requirements">Dynatrace requirements<a class="headerlink" href="#dynatrace-requirements" title="Permanent link">&para;</a></h3>
<ul>
<li>Dynatrace version 1.276+</li>
<li><a href="/docs/analyze-explore-automate/logs/lma-log-ingestion/lma-cloud-provider-log-forwarding#aws-log-forwarding" title="Configure AWS, Azure and Google Cloud log forwarding to stream log data to Dynatrace using API.">Set up log ingestion</a> (ingests AWS security findings into Grail).</li>
<li><a href="/docs/analyze-explore-automate/workflows/actions/jira#setup" title="Automate creating, transitioning, commenting, and assigning Jira issues on the events and schedules defined for your workflows.">Set up Jira Connector</a> (allows the workflow to convert resulting findings into Jira tickets).</li>
<li>
<p>Make sure the following permissions are enabled.</p>
</li>
<li>
<p><strong>Grail</strong>: <code>storage:logs:read</code>. For instructions, see <a href="/docs/platform/grail/organize-data/assign-permissions-in-grail" title="Find out how to assign permissions to buckets and tables in Grail.">Assign permissions in Grail</a>.</p>
</li>
<li>
<p><img alt="Workflows" src="https://dt-cdn.net/images/workflows-1024-b5708f3cf9.webp" title="Workflows" /> <strong>Workflows</strong>: Permissions to access, view, write, and execute workflows. For details, see <a href="/docs/analyze-explore-automate/workflows#authorization" title="Automate IT processes with Dynatrace Workflows√¢¬Ä¬îreact to events, schedule tasks, and connect services.">Authorization</a>.</p>
<p>To access permissions, go to the <strong>Settings</strong> menu in the upper-right corner of <img alt="Workflows" src="https://dt-cdn.net/images/workflows-1024-b5708f3cf9.webp" title="Workflows" /> <strong>Workflows</strong> and select <strong>Authorization settings</strong>.</p>
</li>
</ul>
<h2 id="get-started_9">Get started<a class="headerlink" href="#get-started_9" title="Permanent link">&para;</a></h2>
<p>Once your AWS security findings are ingested into Grail (see <a href="#prerequisites">Prerequisites</a>), you can set up the CSPM Notification Automation workflow.</p>
<p>The workflow consists of several steps you can adapt according to your needs. To configure it, you can start by importing a prefilled workflow into your environment.</p>
<ol>
<li>
<p>Import workflow</p>
</li>
<li>
<p>Copy and save the JSON file below.</p>
</li>
</ol>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-59-1" name="__codelineno-59-1" href="#__codelineno-59-1"></a>{
<a id="__codelineno-59-2" name="__codelineno-59-2" href="#__codelineno-59-2"></a>
<a id="__codelineno-59-3" name="__codelineno-59-3" href="#__codelineno-59-3"></a>
<a id="__codelineno-59-4" name="__codelineno-59-4" href="#__codelineno-59-4"></a>
<a id="__codelineno-59-5" name="__codelineno-59-5" href="#__codelineno-59-5"></a>&quot;id&quot;: &quot;dcce961d-26a9-46e6-a9e4-14a0f7f2185c&quot;,
<a id="__codelineno-59-6" name="__codelineno-59-6" href="#__codelineno-59-6"></a>
<a id="__codelineno-59-7" name="__codelineno-59-7" href="#__codelineno-59-7"></a>
<a id="__codelineno-59-8" name="__codelineno-59-8" href="#__codelineno-59-8"></a>
<a id="__codelineno-59-9" name="__codelineno-59-9" href="#__codelineno-59-9"></a>&quot;title&quot;: &quot;CSPM Notification Automation&quot;,
<a id="__codelineno-59-10" name="__codelineno-59-10" href="#__codelineno-59-10"></a>
<a id="__codelineno-59-11" name="__codelineno-59-11" href="#__codelineno-59-11"></a>
<a id="__codelineno-59-12" name="__codelineno-59-12" href="#__codelineno-59-12"></a>
<a id="__codelineno-59-13" name="__codelineno-59-13" href="#__codelineno-59-13"></a>&quot;description&quot;: &quot;&quot;,
<a id="__codelineno-59-14" name="__codelineno-59-14" href="#__codelineno-59-14"></a>
<a id="__codelineno-59-15" name="__codelineno-59-15" href="#__codelineno-59-15"></a>
<a id="__codelineno-59-16" name="__codelineno-59-16" href="#__codelineno-59-16"></a>
<a id="__codelineno-59-17" name="__codelineno-59-17" href="#__codelineno-59-17"></a>&quot;tasks&quot;: {
<a id="__codelineno-59-18" name="__codelineno-59-18" href="#__codelineno-59-18"></a>
<a id="__codelineno-59-19" name="__codelineno-59-19" href="#__codelineno-59-19"></a>
<a id="__codelineno-59-20" name="__codelineno-59-20" href="#__codelineno-59-20"></a>
<a id="__codelineno-59-21" name="__codelineno-59-21" href="#__codelineno-59-21"></a>&quot;count_all_new_findings&quot;: {
<a id="__codelineno-59-22" name="__codelineno-59-22" href="#__codelineno-59-22"></a>
<a id="__codelineno-59-23" name="__codelineno-59-23" href="#__codelineno-59-23"></a>
<a id="__codelineno-59-24" name="__codelineno-59-24" href="#__codelineno-59-24"></a>
<a id="__codelineno-59-25" name="__codelineno-59-25" href="#__codelineno-59-25"></a>&quot;name&quot;: &quot;count_all_new_findings&quot;,
<a id="__codelineno-59-26" name="__codelineno-59-26" href="#__codelineno-59-26"></a>
<a id="__codelineno-59-27" name="__codelineno-59-27" href="#__codelineno-59-27"></a>
<a id="__codelineno-59-28" name="__codelineno-59-28" href="#__codelineno-59-28"></a>
<a id="__codelineno-59-29" name="__codelineno-59-29" href="#__codelineno-59-29"></a>&quot;description&quot;: &quot;Executes query to count all recently created AWS findings&quot;,
<a id="__codelineno-59-30" name="__codelineno-59-30" href="#__codelineno-59-30"></a>
<a id="__codelineno-59-31" name="__codelineno-59-31" href="#__codelineno-59-31"></a>
<a id="__codelineno-59-32" name="__codelineno-59-32" href="#__codelineno-59-32"></a>
<a id="__codelineno-59-33" name="__codelineno-59-33" href="#__codelineno-59-33"></a>&quot;action&quot;: &quot;dynatrace.automations:execute-dql-query&quot;,
<a id="__codelineno-59-34" name="__codelineno-59-34" href="#__codelineno-59-34"></a>
<a id="__codelineno-59-35" name="__codelineno-59-35" href="#__codelineno-59-35"></a>
<a id="__codelineno-59-36" name="__codelineno-59-36" href="#__codelineno-59-36"></a>
<a id="__codelineno-59-37" name="__codelineno-59-37" href="#__codelineno-59-37"></a>&quot;active&quot;: true,
<a id="__codelineno-59-38" name="__codelineno-59-38" href="#__codelineno-59-38"></a>
<a id="__codelineno-59-39" name="__codelineno-59-39" href="#__codelineno-59-39"></a>
<a id="__codelineno-59-40" name="__codelineno-59-40" href="#__codelineno-59-40"></a>
<a id="__codelineno-59-41" name="__codelineno-59-41" href="#__codelineno-59-41"></a>&quot;input&quot;: {
<a id="__codelineno-59-42" name="__codelineno-59-42" href="#__codelineno-59-42"></a>
<a id="__codelineno-59-43" name="__codelineno-59-43" href="#__codelineno-59-43"></a>
<a id="__codelineno-59-44" name="__codelineno-59-44" href="#__codelineno-59-44"></a>
<a id="__codelineno-59-45" name="__codelineno-59-45" href="#__codelineno-59-45"></a>&quot;query&quot;: &quot;fetch logs, from:now() - 24h, scanLimitGBytes: -1\n| filter aws.log_group == \&quot;/aws/events/AWSSecurityHubLogGroup\&quot;\n| fields timestamp\n| filter timestamp &gt; now() - 24h                                                                        // Only filter created since last successful run         \n| summarize { count=count() }&quot;
<a id="__codelineno-59-46" name="__codelineno-59-46" href="#__codelineno-59-46"></a>
<a id="__codelineno-59-47" name="__codelineno-59-47" href="#__codelineno-59-47"></a>
<a id="__codelineno-59-48" name="__codelineno-59-48" href="#__codelineno-59-48"></a>
<a id="__codelineno-59-49" name="__codelineno-59-49" href="#__codelineno-59-49"></a>},
<a id="__codelineno-59-50" name="__codelineno-59-50" href="#__codelineno-59-50"></a>
<a id="__codelineno-59-51" name="__codelineno-59-51" href="#__codelineno-59-51"></a>
<a id="__codelineno-59-52" name="__codelineno-59-52" href="#__codelineno-59-52"></a>
<a id="__codelineno-59-53" name="__codelineno-59-53" href="#__codelineno-59-53"></a>&quot;position&quot;: {
<a id="__codelineno-59-54" name="__codelineno-59-54" href="#__codelineno-59-54"></a>
<a id="__codelineno-59-55" name="__codelineno-59-55" href="#__codelineno-59-55"></a>
<a id="__codelineno-59-56" name="__codelineno-59-56" href="#__codelineno-59-56"></a>
<a id="__codelineno-59-57" name="__codelineno-59-57" href="#__codelineno-59-57"></a>&quot;x&quot;: -1,
<a id="__codelineno-59-58" name="__codelineno-59-58" href="#__codelineno-59-58"></a>
<a id="__codelineno-59-59" name="__codelineno-59-59" href="#__codelineno-59-59"></a>
<a id="__codelineno-59-60" name="__codelineno-59-60" href="#__codelineno-59-60"></a>
<a id="__codelineno-59-61" name="__codelineno-59-61" href="#__codelineno-59-61"></a>&quot;y&quot;: 2
<a id="__codelineno-59-62" name="__codelineno-59-62" href="#__codelineno-59-62"></a>
<a id="__codelineno-59-63" name="__codelineno-59-63" href="#__codelineno-59-63"></a>
<a id="__codelineno-59-64" name="__codelineno-59-64" href="#__codelineno-59-64"></a>
<a id="__codelineno-59-65" name="__codelineno-59-65" href="#__codelineno-59-65"></a>},
<a id="__codelineno-59-66" name="__codelineno-59-66" href="#__codelineno-59-66"></a>
<a id="__codelineno-59-67" name="__codelineno-59-67" href="#__codelineno-59-67"></a>
<a id="__codelineno-59-68" name="__codelineno-59-68" href="#__codelineno-59-68"></a>
<a id="__codelineno-59-69" name="__codelineno-59-69" href="#__codelineno-59-69"></a>&quot;predecessors&quot;: [
<a id="__codelineno-59-70" name="__codelineno-59-70" href="#__codelineno-59-70"></a>
<a id="__codelineno-59-71" name="__codelineno-59-71" href="#__codelineno-59-71"></a>
<a id="__codelineno-59-72" name="__codelineno-59-72" href="#__codelineno-59-72"></a>
<a id="__codelineno-59-73" name="__codelineno-59-73" href="#__codelineno-59-73"></a>&quot;workflow_config_params&quot;
<a id="__codelineno-59-74" name="__codelineno-59-74" href="#__codelineno-59-74"></a>
<a id="__codelineno-59-75" name="__codelineno-59-75" href="#__codelineno-59-75"></a>
<a id="__codelineno-59-76" name="__codelineno-59-76" href="#__codelineno-59-76"></a>
<a id="__codelineno-59-77" name="__codelineno-59-77" href="#__codelineno-59-77"></a>],
<a id="__codelineno-59-78" name="__codelineno-59-78" href="#__codelineno-59-78"></a>
<a id="__codelineno-59-79" name="__codelineno-59-79" href="#__codelineno-59-79"></a>
<a id="__codelineno-59-80" name="__codelineno-59-80" href="#__codelineno-59-80"></a>
<a id="__codelineno-59-81" name="__codelineno-59-81" href="#__codelineno-59-81"></a>&quot;conditions&quot;: {
<a id="__codelineno-59-82" name="__codelineno-59-82" href="#__codelineno-59-82"></a>
<a id="__codelineno-59-83" name="__codelineno-59-83" href="#__codelineno-59-83"></a>
<a id="__codelineno-59-84" name="__codelineno-59-84" href="#__codelineno-59-84"></a>
<a id="__codelineno-59-85" name="__codelineno-59-85" href="#__codelineno-59-85"></a>&quot;states&quot;: {
<a id="__codelineno-59-86" name="__codelineno-59-86" href="#__codelineno-59-86"></a>
<a id="__codelineno-59-87" name="__codelineno-59-87" href="#__codelineno-59-87"></a>
<a id="__codelineno-59-88" name="__codelineno-59-88" href="#__codelineno-59-88"></a>
<a id="__codelineno-59-89" name="__codelineno-59-89" href="#__codelineno-59-89"></a>&quot;workflow_config_params&quot;: &quot;OK&quot;
<a id="__codelineno-59-90" name="__codelineno-59-90" href="#__codelineno-59-90"></a>
<a id="__codelineno-59-91" name="__codelineno-59-91" href="#__codelineno-59-91"></a>
<a id="__codelineno-59-92" name="__codelineno-59-92" href="#__codelineno-59-92"></a>
<a id="__codelineno-59-93" name="__codelineno-59-93" href="#__codelineno-59-93"></a>}
<a id="__codelineno-59-94" name="__codelineno-59-94" href="#__codelineno-59-94"></a>
<a id="__codelineno-59-95" name="__codelineno-59-95" href="#__codelineno-59-95"></a>
<a id="__codelineno-59-96" name="__codelineno-59-96" href="#__codelineno-59-96"></a>
<a id="__codelineno-59-97" name="__codelineno-59-97" href="#__codelineno-59-97"></a>}
<a id="__codelineno-59-98" name="__codelineno-59-98" href="#__codelineno-59-98"></a>
<a id="__codelineno-59-99" name="__codelineno-59-99" href="#__codelineno-59-99"></a>
<a id="__codelineno-59-100" name="__codelineno-59-100" href="#__codelineno-59-100"></a>
<a id="__codelineno-59-101" name="__codelineno-59-101" href="#__codelineno-59-101"></a>},
<a id="__codelineno-59-102" name="__codelineno-59-102" href="#__codelineno-59-102"></a>
<a id="__codelineno-59-103" name="__codelineno-59-103" href="#__codelineno-59-103"></a>
<a id="__codelineno-59-104" name="__codelineno-59-104" href="#__codelineno-59-104"></a>
<a id="__codelineno-59-105" name="__codelineno-59-105" href="#__codelineno-59-105"></a>&quot;log_new_findings_count&quot;: {
<a id="__codelineno-59-106" name="__codelineno-59-106" href="#__codelineno-59-106"></a>
<a id="__codelineno-59-107" name="__codelineno-59-107" href="#__codelineno-59-107"></a>
<a id="__codelineno-59-108" name="__codelineno-59-108" href="#__codelineno-59-108"></a>
<a id="__codelineno-59-109" name="__codelineno-59-109" href="#__codelineno-59-109"></a>&quot;name&quot;: &quot;log_new_findings_count&quot;,
<a id="__codelineno-59-110" name="__codelineno-59-110" href="#__codelineno-59-110"></a>
<a id="__codelineno-59-111" name="__codelineno-59-111" href="#__codelineno-59-111"></a>
<a id="__codelineno-59-112" name="__codelineno-59-112" href="#__codelineno-59-112"></a>
<a id="__codelineno-59-113" name="__codelineno-59-113" href="#__codelineno-59-113"></a>&quot;description&quot;: &quot;Logs total number of recently created AWS findings&quot;,
<a id="__codelineno-59-114" name="__codelineno-59-114" href="#__codelineno-59-114"></a>
<a id="__codelineno-59-115" name="__codelineno-59-115" href="#__codelineno-59-115"></a>
<a id="__codelineno-59-116" name="__codelineno-59-116" href="#__codelineno-59-116"></a>
<a id="__codelineno-59-117" name="__codelineno-59-117" href="#__codelineno-59-117"></a>&quot;action&quot;: &quot;dynatrace.automations:run-javascript&quot;,
<a id="__codelineno-59-118" name="__codelineno-59-118" href="#__codelineno-59-118"></a>
<a id="__codelineno-59-119" name="__codelineno-59-119" href="#__codelineno-59-119"></a>
<a id="__codelineno-59-120" name="__codelineno-59-120" href="#__codelineno-59-120"></a>
<a id="__codelineno-59-121" name="__codelineno-59-121" href="#__codelineno-59-121"></a>&quot;active&quot;: true,
<a id="__codelineno-59-122" name="__codelineno-59-122" href="#__codelineno-59-122"></a>
<a id="__codelineno-59-123" name="__codelineno-59-123" href="#__codelineno-59-123"></a>
<a id="__codelineno-59-124" name="__codelineno-59-124" href="#__codelineno-59-124"></a>
<a id="__codelineno-59-125" name="__codelineno-59-125" href="#__codelineno-59-125"></a>&quot;input&quot;: {
<a id="__codelineno-59-126" name="__codelineno-59-126" href="#__codelineno-59-126"></a>
<a id="__codelineno-59-127" name="__codelineno-59-127" href="#__codelineno-59-127"></a>
<a id="__codelineno-59-128" name="__codelineno-59-128" href="#__codelineno-59-128"></a>
<a id="__codelineno-59-129" name="__codelineno-59-129" href="#__codelineno-59-129"></a>&quot;script&quot;: &quot;import { execution } from &#39;@dynatrace-sdk/automation-utils&#39;;\n\nexport default async function ({ executionId }) {\n\n  const ex = await execution(executionId);\n  const countResult = await ex.result(\&quot;count_all_new_findings\&quot;);\n\n  console.log(&#39;======================================================================&#39;)\n  console.log(&#39;Total findings added since last run: &#39;)\n  console.log(countResult.records[0].count)\n  console.log(&#39;&#39;)\n}&quot;
<a id="__codelineno-59-130" name="__codelineno-59-130" href="#__codelineno-59-130"></a>
<a id="__codelineno-59-131" name="__codelineno-59-131" href="#__codelineno-59-131"></a>
<a id="__codelineno-59-132" name="__codelineno-59-132" href="#__codelineno-59-132"></a>
<a id="__codelineno-59-133" name="__codelineno-59-133" href="#__codelineno-59-133"></a>},
<a id="__codelineno-59-134" name="__codelineno-59-134" href="#__codelineno-59-134"></a>
<a id="__codelineno-59-135" name="__codelineno-59-135" href="#__codelineno-59-135"></a>
<a id="__codelineno-59-136" name="__codelineno-59-136" href="#__codelineno-59-136"></a>
<a id="__codelineno-59-137" name="__codelineno-59-137" href="#__codelineno-59-137"></a>&quot;position&quot;: {
<a id="__codelineno-59-138" name="__codelineno-59-138" href="#__codelineno-59-138"></a>
<a id="__codelineno-59-139" name="__codelineno-59-139" href="#__codelineno-59-139"></a>
<a id="__codelineno-59-140" name="__codelineno-59-140" href="#__codelineno-59-140"></a>
<a id="__codelineno-59-141" name="__codelineno-59-141" href="#__codelineno-59-141"></a>&quot;x&quot;: -1,
<a id="__codelineno-59-142" name="__codelineno-59-142" href="#__codelineno-59-142"></a>
<a id="__codelineno-59-143" name="__codelineno-59-143" href="#__codelineno-59-143"></a>
<a id="__codelineno-59-144" name="__codelineno-59-144" href="#__codelineno-59-144"></a>
<a id="__codelineno-59-145" name="__codelineno-59-145" href="#__codelineno-59-145"></a>&quot;y&quot;: 3
<a id="__codelineno-59-146" name="__codelineno-59-146" href="#__codelineno-59-146"></a>
<a id="__codelineno-59-147" name="__codelineno-59-147" href="#__codelineno-59-147"></a>
<a id="__codelineno-59-148" name="__codelineno-59-148" href="#__codelineno-59-148"></a>
<a id="__codelineno-59-149" name="__codelineno-59-149" href="#__codelineno-59-149"></a>},
<a id="__codelineno-59-150" name="__codelineno-59-150" href="#__codelineno-59-150"></a>
<a id="__codelineno-59-151" name="__codelineno-59-151" href="#__codelineno-59-151"></a>
<a id="__codelineno-59-152" name="__codelineno-59-152" href="#__codelineno-59-152"></a>
<a id="__codelineno-59-153" name="__codelineno-59-153" href="#__codelineno-59-153"></a>&quot;predecessors&quot;: [
<a id="__codelineno-59-154" name="__codelineno-59-154" href="#__codelineno-59-154"></a>
<a id="__codelineno-59-155" name="__codelineno-59-155" href="#__codelineno-59-155"></a>
<a id="__codelineno-59-156" name="__codelineno-59-156" href="#__codelineno-59-156"></a>
<a id="__codelineno-59-157" name="__codelineno-59-157" href="#__codelineno-59-157"></a>&quot;count_all_new_findings&quot;
<a id="__codelineno-59-158" name="__codelineno-59-158" href="#__codelineno-59-158"></a>
<a id="__codelineno-59-159" name="__codelineno-59-159" href="#__codelineno-59-159"></a>
<a id="__codelineno-59-160" name="__codelineno-59-160" href="#__codelineno-59-160"></a>
<a id="__codelineno-59-161" name="__codelineno-59-161" href="#__codelineno-59-161"></a>],
<a id="__codelineno-59-162" name="__codelineno-59-162" href="#__codelineno-59-162"></a>
<a id="__codelineno-59-163" name="__codelineno-59-163" href="#__codelineno-59-163"></a>
<a id="__codelineno-59-164" name="__codelineno-59-164" href="#__codelineno-59-164"></a>
<a id="__codelineno-59-165" name="__codelineno-59-165" href="#__codelineno-59-165"></a>&quot;conditions&quot;: {
<a id="__codelineno-59-166" name="__codelineno-59-166" href="#__codelineno-59-166"></a>
<a id="__codelineno-59-167" name="__codelineno-59-167" href="#__codelineno-59-167"></a>
<a id="__codelineno-59-168" name="__codelineno-59-168" href="#__codelineno-59-168"></a>
<a id="__codelineno-59-169" name="__codelineno-59-169" href="#__codelineno-59-169"></a>&quot;states&quot;: {
<a id="__codelineno-59-170" name="__codelineno-59-170" href="#__codelineno-59-170"></a>
<a id="__codelineno-59-171" name="__codelineno-59-171" href="#__codelineno-59-171"></a>
<a id="__codelineno-59-172" name="__codelineno-59-172" href="#__codelineno-59-172"></a>
<a id="__codelineno-59-173" name="__codelineno-59-173" href="#__codelineno-59-173"></a>&quot;count_all_new_findings&quot;: &quot;OK&quot;
<a id="__codelineno-59-174" name="__codelineno-59-174" href="#__codelineno-59-174"></a>
<a id="__codelineno-59-175" name="__codelineno-59-175" href="#__codelineno-59-175"></a>
<a id="__codelineno-59-176" name="__codelineno-59-176" href="#__codelineno-59-176"></a>
<a id="__codelineno-59-177" name="__codelineno-59-177" href="#__codelineno-59-177"></a>}
<a id="__codelineno-59-178" name="__codelineno-59-178" href="#__codelineno-59-178"></a>
<a id="__codelineno-59-179" name="__codelineno-59-179" href="#__codelineno-59-179"></a>
<a id="__codelineno-59-180" name="__codelineno-59-180" href="#__codelineno-59-180"></a>
<a id="__codelineno-59-181" name="__codelineno-59-181" href="#__codelineno-59-181"></a>}
<a id="__codelineno-59-182" name="__codelineno-59-182" href="#__codelineno-59-182"></a>
<a id="__codelineno-59-183" name="__codelineno-59-183" href="#__codelineno-59-183"></a>
<a id="__codelineno-59-184" name="__codelineno-59-184" href="#__codelineno-59-184"></a>
<a id="__codelineno-59-185" name="__codelineno-59-185" href="#__codelineno-59-185"></a>},
<a id="__codelineno-59-186" name="__codelineno-59-186" href="#__codelineno-59-186"></a>
<a id="__codelineno-59-187" name="__codelineno-59-187" href="#__codelineno-59-187"></a>
<a id="__codelineno-59-188" name="__codelineno-59-188" href="#__codelineno-59-188"></a>
<a id="__codelineno-59-189" name="__codelineno-59-189" href="#__codelineno-59-189"></a>&quot;log_tickets_by_account&quot;: {
<a id="__codelineno-59-190" name="__codelineno-59-190" href="#__codelineno-59-190"></a>
<a id="__codelineno-59-191" name="__codelineno-59-191" href="#__codelineno-59-191"></a>
<a id="__codelineno-59-192" name="__codelineno-59-192" href="#__codelineno-59-192"></a>
<a id="__codelineno-59-193" name="__codelineno-59-193" href="#__codelineno-59-193"></a>&quot;name&quot;: &quot;log_tickets_by_account&quot;,
<a id="__codelineno-59-194" name="__codelineno-59-194" href="#__codelineno-59-194"></a>
<a id="__codelineno-59-195" name="__codelineno-59-195" href="#__codelineno-59-195"></a>
<a id="__codelineno-59-196" name="__codelineno-59-196" href="#__codelineno-59-196"></a>
<a id="__codelineno-59-197" name="__codelineno-59-197" href="#__codelineno-59-197"></a>&quot;description&quot;: &quot;Logs potentially created Jira issues for findings by account&quot;,
<a id="__codelineno-59-198" name="__codelineno-59-198" href="#__codelineno-59-198"></a>
<a id="__codelineno-59-199" name="__codelineno-59-199" href="#__codelineno-59-199"></a>
<a id="__codelineno-59-200" name="__codelineno-59-200" href="#__codelineno-59-200"></a>
<a id="__codelineno-59-201" name="__codelineno-59-201" href="#__codelineno-59-201"></a>&quot;action&quot;: &quot;dynatrace.automations:run-javascript&quot;,
<a id="__codelineno-59-202" name="__codelineno-59-202" href="#__codelineno-59-202"></a>
<a id="__codelineno-59-203" name="__codelineno-59-203" href="#__codelineno-59-203"></a>
<a id="__codelineno-59-204" name="__codelineno-59-204" href="#__codelineno-59-204"></a>
<a id="__codelineno-59-205" name="__codelineno-59-205" href="#__codelineno-59-205"></a>&quot;active&quot;: true,
<a id="__codelineno-59-206" name="__codelineno-59-206" href="#__codelineno-59-206"></a>
<a id="__codelineno-59-207" name="__codelineno-59-207" href="#__codelineno-59-207"></a>
<a id="__codelineno-59-208" name="__codelineno-59-208" href="#__codelineno-59-208"></a>
<a id="__codelineno-59-209" name="__codelineno-59-209" href="#__codelineno-59-209"></a>&quot;input&quot;: {
<a id="__codelineno-59-210" name="__codelineno-59-210" href="#__codelineno-59-210"></a>
<a id="__codelineno-59-211" name="__codelineno-59-211" href="#__codelineno-59-211"></a>
<a id="__codelineno-59-212" name="__codelineno-59-212" href="#__codelineno-59-212"></a>
<a id="__codelineno-59-213" name="__codelineno-59-213" href="#__codelineno-59-213"></a>&quot;script&quot;: &quot;import { execution } from &#39;@dynatrace-sdk/automation-utils&#39;;\n\nexport default async function ({ executionId }) {\n  const ex = await execution(executionId);\n  const by_control_id = await ex.result(\&quot;fetch_findings_by_account\&quot;);\n\n  console.log(&#39;=================================================================================================&#39;)\n  console.log(`Issues by accounts, ${by_control_id.records.length} findings`)\n  console.log(&#39;=================================================================================================&#39;)\n\n  for(let finding of by_control_id.records) {\n    console.log(&#39;&#39;)\n    console.log(&#39;=================================================================================================&#39;)\n    console.log(`Automatic Vulnerability Report for ${finding.controlId} - AWS account ${finding.awsAccountId}`)\n    console.log(&#39;=================================================================================================&#39;)\n    console.log(&#39;&#39;)\n    console.log(&#39;The following vulnerabilities were reported for your account via AWS Security Hub.&#39;)\n    console.log(&#39;&#39;)\n    console.log(`AWS Account: ${finding.awsAccountId}`)\n    console.log(&#39;&#39;)\n    console.log(&#39;Vulnerability:&#39;)\n    console.log(`${finding.controlId} - ${finding.title}`)\n    console.log(finding.severity)\n    console.log(finding.description)\n    console.log(finding.remediation[0].Recommendation.Url)\n    console.log(&#39;&#39;)\n    console.log(&#39;Affected resources:&#39;)\n    for(let resource of finding.resources) {\n      console.log(resource)\n    }\n    console.log(&#39;&#39;)          \n    console.log(&#39;=================================================================================================&#39;)\n    console.log(&#39;&#39;)\n    console.log(&#39;&#39;)\n  }\n  \n  return by_control_id.records;\n}&quot;
<a id="__codelineno-59-214" name="__codelineno-59-214" href="#__codelineno-59-214"></a>
<a id="__codelineno-59-215" name="__codelineno-59-215" href="#__codelineno-59-215"></a>
<a id="__codelineno-59-216" name="__codelineno-59-216" href="#__codelineno-59-216"></a>
<a id="__codelineno-59-217" name="__codelineno-59-217" href="#__codelineno-59-217"></a>},
<a id="__codelineno-59-218" name="__codelineno-59-218" href="#__codelineno-59-218"></a>
<a id="__codelineno-59-219" name="__codelineno-59-219" href="#__codelineno-59-219"></a>
<a id="__codelineno-59-220" name="__codelineno-59-220" href="#__codelineno-59-220"></a>
<a id="__codelineno-59-221" name="__codelineno-59-221" href="#__codelineno-59-221"></a>&quot;position&quot;: {
<a id="__codelineno-59-222" name="__codelineno-59-222" href="#__codelineno-59-222"></a>
<a id="__codelineno-59-223" name="__codelineno-59-223" href="#__codelineno-59-223"></a>
<a id="__codelineno-59-224" name="__codelineno-59-224" href="#__codelineno-59-224"></a>
<a id="__codelineno-59-225" name="__codelineno-59-225" href="#__codelineno-59-225"></a>&quot;x&quot;: 0,
<a id="__codelineno-59-226" name="__codelineno-59-226" href="#__codelineno-59-226"></a>
<a id="__codelineno-59-227" name="__codelineno-59-227" href="#__codelineno-59-227"></a>
<a id="__codelineno-59-228" name="__codelineno-59-228" href="#__codelineno-59-228"></a>
<a id="__codelineno-59-229" name="__codelineno-59-229" href="#__codelineno-59-229"></a>&quot;y&quot;: 3
<a id="__codelineno-59-230" name="__codelineno-59-230" href="#__codelineno-59-230"></a>
<a id="__codelineno-59-231" name="__codelineno-59-231" href="#__codelineno-59-231"></a>
<a id="__codelineno-59-232" name="__codelineno-59-232" href="#__codelineno-59-232"></a>
<a id="__codelineno-59-233" name="__codelineno-59-233" href="#__codelineno-59-233"></a>},
<a id="__codelineno-59-234" name="__codelineno-59-234" href="#__codelineno-59-234"></a>
<a id="__codelineno-59-235" name="__codelineno-59-235" href="#__codelineno-59-235"></a>
<a id="__codelineno-59-236" name="__codelineno-59-236" href="#__codelineno-59-236"></a>
<a id="__codelineno-59-237" name="__codelineno-59-237" href="#__codelineno-59-237"></a>&quot;predecessors&quot;: [
<a id="__codelineno-59-238" name="__codelineno-59-238" href="#__codelineno-59-238"></a>
<a id="__codelineno-59-239" name="__codelineno-59-239" href="#__codelineno-59-239"></a>
<a id="__codelineno-59-240" name="__codelineno-59-240" href="#__codelineno-59-240"></a>
<a id="__codelineno-59-241" name="__codelineno-59-241" href="#__codelineno-59-241"></a>&quot;fetch_findings_by_account&quot;
<a id="__codelineno-59-242" name="__codelineno-59-242" href="#__codelineno-59-242"></a>
<a id="__codelineno-59-243" name="__codelineno-59-243" href="#__codelineno-59-243"></a>
<a id="__codelineno-59-244" name="__codelineno-59-244" href="#__codelineno-59-244"></a>
<a id="__codelineno-59-245" name="__codelineno-59-245" href="#__codelineno-59-245"></a>],
<a id="__codelineno-59-246" name="__codelineno-59-246" href="#__codelineno-59-246"></a>
<a id="__codelineno-59-247" name="__codelineno-59-247" href="#__codelineno-59-247"></a>
<a id="__codelineno-59-248" name="__codelineno-59-248" href="#__codelineno-59-248"></a>
<a id="__codelineno-59-249" name="__codelineno-59-249" href="#__codelineno-59-249"></a>&quot;conditions&quot;: {
<a id="__codelineno-59-250" name="__codelineno-59-250" href="#__codelineno-59-250"></a>
<a id="__codelineno-59-251" name="__codelineno-59-251" href="#__codelineno-59-251"></a>
<a id="__codelineno-59-252" name="__codelineno-59-252" href="#__codelineno-59-252"></a>
<a id="__codelineno-59-253" name="__codelineno-59-253" href="#__codelineno-59-253"></a>&quot;states&quot;: {
<a id="__codelineno-59-254" name="__codelineno-59-254" href="#__codelineno-59-254"></a>
<a id="__codelineno-59-255" name="__codelineno-59-255" href="#__codelineno-59-255"></a>
<a id="__codelineno-59-256" name="__codelineno-59-256" href="#__codelineno-59-256"></a>
<a id="__codelineno-59-257" name="__codelineno-59-257" href="#__codelineno-59-257"></a>&quot;fetch_findings_by_account&quot;: &quot;OK&quot;
<a id="__codelineno-59-258" name="__codelineno-59-258" href="#__codelineno-59-258"></a>
<a id="__codelineno-59-259" name="__codelineno-59-259" href="#__codelineno-59-259"></a>
<a id="__codelineno-59-260" name="__codelineno-59-260" href="#__codelineno-59-260"></a>
<a id="__codelineno-59-261" name="__codelineno-59-261" href="#__codelineno-59-261"></a>}
<a id="__codelineno-59-262" name="__codelineno-59-262" href="#__codelineno-59-262"></a>
<a id="__codelineno-59-263" name="__codelineno-59-263" href="#__codelineno-59-263"></a>
<a id="__codelineno-59-264" name="__codelineno-59-264" href="#__codelineno-59-264"></a>
<a id="__codelineno-59-265" name="__codelineno-59-265" href="#__codelineno-59-265"></a>}
<a id="__codelineno-59-266" name="__codelineno-59-266" href="#__codelineno-59-266"></a>
<a id="__codelineno-59-267" name="__codelineno-59-267" href="#__codelineno-59-267"></a>
<a id="__codelineno-59-268" name="__codelineno-59-268" href="#__codelineno-59-268"></a>
<a id="__codelineno-59-269" name="__codelineno-59-269" href="#__codelineno-59-269"></a>},
<a id="__codelineno-59-270" name="__codelineno-59-270" href="#__codelineno-59-270"></a>
<a id="__codelineno-59-271" name="__codelineno-59-271" href="#__codelineno-59-271"></a>
<a id="__codelineno-59-272" name="__codelineno-59-272" href="#__codelineno-59-272"></a>
<a id="__codelineno-59-273" name="__codelineno-59-273" href="#__codelineno-59-273"></a>&quot;workflow_config_params&quot;: {
<a id="__codelineno-59-274" name="__codelineno-59-274" href="#__codelineno-59-274"></a>
<a id="__codelineno-59-275" name="__codelineno-59-275" href="#__codelineno-59-275"></a>
<a id="__codelineno-59-276" name="__codelineno-59-276" href="#__codelineno-59-276"></a>
<a id="__codelineno-59-277" name="__codelineno-59-277" href="#__codelineno-59-277"></a>&quot;name&quot;: &quot;workflow_config_params&quot;,
<a id="__codelineno-59-278" name="__codelineno-59-278" href="#__codelineno-59-278"></a>
<a id="__codelineno-59-279" name="__codelineno-59-279" href="#__codelineno-59-279"></a>
<a id="__codelineno-59-280" name="__codelineno-59-280" href="#__codelineno-59-280"></a>
<a id="__codelineno-59-281" name="__codelineno-59-281" href="#__codelineno-59-281"></a>&quot;description&quot;: &quot;Sets configuration parameters for the workflow run&quot;,
<a id="__codelineno-59-282" name="__codelineno-59-282" href="#__codelineno-59-282"></a>
<a id="__codelineno-59-283" name="__codelineno-59-283" href="#__codelineno-59-283"></a>
<a id="__codelineno-59-284" name="__codelineno-59-284" href="#__codelineno-59-284"></a>
<a id="__codelineno-59-285" name="__codelineno-59-285" href="#__codelineno-59-285"></a>&quot;action&quot;: &quot;dynatrace.automations:run-javascript&quot;,
<a id="__codelineno-59-286" name="__codelineno-59-286" href="#__codelineno-59-286"></a>
<a id="__codelineno-59-287" name="__codelineno-59-287" href="#__codelineno-59-287"></a>
<a id="__codelineno-59-288" name="__codelineno-59-288" href="#__codelineno-59-288"></a>
<a id="__codelineno-59-289" name="__codelineno-59-289" href="#__codelineno-59-289"></a>&quot;input&quot;: {
<a id="__codelineno-59-290" name="__codelineno-59-290" href="#__codelineno-59-290"></a>
<a id="__codelineno-59-291" name="__codelineno-59-291" href="#__codelineno-59-291"></a>
<a id="__codelineno-59-292" name="__codelineno-59-292" href="#__codelineno-59-292"></a>
<a id="__codelineno-59-293" name="__codelineno-59-293" href="#__codelineno-59-293"></a>&quot;script&quot;: &quot;// This step sets up some configurational parameters for the workflow run \n// (e.g. which accounts, which finding types we are filtering for)\nexport default async function () {\n\n  // AWS accounts to filter for\n  const awsAccountIds = [\n    // add your AWS account ids here, e.g.\n    // \&quot;1234567890\&quot;\n  ]\n\n  // Findings that should be grouped by AWS account\n  const securityControlIdsToGroupByAccount = [\n    // add you control IDs here, e.g.\n    // \&quot;S3.1\&quot; // S3 Block Public Access setting should be enabled\n  ]\n\n  // Findings that should be grouped by AWS Resource\n  const securityControlIdsToGroupByResource = [\n    // add you control IDs here, e.g.\n    // \&quot;EC2.13\&quot; // Security groups should not allow ingress from 0.0.0.0/0 to port 22\n  ]\n  \n  return { awsAccountIds, securityControlIdsToGroupByAccount, securityControlIdsToGroupByResource }\n}&quot;
<a id="__codelineno-59-294" name="__codelineno-59-294" href="#__codelineno-59-294"></a>
<a id="__codelineno-59-295" name="__codelineno-59-295" href="#__codelineno-59-295"></a>
<a id="__codelineno-59-296" name="__codelineno-59-296" href="#__codelineno-59-296"></a>
<a id="__codelineno-59-297" name="__codelineno-59-297" href="#__codelineno-59-297"></a>},
<a id="__codelineno-59-298" name="__codelineno-59-298" href="#__codelineno-59-298"></a>
<a id="__codelineno-59-299" name="__codelineno-59-299" href="#__codelineno-59-299"></a>
<a id="__codelineno-59-300" name="__codelineno-59-300" href="#__codelineno-59-300"></a>
<a id="__codelineno-59-301" name="__codelineno-59-301" href="#__codelineno-59-301"></a>&quot;position&quot;: {
<a id="__codelineno-59-302" name="__codelineno-59-302" href="#__codelineno-59-302"></a>
<a id="__codelineno-59-303" name="__codelineno-59-303" href="#__codelineno-59-303"></a>
<a id="__codelineno-59-304" name="__codelineno-59-304" href="#__codelineno-59-304"></a>
<a id="__codelineno-59-305" name="__codelineno-59-305" href="#__codelineno-59-305"></a>&quot;x&quot;: 0,
<a id="__codelineno-59-306" name="__codelineno-59-306" href="#__codelineno-59-306"></a>
<a id="__codelineno-59-307" name="__codelineno-59-307" href="#__codelineno-59-307"></a>
<a id="__codelineno-59-308" name="__codelineno-59-308" href="#__codelineno-59-308"></a>
<a id="__codelineno-59-309" name="__codelineno-59-309" href="#__codelineno-59-309"></a>&quot;y&quot;: 1
<a id="__codelineno-59-310" name="__codelineno-59-310" href="#__codelineno-59-310"></a>
<a id="__codelineno-59-311" name="__codelineno-59-311" href="#__codelineno-59-311"></a>
<a id="__codelineno-59-312" name="__codelineno-59-312" href="#__codelineno-59-312"></a>
<a id="__codelineno-59-313" name="__codelineno-59-313" href="#__codelineno-59-313"></a>},
<a id="__codelineno-59-314" name="__codelineno-59-314" href="#__codelineno-59-314"></a>
<a id="__codelineno-59-315" name="__codelineno-59-315" href="#__codelineno-59-315"></a>
<a id="__codelineno-59-316" name="__codelineno-59-316" href="#__codelineno-59-316"></a>
<a id="__codelineno-59-317" name="__codelineno-59-317" href="#__codelineno-59-317"></a>&quot;predecessors&quot;: []
<a id="__codelineno-59-318" name="__codelineno-59-318" href="#__codelineno-59-318"></a>
<a id="__codelineno-59-319" name="__codelineno-59-319" href="#__codelineno-59-319"></a>
<a id="__codelineno-59-320" name="__codelineno-59-320" href="#__codelineno-59-320"></a>
<a id="__codelineno-59-321" name="__codelineno-59-321" href="#__codelineno-59-321"></a>},
<a id="__codelineno-59-322" name="__codelineno-59-322" href="#__codelineno-59-322"></a>
<a id="__codelineno-59-323" name="__codelineno-59-323" href="#__codelineno-59-323"></a>
<a id="__codelineno-59-324" name="__codelineno-59-324" href="#__codelineno-59-324"></a>
<a id="__codelineno-59-325" name="__codelineno-59-325" href="#__codelineno-59-325"></a>&quot;log_tickets_by_resource&quot;: {
<a id="__codelineno-59-326" name="__codelineno-59-326" href="#__codelineno-59-326"></a>
<a id="__codelineno-59-327" name="__codelineno-59-327" href="#__codelineno-59-327"></a>
<a id="__codelineno-59-328" name="__codelineno-59-328" href="#__codelineno-59-328"></a>
<a id="__codelineno-59-329" name="__codelineno-59-329" href="#__codelineno-59-329"></a>&quot;name&quot;: &quot;log_tickets_by_resource&quot;,
<a id="__codelineno-59-330" name="__codelineno-59-330" href="#__codelineno-59-330"></a>
<a id="__codelineno-59-331" name="__codelineno-59-331" href="#__codelineno-59-331"></a>
<a id="__codelineno-59-332" name="__codelineno-59-332" href="#__codelineno-59-332"></a>
<a id="__codelineno-59-333" name="__codelineno-59-333" href="#__codelineno-59-333"></a>&quot;description&quot;: &quot;Logs potentially created Jira issues for findings by resource&quot;,
<a id="__codelineno-59-334" name="__codelineno-59-334" href="#__codelineno-59-334"></a>
<a id="__codelineno-59-335" name="__codelineno-59-335" href="#__codelineno-59-335"></a>
<a id="__codelineno-59-336" name="__codelineno-59-336" href="#__codelineno-59-336"></a>
<a id="__codelineno-59-337" name="__codelineno-59-337" href="#__codelineno-59-337"></a>&quot;action&quot;: &quot;dynatrace.automations:run-javascript&quot;,
<a id="__codelineno-59-338" name="__codelineno-59-338" href="#__codelineno-59-338"></a>
<a id="__codelineno-59-339" name="__codelineno-59-339" href="#__codelineno-59-339"></a>
<a id="__codelineno-59-340" name="__codelineno-59-340" href="#__codelineno-59-340"></a>
<a id="__codelineno-59-341" name="__codelineno-59-341" href="#__codelineno-59-341"></a>&quot;active&quot;: true,
<a id="__codelineno-59-342" name="__codelineno-59-342" href="#__codelineno-59-342"></a>
<a id="__codelineno-59-343" name="__codelineno-59-343" href="#__codelineno-59-343"></a>
<a id="__codelineno-59-344" name="__codelineno-59-344" href="#__codelineno-59-344"></a>
<a id="__codelineno-59-345" name="__codelineno-59-345" href="#__codelineno-59-345"></a>&quot;input&quot;: {
<a id="__codelineno-59-346" name="__codelineno-59-346" href="#__codelineno-59-346"></a>
<a id="__codelineno-59-347" name="__codelineno-59-347" href="#__codelineno-59-347"></a>
<a id="__codelineno-59-348" name="__codelineno-59-348" href="#__codelineno-59-348"></a>
<a id="__codelineno-59-349" name="__codelineno-59-349" href="#__codelineno-59-349"></a>&quot;script&quot;: &quot;import { execution } from &#39;@dynatrace-sdk/automation-utils&#39;;\n\nexport default async function ({ executionId }) {\n  const ex = await execution(executionId);\n  const by_resource = await ex.result(\&quot;fetch_findings_by_resource\&quot;);\n\n  console.log(&#39;=================================================================================================&#39;)\n  console.log(`Issues by resource, ${by_resource.records.length} findings`)\n  console.log(&#39;=================================================================================================&#39;)\n\n  for(let finding of by_resource.records) {\n    console.log(&#39;&#39;)\n    console.log(&#39;=================================================================================================&#39;)\n    console.log(`Automatic Vulnerability Report for ${finding.resource.resourceId}`)\n    console.log(&#39;=================================================================================================&#39;)\n    console.log(&#39;&#39;)\n    console.log(&#39;The following vulnerabilities were reported for your resource via AWS Security Hub.&#39;)\n    console.log(&#39;&#39;)\n    console.log(`AWS Account: ${finding.aws.accountId}`)\n    console.log(&#39;&#39;)\n    console.log(&#39;Resource details:&#39;)\n    console.log(finding.resource.resourceType)\n    console.log(finding.resource.resourceId)\n    console.log(&#39;&#39;)\n    console.log(&#39;Vulnerabilities:&#39;)\n    for(let vulnerability of finding.vulnerabilities) {\n      console.log(`${vulnerability.controlId} - ${vulnerability.title}`)\n      console.log(vulnerability.severity)\n      console.log(vulnerability.description)\n      console.log(vulnerability.remediation[0].Recommendation.Url)      \n    }\n    console.log(&#39;=================================================================================================&#39;)\n    console.log(&#39;&#39;)\n    console.log(&#39;&#39;)\n  }\n  \n  return by_resource.records;\n}&quot;
<a id="__codelineno-59-350" name="__codelineno-59-350" href="#__codelineno-59-350"></a>
<a id="__codelineno-59-351" name="__codelineno-59-351" href="#__codelineno-59-351"></a>
<a id="__codelineno-59-352" name="__codelineno-59-352" href="#__codelineno-59-352"></a>
<a id="__codelineno-59-353" name="__codelineno-59-353" href="#__codelineno-59-353"></a>},
<a id="__codelineno-59-354" name="__codelineno-59-354" href="#__codelineno-59-354"></a>
<a id="__codelineno-59-355" name="__codelineno-59-355" href="#__codelineno-59-355"></a>
<a id="__codelineno-59-356" name="__codelineno-59-356" href="#__codelineno-59-356"></a>
<a id="__codelineno-59-357" name="__codelineno-59-357" href="#__codelineno-59-357"></a>&quot;position&quot;: {
<a id="__codelineno-59-358" name="__codelineno-59-358" href="#__codelineno-59-358"></a>
<a id="__codelineno-59-359" name="__codelineno-59-359" href="#__codelineno-59-359"></a>
<a id="__codelineno-59-360" name="__codelineno-59-360" href="#__codelineno-59-360"></a>
<a id="__codelineno-59-361" name="__codelineno-59-361" href="#__codelineno-59-361"></a>&quot;x&quot;: 1,
<a id="__codelineno-59-362" name="__codelineno-59-362" href="#__codelineno-59-362"></a>
<a id="__codelineno-59-363" name="__codelineno-59-363" href="#__codelineno-59-363"></a>
<a id="__codelineno-59-364" name="__codelineno-59-364" href="#__codelineno-59-364"></a>
<a id="__codelineno-59-365" name="__codelineno-59-365" href="#__codelineno-59-365"></a>&quot;y&quot;: 3
<a id="__codelineno-59-366" name="__codelineno-59-366" href="#__codelineno-59-366"></a>
<a id="__codelineno-59-367" name="__codelineno-59-367" href="#__codelineno-59-367"></a>
<a id="__codelineno-59-368" name="__codelineno-59-368" href="#__codelineno-59-368"></a>
<a id="__codelineno-59-369" name="__codelineno-59-369" href="#__codelineno-59-369"></a>},
<a id="__codelineno-59-370" name="__codelineno-59-370" href="#__codelineno-59-370"></a>
<a id="__codelineno-59-371" name="__codelineno-59-371" href="#__codelineno-59-371"></a>
<a id="__codelineno-59-372" name="__codelineno-59-372" href="#__codelineno-59-372"></a>
<a id="__codelineno-59-373" name="__codelineno-59-373" href="#__codelineno-59-373"></a>&quot;predecessors&quot;: [
<a id="__codelineno-59-374" name="__codelineno-59-374" href="#__codelineno-59-374"></a>
<a id="__codelineno-59-375" name="__codelineno-59-375" href="#__codelineno-59-375"></a>
<a id="__codelineno-59-376" name="__codelineno-59-376" href="#__codelineno-59-376"></a>
<a id="__codelineno-59-377" name="__codelineno-59-377" href="#__codelineno-59-377"></a>&quot;fetch_findings_by_resource&quot;
<a id="__codelineno-59-378" name="__codelineno-59-378" href="#__codelineno-59-378"></a>
<a id="__codelineno-59-379" name="__codelineno-59-379" href="#__codelineno-59-379"></a>
<a id="__codelineno-59-380" name="__codelineno-59-380" href="#__codelineno-59-380"></a>
<a id="__codelineno-59-381" name="__codelineno-59-381" href="#__codelineno-59-381"></a>],
<a id="__codelineno-59-382" name="__codelineno-59-382" href="#__codelineno-59-382"></a>
<a id="__codelineno-59-383" name="__codelineno-59-383" href="#__codelineno-59-383"></a>
<a id="__codelineno-59-384" name="__codelineno-59-384" href="#__codelineno-59-384"></a>
<a id="__codelineno-59-385" name="__codelineno-59-385" href="#__codelineno-59-385"></a>&quot;conditions&quot;: {
<a id="__codelineno-59-386" name="__codelineno-59-386" href="#__codelineno-59-386"></a>
<a id="__codelineno-59-387" name="__codelineno-59-387" href="#__codelineno-59-387"></a>
<a id="__codelineno-59-388" name="__codelineno-59-388" href="#__codelineno-59-388"></a>
<a id="__codelineno-59-389" name="__codelineno-59-389" href="#__codelineno-59-389"></a>&quot;states&quot;: {
<a id="__codelineno-59-390" name="__codelineno-59-390" href="#__codelineno-59-390"></a>
<a id="__codelineno-59-391" name="__codelineno-59-391" href="#__codelineno-59-391"></a>
<a id="__codelineno-59-392" name="__codelineno-59-392" href="#__codelineno-59-392"></a>
<a id="__codelineno-59-393" name="__codelineno-59-393" href="#__codelineno-59-393"></a>&quot;fetch_findings_by_resource&quot;: &quot;OK&quot;
<a id="__codelineno-59-394" name="__codelineno-59-394" href="#__codelineno-59-394"></a>
<a id="__codelineno-59-395" name="__codelineno-59-395" href="#__codelineno-59-395"></a>
<a id="__codelineno-59-396" name="__codelineno-59-396" href="#__codelineno-59-396"></a>
<a id="__codelineno-59-397" name="__codelineno-59-397" href="#__codelineno-59-397"></a>}
<a id="__codelineno-59-398" name="__codelineno-59-398" href="#__codelineno-59-398"></a>
<a id="__codelineno-59-399" name="__codelineno-59-399" href="#__codelineno-59-399"></a>
<a id="__codelineno-59-400" name="__codelineno-59-400" href="#__codelineno-59-400"></a>
<a id="__codelineno-59-401" name="__codelineno-59-401" href="#__codelineno-59-401"></a>}
<a id="__codelineno-59-402" name="__codelineno-59-402" href="#__codelineno-59-402"></a>
<a id="__codelineno-59-403" name="__codelineno-59-403" href="#__codelineno-59-403"></a>
<a id="__codelineno-59-404" name="__codelineno-59-404" href="#__codelineno-59-404"></a>
<a id="__codelineno-59-405" name="__codelineno-59-405" href="#__codelineno-59-405"></a>},
<a id="__codelineno-59-406" name="__codelineno-59-406" href="#__codelineno-59-406"></a>
<a id="__codelineno-59-407" name="__codelineno-59-407" href="#__codelineno-59-407"></a>
<a id="__codelineno-59-408" name="__codelineno-59-408" href="#__codelineno-59-408"></a>
<a id="__codelineno-59-409" name="__codelineno-59-409" href="#__codelineno-59-409"></a>&quot;create_issue_for_account&quot;: {
<a id="__codelineno-59-410" name="__codelineno-59-410" href="#__codelineno-59-410"></a>
<a id="__codelineno-59-411" name="__codelineno-59-411" href="#__codelineno-59-411"></a>
<a id="__codelineno-59-412" name="__codelineno-59-412" href="#__codelineno-59-412"></a>
<a id="__codelineno-59-413" name="__codelineno-59-413" href="#__codelineno-59-413"></a>&quot;name&quot;: &quot;create_issue_for_account&quot;,
<a id="__codelineno-59-414" name="__codelineno-59-414" href="#__codelineno-59-414"></a>
<a id="__codelineno-59-415" name="__codelineno-59-415" href="#__codelineno-59-415"></a>
<a id="__codelineno-59-416" name="__codelineno-59-416" href="#__codelineno-59-416"></a>
<a id="__codelineno-59-417" name="__codelineno-59-417" href="#__codelineno-59-417"></a>&quot;description&quot;: &quot;Creates new Jira issue or the vulnerable AWS account&quot;,
<a id="__codelineno-59-418" name="__codelineno-59-418" href="#__codelineno-59-418"></a>
<a id="__codelineno-59-419" name="__codelineno-59-419" href="#__codelineno-59-419"></a>
<a id="__codelineno-59-420" name="__codelineno-59-420" href="#__codelineno-59-420"></a>
<a id="__codelineno-59-421" name="__codelineno-59-421" href="#__codelineno-59-421"></a>&quot;action&quot;: &quot;dynatrace.jira:jira-create-issue&quot;,
<a id="__codelineno-59-422" name="__codelineno-59-422" href="#__codelineno-59-422"></a>
<a id="__codelineno-59-423" name="__codelineno-59-423" href="#__codelineno-59-423"></a>
<a id="__codelineno-59-424" name="__codelineno-59-424" href="#__codelineno-59-424"></a>
<a id="__codelineno-59-425" name="__codelineno-59-425" href="#__codelineno-59-425"></a>&quot;active&quot;: false,
<a id="__codelineno-59-426" name="__codelineno-59-426" href="#__codelineno-59-426"></a>
<a id="__codelineno-59-427" name="__codelineno-59-427" href="#__codelineno-59-427"></a>
<a id="__codelineno-59-428" name="__codelineno-59-428" href="#__codelineno-59-428"></a>
<a id="__codelineno-59-429" name="__codelineno-59-429" href="#__codelineno-59-429"></a>&quot;input&quot;: {
<a id="__codelineno-59-430" name="__codelineno-59-430" href="#__codelineno-59-430"></a>
<a id="__codelineno-59-431" name="__codelineno-59-431" href="#__codelineno-59-431"></a>
<a id="__codelineno-59-432" name="__codelineno-59-432" href="#__codelineno-59-432"></a>
<a id="__codelineno-59-433" name="__codelineno-59-433" href="#__codelineno-59-433"></a>&quot;labels&quot;: [],
<a id="__codelineno-59-434" name="__codelineno-59-434" href="#__codelineno-59-434"></a>
<a id="__codelineno-59-435" name="__codelineno-59-435" href="#__codelineno-59-435"></a>
<a id="__codelineno-59-436" name="__codelineno-59-436" href="#__codelineno-59-436"></a>
<a id="__codelineno-59-437" name="__codelineno-59-437" href="#__codelineno-59-437"></a>&quot;summary&quot;: &quot;{{ _.item.summary }}&quot;,
<a id="__codelineno-59-438" name="__codelineno-59-438" href="#__codelineno-59-438"></a>
<a id="__codelineno-59-439" name="__codelineno-59-439" href="#__codelineno-59-439"></a>
<a id="__codelineno-59-440" name="__codelineno-59-440" href="#__codelineno-59-440"></a>
<a id="__codelineno-59-441" name="__codelineno-59-441" href="#__codelineno-59-441"></a>&quot;components&quot;: [],
<a id="__codelineno-59-442" name="__codelineno-59-442" href="#__codelineno-59-442"></a>
<a id="__codelineno-59-443" name="__codelineno-59-443" href="#__codelineno-59-443"></a>
<a id="__codelineno-59-444" name="__codelineno-59-444" href="#__codelineno-59-444"></a>
<a id="__codelineno-59-445" name="__codelineno-59-445" href="#__codelineno-59-445"></a>&quot;description&quot;: &quot;{{ _.item.description }}&quot;,
<a id="__codelineno-59-446" name="__codelineno-59-446" href="#__codelineno-59-446"></a>
<a id="__codelineno-59-447" name="__codelineno-59-447" href="#__codelineno-59-447"></a>
<a id="__codelineno-59-448" name="__codelineno-59-448" href="#__codelineno-59-448"></a>
<a id="__codelineno-59-449" name="__codelineno-59-449" href="#__codelineno-59-449"></a>&quot;fieldSetters&quot;: []
<a id="__codelineno-59-450" name="__codelineno-59-450" href="#__codelineno-59-450"></a>
<a id="__codelineno-59-451" name="__codelineno-59-451" href="#__codelineno-59-451"></a>
<a id="__codelineno-59-452" name="__codelineno-59-452" href="#__codelineno-59-452"></a>
<a id="__codelineno-59-453" name="__codelineno-59-453" href="#__codelineno-59-453"></a>},
<a id="__codelineno-59-454" name="__codelineno-59-454" href="#__codelineno-59-454"></a>
<a id="__codelineno-59-455" name="__codelineno-59-455" href="#__codelineno-59-455"></a>
<a id="__codelineno-59-456" name="__codelineno-59-456" href="#__codelineno-59-456"></a>
<a id="__codelineno-59-457" name="__codelineno-59-457" href="#__codelineno-59-457"></a>&quot;position&quot;: {
<a id="__codelineno-59-458" name="__codelineno-59-458" href="#__codelineno-59-458"></a>
<a id="__codelineno-59-459" name="__codelineno-59-459" href="#__codelineno-59-459"></a>
<a id="__codelineno-59-460" name="__codelineno-59-460" href="#__codelineno-59-460"></a>
<a id="__codelineno-59-461" name="__codelineno-59-461" href="#__codelineno-59-461"></a>&quot;x&quot;: 0,
<a id="__codelineno-59-462" name="__codelineno-59-462" href="#__codelineno-59-462"></a>
<a id="__codelineno-59-463" name="__codelineno-59-463" href="#__codelineno-59-463"></a>
<a id="__codelineno-59-464" name="__codelineno-59-464" href="#__codelineno-59-464"></a>
<a id="__codelineno-59-465" name="__codelineno-59-465" href="#__codelineno-59-465"></a>&quot;y&quot;: 5
<a id="__codelineno-59-466" name="__codelineno-59-466" href="#__codelineno-59-466"></a>
<a id="__codelineno-59-467" name="__codelineno-59-467" href="#__codelineno-59-467"></a>
<a id="__codelineno-59-468" name="__codelineno-59-468" href="#__codelineno-59-468"></a>
<a id="__codelineno-59-469" name="__codelineno-59-469" href="#__codelineno-59-469"></a>},
<a id="__codelineno-59-470" name="__codelineno-59-470" href="#__codelineno-59-470"></a>
<a id="__codelineno-59-471" name="__codelineno-59-471" href="#__codelineno-59-471"></a>
<a id="__codelineno-59-472" name="__codelineno-59-472" href="#__codelineno-59-472"></a>
<a id="__codelineno-59-473" name="__codelineno-59-473" href="#__codelineno-59-473"></a>&quot;predecessors&quot;: [
<a id="__codelineno-59-474" name="__codelineno-59-474" href="#__codelineno-59-474"></a>
<a id="__codelineno-59-475" name="__codelineno-59-475" href="#__codelineno-59-475"></a>
<a id="__codelineno-59-476" name="__codelineno-59-476" href="#__codelineno-59-476"></a>
<a id="__codelineno-59-477" name="__codelineno-59-477" href="#__codelineno-59-477"></a>&quot;prepare_tickets_by_account&quot;
<a id="__codelineno-59-478" name="__codelineno-59-478" href="#__codelineno-59-478"></a>
<a id="__codelineno-59-479" name="__codelineno-59-479" href="#__codelineno-59-479"></a>
<a id="__codelineno-59-480" name="__codelineno-59-480" href="#__codelineno-59-480"></a>
<a id="__codelineno-59-481" name="__codelineno-59-481" href="#__codelineno-59-481"></a>],
<a id="__codelineno-59-482" name="__codelineno-59-482" href="#__codelineno-59-482"></a>
<a id="__codelineno-59-483" name="__codelineno-59-483" href="#__codelineno-59-483"></a>
<a id="__codelineno-59-484" name="__codelineno-59-484" href="#__codelineno-59-484"></a>
<a id="__codelineno-59-485" name="__codelineno-59-485" href="#__codelineno-59-485"></a>&quot;conditions&quot;: {
<a id="__codelineno-59-486" name="__codelineno-59-486" href="#__codelineno-59-486"></a>
<a id="__codelineno-59-487" name="__codelineno-59-487" href="#__codelineno-59-487"></a>
<a id="__codelineno-59-488" name="__codelineno-59-488" href="#__codelineno-59-488"></a>
<a id="__codelineno-59-489" name="__codelineno-59-489" href="#__codelineno-59-489"></a>&quot;states&quot;: {
<a id="__codelineno-59-490" name="__codelineno-59-490" href="#__codelineno-59-490"></a>
<a id="__codelineno-59-491" name="__codelineno-59-491" href="#__codelineno-59-491"></a>
<a id="__codelineno-59-492" name="__codelineno-59-492" href="#__codelineno-59-492"></a>
<a id="__codelineno-59-493" name="__codelineno-59-493" href="#__codelineno-59-493"></a>&quot;prepare_tickets_by_account&quot;: &quot;OK&quot;
<a id="__codelineno-59-494" name="__codelineno-59-494" href="#__codelineno-59-494"></a>
<a id="__codelineno-59-495" name="__codelineno-59-495" href="#__codelineno-59-495"></a>
<a id="__codelineno-59-496" name="__codelineno-59-496" href="#__codelineno-59-496"></a>
<a id="__codelineno-59-497" name="__codelineno-59-497" href="#__codelineno-59-497"></a>}
<a id="__codelineno-59-498" name="__codelineno-59-498" href="#__codelineno-59-498"></a>
<a id="__codelineno-59-499" name="__codelineno-59-499" href="#__codelineno-59-499"></a>
<a id="__codelineno-59-500" name="__codelineno-59-500" href="#__codelineno-59-500"></a>
<a id="__codelineno-59-501" name="__codelineno-59-501" href="#__codelineno-59-501"></a>},
<a id="__codelineno-59-502" name="__codelineno-59-502" href="#__codelineno-59-502"></a>
<a id="__codelineno-59-503" name="__codelineno-59-503" href="#__codelineno-59-503"></a>
<a id="__codelineno-59-504" name="__codelineno-59-504" href="#__codelineno-59-504"></a>
<a id="__codelineno-59-505" name="__codelineno-59-505" href="#__codelineno-59-505"></a>&quot;concurrency&quot;: 1,
<a id="__codelineno-59-506" name="__codelineno-59-506" href="#__codelineno-59-506"></a>
<a id="__codelineno-59-507" name="__codelineno-59-507" href="#__codelineno-59-507"></a>
<a id="__codelineno-59-508" name="__codelineno-59-508" href="#__codelineno-59-508"></a>
<a id="__codelineno-59-509" name="__codelineno-59-509" href="#__codelineno-59-509"></a>&quot;withItems&quot;: &quot;item in {{result(\&quot;prepare_tickets_by_account\&quot;)}}&quot;
<a id="__codelineno-59-510" name="__codelineno-59-510" href="#__codelineno-59-510"></a>
<a id="__codelineno-59-511" name="__codelineno-59-511" href="#__codelineno-59-511"></a>
<a id="__codelineno-59-512" name="__codelineno-59-512" href="#__codelineno-59-512"></a>
<a id="__codelineno-59-513" name="__codelineno-59-513" href="#__codelineno-59-513"></a>},
<a id="__codelineno-59-514" name="__codelineno-59-514" href="#__codelineno-59-514"></a>
<a id="__codelineno-59-515" name="__codelineno-59-515" href="#__codelineno-59-515"></a>
<a id="__codelineno-59-516" name="__codelineno-59-516" href="#__codelineno-59-516"></a>
<a id="__codelineno-59-517" name="__codelineno-59-517" href="#__codelineno-59-517"></a>&quot;create_issue_for_resource&quot;: {
<a id="__codelineno-59-518" name="__codelineno-59-518" href="#__codelineno-59-518"></a>
<a id="__codelineno-59-519" name="__codelineno-59-519" href="#__codelineno-59-519"></a>
<a id="__codelineno-59-520" name="__codelineno-59-520" href="#__codelineno-59-520"></a>
<a id="__codelineno-59-521" name="__codelineno-59-521" href="#__codelineno-59-521"></a>&quot;name&quot;: &quot;create_issue_for_resource&quot;,
<a id="__codelineno-59-522" name="__codelineno-59-522" href="#__codelineno-59-522"></a>
<a id="__codelineno-59-523" name="__codelineno-59-523" href="#__codelineno-59-523"></a>
<a id="__codelineno-59-524" name="__codelineno-59-524" href="#__codelineno-59-524"></a>
<a id="__codelineno-59-525" name="__codelineno-59-525" href="#__codelineno-59-525"></a>&quot;description&quot;: &quot;Creates new issue for the vulnerable AWS resource&quot;,
<a id="__codelineno-59-526" name="__codelineno-59-526" href="#__codelineno-59-526"></a>
<a id="__codelineno-59-527" name="__codelineno-59-527" href="#__codelineno-59-527"></a>
<a id="__codelineno-59-528" name="__codelineno-59-528" href="#__codelineno-59-528"></a>
<a id="__codelineno-59-529" name="__codelineno-59-529" href="#__codelineno-59-529"></a>&quot;action&quot;: &quot;dynatrace.jira:jira-create-issue&quot;,
<a id="__codelineno-59-530" name="__codelineno-59-530" href="#__codelineno-59-530"></a>
<a id="__codelineno-59-531" name="__codelineno-59-531" href="#__codelineno-59-531"></a>
<a id="__codelineno-59-532" name="__codelineno-59-532" href="#__codelineno-59-532"></a>
<a id="__codelineno-59-533" name="__codelineno-59-533" href="#__codelineno-59-533"></a>&quot;active&quot;: false,
<a id="__codelineno-59-534" name="__codelineno-59-534" href="#__codelineno-59-534"></a>
<a id="__codelineno-59-535" name="__codelineno-59-535" href="#__codelineno-59-535"></a>
<a id="__codelineno-59-536" name="__codelineno-59-536" href="#__codelineno-59-536"></a>
<a id="__codelineno-59-537" name="__codelineno-59-537" href="#__codelineno-59-537"></a>&quot;input&quot;: {
<a id="__codelineno-59-538" name="__codelineno-59-538" href="#__codelineno-59-538"></a>
<a id="__codelineno-59-539" name="__codelineno-59-539" href="#__codelineno-59-539"></a>
<a id="__codelineno-59-540" name="__codelineno-59-540" href="#__codelineno-59-540"></a>
<a id="__codelineno-59-541" name="__codelineno-59-541" href="#__codelineno-59-541"></a>&quot;labels&quot;: [],
<a id="__codelineno-59-542" name="__codelineno-59-542" href="#__codelineno-59-542"></a>
<a id="__codelineno-59-543" name="__codelineno-59-543" href="#__codelineno-59-543"></a>
<a id="__codelineno-59-544" name="__codelineno-59-544" href="#__codelineno-59-544"></a>
<a id="__codelineno-59-545" name="__codelineno-59-545" href="#__codelineno-59-545"></a>&quot;summary&quot;: &quot;{{ _.item.summary }}&quot;,
<a id="__codelineno-59-546" name="__codelineno-59-546" href="#__codelineno-59-546"></a>
<a id="__codelineno-59-547" name="__codelineno-59-547" href="#__codelineno-59-547"></a>
<a id="__codelineno-59-548" name="__codelineno-59-548" href="#__codelineno-59-548"></a>
<a id="__codelineno-59-549" name="__codelineno-59-549" href="#__codelineno-59-549"></a>&quot;components&quot;: [],
<a id="__codelineno-59-550" name="__codelineno-59-550" href="#__codelineno-59-550"></a>
<a id="__codelineno-59-551" name="__codelineno-59-551" href="#__codelineno-59-551"></a>
<a id="__codelineno-59-552" name="__codelineno-59-552" href="#__codelineno-59-552"></a>
<a id="__codelineno-59-553" name="__codelineno-59-553" href="#__codelineno-59-553"></a>&quot;description&quot;: &quot;{{ _.item.description }}&quot;,
<a id="__codelineno-59-554" name="__codelineno-59-554" href="#__codelineno-59-554"></a>
<a id="__codelineno-59-555" name="__codelineno-59-555" href="#__codelineno-59-555"></a>
<a id="__codelineno-59-556" name="__codelineno-59-556" href="#__codelineno-59-556"></a>
<a id="__codelineno-59-557" name="__codelineno-59-557" href="#__codelineno-59-557"></a>&quot;fieldSetters&quot;: []
<a id="__codelineno-59-558" name="__codelineno-59-558" href="#__codelineno-59-558"></a>
<a id="__codelineno-59-559" name="__codelineno-59-559" href="#__codelineno-59-559"></a>
<a id="__codelineno-59-560" name="__codelineno-59-560" href="#__codelineno-59-560"></a>
<a id="__codelineno-59-561" name="__codelineno-59-561" href="#__codelineno-59-561"></a>},
<a id="__codelineno-59-562" name="__codelineno-59-562" href="#__codelineno-59-562"></a>
<a id="__codelineno-59-563" name="__codelineno-59-563" href="#__codelineno-59-563"></a>
<a id="__codelineno-59-564" name="__codelineno-59-564" href="#__codelineno-59-564"></a>
<a id="__codelineno-59-565" name="__codelineno-59-565" href="#__codelineno-59-565"></a>&quot;position&quot;: {
<a id="__codelineno-59-566" name="__codelineno-59-566" href="#__codelineno-59-566"></a>
<a id="__codelineno-59-567" name="__codelineno-59-567" href="#__codelineno-59-567"></a>
<a id="__codelineno-59-568" name="__codelineno-59-568" href="#__codelineno-59-568"></a>
<a id="__codelineno-59-569" name="__codelineno-59-569" href="#__codelineno-59-569"></a>&quot;x&quot;: 1,
<a id="__codelineno-59-570" name="__codelineno-59-570" href="#__codelineno-59-570"></a>
<a id="__codelineno-59-571" name="__codelineno-59-571" href="#__codelineno-59-571"></a>
<a id="__codelineno-59-572" name="__codelineno-59-572" href="#__codelineno-59-572"></a>
<a id="__codelineno-59-573" name="__codelineno-59-573" href="#__codelineno-59-573"></a>&quot;y&quot;: 5
<a id="__codelineno-59-574" name="__codelineno-59-574" href="#__codelineno-59-574"></a>
<a id="__codelineno-59-575" name="__codelineno-59-575" href="#__codelineno-59-575"></a>
<a id="__codelineno-59-576" name="__codelineno-59-576" href="#__codelineno-59-576"></a>
<a id="__codelineno-59-577" name="__codelineno-59-577" href="#__codelineno-59-577"></a>},
<a id="__codelineno-59-578" name="__codelineno-59-578" href="#__codelineno-59-578"></a>
<a id="__codelineno-59-579" name="__codelineno-59-579" href="#__codelineno-59-579"></a>
<a id="__codelineno-59-580" name="__codelineno-59-580" href="#__codelineno-59-580"></a>
<a id="__codelineno-59-581" name="__codelineno-59-581" href="#__codelineno-59-581"></a>&quot;predecessors&quot;: [
<a id="__codelineno-59-582" name="__codelineno-59-582" href="#__codelineno-59-582"></a>
<a id="__codelineno-59-583" name="__codelineno-59-583" href="#__codelineno-59-583"></a>
<a id="__codelineno-59-584" name="__codelineno-59-584" href="#__codelineno-59-584"></a>
<a id="__codelineno-59-585" name="__codelineno-59-585" href="#__codelineno-59-585"></a>&quot;prepare_tickets_by_resource&quot;
<a id="__codelineno-59-586" name="__codelineno-59-586" href="#__codelineno-59-586"></a>
<a id="__codelineno-59-587" name="__codelineno-59-587" href="#__codelineno-59-587"></a>
<a id="__codelineno-59-588" name="__codelineno-59-588" href="#__codelineno-59-588"></a>
<a id="__codelineno-59-589" name="__codelineno-59-589" href="#__codelineno-59-589"></a>],
<a id="__codelineno-59-590" name="__codelineno-59-590" href="#__codelineno-59-590"></a>
<a id="__codelineno-59-591" name="__codelineno-59-591" href="#__codelineno-59-591"></a>
<a id="__codelineno-59-592" name="__codelineno-59-592" href="#__codelineno-59-592"></a>
<a id="__codelineno-59-593" name="__codelineno-59-593" href="#__codelineno-59-593"></a>&quot;conditions&quot;: {
<a id="__codelineno-59-594" name="__codelineno-59-594" href="#__codelineno-59-594"></a>
<a id="__codelineno-59-595" name="__codelineno-59-595" href="#__codelineno-59-595"></a>
<a id="__codelineno-59-596" name="__codelineno-59-596" href="#__codelineno-59-596"></a>
<a id="__codelineno-59-597" name="__codelineno-59-597" href="#__codelineno-59-597"></a>&quot;states&quot;: {
<a id="__codelineno-59-598" name="__codelineno-59-598" href="#__codelineno-59-598"></a>
<a id="__codelineno-59-599" name="__codelineno-59-599" href="#__codelineno-59-599"></a>
<a id="__codelineno-59-600" name="__codelineno-59-600" href="#__codelineno-59-600"></a>
<a id="__codelineno-59-601" name="__codelineno-59-601" href="#__codelineno-59-601"></a>&quot;prepare_tickets_by_resource&quot;: &quot;OK&quot;
<a id="__codelineno-59-602" name="__codelineno-59-602" href="#__codelineno-59-602"></a>
<a id="__codelineno-59-603" name="__codelineno-59-603" href="#__codelineno-59-603"></a>
<a id="__codelineno-59-604" name="__codelineno-59-604" href="#__codelineno-59-604"></a>
<a id="__codelineno-59-605" name="__codelineno-59-605" href="#__codelineno-59-605"></a>}
<a id="__codelineno-59-606" name="__codelineno-59-606" href="#__codelineno-59-606"></a>
<a id="__codelineno-59-607" name="__codelineno-59-607" href="#__codelineno-59-607"></a>
<a id="__codelineno-59-608" name="__codelineno-59-608" href="#__codelineno-59-608"></a>
<a id="__codelineno-59-609" name="__codelineno-59-609" href="#__codelineno-59-609"></a>},
<a id="__codelineno-59-610" name="__codelineno-59-610" href="#__codelineno-59-610"></a>
<a id="__codelineno-59-611" name="__codelineno-59-611" href="#__codelineno-59-611"></a>
<a id="__codelineno-59-612" name="__codelineno-59-612" href="#__codelineno-59-612"></a>
<a id="__codelineno-59-613" name="__codelineno-59-613" href="#__codelineno-59-613"></a>&quot;concurrency&quot;: 1,
<a id="__codelineno-59-614" name="__codelineno-59-614" href="#__codelineno-59-614"></a>
<a id="__codelineno-59-615" name="__codelineno-59-615" href="#__codelineno-59-615"></a>
<a id="__codelineno-59-616" name="__codelineno-59-616" href="#__codelineno-59-616"></a>
<a id="__codelineno-59-617" name="__codelineno-59-617" href="#__codelineno-59-617"></a>&quot;withItems&quot;: &quot;item in {{result(\&quot;prepare_tickets_by_resource\&quot;)}}&quot;
<a id="__codelineno-59-618" name="__codelineno-59-618" href="#__codelineno-59-618"></a>
<a id="__codelineno-59-619" name="__codelineno-59-619" href="#__codelineno-59-619"></a>
<a id="__codelineno-59-620" name="__codelineno-59-620" href="#__codelineno-59-620"></a>
<a id="__codelineno-59-621" name="__codelineno-59-621" href="#__codelineno-59-621"></a>},
<a id="__codelineno-59-622" name="__codelineno-59-622" href="#__codelineno-59-622"></a>
<a id="__codelineno-59-623" name="__codelineno-59-623" href="#__codelineno-59-623"></a>
<a id="__codelineno-59-624" name="__codelineno-59-624" href="#__codelineno-59-624"></a>
<a id="__codelineno-59-625" name="__codelineno-59-625" href="#__codelineno-59-625"></a>&quot;fetch_findings_by_account&quot;: {
<a id="__codelineno-59-626" name="__codelineno-59-626" href="#__codelineno-59-626"></a>
<a id="__codelineno-59-627" name="__codelineno-59-627" href="#__codelineno-59-627"></a>
<a id="__codelineno-59-628" name="__codelineno-59-628" href="#__codelineno-59-628"></a>
<a id="__codelineno-59-629" name="__codelineno-59-629" href="#__codelineno-59-629"></a>&quot;name&quot;: &quot;fetch_findings_by_account&quot;,
<a id="__codelineno-59-630" name="__codelineno-59-630" href="#__codelineno-59-630"></a>
<a id="__codelineno-59-631" name="__codelineno-59-631" href="#__codelineno-59-631"></a>
<a id="__codelineno-59-632" name="__codelineno-59-632" href="#__codelineno-59-632"></a>
<a id="__codelineno-59-633" name="__codelineno-59-633" href="#__codelineno-59-633"></a>&quot;description&quot;: &quot;Executes query to get relevant security findings grouped by AWS account&quot;,
<a id="__codelineno-59-634" name="__codelineno-59-634" href="#__codelineno-59-634"></a>
<a id="__codelineno-59-635" name="__codelineno-59-635" href="#__codelineno-59-635"></a>
<a id="__codelineno-59-636" name="__codelineno-59-636" href="#__codelineno-59-636"></a>
<a id="__codelineno-59-637" name="__codelineno-59-637" href="#__codelineno-59-637"></a>&quot;action&quot;: &quot;dynatrace.automations:execute-dql-query&quot;,
<a id="__codelineno-59-638" name="__codelineno-59-638" href="#__codelineno-59-638"></a>
<a id="__codelineno-59-639" name="__codelineno-59-639" href="#__codelineno-59-639"></a>
<a id="__codelineno-59-640" name="__codelineno-59-640" href="#__codelineno-59-640"></a>
<a id="__codelineno-59-641" name="__codelineno-59-641" href="#__codelineno-59-641"></a>&quot;active&quot;: true,
<a id="__codelineno-59-642" name="__codelineno-59-642" href="#__codelineno-59-642"></a>
<a id="__codelineno-59-643" name="__codelineno-59-643" href="#__codelineno-59-643"></a>
<a id="__codelineno-59-644" name="__codelineno-59-644" href="#__codelineno-59-644"></a>
<a id="__codelineno-59-645" name="__codelineno-59-645" href="#__codelineno-59-645"></a>&quot;input&quot;: {
<a id="__codelineno-59-646" name="__codelineno-59-646" href="#__codelineno-59-646"></a>
<a id="__codelineno-59-647" name="__codelineno-59-647" href="#__codelineno-59-647"></a>
<a id="__codelineno-59-648" name="__codelineno-59-648" href="#__codelineno-59-648"></a>
<a id="__codelineno-59-649" name="__codelineno-59-649" href="#__codelineno-59-649"></a>&quot;query&quot;: &quot;fetch logs, from:now() - 24h, scanLimitGBytes: -1\n| filter aws.log_group == \&quot;/aws/events/AWSSecurityHubLogGroup\&quot;\n| parse content, \&quot;JSON:alert\&quot;\n| fields timestamp,\n         awsRegion = toString(alert[detail][findings][0][Region]),\n         awsAccountId = toString(alert[detail][findings][0][AwsAccountId]),\n         resourceType = toString(alert[detail][findings][0][Resources][0][Type]),          \n         resource = toString(alert[detail][findings][0][Resources][0][Id]),\n         alertType = toString(alert[detail][findings][0][Types][0]),\n         id = toString(alert[detail][findings][0][Id]),\n         severity = toString(alert[detail][findings][0][FindingProviderFields][Severity][Label]),\n         title = toString(alert[detail][findings][0][Title]),\n         description = toString(alert[detail][findings][0][Description]),\n         complianceStatus = toString(alert[detail][findings][0][Compliance][Status]),\n         controlId = toString(alert[detail][findings][0][Compliance][SecurityControlId]),\n         remediation = alert[detail][findings][0][Remediation],\n         created = toTimestamp(alert[detail][findings][0][CreatedAt]),\n         lastObservedAt = toTimestamp(alert[detail][findings][0][LastObservedAt])\n| filter in(severity, array(\&quot;HIGH\&quot;, \&quot;CRITICAL\&quot;, \&quot;MEDIUM\&quot;))\n| filter created &gt; now() - 24h\n| filter in(awsAccountId, array(\&quot;{{ result(&#39;workflow_config_params&#39;).awsAccountIds | join(&#39;\&quot;,\&quot;&#39;) }}\&quot;))\n| filter in(controlId, array(\&quot;{{ result(&#39;workflow_config_params&#39;).securityControlIdsToGroupByAccount | join(&#39;\&quot;,\&quot;&#39;) }}\&quot;))\n| summarize { count=count(),\n              lastObservedAt = max(lastObservedAt),\n              remediation = collectDistinct(remediation),\n              complianceStatus = takeLast(complianceStatus),\n              resources = collectDistinct(resource),\n              title = takeAny(title),\n              description = takeAny(description),\n              severity = takeAny(severity),\n              awsRegion = collectArray(awsRegion)\n            },\n            by:{\n              controlId, \n              awsAccountId\n           }\n| lookup\n  [ fetch dt.entity.aws_credentials \n    | fields awsAccountId, entity.name\n  ], lookupField:awsAccountId, sourceField:awsAccountId, prefix: \&quot;aws.account.\&quot;\n&quot;
<a id="__codelineno-59-650" name="__codelineno-59-650" href="#__codelineno-59-650"></a>
<a id="__codelineno-59-651" name="__codelineno-59-651" href="#__codelineno-59-651"></a>
<a id="__codelineno-59-652" name="__codelineno-59-652" href="#__codelineno-59-652"></a>
<a id="__codelineno-59-653" name="__codelineno-59-653" href="#__codelineno-59-653"></a>},
<a id="__codelineno-59-654" name="__codelineno-59-654" href="#__codelineno-59-654"></a>
<a id="__codelineno-59-655" name="__codelineno-59-655" href="#__codelineno-59-655"></a>
<a id="__codelineno-59-656" name="__codelineno-59-656" href="#__codelineno-59-656"></a>
<a id="__codelineno-59-657" name="__codelineno-59-657" href="#__codelineno-59-657"></a>&quot;position&quot;: {
<a id="__codelineno-59-658" name="__codelineno-59-658" href="#__codelineno-59-658"></a>
<a id="__codelineno-59-659" name="__codelineno-59-659" href="#__codelineno-59-659"></a>
<a id="__codelineno-59-660" name="__codelineno-59-660" href="#__codelineno-59-660"></a>
<a id="__codelineno-59-661" name="__codelineno-59-661" href="#__codelineno-59-661"></a>&quot;x&quot;: 0,
<a id="__codelineno-59-662" name="__codelineno-59-662" href="#__codelineno-59-662"></a>
<a id="__codelineno-59-663" name="__codelineno-59-663" href="#__codelineno-59-663"></a>
<a id="__codelineno-59-664" name="__codelineno-59-664" href="#__codelineno-59-664"></a>
<a id="__codelineno-59-665" name="__codelineno-59-665" href="#__codelineno-59-665"></a>&quot;y&quot;: 2
<a id="__codelineno-59-666" name="__codelineno-59-666" href="#__codelineno-59-666"></a>
<a id="__codelineno-59-667" name="__codelineno-59-667" href="#__codelineno-59-667"></a>
<a id="__codelineno-59-668" name="__codelineno-59-668" href="#__codelineno-59-668"></a>
<a id="__codelineno-59-669" name="__codelineno-59-669" href="#__codelineno-59-669"></a>},
<a id="__codelineno-59-670" name="__codelineno-59-670" href="#__codelineno-59-670"></a>
<a id="__codelineno-59-671" name="__codelineno-59-671" href="#__codelineno-59-671"></a>
<a id="__codelineno-59-672" name="__codelineno-59-672" href="#__codelineno-59-672"></a>
<a id="__codelineno-59-673" name="__codelineno-59-673" href="#__codelineno-59-673"></a>&quot;predecessors&quot;: [
<a id="__codelineno-59-674" name="__codelineno-59-674" href="#__codelineno-59-674"></a>
<a id="__codelineno-59-675" name="__codelineno-59-675" href="#__codelineno-59-675"></a>
<a id="__codelineno-59-676" name="__codelineno-59-676" href="#__codelineno-59-676"></a>
<a id="__codelineno-59-677" name="__codelineno-59-677" href="#__codelineno-59-677"></a>&quot;workflow_config_params&quot;
<a id="__codelineno-59-678" name="__codelineno-59-678" href="#__codelineno-59-678"></a>
<a id="__codelineno-59-679" name="__codelineno-59-679" href="#__codelineno-59-679"></a>
<a id="__codelineno-59-680" name="__codelineno-59-680" href="#__codelineno-59-680"></a>
<a id="__codelineno-59-681" name="__codelineno-59-681" href="#__codelineno-59-681"></a>],
<a id="__codelineno-59-682" name="__codelineno-59-682" href="#__codelineno-59-682"></a>
<a id="__codelineno-59-683" name="__codelineno-59-683" href="#__codelineno-59-683"></a>
<a id="__codelineno-59-684" name="__codelineno-59-684" href="#__codelineno-59-684"></a>
<a id="__codelineno-59-685" name="__codelineno-59-685" href="#__codelineno-59-685"></a>&quot;conditions&quot;: {
<a id="__codelineno-59-686" name="__codelineno-59-686" href="#__codelineno-59-686"></a>
<a id="__codelineno-59-687" name="__codelineno-59-687" href="#__codelineno-59-687"></a>
<a id="__codelineno-59-688" name="__codelineno-59-688" href="#__codelineno-59-688"></a>
<a id="__codelineno-59-689" name="__codelineno-59-689" href="#__codelineno-59-689"></a>&quot;states&quot;: {
<a id="__codelineno-59-690" name="__codelineno-59-690" href="#__codelineno-59-690"></a>
<a id="__codelineno-59-691" name="__codelineno-59-691" href="#__codelineno-59-691"></a>
<a id="__codelineno-59-692" name="__codelineno-59-692" href="#__codelineno-59-692"></a>
<a id="__codelineno-59-693" name="__codelineno-59-693" href="#__codelineno-59-693"></a>&quot;workflow_config_params&quot;: &quot;OK&quot;
<a id="__codelineno-59-694" name="__codelineno-59-694" href="#__codelineno-59-694"></a>
<a id="__codelineno-59-695" name="__codelineno-59-695" href="#__codelineno-59-695"></a>
<a id="__codelineno-59-696" name="__codelineno-59-696" href="#__codelineno-59-696"></a>
<a id="__codelineno-59-697" name="__codelineno-59-697" href="#__codelineno-59-697"></a>}
<a id="__codelineno-59-698" name="__codelineno-59-698" href="#__codelineno-59-698"></a>
<a id="__codelineno-59-699" name="__codelineno-59-699" href="#__codelineno-59-699"></a>
<a id="__codelineno-59-700" name="__codelineno-59-700" href="#__codelineno-59-700"></a>
<a id="__codelineno-59-701" name="__codelineno-59-701" href="#__codelineno-59-701"></a>}
<a id="__codelineno-59-702" name="__codelineno-59-702" href="#__codelineno-59-702"></a>
<a id="__codelineno-59-703" name="__codelineno-59-703" href="#__codelineno-59-703"></a>
<a id="__codelineno-59-704" name="__codelineno-59-704" href="#__codelineno-59-704"></a>
<a id="__codelineno-59-705" name="__codelineno-59-705" href="#__codelineno-59-705"></a>},
<a id="__codelineno-59-706" name="__codelineno-59-706" href="#__codelineno-59-706"></a>
<a id="__codelineno-59-707" name="__codelineno-59-707" href="#__codelineno-59-707"></a>
<a id="__codelineno-59-708" name="__codelineno-59-708" href="#__codelineno-59-708"></a>
<a id="__codelineno-59-709" name="__codelineno-59-709" href="#__codelineno-59-709"></a>&quot;fetch_findings_by_resource&quot;: {
<a id="__codelineno-59-710" name="__codelineno-59-710" href="#__codelineno-59-710"></a>
<a id="__codelineno-59-711" name="__codelineno-59-711" href="#__codelineno-59-711"></a>
<a id="__codelineno-59-712" name="__codelineno-59-712" href="#__codelineno-59-712"></a>
<a id="__codelineno-59-713" name="__codelineno-59-713" href="#__codelineno-59-713"></a>&quot;name&quot;: &quot;fetch_findings_by_resource&quot;,
<a id="__codelineno-59-714" name="__codelineno-59-714" href="#__codelineno-59-714"></a>
<a id="__codelineno-59-715" name="__codelineno-59-715" href="#__codelineno-59-715"></a>
<a id="__codelineno-59-716" name="__codelineno-59-716" href="#__codelineno-59-716"></a>
<a id="__codelineno-59-717" name="__codelineno-59-717" href="#__codelineno-59-717"></a>&quot;description&quot;: &quot;Executes query to get relevant security findings grouped by AWS resource&quot;,
<a id="__codelineno-59-718" name="__codelineno-59-718" href="#__codelineno-59-718"></a>
<a id="__codelineno-59-719" name="__codelineno-59-719" href="#__codelineno-59-719"></a>
<a id="__codelineno-59-720" name="__codelineno-59-720" href="#__codelineno-59-720"></a>
<a id="__codelineno-59-721" name="__codelineno-59-721" href="#__codelineno-59-721"></a>&quot;action&quot;: &quot;dynatrace.automations:execute-dql-query&quot;,
<a id="__codelineno-59-722" name="__codelineno-59-722" href="#__codelineno-59-722"></a>
<a id="__codelineno-59-723" name="__codelineno-59-723" href="#__codelineno-59-723"></a>
<a id="__codelineno-59-724" name="__codelineno-59-724" href="#__codelineno-59-724"></a>
<a id="__codelineno-59-725" name="__codelineno-59-725" href="#__codelineno-59-725"></a>&quot;active&quot;: true,
<a id="__codelineno-59-726" name="__codelineno-59-726" href="#__codelineno-59-726"></a>
<a id="__codelineno-59-727" name="__codelineno-59-727" href="#__codelineno-59-727"></a>
<a id="__codelineno-59-728" name="__codelineno-59-728" href="#__codelineno-59-728"></a>
<a id="__codelineno-59-729" name="__codelineno-59-729" href="#__codelineno-59-729"></a>&quot;input&quot;: {
<a id="__codelineno-59-730" name="__codelineno-59-730" href="#__codelineno-59-730"></a>
<a id="__codelineno-59-731" name="__codelineno-59-731" href="#__codelineno-59-731"></a>
<a id="__codelineno-59-732" name="__codelineno-59-732" href="#__codelineno-59-732"></a>
<a id="__codelineno-59-733" name="__codelineno-59-733" href="#__codelineno-59-733"></a>&quot;query&quot;: &quot;fetch logs, from:now() - 24h, scanLimitGBytes: -1\n| filter aws.log_group == \&quot;/aws/events/AWSSecurityHubLogGroup\&quot;\n| parse content, \&quot;JSON:alert\&quot;\n| fields timestamp,\n         awsRegion = toString(alert[detail][findings][0][Region]),\n         awsAccountId = toString(alert[detail][findings][0][AwsAccountId]),\n         resourceType = toString(alert[detail][findings][0][Resources][0][Type]),          \n         resourceId = toString(alert[detail][findings][0][Resources][0][Id]),\n         alertType = toString(alert[detail][findings][0][Types][0]),\n         id = toString(alert[detail][findings][0][Id]),\n         severity = toString(alert[detail][findings][0][FindingProviderFields][Severity][Label]),\n         title = toString(alert[detail][findings][0][Title]),\n         description = toString(alert[detail][findings][0][Description]),\n         complianceStatus = toString(alert[detail][findings][0][Compliance][Status]),\n         controlId = toString(alert[detail][findings][0][Compliance][SecurityControlId]),\n         remediation = alert[detail][findings][0][Remediation],\n         created = toTimestamp(alert[detail][findings][0][CreatedAt]),\n         lastObservedAt = toTimestamp(alert[detail][findings][0][LastObservedAt])\n| filter in(severity, array(\&quot;HIGH\&quot;, \&quot;CRITICAL\&quot;, \&quot;MEDIUM\&quot;))\n| filter created &gt; now() - 24h\n| filter in(awsAccountId, array(\&quot;{{ result(&#39;workflow_config_params&#39;).awsAccountIds | join(&#39;\&quot;,\&quot;&#39;) }}\&quot;))\n| filter in(controlId, array(\&quot;{{ result(&#39;workflow_config_params&#39;).securityControlIdsToGroupByResource | join(&#39;\&quot;,\&quot;&#39;) }}\&quot;))\n| summarize { count=count(),\n              lastObservedAt = max(lastObservedAt),\n              remediation = collectDistinct(remediation),\n              complianceStatus = takeLast(complianceStatus)\n            },\n            by:{\n              alertType, \n              resourceType, \n              controlId, \n              title,\n              description, \n              severity, \n              resourceId, \n              awsAccountId,\n              created,\n              awsRegion\n           }\n| lookup\n  [ fetch dt.entity.aws_credentials \n    | fields id, awsAccountId, entity.name, tags, awsNameTag\n  ], lookupField:awsAccountId, sourceField:awsAccountId, prefix: \&quot;aws.account.\&quot;\n| fields aws = record(\n            accountId = awsAccountId,\n            name = aws.account.entity.name,\n            entity = aws.account.id\n         ), \n         resource = record(\n           resourceId = resourceId,\n           resourceType = resourceType\n         ),\n         region = awsRegion,\n         alert = record(controlId = controlId, \n           severity = severity, \n           complianceStatus = complianceStatus,\n           title = title,\n           description = description,\n           remediation = remediation\n         )\n| summarize {\n        count=count(),\n        vulnerabilities = collectDistinct(alert)\n      },\n      by:{\n        aws,\n        resource,\n        region\n      }&quot;
<a id="__codelineno-59-734" name="__codelineno-59-734" href="#__codelineno-59-734"></a>
<a id="__codelineno-59-735" name="__codelineno-59-735" href="#__codelineno-59-735"></a>
<a id="__codelineno-59-736" name="__codelineno-59-736" href="#__codelineno-59-736"></a>
<a id="__codelineno-59-737" name="__codelineno-59-737" href="#__codelineno-59-737"></a>},
<a id="__codelineno-59-738" name="__codelineno-59-738" href="#__codelineno-59-738"></a>
<a id="__codelineno-59-739" name="__codelineno-59-739" href="#__codelineno-59-739"></a>
<a id="__codelineno-59-740" name="__codelineno-59-740" href="#__codelineno-59-740"></a>
<a id="__codelineno-59-741" name="__codelineno-59-741" href="#__codelineno-59-741"></a>&quot;position&quot;: {
<a id="__codelineno-59-742" name="__codelineno-59-742" href="#__codelineno-59-742"></a>
<a id="__codelineno-59-743" name="__codelineno-59-743" href="#__codelineno-59-743"></a>
<a id="__codelineno-59-744" name="__codelineno-59-744" href="#__codelineno-59-744"></a>
<a id="__codelineno-59-745" name="__codelineno-59-745" href="#__codelineno-59-745"></a>&quot;x&quot;: 1,
<a id="__codelineno-59-746" name="__codelineno-59-746" href="#__codelineno-59-746"></a>
<a id="__codelineno-59-747" name="__codelineno-59-747" href="#__codelineno-59-747"></a>
<a id="__codelineno-59-748" name="__codelineno-59-748" href="#__codelineno-59-748"></a>
<a id="__codelineno-59-749" name="__codelineno-59-749" href="#__codelineno-59-749"></a>&quot;y&quot;: 2
<a id="__codelineno-59-750" name="__codelineno-59-750" href="#__codelineno-59-750"></a>
<a id="__codelineno-59-751" name="__codelineno-59-751" href="#__codelineno-59-751"></a>
<a id="__codelineno-59-752" name="__codelineno-59-752" href="#__codelineno-59-752"></a>
<a id="__codelineno-59-753" name="__codelineno-59-753" href="#__codelineno-59-753"></a>},
<a id="__codelineno-59-754" name="__codelineno-59-754" href="#__codelineno-59-754"></a>
<a id="__codelineno-59-755" name="__codelineno-59-755" href="#__codelineno-59-755"></a>
<a id="__codelineno-59-756" name="__codelineno-59-756" href="#__codelineno-59-756"></a>
<a id="__codelineno-59-757" name="__codelineno-59-757" href="#__codelineno-59-757"></a>&quot;predecessors&quot;: [
<a id="__codelineno-59-758" name="__codelineno-59-758" href="#__codelineno-59-758"></a>
<a id="__codelineno-59-759" name="__codelineno-59-759" href="#__codelineno-59-759"></a>
<a id="__codelineno-59-760" name="__codelineno-59-760" href="#__codelineno-59-760"></a>
<a id="__codelineno-59-761" name="__codelineno-59-761" href="#__codelineno-59-761"></a>&quot;workflow_config_params&quot;
<a id="__codelineno-59-762" name="__codelineno-59-762" href="#__codelineno-59-762"></a>
<a id="__codelineno-59-763" name="__codelineno-59-763" href="#__codelineno-59-763"></a>
<a id="__codelineno-59-764" name="__codelineno-59-764" href="#__codelineno-59-764"></a>
<a id="__codelineno-59-765" name="__codelineno-59-765" href="#__codelineno-59-765"></a>],
<a id="__codelineno-59-766" name="__codelineno-59-766" href="#__codelineno-59-766"></a>
<a id="__codelineno-59-767" name="__codelineno-59-767" href="#__codelineno-59-767"></a>
<a id="__codelineno-59-768" name="__codelineno-59-768" href="#__codelineno-59-768"></a>
<a id="__codelineno-59-769" name="__codelineno-59-769" href="#__codelineno-59-769"></a>&quot;conditions&quot;: {
<a id="__codelineno-59-770" name="__codelineno-59-770" href="#__codelineno-59-770"></a>
<a id="__codelineno-59-771" name="__codelineno-59-771" href="#__codelineno-59-771"></a>
<a id="__codelineno-59-772" name="__codelineno-59-772" href="#__codelineno-59-772"></a>
<a id="__codelineno-59-773" name="__codelineno-59-773" href="#__codelineno-59-773"></a>&quot;states&quot;: {
<a id="__codelineno-59-774" name="__codelineno-59-774" href="#__codelineno-59-774"></a>
<a id="__codelineno-59-775" name="__codelineno-59-775" href="#__codelineno-59-775"></a>
<a id="__codelineno-59-776" name="__codelineno-59-776" href="#__codelineno-59-776"></a>
<a id="__codelineno-59-777" name="__codelineno-59-777" href="#__codelineno-59-777"></a>&quot;workflow_config_params&quot;: &quot;OK&quot;
<a id="__codelineno-59-778" name="__codelineno-59-778" href="#__codelineno-59-778"></a>
<a id="__codelineno-59-779" name="__codelineno-59-779" href="#__codelineno-59-779"></a>
<a id="__codelineno-59-780" name="__codelineno-59-780" href="#__codelineno-59-780"></a>
<a id="__codelineno-59-781" name="__codelineno-59-781" href="#__codelineno-59-781"></a>}
<a id="__codelineno-59-782" name="__codelineno-59-782" href="#__codelineno-59-782"></a>
<a id="__codelineno-59-783" name="__codelineno-59-783" href="#__codelineno-59-783"></a>
<a id="__codelineno-59-784" name="__codelineno-59-784" href="#__codelineno-59-784"></a>
<a id="__codelineno-59-785" name="__codelineno-59-785" href="#__codelineno-59-785"></a>}
<a id="__codelineno-59-786" name="__codelineno-59-786" href="#__codelineno-59-786"></a>
<a id="__codelineno-59-787" name="__codelineno-59-787" href="#__codelineno-59-787"></a>
<a id="__codelineno-59-788" name="__codelineno-59-788" href="#__codelineno-59-788"></a>
<a id="__codelineno-59-789" name="__codelineno-59-789" href="#__codelineno-59-789"></a>},
<a id="__codelineno-59-790" name="__codelineno-59-790" href="#__codelineno-59-790"></a>
<a id="__codelineno-59-791" name="__codelineno-59-791" href="#__codelineno-59-791"></a>
<a id="__codelineno-59-792" name="__codelineno-59-792" href="#__codelineno-59-792"></a>
<a id="__codelineno-59-793" name="__codelineno-59-793" href="#__codelineno-59-793"></a>&quot;prepare_tickets_by_account&quot;: {
<a id="__codelineno-59-794" name="__codelineno-59-794" href="#__codelineno-59-794"></a>
<a id="__codelineno-59-795" name="__codelineno-59-795" href="#__codelineno-59-795"></a>
<a id="__codelineno-59-796" name="__codelineno-59-796" href="#__codelineno-59-796"></a>
<a id="__codelineno-59-797" name="__codelineno-59-797" href="#__codelineno-59-797"></a>&quot;name&quot;: &quot;prepare_tickets_by_account&quot;,
<a id="__codelineno-59-798" name="__codelineno-59-798" href="#__codelineno-59-798"></a>
<a id="__codelineno-59-799" name="__codelineno-59-799" href="#__codelineno-59-799"></a>
<a id="__codelineno-59-800" name="__codelineno-59-800" href="#__codelineno-59-800"></a>
<a id="__codelineno-59-801" name="__codelineno-59-801" href="#__codelineno-59-801"></a>&quot;description&quot;: &quot;Prepares payload of Jira tickets for vulnerable AWS accounts&quot;,
<a id="__codelineno-59-802" name="__codelineno-59-802" href="#__codelineno-59-802"></a>
<a id="__codelineno-59-803" name="__codelineno-59-803" href="#__codelineno-59-803"></a>
<a id="__codelineno-59-804" name="__codelineno-59-804" href="#__codelineno-59-804"></a>
<a id="__codelineno-59-805" name="__codelineno-59-805" href="#__codelineno-59-805"></a>&quot;action&quot;: &quot;dynatrace.automations:run-javascript&quot;,
<a id="__codelineno-59-806" name="__codelineno-59-806" href="#__codelineno-59-806"></a>
<a id="__codelineno-59-807" name="__codelineno-59-807" href="#__codelineno-59-807"></a>
<a id="__codelineno-59-808" name="__codelineno-59-808" href="#__codelineno-59-808"></a>
<a id="__codelineno-59-809" name="__codelineno-59-809" href="#__codelineno-59-809"></a>&quot;active&quot;: true,
<a id="__codelineno-59-810" name="__codelineno-59-810" href="#__codelineno-59-810"></a>
<a id="__codelineno-59-811" name="__codelineno-59-811" href="#__codelineno-59-811"></a>
<a id="__codelineno-59-812" name="__codelineno-59-812" href="#__codelineno-59-812"></a>
<a id="__codelineno-59-813" name="__codelineno-59-813" href="#__codelineno-59-813"></a>&quot;input&quot;: {
<a id="__codelineno-59-814" name="__codelineno-59-814" href="#__codelineno-59-814"></a>
<a id="__codelineno-59-815" name="__codelineno-59-815" href="#__codelineno-59-815"></a>
<a id="__codelineno-59-816" name="__codelineno-59-816" href="#__codelineno-59-816"></a>
<a id="__codelineno-59-817" name="__codelineno-59-817" href="#__codelineno-59-817"></a>&quot;script&quot;: &quot;import { execution } from &#39;@dynatrace-sdk/automation-utils&#39;;\n\nexport default async function ({ executionId }) {\n    const ex = await execution(executionId);\n    const records = await ex.result(\&quot;log_tickets_by_account\&quot;);\n\n    console.log(`${records.length} Tickets will be created!`)\n    const result = [];\n    for (const finding of records) {\n        console.log(&#39;------------------------------------- NEW TICKET -------------------------------------&#39;)\n        const resourcesList = finding.resources\n          .map( resource =&gt; `|${resource}|` )\n          .join(&#39;\\n&#39;)\n        const ticket =  {\n            summary: `Automatic Vulnerability Report for ${finding.controlId} - AWS Account ${finding.awsAccountId}`,\n            description: &#39;The following vulnerabilities were reported for your resource via AWS Security Hub:\\n\\n&#39;\n              + &#39;*AWS Account*:\\n&#39;\n              + &#39;||AWS Account Id||\\n&#39;\n              +  `|${finding.awsAccountId}|\\n\\n`\n              + &#39;*Vulnerability*:\\n&#39;\n              + &#39;||Id||Sev||Title||Description||Remediation Url||\\n&#39;\n              + `|{noformat}${finding.controlId}{noformat}|{noformat}${finding.severity}{noformat}|${finding.title}|${finding.description}|[${finding.remediation[0].Recommendation.Url}]|\\n\\n`\n              + &#39;*Affected Resources*:\\n&#39;\n              + &#39;||Resource Id||\\n&#39;\n              + resourcesList\n              + &#39;\\n\\n---\\nAutomatically generated by CSPM Notification Automation&#39;\n        }\n        console.log(JSON.stringify(ticket))\n        result.push(ticket)\n    }\n\n    return result;\n}&quot;
<a id="__codelineno-59-818" name="__codelineno-59-818" href="#__codelineno-59-818"></a>
<a id="__codelineno-59-819" name="__codelineno-59-819" href="#__codelineno-59-819"></a>
<a id="__codelineno-59-820" name="__codelineno-59-820" href="#__codelineno-59-820"></a>
<a id="__codelineno-59-821" name="__codelineno-59-821" href="#__codelineno-59-821"></a>},
<a id="__codelineno-59-822" name="__codelineno-59-822" href="#__codelineno-59-822"></a>
<a id="__codelineno-59-823" name="__codelineno-59-823" href="#__codelineno-59-823"></a>
<a id="__codelineno-59-824" name="__codelineno-59-824" href="#__codelineno-59-824"></a>
<a id="__codelineno-59-825" name="__codelineno-59-825" href="#__codelineno-59-825"></a>&quot;position&quot;: {
<a id="__codelineno-59-826" name="__codelineno-59-826" href="#__codelineno-59-826"></a>
<a id="__codelineno-59-827" name="__codelineno-59-827" href="#__codelineno-59-827"></a>
<a id="__codelineno-59-828" name="__codelineno-59-828" href="#__codelineno-59-828"></a>
<a id="__codelineno-59-829" name="__codelineno-59-829" href="#__codelineno-59-829"></a>&quot;x&quot;: 0,
<a id="__codelineno-59-830" name="__codelineno-59-830" href="#__codelineno-59-830"></a>
<a id="__codelineno-59-831" name="__codelineno-59-831" href="#__codelineno-59-831"></a>
<a id="__codelineno-59-832" name="__codelineno-59-832" href="#__codelineno-59-832"></a>
<a id="__codelineno-59-833" name="__codelineno-59-833" href="#__codelineno-59-833"></a>&quot;y&quot;: 4
<a id="__codelineno-59-834" name="__codelineno-59-834" href="#__codelineno-59-834"></a>
<a id="__codelineno-59-835" name="__codelineno-59-835" href="#__codelineno-59-835"></a>
<a id="__codelineno-59-836" name="__codelineno-59-836" href="#__codelineno-59-836"></a>
<a id="__codelineno-59-837" name="__codelineno-59-837" href="#__codelineno-59-837"></a>},
<a id="__codelineno-59-838" name="__codelineno-59-838" href="#__codelineno-59-838"></a>
<a id="__codelineno-59-839" name="__codelineno-59-839" href="#__codelineno-59-839"></a>
<a id="__codelineno-59-840" name="__codelineno-59-840" href="#__codelineno-59-840"></a>
<a id="__codelineno-59-841" name="__codelineno-59-841" href="#__codelineno-59-841"></a>&quot;predecessors&quot;: [
<a id="__codelineno-59-842" name="__codelineno-59-842" href="#__codelineno-59-842"></a>
<a id="__codelineno-59-843" name="__codelineno-59-843" href="#__codelineno-59-843"></a>
<a id="__codelineno-59-844" name="__codelineno-59-844" href="#__codelineno-59-844"></a>
<a id="__codelineno-59-845" name="__codelineno-59-845" href="#__codelineno-59-845"></a>&quot;log_tickets_by_account&quot;
<a id="__codelineno-59-846" name="__codelineno-59-846" href="#__codelineno-59-846"></a>
<a id="__codelineno-59-847" name="__codelineno-59-847" href="#__codelineno-59-847"></a>
<a id="__codelineno-59-848" name="__codelineno-59-848" href="#__codelineno-59-848"></a>
<a id="__codelineno-59-849" name="__codelineno-59-849" href="#__codelineno-59-849"></a>],
<a id="__codelineno-59-850" name="__codelineno-59-850" href="#__codelineno-59-850"></a>
<a id="__codelineno-59-851" name="__codelineno-59-851" href="#__codelineno-59-851"></a>
<a id="__codelineno-59-852" name="__codelineno-59-852" href="#__codelineno-59-852"></a>
<a id="__codelineno-59-853" name="__codelineno-59-853" href="#__codelineno-59-853"></a>&quot;conditions&quot;: {
<a id="__codelineno-59-854" name="__codelineno-59-854" href="#__codelineno-59-854"></a>
<a id="__codelineno-59-855" name="__codelineno-59-855" href="#__codelineno-59-855"></a>
<a id="__codelineno-59-856" name="__codelineno-59-856" href="#__codelineno-59-856"></a>
<a id="__codelineno-59-857" name="__codelineno-59-857" href="#__codelineno-59-857"></a>&quot;states&quot;: {
<a id="__codelineno-59-858" name="__codelineno-59-858" href="#__codelineno-59-858"></a>
<a id="__codelineno-59-859" name="__codelineno-59-859" href="#__codelineno-59-859"></a>
<a id="__codelineno-59-860" name="__codelineno-59-860" href="#__codelineno-59-860"></a>
<a id="__codelineno-59-861" name="__codelineno-59-861" href="#__codelineno-59-861"></a>&quot;log_tickets_by_account&quot;: &quot;OK&quot;
<a id="__codelineno-59-862" name="__codelineno-59-862" href="#__codelineno-59-862"></a>
<a id="__codelineno-59-863" name="__codelineno-59-863" href="#__codelineno-59-863"></a>
<a id="__codelineno-59-864" name="__codelineno-59-864" href="#__codelineno-59-864"></a>
<a id="__codelineno-59-865" name="__codelineno-59-865" href="#__codelineno-59-865"></a>}
<a id="__codelineno-59-866" name="__codelineno-59-866" href="#__codelineno-59-866"></a>
<a id="__codelineno-59-867" name="__codelineno-59-867" href="#__codelineno-59-867"></a>
<a id="__codelineno-59-868" name="__codelineno-59-868" href="#__codelineno-59-868"></a>
<a id="__codelineno-59-869" name="__codelineno-59-869" href="#__codelineno-59-869"></a>}
<a id="__codelineno-59-870" name="__codelineno-59-870" href="#__codelineno-59-870"></a>
<a id="__codelineno-59-871" name="__codelineno-59-871" href="#__codelineno-59-871"></a>
<a id="__codelineno-59-872" name="__codelineno-59-872" href="#__codelineno-59-872"></a>
<a id="__codelineno-59-873" name="__codelineno-59-873" href="#__codelineno-59-873"></a>},
<a id="__codelineno-59-874" name="__codelineno-59-874" href="#__codelineno-59-874"></a>
<a id="__codelineno-59-875" name="__codelineno-59-875" href="#__codelineno-59-875"></a>
<a id="__codelineno-59-876" name="__codelineno-59-876" href="#__codelineno-59-876"></a>
<a id="__codelineno-59-877" name="__codelineno-59-877" href="#__codelineno-59-877"></a>&quot;prepare_tickets_by_resource&quot;: {
<a id="__codelineno-59-878" name="__codelineno-59-878" href="#__codelineno-59-878"></a>
<a id="__codelineno-59-879" name="__codelineno-59-879" href="#__codelineno-59-879"></a>
<a id="__codelineno-59-880" name="__codelineno-59-880" href="#__codelineno-59-880"></a>
<a id="__codelineno-59-881" name="__codelineno-59-881" href="#__codelineno-59-881"></a>&quot;name&quot;: &quot;prepare_tickets_by_resource&quot;,
<a id="__codelineno-59-882" name="__codelineno-59-882" href="#__codelineno-59-882"></a>
<a id="__codelineno-59-883" name="__codelineno-59-883" href="#__codelineno-59-883"></a>
<a id="__codelineno-59-884" name="__codelineno-59-884" href="#__codelineno-59-884"></a>
<a id="__codelineno-59-885" name="__codelineno-59-885" href="#__codelineno-59-885"></a>&quot;description&quot;: &quot;Prepares payload of Jira tickets for vulnerable AWS resources&quot;,
<a id="__codelineno-59-886" name="__codelineno-59-886" href="#__codelineno-59-886"></a>
<a id="__codelineno-59-887" name="__codelineno-59-887" href="#__codelineno-59-887"></a>
<a id="__codelineno-59-888" name="__codelineno-59-888" href="#__codelineno-59-888"></a>
<a id="__codelineno-59-889" name="__codelineno-59-889" href="#__codelineno-59-889"></a>&quot;action&quot;: &quot;dynatrace.automations:run-javascript&quot;,
<a id="__codelineno-59-890" name="__codelineno-59-890" href="#__codelineno-59-890"></a>
<a id="__codelineno-59-891" name="__codelineno-59-891" href="#__codelineno-59-891"></a>
<a id="__codelineno-59-892" name="__codelineno-59-892" href="#__codelineno-59-892"></a>
<a id="__codelineno-59-893" name="__codelineno-59-893" href="#__codelineno-59-893"></a>&quot;active&quot;: true,
<a id="__codelineno-59-894" name="__codelineno-59-894" href="#__codelineno-59-894"></a>
<a id="__codelineno-59-895" name="__codelineno-59-895" href="#__codelineno-59-895"></a>
<a id="__codelineno-59-896" name="__codelineno-59-896" href="#__codelineno-59-896"></a>
<a id="__codelineno-59-897" name="__codelineno-59-897" href="#__codelineno-59-897"></a>&quot;input&quot;: {
<a id="__codelineno-59-898" name="__codelineno-59-898" href="#__codelineno-59-898"></a>
<a id="__codelineno-59-899" name="__codelineno-59-899" href="#__codelineno-59-899"></a>
<a id="__codelineno-59-900" name="__codelineno-59-900" href="#__codelineno-59-900"></a>
<a id="__codelineno-59-901" name="__codelineno-59-901" href="#__codelineno-59-901"></a>&quot;script&quot;: &quot;import { execution } from &#39;@dynatrace-sdk/automation-utils&#39;;\n\nexport default async function ({ executionId }) {\n    const ex = await execution(executionId);\n    const records = await ex.result(\&quot;log_tickets_by_resource\&quot;);\n\n    console.log(`${records.length} Tickets will be created!`)\n    const result = [];\n    for (const finding of records) {\n        console.log(&#39;------------------------------------- NEW TICKET -------------------------------------&#39;)\n        const vulnerabilitiesList = finding.vulnerabilities\n          .map( vuln =&gt; \n            `|{noformat}${vuln.controlId}{noformat}|{noformat}${vuln.severity}{noformat}|${vuln.title}|${vuln.description}|[${vuln.remediation[0].Recommendation.Url}]|`)\n          .join(&#39;\\n&#39;)\n        const ticket =  {\n            summary: `Automatic Vulnerability Report for ${finding.resource.resourceId}`,\n            description: &#39;The following vulnerabilities were reported for your resource via AWS Security Hub:\\n\\n&#39;\n              + &#39;*AWS Account*:\\n&#39;\n              + &#39;||AWS Account Id||\\n&#39;\n              +  `|${finding.aws.accountId}|\\n\\n`\n              + &#39;*Resource Details*:\\n&#39;\n              + &#39;||Resource Type||Resource Id||\\n&#39;\n              + `|${finding.resource.resourceType}|${finding.resource.resourceId}|\\n\\n`\n              + &#39;*Vulnerabilities*:\\n&#39;\n              + &#39;||Id||Sev||Title||Description||Remediation Url||\\n&#39;\n              + vulnerabilitiesList\n              + &#39;\\n\\n---\\nAutomatically generated by CSPM Notification Automation&#39;\n        }\n        console.log(JSON.stringify(ticket))\n        result.push(ticket)\n    }\n\n    return result;\n}&quot;
<a id="__codelineno-59-902" name="__codelineno-59-902" href="#__codelineno-59-902"></a>
<a id="__codelineno-59-903" name="__codelineno-59-903" href="#__codelineno-59-903"></a>
<a id="__codelineno-59-904" name="__codelineno-59-904" href="#__codelineno-59-904"></a>
<a id="__codelineno-59-905" name="__codelineno-59-905" href="#__codelineno-59-905"></a>},
<a id="__codelineno-59-906" name="__codelineno-59-906" href="#__codelineno-59-906"></a>
<a id="__codelineno-59-907" name="__codelineno-59-907" href="#__codelineno-59-907"></a>
<a id="__codelineno-59-908" name="__codelineno-59-908" href="#__codelineno-59-908"></a>
<a id="__codelineno-59-909" name="__codelineno-59-909" href="#__codelineno-59-909"></a>&quot;position&quot;: {
<a id="__codelineno-59-910" name="__codelineno-59-910" href="#__codelineno-59-910"></a>
<a id="__codelineno-59-911" name="__codelineno-59-911" href="#__codelineno-59-911"></a>
<a id="__codelineno-59-912" name="__codelineno-59-912" href="#__codelineno-59-912"></a>
<a id="__codelineno-59-913" name="__codelineno-59-913" href="#__codelineno-59-913"></a>&quot;x&quot;: 1,
<a id="__codelineno-59-914" name="__codelineno-59-914" href="#__codelineno-59-914"></a>
<a id="__codelineno-59-915" name="__codelineno-59-915" href="#__codelineno-59-915"></a>
<a id="__codelineno-59-916" name="__codelineno-59-916" href="#__codelineno-59-916"></a>
<a id="__codelineno-59-917" name="__codelineno-59-917" href="#__codelineno-59-917"></a>&quot;y&quot;: 4
<a id="__codelineno-59-918" name="__codelineno-59-918" href="#__codelineno-59-918"></a>
<a id="__codelineno-59-919" name="__codelineno-59-919" href="#__codelineno-59-919"></a>
<a id="__codelineno-59-920" name="__codelineno-59-920" href="#__codelineno-59-920"></a>
<a id="__codelineno-59-921" name="__codelineno-59-921" href="#__codelineno-59-921"></a>},
<a id="__codelineno-59-922" name="__codelineno-59-922" href="#__codelineno-59-922"></a>
<a id="__codelineno-59-923" name="__codelineno-59-923" href="#__codelineno-59-923"></a>
<a id="__codelineno-59-924" name="__codelineno-59-924" href="#__codelineno-59-924"></a>
<a id="__codelineno-59-925" name="__codelineno-59-925" href="#__codelineno-59-925"></a>&quot;predecessors&quot;: [
<a id="__codelineno-59-926" name="__codelineno-59-926" href="#__codelineno-59-926"></a>
<a id="__codelineno-59-927" name="__codelineno-59-927" href="#__codelineno-59-927"></a>
<a id="__codelineno-59-928" name="__codelineno-59-928" href="#__codelineno-59-928"></a>
<a id="__codelineno-59-929" name="__codelineno-59-929" href="#__codelineno-59-929"></a>&quot;log_tickets_by_resource&quot;
<a id="__codelineno-59-930" name="__codelineno-59-930" href="#__codelineno-59-930"></a>
<a id="__codelineno-59-931" name="__codelineno-59-931" href="#__codelineno-59-931"></a>
<a id="__codelineno-59-932" name="__codelineno-59-932" href="#__codelineno-59-932"></a>
<a id="__codelineno-59-933" name="__codelineno-59-933" href="#__codelineno-59-933"></a>],
<a id="__codelineno-59-934" name="__codelineno-59-934" href="#__codelineno-59-934"></a>
<a id="__codelineno-59-935" name="__codelineno-59-935" href="#__codelineno-59-935"></a>
<a id="__codelineno-59-936" name="__codelineno-59-936" href="#__codelineno-59-936"></a>
<a id="__codelineno-59-937" name="__codelineno-59-937" href="#__codelineno-59-937"></a>&quot;conditions&quot;: {
<a id="__codelineno-59-938" name="__codelineno-59-938" href="#__codelineno-59-938"></a>
<a id="__codelineno-59-939" name="__codelineno-59-939" href="#__codelineno-59-939"></a>
<a id="__codelineno-59-940" name="__codelineno-59-940" href="#__codelineno-59-940"></a>
<a id="__codelineno-59-941" name="__codelineno-59-941" href="#__codelineno-59-941"></a>&quot;states&quot;: {
<a id="__codelineno-59-942" name="__codelineno-59-942" href="#__codelineno-59-942"></a>
<a id="__codelineno-59-943" name="__codelineno-59-943" href="#__codelineno-59-943"></a>
<a id="__codelineno-59-944" name="__codelineno-59-944" href="#__codelineno-59-944"></a>
<a id="__codelineno-59-945" name="__codelineno-59-945" href="#__codelineno-59-945"></a>&quot;log_tickets_by_resource&quot;: &quot;OK&quot;
<a id="__codelineno-59-946" name="__codelineno-59-946" href="#__codelineno-59-946"></a>
<a id="__codelineno-59-947" name="__codelineno-59-947" href="#__codelineno-59-947"></a>
<a id="__codelineno-59-948" name="__codelineno-59-948" href="#__codelineno-59-948"></a>
<a id="__codelineno-59-949" name="__codelineno-59-949" href="#__codelineno-59-949"></a>}
<a id="__codelineno-59-950" name="__codelineno-59-950" href="#__codelineno-59-950"></a>
<a id="__codelineno-59-951" name="__codelineno-59-951" href="#__codelineno-59-951"></a>
<a id="__codelineno-59-952" name="__codelineno-59-952" href="#__codelineno-59-952"></a>
<a id="__codelineno-59-953" name="__codelineno-59-953" href="#__codelineno-59-953"></a>}
<a id="__codelineno-59-954" name="__codelineno-59-954" href="#__codelineno-59-954"></a>
<a id="__codelineno-59-955" name="__codelineno-59-955" href="#__codelineno-59-955"></a>
<a id="__codelineno-59-956" name="__codelineno-59-956" href="#__codelineno-59-956"></a>
<a id="__codelineno-59-957" name="__codelineno-59-957" href="#__codelineno-59-957"></a>}
<a id="__codelineno-59-958" name="__codelineno-59-958" href="#__codelineno-59-958"></a>
<a id="__codelineno-59-959" name="__codelineno-59-959" href="#__codelineno-59-959"></a>
<a id="__codelineno-59-960" name="__codelineno-59-960" href="#__codelineno-59-960"></a>
<a id="__codelineno-59-961" name="__codelineno-59-961" href="#__codelineno-59-961"></a>},
<a id="__codelineno-59-962" name="__codelineno-59-962" href="#__codelineno-59-962"></a>
<a id="__codelineno-59-963" name="__codelineno-59-963" href="#__codelineno-59-963"></a>
<a id="__codelineno-59-964" name="__codelineno-59-964" href="#__codelineno-59-964"></a>
<a id="__codelineno-59-965" name="__codelineno-59-965" href="#__codelineno-59-965"></a>&quot;ownerType&quot;: &quot;USER&quot;,
<a id="__codelineno-59-966" name="__codelineno-59-966" href="#__codelineno-59-966"></a>
<a id="__codelineno-59-967" name="__codelineno-59-967" href="#__codelineno-59-967"></a>
<a id="__codelineno-59-968" name="__codelineno-59-968" href="#__codelineno-59-968"></a>
<a id="__codelineno-59-969" name="__codelineno-59-969" href="#__codelineno-59-969"></a>&quot;isPrivate&quot;: false,
<a id="__codelineno-59-970" name="__codelineno-59-970" href="#__codelineno-59-970"></a>
<a id="__codelineno-59-971" name="__codelineno-59-971" href="#__codelineno-59-971"></a>
<a id="__codelineno-59-972" name="__codelineno-59-972" href="#__codelineno-59-972"></a>
<a id="__codelineno-59-973" name="__codelineno-59-973" href="#__codelineno-59-973"></a>&quot;trigger&quot;: {
<a id="__codelineno-59-974" name="__codelineno-59-974" href="#__codelineno-59-974"></a>
<a id="__codelineno-59-975" name="__codelineno-59-975" href="#__codelineno-59-975"></a>
<a id="__codelineno-59-976" name="__codelineno-59-976" href="#__codelineno-59-976"></a>
<a id="__codelineno-59-977" name="__codelineno-59-977" href="#__codelineno-59-977"></a>&quot;schedule&quot;: {
<a id="__codelineno-59-978" name="__codelineno-59-978" href="#__codelineno-59-978"></a>
<a id="__codelineno-59-979" name="__codelineno-59-979" href="#__codelineno-59-979"></a>
<a id="__codelineno-59-980" name="__codelineno-59-980" href="#__codelineno-59-980"></a>
<a id="__codelineno-59-981" name="__codelineno-59-981" href="#__codelineno-59-981"></a>&quot;rule&quot;: null,
<a id="__codelineno-59-982" name="__codelineno-59-982" href="#__codelineno-59-982"></a>
<a id="__codelineno-59-983" name="__codelineno-59-983" href="#__codelineno-59-983"></a>
<a id="__codelineno-59-984" name="__codelineno-59-984" href="#__codelineno-59-984"></a>
<a id="__codelineno-59-985" name="__codelineno-59-985" href="#__codelineno-59-985"></a>&quot;trigger&quot;: {
<a id="__codelineno-59-986" name="__codelineno-59-986" href="#__codelineno-59-986"></a>
<a id="__codelineno-59-987" name="__codelineno-59-987" href="#__codelineno-59-987"></a>
<a id="__codelineno-59-988" name="__codelineno-59-988" href="#__codelineno-59-988"></a>
<a id="__codelineno-59-989" name="__codelineno-59-989" href="#__codelineno-59-989"></a>&quot;type&quot;: &quot;time&quot;,
<a id="__codelineno-59-990" name="__codelineno-59-990" href="#__codelineno-59-990"></a>
<a id="__codelineno-59-991" name="__codelineno-59-991" href="#__codelineno-59-991"></a>
<a id="__codelineno-59-992" name="__codelineno-59-992" href="#__codelineno-59-992"></a>
<a id="__codelineno-59-993" name="__codelineno-59-993" href="#__codelineno-59-993"></a>&quot;time&quot;: &quot;09:00&quot;
<a id="__codelineno-59-994" name="__codelineno-59-994" href="#__codelineno-59-994"></a>
<a id="__codelineno-59-995" name="__codelineno-59-995" href="#__codelineno-59-995"></a>
<a id="__codelineno-59-996" name="__codelineno-59-996" href="#__codelineno-59-996"></a>
<a id="__codelineno-59-997" name="__codelineno-59-997" href="#__codelineno-59-997"></a>},
<a id="__codelineno-59-998" name="__codelineno-59-998" href="#__codelineno-59-998"></a>
<a id="__codelineno-59-999" name="__codelineno-59-999" href="#__codelineno-59-999"></a>
<a id="__codelineno-59-1000" name="__codelineno-59-1000" href="#__codelineno-59-1000"></a>
<a id="__codelineno-59-1001" name="__codelineno-59-1001" href="#__codelineno-59-1001"></a>&quot;timezone&quot;: &quot;Europe/Berlin&quot;,
<a id="__codelineno-59-1002" name="__codelineno-59-1002" href="#__codelineno-59-1002"></a>
<a id="__codelineno-59-1003" name="__codelineno-59-1003" href="#__codelineno-59-1003"></a>
<a id="__codelineno-59-1004" name="__codelineno-59-1004" href="#__codelineno-59-1004"></a>
<a id="__codelineno-59-1005" name="__codelineno-59-1005" href="#__codelineno-59-1005"></a>&quot;isActive&quot;: true,
<a id="__codelineno-59-1006" name="__codelineno-59-1006" href="#__codelineno-59-1006"></a>
<a id="__codelineno-59-1007" name="__codelineno-59-1007" href="#__codelineno-59-1007"></a>
<a id="__codelineno-59-1008" name="__codelineno-59-1008" href="#__codelineno-59-1008"></a>
<a id="__codelineno-59-1009" name="__codelineno-59-1009" href="#__codelineno-59-1009"></a>&quot;isFaulty&quot;: false,
<a id="__codelineno-59-1010" name="__codelineno-59-1010" href="#__codelineno-59-1010"></a>
<a id="__codelineno-59-1011" name="__codelineno-59-1011" href="#__codelineno-59-1011"></a>
<a id="__codelineno-59-1012" name="__codelineno-59-1012" href="#__codelineno-59-1012"></a>
<a id="__codelineno-59-1013" name="__codelineno-59-1013" href="#__codelineno-59-1013"></a>&quot;nextExecution&quot;: &quot;2023-10-03T07:00:00.000Z&quot;,
<a id="__codelineno-59-1014" name="__codelineno-59-1014" href="#__codelineno-59-1014"></a>
<a id="__codelineno-59-1015" name="__codelineno-59-1015" href="#__codelineno-59-1015"></a>
<a id="__codelineno-59-1016" name="__codelineno-59-1016" href="#__codelineno-59-1016"></a>
<a id="__codelineno-59-1017" name="__codelineno-59-1017" href="#__codelineno-59-1017"></a>&quot;filterParameters&quot;: {
<a id="__codelineno-59-1018" name="__codelineno-59-1018" href="#__codelineno-59-1018"></a>
<a id="__codelineno-59-1019" name="__codelineno-59-1019" href="#__codelineno-59-1019"></a>
<a id="__codelineno-59-1020" name="__codelineno-59-1020" href="#__codelineno-59-1020"></a>
<a id="__codelineno-59-1021" name="__codelineno-59-1021" href="#__codelineno-59-1021"></a>&quot;earliestStart&quot;: &quot;2023-09-25&quot;
<a id="__codelineno-59-1022" name="__codelineno-59-1022" href="#__codelineno-59-1022"></a>
<a id="__codelineno-59-1023" name="__codelineno-59-1023" href="#__codelineno-59-1023"></a>
<a id="__codelineno-59-1024" name="__codelineno-59-1024" href="#__codelineno-59-1024"></a>
<a id="__codelineno-59-1025" name="__codelineno-59-1025" href="#__codelineno-59-1025"></a>},
<a id="__codelineno-59-1026" name="__codelineno-59-1026" href="#__codelineno-59-1026"></a>
<a id="__codelineno-59-1027" name="__codelineno-59-1027" href="#__codelineno-59-1027"></a>
<a id="__codelineno-59-1028" name="__codelineno-59-1028" href="#__codelineno-59-1028"></a>
<a id="__codelineno-59-1029" name="__codelineno-59-1029" href="#__codelineno-59-1029"></a>&quot;inputs&quot;: {}
<a id="__codelineno-59-1030" name="__codelineno-59-1030" href="#__codelineno-59-1030"></a>
<a id="__codelineno-59-1031" name="__codelineno-59-1031" href="#__codelineno-59-1031"></a>
<a id="__codelineno-59-1032" name="__codelineno-59-1032" href="#__codelineno-59-1032"></a>
<a id="__codelineno-59-1033" name="__codelineno-59-1033" href="#__codelineno-59-1033"></a>}
<a id="__codelineno-59-1034" name="__codelineno-59-1034" href="#__codelineno-59-1034"></a>
<a id="__codelineno-59-1035" name="__codelineno-59-1035" href="#__codelineno-59-1035"></a>
<a id="__codelineno-59-1036" name="__codelineno-59-1036" href="#__codelineno-59-1036"></a>
<a id="__codelineno-59-1037" name="__codelineno-59-1037" href="#__codelineno-59-1037"></a>},
<a id="__codelineno-59-1038" name="__codelineno-59-1038" href="#__codelineno-59-1038"></a>
<a id="__codelineno-59-1039" name="__codelineno-59-1039" href="#__codelineno-59-1039"></a>
<a id="__codelineno-59-1040" name="__codelineno-59-1040" href="#__codelineno-59-1040"></a>
<a id="__codelineno-59-1041" name="__codelineno-59-1041" href="#__codelineno-59-1041"></a>&quot;schemaVersion&quot;: 3
<a id="__codelineno-59-1042" name="__codelineno-59-1042" href="#__codelineno-59-1042"></a>
<a id="__codelineno-59-1043" name="__codelineno-59-1043" href="#__codelineno-59-1043"></a>
<a id="__codelineno-59-1044" name="__codelineno-59-1044" href="#__codelineno-59-1044"></a>
<a id="__codelineno-59-1045" name="__codelineno-59-1045" href="#__codelineno-59-1045"></a>}
</code></pre></div>
2. In <img alt="Workflows" src="https://dt-cdn.net/images/workflows-1024-b5708f3cf9.webp" title="Workflows" /> <strong>Workflows</strong>, select <strong>Upload</strong> and upload the file.</p>
<ol>
<li>Set the time</li>
</ol>
<p><strong>Fixed time trigger</strong>: Sets the time when you want the workflow to run (in the current case, the workflow runs every day at 9:00 AM). See <a href="/docs/analyze-explore-automate/workflows/trigger/schedules" title="Guide to creating workflow automation schedule triggers in Dynatrace Workflows.">Schedule workflows</a> for more information on scheduling a workflow.</p>
<p>Show me the relevant workflow task</p>
<p><img alt="Set the time in CSPM workflow " src="https://dt-cdn.net/images/441c8585-ef4b-4272-b62a-872410b504c7-896-79b6452375.png" /></p>
<ol>
<li>Define parameters</li>
</ol>
<p><strong>Workflow config params</strong>: Determines what findings you want to filter for. In the current scenario, the team wants to</p>
<ul>
<li>
<p>Receive notifications only about findings from important AWS accounts while discarding those from other accounts, such as environments that aren't in production.</p>
</li>
<li>
<p>Under <code>awsAccountIds</code>, select which AWS accounts you want to get findings for.</p>
</li>
<li>
<p>Group findings for specific <a href="https://dt-url.net/nx8393z">security control IDs√Ø¬ª¬ø</a> into one ticket per AWS account.</p>
</li>
<li>
<p>Under <code>securityControlIdsToGroupByAccount</code>, select which security control IDs you want to group by AWS account.</p>
</li>
<li>
<p>Group findings for specific security control IDs into one ticket per AWS resource.</p>
</li>
<li>
<p>Under <code>securityControlIdsToGroupByResource</code>, select which security control IDs you want to group by AWS resource.</p>
</li>
</ul>
<p>Show me the relevant workflow task</p>
<p><img alt="Define parameters in CSMP workflow" src="https://dt-cdn.net/images/441c8585-ef4b-4272-b62a-872410b504c7-896-711174cd7e.png" /></p>
<ol>
<li>Orchestrate findings</li>
</ol>
<p>By AWS account</p>
<p>By AWS resource</p>
<p>The following task sequence orchestrates grouping and converting the resulting findings into one ticket per AWS account.</p>
<ol>
<li>
<p><strong>Fetch findings by account</strong>: Executes the <a href="/docs/platform/grail/dynatrace-query-language/dql-guide" title="Find out how DQL works and what are DQL key concepts.">DQL query</a> that fetches the findings. Some of the information fetched for the current case, to be displayed in Jira, includes</p>
</li>
<li>
<p>Number of findings for the respective account</p>
</li>
<li>Issue title, including the security control IDs and the AWS account name</li>
<li>Short description of the vulnerabilities</li>
<li>Link to AWS for how to remediate the vulnerabilities</li>
<li>List of affected AWS resources</li>
<li><strong>Log tickets by account</strong>: Shows a ticket's potential content before one is automatically created. This step ensures that your configuration is correct. For details, see <a href="#test">Plot statistics before creating tickets</a>.</li>
<li><strong>Prepare tickets by account</strong>: Configures the payload for the Jira ticket.</li>
<li><strong>Create issues for account</strong>: Integrates with your Jira connection. In <strong>Input</strong>, select your Jira connection created in <a href="#dt">Prerequisites</a> and enter the desired parameters of the Jira ticket.</li>
</ol>
<p>Show me the relevant workflow task sequence</p>
<p><img alt="Group findings by AWS account" src="https://dt-cdn.net/images/441c8585-ef4b-4272-b62a-872410b504c7-896-e9069605d2.png" /></p>
<p>The following task sequence orchestrates grouping and converting the resulting findings into one ticket per AWS resource.</p>
<ol>
<li>
<p><strong>Fetch findings by resource</strong>: Executes the <a href="/docs/platform/grail/dynatrace-query-language/dql-guide" title="Find out how DQL works and what are DQL key concepts.">DQL query</a> that fetches the findings. Some of the information fetched for the current case, to be displayed in Jira, includes</p>
</li>
<li>
<p>Number of findings for the respective resource</p>
</li>
<li>Issue title, including the security control IDs and the AWS resource name</li>
<li>AWS account name of the respective resource</li>
<li>Resource details</li>
<li>Short description of the vulnerabilities</li>
<li>Link to AWS for how to remediate the vulnerabilities</li>
<li><strong>Log tickets by resource</strong>: Shows a ticket's potential content before one is automatically created. This step ensures that your configuration is correct. For details, see <a href="#test">Plot statistics before creating tickets</a>.</li>
<li><strong>Prepare tickets by resource</strong>: Configures the payload for the Jira ticket.</li>
<li><strong>Create issues for resource</strong>: Integrates with your Jira connection. In <strong>Input</strong>, select your Jira connection created in <a href="#dt">Prerequisites</a> and enter the desired parameters of the Jira ticket.</li>
</ol>
<p>Show me the relevant workflow task sequence</p>
<p><img alt="Group findings by AWS resource" src="https://dt-cdn.net/images/441c8585-ef4b-4272-b62a-872410b504c7-896-e30cc64df3.png" /></p>
<ol>
<li>Display statistics</li>
</ol>
<p>The following task sequence displays a count of the new findings since the last workflow run.</p>
<ol>
<li><strong>Count all new findings</strong>: Executes the DQL query that fetches the number of findings created by AWS Security Hub in the last 24 hours.</li>
<li><strong>Log new findings count</strong>: Displays the query result.</li>
</ol>
<p>Show me the relevant workflow task sequence</p>
<p><img alt="Display stats in CSPM workflow" src="https://dt-cdn.net/images/441c8585-ef4b-4272-b62a-872410b504c7-896-ac3fc24771.png" /></p>
<p>Once you're done configuring the workflow, select <strong>Save</strong>.</p>
<h3 id="plot-statistics-before-creating-tickets">Plot statistics before creating tickets<a class="headerlink" href="#plot-statistics-before-creating-tickets" title="Permanent link">&para;</a></h3>
<p>To test your configuration before sending Jira tickets</p>
<ol>
<li>Disable the <strong>Prepare tickets by account/resource</strong> and <strong>Create issues for account/resource</strong> tasks.</li>
</ol>
<p>Show me the relevant workflow task sequences</p>
<p><img alt="Disable tasks for creating notifications " src="https://dt-cdn.net/images/441c8585-ef4b-4272-b62a-872410b504c7-896-ef757cb613.png" /></p>
<p>For instructions on disabling a task, see <a href="/docs/analyze-explore-automate/workflows/building#disable-enable" title="Create and edit workflows in Dynatrace Workflows.">Disable or enable a task</a>.</p>
<ol>
<li>Run the workflow or execute individual tasks for which you want to check the output. For instructions, see <a href="/docs/analyze-explore-automate/workflows/running" title="Run and monitor workflows created in Dynatrace Workflows.">Run and monitor workflows</a>.</li>
</ol>
<h2 id="smart-security">Smart security<a class="headerlink" href="#smart-security" title="Permanent link">&para;</a></h2>
<p>Congratulations! You√¢¬Ä¬ôve now set up an automation that empowers your security team. With Dynatrace CSPM Notification Automation, critical events are streamlined, alert fatigue is minimized, and cloud security is enhanced. Efficiency unleashed!</p>
<h2 id="further-resources">Further resources<a class="headerlink" href="#further-resources" title="Permanent link">&para;</a></h2>
<p>The following is a tutorial by the internal customer of Dynatrace CSPM Notification Automation.</p>
<p>CSPM Notification Automation with Dynatrace</p>
<hr />
<h2 id="source-runtime-contextualization-of-container-findingsmd">Source: runtime-contextualization-of-container-findings.md<a class="headerlink" href="#source-runtime-contextualization-of-container-findingsmd" title="Permanent link">&para;</a></h2>
<hr />
<p>title: Runtime contextualization of container findings
source: https://www.dynatrace.com/docs/secure/use-cases/runtime-contextualization-of-container-findings
scraped: 2026-02-17T04:59:04.504947</p>
<hr />
<h1 id="runtime-contextualization-of-container-findings">Runtime contextualization of container findings<a class="headerlink" href="#runtime-contextualization-of-container-findings" title="Permanent link">&para;</a></h1>
<h1 id="runtime-contextualization-of-container-findings_1">Runtime contextualization of container findings<a class="headerlink" href="#runtime-contextualization-of-container-findings_1" title="Permanent link">&para;</a></h1>
<ul>
<li>Latest Dynatrace</li>
<li>Tutorial</li>
<li>Updated on Sep 30, 2025</li>
</ul>
<p>Container image scanning is usually performed in artifact repositories, such as <a href="https://dt-url.net/mu03pcw">AWS Elastic Container Registry (ECR)√Ø¬ª¬ø</a>, <a href="https://dt-url.net/9g03udo">GCP Artifact Registry√Ø¬ª¬ø</a>, and <a href="https://dt-url.net/mn23u20">Microsoft Azure Container Registry√Ø¬ª¬ø</a>. After the images are deployed in production, continuous reassessing of the container images is essential to ensure they're not affected by emerging critical vulnerabilities.</p>
<p>The number of vulnerability findings grows with the number of stored container images, and the development team might become overwhelmed by the number of critical findings. Some of the container images will never be deployed to your production environment. They might be part of your test environments or become obsolete and lay in the repository as a legacy.</p>
<p>In this context, Dynatrace helps you</p>
<ul>
<li>Reduce alert fatigue</li>
<li>Focus remediation efforts on the critical vulnerability findings that significantly impact your production applications</li>
</ul>
<p><img alt="overview of vulnerability alert reduction" src="https://dt-cdn.net/images/final-final-v3-last-final-teo-500-f2e05b1ca1.png" /></p>
<h2 id="target-audience_11">Target audience<a class="headerlink" href="#target-audience_11" title="Permanent link">&para;</a></h2>
<p>Site reliability engineers (SREs) and application owners who want to maintain the security hygiene and health of their applications.</p>
<h2 id="scenario_5">Scenario<a class="headerlink" href="#scenario_5" title="Permanent link">&para;</a></h2>
<ul>
<li>The development team stores container images in Amazon ECR. Later on, those images are deployed into staging and production environments running on Kubernetes.</li>
<li>You monitor the health of your applications with Dynatrace OneAgent in Kubernetes.</li>
<li>Several new critical vulnerabilities have been discovered recently by Amazon ECR in the container images.</li>
</ul>
<h3 id="request_2">Request<a class="headerlink" href="#request_2" title="Permanent link">&para;</a></h3>
<ul>
<li>Triage critical vulnerabilities and assess the situation automatically.</li>
<li>Automatically create tickets and notifications for emerging critical vulnerabilities that threaten your production application.</li>
</ul>
<h3 id="goal_1">Goal<a class="headerlink" href="#goal_1" title="Permanent link">&para;</a></h3>
<p>Avoid critical vulnerability exposure in production applications on containers with vulnerable container images.</p>
<h3 id="result_2">Result<a class="headerlink" href="#result_2" title="Permanent link">&para;</a></h3>
<p>Our solution allows you to</p>
<ul>
<li>Filter for critical findings in production applications on containers with vulnerable container images</li>
<li>Create notification automation workflows based on those findings</li>
</ul>
<h2 id="prerequisites_12">Prerequisites<a class="headerlink" href="#prerequisites_12" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="/docs/ingest-from/setup-on-k8s/deployment/other/classic-full-stack" title="Deploy Dynatrace Operator in classic full-stack mode to Kubernetes">Set up Kubernetes observability with Dynatrace Operator</a></li>
<li><a href="/docs/secure/threat-observability/security-events-ingest/ingest-aws-ecr-data" title="Ingest Amazon ECR container image vulnerability findings and scan events and analyze them in Dynatrace.">Ingest Amazon ECR vulnerability findings and scan events</a></li>
<li><a href="/docs/deliver/release-monitoring/version-detection-strategies" title="Metadata for version detection in different technologies">Use Dynatrace release product/stage tags</a> for your containers</li>
</ul>
<h2 id="get-started_10">Get started<a class="headerlink" href="#get-started_10" title="Permanent link">&para;</a></h2>
<ol>
<li>Visualize</li>
</ol>
<p>To view the summarized and unified list of recent vulnerability findings ingested from Amazon ECR</p>
<ol>
<li>Open <a href="/docs/analyze-explore-automate/dashboards-and-notebooks/dashboards-new" title="Create interactive, customizable views to visualize, analyze, and share your observability data in real time."><img alt="Dashboards" src="https://dt-cdn.net/images/dashboards-512-b1f1e9690b.png" title="Dashboards" /> <strong>Dashboards</strong></a> and go to <strong>Ready-made</strong>.</li>
<li>Search for and select <strong>Container Vulnerability Findings</strong> for the Amazon ECR integration.</li>
</ol>
<p>Example dashboard:</p>
<p><img alt="dashboard sample for container vulnerabilities" src="https://dt-cdn.net/images/new-dashboard-4308-b95f9d6ec2.png" /></p>
<ol>
<li>
<p>Filter</p>
</li>
<li>
<p>Filter for <code>RuntimeStatus</code> to display contextualized findings affecting your runtime containers.</p>
</li>
</ol>
<p><img alt="runtime status filter" src="https://dt-cdn.net/images/2024-11-04-10-10-45-1835-6e0d130070.png" />
2. Filter for <code>ProductStage</code> to display contextualized findings affecting your production services and applications.</p>
<p><img alt="product stage filter" src="https://dt-cdn.net/images/2024-11-04-10-12-42-1829-24210337bc.png" /></p>
<ol>
<li>Automate</li>
</ol>
<p>You can adjust our automation workflow samples to enrich and filter external container image vulnerability findings for runtime context. For details, see <a href="/docs/secure/use-cases/automate-and-orchestrate-security-findings" title="Regularly check for critical security findings and get automatic Jira tickets or Slack alerts.">Automate and orchestrate security findings</a>.</p>
<p>Example query to get new critical container image vulnerabilities with a list of the affected container images and running containers:</p>
<p>This query has been updated to align with the new Grail security events table. For the complete list of updates and actions needed to accomplish the migration, follow the steps in the <a href="/docs/secure/threat-observability/migration" title="Understand the changes in the new Grail security table and learn how to migrate to it.">Grail security table migration guide</a>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-60-1" name="__codelineno-60-1" href="#__codelineno-60-1"></a>// The query has a rolling window of 7 days and the last 24hrs.
<a id="__codelineno-60-2" name="__codelineno-60-2" href="#__codelineno-60-2"></a>
<a id="__codelineno-60-3" name="__codelineno-60-3" href="#__codelineno-60-3"></a>
<a id="__codelineno-60-4" name="__codelineno-60-4" href="#__codelineno-60-4"></a>
<a id="__codelineno-60-5" name="__codelineno-60-5" href="#__codelineno-60-5"></a>// Vulnerability finding events which have already been reported
<a id="__codelineno-60-6" name="__codelineno-60-6" href="#__codelineno-60-6"></a>
<a id="__codelineno-60-7" name="__codelineno-60-7" href="#__codelineno-60-7"></a>
<a id="__codelineno-60-8" name="__codelineno-60-8" href="#__codelineno-60-8"></a>
<a id="__codelineno-60-9" name="__codelineno-60-9" href="#__codelineno-60-9"></a>// before the current 24hr window will not be reported again.
<a id="__codelineno-60-10" name="__codelineno-60-10" href="#__codelineno-60-10"></a>
<a id="__codelineno-60-11" name="__codelineno-60-11" href="#__codelineno-60-11"></a>
<a id="__codelineno-60-12" name="__codelineno-60-12" href="#__codelineno-60-12"></a>
<a id="__codelineno-60-13" name="__codelineno-60-13" href="#__codelineno-60-13"></a>fetch security.events, from: now() - 7d
<a id="__codelineno-60-14" name="__codelineno-60-14" href="#__codelineno-60-14"></a>
<a id="__codelineno-60-15" name="__codelineno-60-15" href="#__codelineno-60-15"></a>
<a id="__codelineno-60-16" name="__codelineno-60-16" href="#__codelineno-60-16"></a>
<a id="__codelineno-60-17" name="__codelineno-60-17" href="#__codelineno-60-17"></a>| filter dt.system.bucket == &quot;default_securityevents&quot;
<a id="__codelineno-60-18" name="__codelineno-60-18" href="#__codelineno-60-18"></a>
<a id="__codelineno-60-19" name="__codelineno-60-19" href="#__codelineno-60-19"></a>
<a id="__codelineno-60-20" name="__codelineno-60-20" href="#__codelineno-60-20"></a>
<a id="__codelineno-60-21" name="__codelineno-60-21" href="#__codelineno-60-21"></a>AND object.type == &quot;CONTAINER_IMAGE&quot;
<a id="__codelineno-60-22" name="__codelineno-60-22" href="#__codelineno-60-22"></a>
<a id="__codelineno-60-23" name="__codelineno-60-23" href="#__codelineno-60-23"></a>
<a id="__codelineno-60-24" name="__codelineno-60-24" href="#__codelineno-60-24"></a>
<a id="__codelineno-60-25" name="__codelineno-60-25" href="#__codelineno-60-25"></a>AND event.type == &quot;VULNERABILITY_FINDING&quot;
<a id="__codelineno-60-26" name="__codelineno-60-26" href="#__codelineno-60-26"></a>
<a id="__codelineno-60-27" name="__codelineno-60-27" href="#__codelineno-60-27"></a>
<a id="__codelineno-60-28" name="__codelineno-60-28" href="#__codelineno-60-28"></a>
<a id="__codelineno-60-29" name="__codelineno-60-29" href="#__codelineno-60-29"></a>AND dt.security.risk.level == &quot;CRITICAL&quot;
<a id="__codelineno-60-30" name="__codelineno-60-30" href="#__codelineno-60-30"></a>
<a id="__codelineno-60-31" name="__codelineno-60-31" href="#__codelineno-60-31"></a>
<a id="__codelineno-60-32" name="__codelineno-60-32" href="#__codelineno-60-32"></a>
<a id="__codelineno-60-33" name="__codelineno-60-33" href="#__codelineno-60-33"></a>// now enrich the runtime context
<a id="__codelineno-60-34" name="__codelineno-60-34" href="#__codelineno-60-34"></a>
<a id="__codelineno-60-35" name="__codelineno-60-35" href="#__codelineno-60-35"></a>
<a id="__codelineno-60-36" name="__codelineno-60-36" href="#__codelineno-60-36"></a>
<a id="__codelineno-60-37" name="__codelineno-60-37" href="#__codelineno-60-37"></a>| join [
<a id="__codelineno-60-38" name="__codelineno-60-38" href="#__codelineno-60-38"></a>
<a id="__codelineno-60-39" name="__codelineno-60-39" href="#__codelineno-60-39"></a>
<a id="__codelineno-60-40" name="__codelineno-60-40" href="#__codelineno-60-40"></a>
<a id="__codelineno-60-41" name="__codelineno-60-41" href="#__codelineno-60-41"></a>fetch dt.entity.container_group_instance, from:now()-3h
<a id="__codelineno-60-42" name="__codelineno-60-42" href="#__codelineno-60-42"></a>
<a id="__codelineno-60-43" name="__codelineno-60-43" href="#__codelineno-60-43"></a>
<a id="__codelineno-60-44" name="__codelineno-60-44" href="#__codelineno-60-44"></a>
<a id="__codelineno-60-45" name="__codelineno-60-45" href="#__codelineno-60-45"></a>| fieldsAdd entity.name, containerImageDigest, containerImageName, workloadName, containerStatus, processes=contains[dt.entity.process_group_instance]
<a id="__codelineno-60-46" name="__codelineno-60-46" href="#__codelineno-60-46"></a>
<a id="__codelineno-60-47" name="__codelineno-60-47" href="#__codelineno-60-47"></a>
<a id="__codelineno-60-48" name="__codelineno-60-48" href="#__codelineno-60-48"></a>
<a id="__codelineno-60-49" name="__codelineno-60-49" href="#__codelineno-60-49"></a>| expand dt.entity.process=processes
<a id="__codelineno-60-50" name="__codelineno-60-50" href="#__codelineno-60-50"></a>
<a id="__codelineno-60-51" name="__codelineno-60-51" href="#__codelineno-60-51"></a>
<a id="__codelineno-60-52" name="__codelineno-60-52" href="#__codelineno-60-52"></a>
<a id="__codelineno-60-53" name="__codelineno-60-53" href="#__codelineno-60-53"></a>| fieldsRemove processes
<a id="__codelineno-60-54" name="__codelineno-60-54" href="#__codelineno-60-54"></a>
<a id="__codelineno-60-55" name="__codelineno-60-55" href="#__codelineno-60-55"></a>
<a id="__codelineno-60-56" name="__codelineno-60-56" href="#__codelineno-60-56"></a>
<a id="__codelineno-60-57" name="__codelineno-60-57" href="#__codelineno-60-57"></a>| join [
<a id="__codelineno-60-58" name="__codelineno-60-58" href="#__codelineno-60-58"></a>
<a id="__codelineno-60-59" name="__codelineno-60-59" href="#__codelineno-60-59"></a>
<a id="__codelineno-60-60" name="__codelineno-60-60" href="#__codelineno-60-60"></a>
<a id="__codelineno-60-61" name="__codelineno-60-61" href="#__codelineno-60-61"></a>fetch dt.entity.process_group_instance, from:now()-3h
<a id="__codelineno-60-62" name="__codelineno-60-62" href="#__codelineno-60-62"></a>
<a id="__codelineno-60-63" name="__codelineno-60-63" href="#__codelineno-60-63"></a>
<a id="__codelineno-60-64" name="__codelineno-60-64" href="#__codelineno-60-64"></a>
<a id="__codelineno-60-65" name="__codelineno-60-65" href="#__codelineno-60-65"></a>], on:{left[dt.entity.process]==right[id]}, kind:leftOuter, fields:{releasesProduct, releasesStage}
<a id="__codelineno-60-66" name="__codelineno-60-66" href="#__codelineno-60-66"></a>
<a id="__codelineno-60-67" name="__codelineno-60-67" href="#__codelineno-60-67"></a>
<a id="__codelineno-60-68" name="__codelineno-60-68" href="#__codelineno-60-68"></a>
<a id="__codelineno-60-69" name="__codelineno-60-69" href="#__codelineno-60-69"></a>], on:{left[container_image.digest]==right[containerImageDigest]}, kind:leftOuter,
<a id="__codelineno-60-70" name="__codelineno-60-70" href="#__codelineno-60-70"></a>
<a id="__codelineno-60-71" name="__codelineno-60-71" href="#__codelineno-60-71"></a>
<a id="__codelineno-60-72" name="__codelineno-60-72" href="#__codelineno-60-72"></a>
<a id="__codelineno-60-73" name="__codelineno-60-73" href="#__codelineno-60-73"></a>fields:{container_instance.id=id, container_instance.name=entity.name, container_image.name=containerImageName,
<a id="__codelineno-60-74" name="__codelineno-60-74" href="#__codelineno-60-74"></a>
<a id="__codelineno-60-75" name="__codelineno-60-75" href="#__codelineno-60-75"></a>
<a id="__codelineno-60-76" name="__codelineno-60-76" href="#__codelineno-60-76"></a>
<a id="__codelineno-60-77" name="__codelineno-60-77" href="#__codelineno-60-77"></a>releasesProduct, releasesStage, containerStatus}
<a id="__codelineno-60-78" name="__codelineno-60-78" href="#__codelineno-60-78"></a>
<a id="__codelineno-60-79" name="__codelineno-60-79" href="#__codelineno-60-79"></a>
<a id="__codelineno-60-80" name="__codelineno-60-80" href="#__codelineno-60-80"></a>
<a id="__codelineno-60-81" name="__codelineno-60-81" href="#__codelineno-60-81"></a>// summarize and filter
<a id="__codelineno-60-82" name="__codelineno-60-82" href="#__codelineno-60-82"></a>
<a id="__codelineno-60-83" name="__codelineno-60-83" href="#__codelineno-60-83"></a>
<a id="__codelineno-60-84" name="__codelineno-60-84" href="#__codelineno-60-84"></a>
<a id="__codelineno-60-85" name="__codelineno-60-85" href="#__codelineno-60-85"></a>| dedup {object.id, vulnerability.id, component.name, component.version,
<a id="__codelineno-60-86" name="__codelineno-60-86" href="#__codelineno-60-86"></a>
<a id="__codelineno-60-87" name="__codelineno-60-87" href="#__codelineno-60-87"></a>
<a id="__codelineno-60-88" name="__codelineno-60-88" href="#__codelineno-60-88"></a>
<a id="__codelineno-60-89" name="__codelineno-60-89" href="#__codelineno-60-89"></a>container_image.registry, container_image.repository}, sort: {timestamp desc}
<a id="__codelineno-60-90" name="__codelineno-60-90" href="#__codelineno-60-90"></a>
<a id="__codelineno-60-91" name="__codelineno-60-91" href="#__codelineno-60-91"></a>
<a id="__codelineno-60-92" name="__codelineno-60-92" href="#__codelineno-60-92"></a>
<a id="__codelineno-60-93" name="__codelineno-60-93" href="#__codelineno-60-93"></a>| parse containerStatus, &quot;&quot;&quot;LD* &quot;state=&quot; LD:containerStatus (&quot;}&quot; | &quot;,&quot;)&quot;&quot;&quot;
<a id="__codelineno-60-94" name="__codelineno-60-94" href="#__codelineno-60-94"></a>
<a id="__codelineno-60-95" name="__codelineno-60-95" href="#__codelineno-60-95"></a>
<a id="__codelineno-60-96" name="__codelineno-60-96" href="#__codelineno-60-96"></a>
<a id="__codelineno-60-97" name="__codelineno-60-97" href="#__codelineno-60-97"></a>| fieldsAdd containerStatus=if(isNull(containerStatus),&quot;not running&quot;,else:containerStatus)
<a id="__codelineno-60-98" name="__codelineno-60-98" href="#__codelineno-60-98"></a>
<a id="__codelineno-60-99" name="__codelineno-60-99" href="#__codelineno-60-99"></a>
<a id="__codelineno-60-100" name="__codelineno-60-100" href="#__codelineno-60-100"></a>
<a id="__codelineno-60-101" name="__codelineno-60-101" href="#__codelineno-60-101"></a>| fieldsAdd releasesStage=if(isNull(releasesStage), &quot;None&quot;, else:releasesStage)
<a id="__codelineno-60-102" name="__codelineno-60-102" href="#__codelineno-60-102"></a>
<a id="__codelineno-60-103" name="__codelineno-60-103" href="#__codelineno-60-103"></a>
<a id="__codelineno-60-104" name="__codelineno-60-104" href="#__codelineno-60-104"></a>
<a id="__codelineno-60-105" name="__codelineno-60-105" href="#__codelineno-60-105"></a>| filter containerStatus==&quot;running&quot; AND releasesStage==&quot;production&quot;
<a id="__codelineno-60-106" name="__codelineno-60-106" href="#__codelineno-60-106"></a>
<a id="__codelineno-60-107" name="__codelineno-60-107" href="#__codelineno-60-107"></a>
<a id="__codelineno-60-108" name="__codelineno-60-108" href="#__codelineno-60-108"></a>
<a id="__codelineno-60-109" name="__codelineno-60-109" href="#__codelineno-60-109"></a>// Aggregate vulnerability findings per vulnerability, repository,
<a id="__codelineno-60-110" name="__codelineno-60-110" href="#__codelineno-60-110"></a>
<a id="__codelineno-60-111" name="__codelineno-60-111" href="#__codelineno-60-111"></a>
<a id="__codelineno-60-112" name="__codelineno-60-112" href="#__codelineno-60-112"></a>
<a id="__codelineno-60-113" name="__codelineno-60-113" href="#__codelineno-60-113"></a>// component and component version.
<a id="__codelineno-60-114" name="__codelineno-60-114" href="#__codelineno-60-114"></a>
<a id="__codelineno-60-115" name="__codelineno-60-115" href="#__codelineno-60-115"></a>
<a id="__codelineno-60-116" name="__codelineno-60-116" href="#__codelineno-60-116"></a>
<a id="__codelineno-60-117" name="__codelineno-60-117" href="#__codelineno-60-117"></a>| summarize {
<a id="__codelineno-60-118" name="__codelineno-60-118" href="#__codelineno-60-118"></a>
<a id="__codelineno-60-119" name="__codelineno-60-119" href="#__codelineno-60-119"></a>
<a id="__codelineno-60-120" name="__codelineno-60-120" href="#__codelineno-60-120"></a>
<a id="__codelineno-60-121" name="__codelineno-60-121" href="#__codelineno-60-121"></a>affected_images_count = count(),
<a id="__codelineno-60-122" name="__codelineno-60-122" href="#__codelineno-60-122"></a>
<a id="__codelineno-60-123" name="__codelineno-60-123" href="#__codelineno-60-123"></a>
<a id="__codelineno-60-124" name="__codelineno-60-124" href="#__codelineno-60-124"></a>
<a id="__codelineno-60-125" name="__codelineno-60-125" href="#__codelineno-60-125"></a>vulnerability_finding_events = collectArray(
<a id="__codelineno-60-126" name="__codelineno-60-126" href="#__codelineno-60-126"></a>
<a id="__codelineno-60-127" name="__codelineno-60-127" href="#__codelineno-60-127"></a>
<a id="__codelineno-60-128" name="__codelineno-60-128" href="#__codelineno-60-128"></a>
<a id="__codelineno-60-129" name="__codelineno-60-129" href="#__codelineno-60-129"></a>record(
<a id="__codelineno-60-130" name="__codelineno-60-130" href="#__codelineno-60-130"></a>
<a id="__codelineno-60-131" name="__codelineno-60-131" href="#__codelineno-60-131"></a>
<a id="__codelineno-60-132" name="__codelineno-60-132" href="#__codelineno-60-132"></a>
<a id="__codelineno-60-133" name="__codelineno-60-133" href="#__codelineno-60-133"></a>object.id = object.id,
<a id="__codelineno-60-134" name="__codelineno-60-134" href="#__codelineno-60-134"></a>
<a id="__codelineno-60-135" name="__codelineno-60-135" href="#__codelineno-60-135"></a>
<a id="__codelineno-60-136" name="__codelineno-60-136" href="#__codelineno-60-136"></a>
<a id="__codelineno-60-137" name="__codelineno-60-137" href="#__codelineno-60-137"></a>event.provider = event.provider,
<a id="__codelineno-60-138" name="__codelineno-60-138" href="#__codelineno-60-138"></a>
<a id="__codelineno-60-139" name="__codelineno-60-139" href="#__codelineno-60-139"></a>
<a id="__codelineno-60-140" name="__codelineno-60-140" href="#__codelineno-60-140"></a>
<a id="__codelineno-60-141" name="__codelineno-60-141" href="#__codelineno-60-141"></a>container_image.registry = container_image.registry,
<a id="__codelineno-60-142" name="__codelineno-60-142" href="#__codelineno-60-142"></a>
<a id="__codelineno-60-143" name="__codelineno-60-143" href="#__codelineno-60-143"></a>
<a id="__codelineno-60-144" name="__codelineno-60-144" href="#__codelineno-60-144"></a>
<a id="__codelineno-60-145" name="__codelineno-60-145" href="#__codelineno-60-145"></a>container_image.repository = container_image.repository,
<a id="__codelineno-60-146" name="__codelineno-60-146" href="#__codelineno-60-146"></a>
<a id="__codelineno-60-147" name="__codelineno-60-147" href="#__codelineno-60-147"></a>
<a id="__codelineno-60-148" name="__codelineno-60-148" href="#__codelineno-60-148"></a>
<a id="__codelineno-60-149" name="__codelineno-60-149" href="#__codelineno-60-149"></a>component.version = component.version,
<a id="__codelineno-60-150" name="__codelineno-60-150" href="#__codelineno-60-150"></a>
<a id="__codelineno-60-151" name="__codelineno-60-151" href="#__codelineno-60-151"></a>
<a id="__codelineno-60-152" name="__codelineno-60-152" href="#__codelineno-60-152"></a>
<a id="__codelineno-60-153" name="__codelineno-60-153" href="#__codelineno-60-153"></a>component.name = component.name,
<a id="__codelineno-60-154" name="__codelineno-60-154" href="#__codelineno-60-154"></a>
<a id="__codelineno-60-155" name="__codelineno-60-155" href="#__codelineno-60-155"></a>
<a id="__codelineno-60-156" name="__codelineno-60-156" href="#__codelineno-60-156"></a>
<a id="__codelineno-60-157" name="__codelineno-60-157" href="#__codelineno-60-157"></a>dt.security.risk.level = dt.security.risk.level,
<a id="__codelineno-60-158" name="__codelineno-60-158" href="#__codelineno-60-158"></a>
<a id="__codelineno-60-159" name="__codelineno-60-159" href="#__codelineno-60-159"></a>
<a id="__codelineno-60-160" name="__codelineno-60-160" href="#__codelineno-60-160"></a>
<a id="__codelineno-60-161" name="__codelineno-60-161" href="#__codelineno-60-161"></a>ingest_time = timestamp
<a id="__codelineno-60-162" name="__codelineno-60-162" href="#__codelineno-60-162"></a>
<a id="__codelineno-60-163" name="__codelineno-60-163" href="#__codelineno-60-163"></a>
<a id="__codelineno-60-164" name="__codelineno-60-164" href="#__codelineno-60-164"></a>
<a id="__codelineno-60-165" name="__codelineno-60-165" href="#__codelineno-60-165"></a>)
<a id="__codelineno-60-166" name="__codelineno-60-166" href="#__codelineno-60-166"></a>
<a id="__codelineno-60-167" name="__codelineno-60-167" href="#__codelineno-60-167"></a>
<a id="__codelineno-60-168" name="__codelineno-60-168" href="#__codelineno-60-168"></a>
<a id="__codelineno-60-169" name="__codelineno-60-169" href="#__codelineno-60-169"></a>)
<a id="__codelineno-60-170" name="__codelineno-60-170" href="#__codelineno-60-170"></a>
<a id="__codelineno-60-171" name="__codelineno-60-171" href="#__codelineno-60-171"></a>
<a id="__codelineno-60-172" name="__codelineno-60-172" href="#__codelineno-60-172"></a>
<a id="__codelineno-60-173" name="__codelineno-60-173" href="#__codelineno-60-173"></a>}, by:{ vulnerability.id, vulnerability.title, event.provider, container_image.registry, container_image.repository, component.name, component.version }
<a id="__codelineno-60-174" name="__codelineno-60-174" href="#__codelineno-60-174"></a>
<a id="__codelineno-60-175" name="__codelineno-60-175" href="#__codelineno-60-175"></a>
<a id="__codelineno-60-176" name="__codelineno-60-176" href="#__codelineno-60-176"></a>
<a id="__codelineno-60-177" name="__codelineno-60-177" href="#__codelineno-60-177"></a>// Filter out, if this vulnerability for the repository and the component
<a id="__codelineno-60-178" name="__codelineno-60-178" href="#__codelineno-60-178"></a>
<a id="__codelineno-60-179" name="__codelineno-60-179" href="#__codelineno-60-179"></a>
<a id="__codelineno-60-180" name="__codelineno-60-180" href="#__codelineno-60-180"></a>
<a id="__codelineno-60-181" name="__codelineno-60-181" href="#__codelineno-60-181"></a>// and version was already reported before the last 24 hours.
<a id="__codelineno-60-182" name="__codelineno-60-182" href="#__codelineno-60-182"></a>
<a id="__codelineno-60-183" name="__codelineno-60-183" href="#__codelineno-60-183"></a>
<a id="__codelineno-60-184" name="__codelineno-60-184" href="#__codelineno-60-184"></a>
<a id="__codelineno-60-185" name="__codelineno-60-185" href="#__codelineno-60-185"></a>// For example, if the same vulnerability was reported multiple times
<a id="__codelineno-60-186" name="__codelineno-60-186" href="#__codelineno-60-186"></a>
<a id="__codelineno-60-187" name="__codelineno-60-187" href="#__codelineno-60-187"></a>
<a id="__codelineno-60-188" name="__codelineno-60-188" href="#__codelineno-60-188"></a>
<a id="__codelineno-60-189" name="__codelineno-60-189" href="#__codelineno-60-189"></a>// during the last 7 days, don&#39;t report it again.
<a id="__codelineno-60-190" name="__codelineno-60-190" href="#__codelineno-60-190"></a>
<a id="__codelineno-60-191" name="__codelineno-60-191" href="#__codelineno-60-191"></a>
<a id="__codelineno-60-192" name="__codelineno-60-192" href="#__codelineno-60-192"></a>
<a id="__codelineno-60-193" name="__codelineno-60-193" href="#__codelineno-60-193"></a>| filterOut iAny(vulnerability_finding_events[][ingest_time] &lt; now() - 24h)
<a id="__codelineno-60-194" name="__codelineno-60-194" href="#__codelineno-60-194"></a>
<a id="__codelineno-60-195" name="__codelineno-60-195" href="#__codelineno-60-195"></a>
<a id="__codelineno-60-196" name="__codelineno-60-196" href="#__codelineno-60-196"></a>
<a id="__codelineno-60-197" name="__codelineno-60-197" href="#__codelineno-60-197"></a>// Expand and deduplicate for repetitive findings if they
<a id="__codelineno-60-198" name="__codelineno-60-198" href="#__codelineno-60-198"></a>
<a id="__codelineno-60-199" name="__codelineno-60-199" href="#__codelineno-60-199"></a>
<a id="__codelineno-60-200" name="__codelineno-60-200" href="#__codelineno-60-200"></a>
<a id="__codelineno-60-201" name="__codelineno-60-201" href="#__codelineno-60-201"></a>// were reported more than once in the last 24 hours.
<a id="__codelineno-60-202" name="__codelineno-60-202" href="#__codelineno-60-202"></a>
<a id="__codelineno-60-203" name="__codelineno-60-203" href="#__codelineno-60-203"></a>
<a id="__codelineno-60-204" name="__codelineno-60-204" href="#__codelineno-60-204"></a>
<a id="__codelineno-60-205" name="__codelineno-60-205" href="#__codelineno-60-205"></a>| expand vulnerability_finding_events
<a id="__codelineno-60-206" name="__codelineno-60-206" href="#__codelineno-60-206"></a>
<a id="__codelineno-60-207" name="__codelineno-60-207" href="#__codelineno-60-207"></a>
<a id="__codelineno-60-208" name="__codelineno-60-208" href="#__codelineno-60-208"></a>
<a id="__codelineno-60-209" name="__codelineno-60-209" href="#__codelineno-60-209"></a>| dedup { vulnerability.id, vulnerability.title, vulnerability_finding_events[object.id], vulnerability_finding_events[component.name], vulnerability_finding_events[component.version] }
<a id="__codelineno-60-210" name="__codelineno-60-210" href="#__codelineno-60-210"></a>
<a id="__codelineno-60-211" name="__codelineno-60-211" href="#__codelineno-60-211"></a>
<a id="__codelineno-60-212" name="__codelineno-60-212" href="#__codelineno-60-212"></a>
<a id="__codelineno-60-213" name="__codelineno-60-213" href="#__codelineno-60-213"></a>// Aggregate again to count the unique affected images within each repository.
<a id="__codelineno-60-214" name="__codelineno-60-214" href="#__codelineno-60-214"></a>
<a id="__codelineno-60-215" name="__codelineno-60-215" href="#__codelineno-60-215"></a>
<a id="__codelineno-60-216" name="__codelineno-60-216" href="#__codelineno-60-216"></a>
<a id="__codelineno-60-217" name="__codelineno-60-217" href="#__codelineno-60-217"></a>| summarize {
<a id="__codelineno-60-218" name="__codelineno-60-218" href="#__codelineno-60-218"></a>
<a id="__codelineno-60-219" name="__codelineno-60-219" href="#__codelineno-60-219"></a>
<a id="__codelineno-60-220" name="__codelineno-60-220" href="#__codelineno-60-220"></a>
<a id="__codelineno-60-221" name="__codelineno-60-221" href="#__codelineno-60-221"></a>affected_images_count = count(),
<a id="__codelineno-60-222" name="__codelineno-60-222" href="#__codelineno-60-222"></a>
<a id="__codelineno-60-223" name="__codelineno-60-223" href="#__codelineno-60-223"></a>
<a id="__codelineno-60-224" name="__codelineno-60-224" href="#__codelineno-60-224"></a>
<a id="__codelineno-60-225" name="__codelineno-60-225" href="#__codelineno-60-225"></a>vulnerability_finding_events = collectArray(
<a id="__codelineno-60-226" name="__codelineno-60-226" href="#__codelineno-60-226"></a>
<a id="__codelineno-60-227" name="__codelineno-60-227" href="#__codelineno-60-227"></a>
<a id="__codelineno-60-228" name="__codelineno-60-228" href="#__codelineno-60-228"></a>
<a id="__codelineno-60-229" name="__codelineno-60-229" href="#__codelineno-60-229"></a>vulnerability_finding_events
<a id="__codelineno-60-230" name="__codelineno-60-230" href="#__codelineno-60-230"></a>
<a id="__codelineno-60-231" name="__codelineno-60-231" href="#__codelineno-60-231"></a>
<a id="__codelineno-60-232" name="__codelineno-60-232" href="#__codelineno-60-232"></a>
<a id="__codelineno-60-233" name="__codelineno-60-233" href="#__codelineno-60-233"></a>)
<a id="__codelineno-60-234" name="__codelineno-60-234" href="#__codelineno-60-234"></a>
<a id="__codelineno-60-235" name="__codelineno-60-235" href="#__codelineno-60-235"></a>
<a id="__codelineno-60-236" name="__codelineno-60-236" href="#__codelineno-60-236"></a>
<a id="__codelineno-60-237" name="__codelineno-60-237" href="#__codelineno-60-237"></a>}, by:{ vulnerability.id, vulnerability.title, event.provider, container_image.registry, container_image.repository, component.name, component.version }
<a id="__codelineno-60-238" name="__codelineno-60-238" href="#__codelineno-60-238"></a>
<a id="__codelineno-60-239" name="__codelineno-60-239" href="#__codelineno-60-239"></a>
<a id="__codelineno-60-240" name="__codelineno-60-240" href="#__codelineno-60-240"></a>
<a id="__codelineno-60-241" name="__codelineno-60-241" href="#__codelineno-60-241"></a>| sort vulnerability_finding_events[][ingest_time] desc
</code></pre></div>
<p>Example result:</p>
<p><img alt="Example result" src="https://dt-cdn.net/images/2024-11-04-09-48-57-1764-c397b99b5c.png" /></p>
<ol>
<li>Track alert reduction</li>
</ol>
<p>To track the alert reduction process based on the progressive filtering in <a href="#filter">step 2</a></p>
<ol>
<li>Open <a href="/docs/analyze-explore-automate/dashboards-and-notebooks/dashboards-new" title="Create interactive, customizable views to visualize, analyze, and share your observability data in real time."><img alt="Dashboards" src="https://dt-cdn.net/images/dashboards-512-b1f1e9690b.png" title="Dashboards" /> <strong>Dashboards</strong></a> and go to <strong>Ready-made</strong>.</li>
<li>Search for and select <strong>Container image alert reduction</strong> for the Amazon ECR integration.</li>
</ol>
<p>Example result:</p>
<p><img alt="funnel dashboard showing alert reduction" src="https://dt-cdn.net/images/funnel-dashboard-4308-16c82e5aa3.png" /></p>
<hr />
<h2 id="source-stay-compliantmd">Source: stay-compliant.md<a class="headerlink" href="#source-stay-compliantmd" title="Permanent link">&para;</a></h2>
<hr />
<p>title: Stay compliant with Security Posture Management
source: https://www.dynatrace.com/docs/secure/use-cases/stay-compliant
scraped: 2026-02-17T05:07:16.757027</p>
<hr />
<h1 id="stay-compliant-with-security-posture-management">Stay compliant with Security Posture Management<a class="headerlink" href="#stay-compliant-with-security-posture-management" title="Permanent link">&para;</a></h1>
<h1 id="stay-compliant-with-security-posture-management_1">Stay compliant with Security Posture Management<a class="headerlink" href="#stay-compliant-with-security-posture-management_1" title="Permanent link">&para;</a></h1>
<ul>
<li>Latest Dynatrace</li>
<li>Tutorial</li>
<li>Published Dec 02, 2024</li>
</ul>
<p>Early Adopter</p>
<p>In this tutorial you will learn how <a href="/docs/secure/application-security/security-posture-management-hub" title="Assess, manage, and take action on misconfigurations and violations against security hardening guidelines and regulatory compliance standards.">Security Posture Management</a> can help you stay compliant with the <a href="/docs/secure/application-security/security-posture-management-hub#support" title="Assess, manage, and take action on misconfigurations and violations against security hardening guidelines and regulatory compliance standards.">security hardening guidelines and regulatory compliance standards</a>.</p>
<h2 id="target-audience_12">Target audience<a class="headerlink" href="#target-audience_12" title="Permanent link">&para;</a></h2>
<p>This tutorial is dedicated to Security Ops Engineers, DevOps, DevSecOps, and Site Reliability Engineers (SREs).</p>
<h2 id="scenario_6">Scenario<a class="headerlink" href="#scenario_6" title="Permanent link">&para;</a></h2>
<ul>
<li>Your organization requires following Industry best practices or regulatory requirements.</li>
<li>New workloads are constantly added or removed from your environment.</li>
</ul>
<h2 id="goal_2">Goal<a class="headerlink" href="#goal_2" title="Permanent link">&para;</a></h2>
<ul>
<li>Gain immediate insight into the overall security posture of your monitored environment.</li>
<li>Detect and address security issues and misconfigurations easily.</li>
<li>Ensure your environment is configured securely and efficiently.</li>
<li>Enhance the overall system reliability.</li>
<li>Stay compliant with security standards.</li>
</ul>
<h2 id="result_3">Result<a class="headerlink" href="#result_3" title="Permanent link">&para;</a></h2>
<ul>
<li>Kubernetes clusters are actively assessed through Kubernetes Security Posture Management against regulatory compliance standards and security best practices.</li>
<li>Misconfigurations and violations against standards are continuously discovered.</li>
</ul>
<h2 id="prerequisites_13">Prerequisites<a class="headerlink" href="#prerequisites_13" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="/docs/ingest-from/setup-on-k8s/deployment/security-posture-management" title="Configure and enable Security Posture Management in Kubernetes.">Deploy Kubernetes Security Posture Management</a></li>
<li>
<p>Install <img alt="xSPM" src="https://dt-cdn.net/images/security-posture-management-highresolution-1024-83a748ecdd.png" title="xSPM" /> <strong>Security Posture Management</strong></p>
</li>
<li>
<p>Show me how</p>
</li>
<li>
<p>In Dynatrace, open  <a href="/docs/manage/hub" title="See the information about Dynatrace Hub."><strong>Hub</strong></a>.</p>
</li>
<li>Look for <img alt="xSPM" src="https://dt-cdn.net/images/security-posture-management-highresolution-1024-83a748ecdd.png" title="xSPM" /> <strong>Security Posture Management</strong> and select <strong>Install</strong>.</li>
</ul>
<h2 id="get-started_11">Get started<a class="headerlink" href="#get-started_11" title="Permanent link">&para;</a></h2>
<ol>
<li>Review results</li>
</ol>
<p>Open <a href="/docs/secure/xspm" title="Detect, manage, and take action on security and compliance findings."><img alt="xSPM" src="https://dt-cdn.net/images/security-posture-management-highresolution-1024-83a748ecdd.png" title="xSPM" /> <strong>Security Posture Management</strong></a> <img alt="xSPM" src="https://dt-cdn.net/images/security-posture-management-highresolution-1024-83a748ecdd.png" title="xSPM" /> and review</p>
<ul>
<li>The <a href="/docs/secure/xspm/concepts#concept-results" title="Concepts that are specific to the Dynatrace Security Posture Management app.">Assessment results</a></li>
<li>
<p>The compliance status</p>
</li>
<li>
<p><a href="/docs/secure/xspm/assess-coverage#standards" title="Review the Security Posture Management coverage of your systems at a glance.">For the whole environment</a></p>
</li>
<li>
<p><a href="/docs/secure/xspm/assess-coverage#systems" title="Review the Security Posture Management coverage of your systems at a glance.">For specific systems</a></p>
</li>
<li>
<p>Search for relevant information</p>
</li>
</ul>
<p>Use the <a href="/docs/secure/xspm/review-findings" title="Search for relevant information to analyze security and compliance findings efficiently.">filtering and sorting</a> options to gather insights about problems in your environment.</p>
<ol>
<li>Gather insights</li>
</ol>
<p>Define which rules are relevant <a href="/docs/secure/xspm/gain-insights" title="Drill into results that can help you fix misconfigurations and noncompliance.">based on contextual insights</a>.</p>
<ol>
<li>
<p>Define compliance strategy</p>
</li>
<li>
<p>Fix configuration issues for <a href="/docs/secure/xspm/concepts#concept-severity" title="Concepts that are specific to the Dynatrace Security Posture Management app.">rules with the highest priority</a> in a narrow context (for example, on a single cluster).</p>
</li>
<li>Monitor compliance and operation for a while.</li>
<li>
<p>If everything works fine, roll out the fix to other environments.</p>
</li>
<li>
<p>Define monitoring for compliance</p>
</li>
</ol>
<p>There are two ways:</p>
<p>In the app</p>
<p>Via DQL queries</p>
<p>Use <img alt="xSPM" src="https://dt-cdn.net/images/security-posture-management-highresolution-1024-83a748ecdd.png" title="xSPM" /> <strong>Security Posture Management</strong> to monitor that</p>
<ol>
<li>The <a href="/docs/secure/xspm/assess-coverage#standards" title="Review the Security Posture Management coverage of your systems at a glance.">compliance standard percentage</a> is increasing.</li>
<li>The total number of assessed resources with the <code>Passed</code> result is increasing.</li>
</ol>
<p>For easy management and to compare results, you can <a href="/docs/secure/xspm/share-findings#dwld" title="Interact with other apps for further insights and share results with stakeholders.">download results as a CSV file</a>.</p>
<p>Use <a href="/docs/secure/investigations" title="Combine Grail functionalities for evidence-driven investigations, including incident resolution, root cause analysis, and threat hunting."><img alt="Investigations" src="https://dt-cdn.net/images/security-investigator-256-93f6c187d9.png" title="Investigations" /> <strong>Investigations</strong></a> or <a href="/docs/analyze-explore-automate/dashboards-and-notebooks/notebooks" title="Analyze, visualize, and share insights from your observability data√¢¬Ä¬îall in one collaborative, customizable workspace."><img alt="Notebooks" src="https://dt-cdn.net/images/notebooks-768-046137830a.webp" title="Notebooks" /> <strong>Notebooks</strong></a> to monitor</p>
<ol>
<li>The history of results per standard or rule, per cluster or environment.</li>
<li>That the resource assessment result for a specific set of rules remains <code>Passed</code>.</li>
</ol>
<p>For a list of DQL examples based on compliance events that you can use, see <a href="/docs/secure/threat-observability/dql-examples#compliance" title="DQL examples for security data powered by Grail.">Query compliance events</a>.</p>
<ol>
<li>Create notifications</li>
</ol>
<p><a href="/docs/analyze-explore-automate/workflows/actions" title="Use Dynatrace ready-made actions for your workflows and integrate Dynatrace with third-party systems.">Create a workflow</a> to send an alert on your desired channel if the previously <code>Passed</code> rule turns into <code>Failed</code>.</p>
<h2 id="further-resources_1">Further resources<a class="headerlink" href="#further-resources_1" title="Permanent link">&para;</a></h2>
<p><a href="/docs/secure/application-security/security-posture-management-hub" title="Assess, manage, and take action on misconfigurations and violations against security hardening guidelines and regulatory compliance standards.">Security Posture Management</a></p>
<p><a href="/docs/secure/xspm" title="Detect, manage, and take action on security and compliance findings.">Security Posture Management</a></p>
<h2 id="related-topics_3">Related topics<a class="headerlink" href="#related-topics_3" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="/docs/secure/application-security/security-posture-management-hub" title="Assess, manage, and take action on misconfigurations and violations against security hardening guidelines and regulatory compliance standards.">Security Posture Management</a></li>
</ul>
<hr />
<h2 id="source-threat-huntingmd">Source: threat-hunting.md<a class="headerlink" href="#source-threat-huntingmd" title="Permanent link">&para;</a></h2>
<hr />
<p>title: Threat hunting and forensics
source: https://www.dynatrace.com/docs/secure/use-cases/threat-hunting
scraped: 2026-02-16T09:34:45.595381</p>
<hr />
<h1 id="threat-hunting-and-forensics">Threat hunting and forensics<a class="headerlink" href="#threat-hunting-and-forensics" title="Permanent link">&para;</a></h1>
<h1 id="threat-hunting-and-forensics_1">Threat hunting and forensics<a class="headerlink" href="#threat-hunting-and-forensics_1" title="Permanent link">&para;</a></h1>
<ul>
<li>Latest Dynatrace</li>
<li>Tutorial</li>
<li>Published Mar 14, 2024</li>
</ul>
<p>When threat hunting, time and precision are crucial. You need to be as fast and accurate as possible to find and act upon information. As a security analyst investigating security incidents or threat hunting, you often need to</p>
<ul>
<li>Navigate between multiple executed queries and their results</li>
<li>Manage the evidence gathered during investigations and reuse it when building additional queries</li>
<li>
<p>Ensure that</p>
</li>
<li>
<p>The investigation is maintained in context.</p>
</li>
<li>The tools for such activities support quick query creation and a detailed overview of the results.</li>
</ul>
<p>In the following, we demonstrate how you can achieve these goals using <a href="/docs/secure/investigations" title="Combine Grail functionalities for evidence-driven investigations, including incident resolution, root cause analysis, and threat hunting."><img alt="Investigations" src="https://dt-cdn.net/images/security-investigator-256-93f6c187d9.png" title="Investigations" /> <strong>Investigations</strong></a>.</p>
<h2 id="target-audience_13">Target audience<a class="headerlink" href="#target-audience_13" title="Permanent link">&para;</a></h2>
<p>This page is intended for Security teams performing threat hunting or analyzing security incidents, such as the Incident Response team or Security Analysts.</p>
<h2 id="scenario_7">Scenario<a class="headerlink" href="#scenario_7" title="Permanent link">&para;</a></h2>
<p>In the following, we address a scenario in which you get a notification from an external source about a suspiciously high number of unauthorized requests towards our Kubernetes control plane between <code>2024-02-13 16:00:00</code> and <code>2024-02-13 18:59:59</code>. Your Kubernetes cluster has been set up to AWS EKS cluster, and logs are forwarded to Dynatrace.</p>
<p>As a security analyst, you want to understand if this is related to malicious activities or if it may be an indication of a cyber security incident. During this investigation, you will follow the trail of your findings to illustrate the nature of threat hunting and incident solving.</p>
<h2 id="prerequisites_14">Prerequisites<a class="headerlink" href="#prerequisites_14" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="/docs/ingest-from/setup-on-k8s/deployment/other/classic-full-stack" title="Deploy Dynatrace Operator in classic full-stack mode to Kubernetes">Set up Kubernetes observability with Dynatrace Operator</a></li>
<li>
<p>Set up AWS logging to CloudWatch:</p>
</li>
<li>
<p><a href="https://dt-url.net/va038gi">Set up EKS Cluster logging√Ø¬ª¬ø</a></p>
</li>
<li><a href="https://dt-url.net/ya238ol">Set up VPC Flow logging√Ø¬ª¬ø</a></li>
<li><a href="/docs/ingest-from/amazon-web-services/integrate-into-aws/aws-eks/k8s-dns-logs" title="Learn how to ingest Kubernetes-related DNS logs from AWS to Dynatrace.">Set up K8S DNS logging</a></li>
<li><a href="/docs/ingest-from/amazon-web-services/integrate-with-aws/aws-logs-ingest/lma-stream-logs-with-firehose" title="Amazon Data Firehose integration allows ingest of cloud logs directly, without additional infrastructure needed, and at higher throughput.">Stream logs via Amazon Data Firehose</a></li>
<li>
<p>Basic knowledge of</p>
</li>
<li>
<p><a href="/docs/platform/grail/dynatrace-query-language" title="How to use Dynatrace Query Language.">Dynatrace Query Language (DQL)</a></p>
</li>
<li><a href="/docs/platform/grail/dynatrace-pattern-language" title="Use Dynatrace Pattern Language to describe patterns using matchers.">Dynatrace Pattern Language (DPL)</a></li>
<li>How DNS name resolving works in Kubernetes clusters</li>
</ul>
<h2 id="investigation-path-1-analyze-kubernetes-audit-logs">Investigation path 1: Analyze Kubernetes audit logs<a class="headerlink" href="#investigation-path-1-analyze-kubernetes-audit-logs" title="Permanent link">&para;</a></h2>
<p>First, you want to understand which activities caused the notification about the high number of unauthorized requests in your Kubernetes audit logs.
Open <a href="/docs/secure/investigations" title="Combine Grail functionalities for evidence-driven investigations, including incident resolution, root cause analysis, and threat hunting."><img alt="Investigations" src="https://dt-cdn.net/images/security-investigator-256-93f6c187d9.png" title="Investigations" /> <strong>Investigations</strong></a> and create a new investigation.</p>
<ol>
<li>Set the timeframe</li>
</ol>
<p>In the <a href="/docs/secure/investigations/define-timeframes#selector" title="Adjust time ranges for data analysis and event correlation in Investigations.">timeframe section</a>, set the timeframe from <code>2024-02-13 16:00:00</code> to <code>2024-02-13 18:59:59</code>, when the unauthorized requests occurred.</p>
<p><img alt="set the timeframe" src="https://dt-cdn.net/images/2024-03-06-08-15-45-1914-2f0de669a4.png" /></p>
<ol>
<li>
<p>Fetch Kubernetes cluster audit logs</p>
</li>
<li>
<p>Kubernetes audit logs are forwarded to Dynatrace with <code>aws.log_group</code> and <code>log_stream</code> values attached. To fetch all the unique AWS CloudWatch log groups that are ingested to Dynatrace, copy-paste the following <a href="/docs/platform/grail/dynatrace-query-language/dql-guide" title="Find out how DQL works and what are DQL key concepts.">DQL query</a> in the query input.</p>
</li>
</ol>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-61-1" name="__codelineno-61-1" href="#__codelineno-61-1"></a>fetch logs
<a id="__codelineno-61-2" name="__codelineno-61-2" href="#__codelineno-61-2"></a>
<a id="__codelineno-61-3" name="__codelineno-61-3" href="#__codelineno-61-3"></a>
<a id="__codelineno-61-4" name="__codelineno-61-4" href="#__codelineno-61-4"></a>
<a id="__codelineno-61-5" name="__codelineno-61-5" href="#__codelineno-61-5"></a>| summarize count(), by: aws.log_group
</code></pre></div>
2. Select <strong>Run</strong> to execute the query.</p>
<p><img alt="fetch kubernetes cluster audit logs" src="https://dt-cdn.net/images/2024-03-06-08-45-30-1910-d1342717df.png" /></p>
<p>At this point, you notice a circle has appeared in the <strong>Query tree</strong> section in the upper right. This is called a root node and marks the starting point of your investigation. From here on, every time you modify and execute a query, a new node will be added in the query tree, allowing you to navigate among queries while keeping the history of your investigation intact. For details, see <a href="/docs/secure/investigations/concepts#query-tree" title="Key concepts for using Dynatrace Investigations across security, operations, and performance analysis.">query tree</a>.</p>
<ol>
<li>
<p>Filter by log group name</p>
</li>
<li>
<p>In the query results, find the record with the log group collecting the EKS control plane logs (in our example, <code>/aws/eks/unguard-secla-demo/cluster</code>) and <a href="/docs/secure/investigations#fields" title="Combine Grail functionalities for evidence-driven investigations, including incident resolution, root cause analysis, and threat hunting.">add it as a filter</a> to your DQL query.</p>
</li>
</ol>
<p><img alt="Add a filter for the log group name" src="https://dt-cdn.net/images/2024-03-06-09-01-16-1530-51987a9960.png" />
2. To view only the control plane audit events, modify the <code>filter</code> command in the query input by adding the <a href="/docs/platform/grail/dynatrace-query-language/operators#dql-logical-or-equality-operators" title="A list of DQL Operators."><code>and</code> operator</a> and the <a href="/docs/platform/grail/dynatrace-query-language/functions/string-functions#contains" title="A list of DQL string functions."><code>contains</code> string function</a> as follows:</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-62-1" name="__codelineno-62-1" href="#__codelineno-62-1"></a>| filter aws.log_group == &quot;/aws/eks/unguard-secla-demo/cluster&quot; and contains(aws.log_stream, &quot;audit&quot;)
</code></pre></div>
3. In the query input, remove the <code>summarize</code> command and select <strong>Run</strong> to execute the query.</p>
<p><img alt="view only the control plane audit events" src="https://dt-cdn.net/images/2024-03-06-09-19-12-1919-c2f0267459.png" /></p>
<ol>
<li>Inspect the content</li>
</ol>
<p>In the query results table, right-click on any cell in the <strong>content</strong> field and select <strong>View field details</strong> to view the raw content of the field. For details, see <a href="/docs/secure/investigations/enhance-results#view-details" title="Organize and interpret query outputs across investigations --- from performance analysis to threat detection.">Explore data in the original format</a>.</p>
<p><img alt="Inspect the content" src="https://dt-cdn.net/images/2024-03-07-16-43-25-1546-aa18860a77.png" /></p>
<ol>
<li>
<p>Extract fields from JSON</p>
</li>
<li>
<p>In the query results table, right-click on any cell in the <strong>Content</strong> field and select <a href="/docs/secure/investigations/extract-fields#field" title="Pull specific data points from logs in Investigations."><strong>Extract fields</strong></a> to navigate to <a href="/docs/platform/grail/dynatrace-pattern-language/dpl-architect" title="Extract fields with Dynatrace Pattern Language Architect.">DPL Architect</a>.</p>
</li>
<li>Select <strong>Saved patterns</strong>.</li>
<li>In <strong>Dynatrace patterns</strong>, select <strong>k8s</strong> &gt; <strong>audit</strong>.</li>
</ol>
<p><img alt="extract field" src="https://dt-cdn.net/images/2024-03-06-18-41-50-1547-0df2e723b3.png" /></p>
<p>When extracting fields from a JSON structure, you can define only a partial schema for the fields that are relevant for your use case. To continue your investigation, you need to select only the relevant fields.
4. In the query input of DPL Architect, replace the pattern as follows:</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-63-1" name="__codelineno-63-1" href="#__codelineno-63-1"></a>JSON{
<a id="__codelineno-63-2" name="__codelineno-63-2" href="#__codelineno-63-2"></a>
<a id="__codelineno-63-3" name="__codelineno-63-3" href="#__codelineno-63-3"></a>
<a id="__codelineno-63-4" name="__codelineno-63-4" href="#__codelineno-63-4"></a>
<a id="__codelineno-63-5" name="__codelineno-63-5" href="#__codelineno-63-5"></a>STRING:verb,
<a id="__codelineno-63-6" name="__codelineno-63-6" href="#__codelineno-63-6"></a>
<a id="__codelineno-63-7" name="__codelineno-63-7" href="#__codelineno-63-7"></a>
<a id="__codelineno-63-8" name="__codelineno-63-8" href="#__codelineno-63-8"></a>
<a id="__codelineno-63-9" name="__codelineno-63-9" href="#__codelineno-63-9"></a>JSON{string:username}(flat=true):user,
<a id="__codelineno-63-10" name="__codelineno-63-10" href="#__codelineno-63-10"></a>
<a id="__codelineno-63-11" name="__codelineno-63-11" href="#__codelineno-63-11"></a>
<a id="__codelineno-63-12" name="__codelineno-63-12" href="#__codelineno-63-12"></a>
<a id="__codelineno-63-13" name="__codelineno-63-13" href="#__codelineno-63-13"></a>JSON_ARRAY{ipaddr}(typed=true):sourceIPs,
<a id="__codelineno-63-14" name="__codelineno-63-14" href="#__codelineno-63-14"></a>
<a id="__codelineno-63-15" name="__codelineno-63-15" href="#__codelineno-63-15"></a>
<a id="__codelineno-63-16" name="__codelineno-63-16" href="#__codelineno-63-16"></a>
<a id="__codelineno-63-17" name="__codelineno-63-17" href="#__codelineno-63-17"></a>JSON{string+:resource}(flat=true):objectRef,
<a id="__codelineno-63-18" name="__codelineno-63-18" href="#__codelineno-63-18"></a>
<a id="__codelineno-63-19" name="__codelineno-63-19" href="#__codelineno-63-19"></a>
<a id="__codelineno-63-20" name="__codelineno-63-20" href="#__codelineno-63-20"></a>
<a id="__codelineno-63-21" name="__codelineno-63-21" href="#__codelineno-63-21"></a>JSON{int:code}(flat=true):responseStatus
<a id="__codelineno-63-22" name="__codelineno-63-22" href="#__codelineno-63-22"></a>
<a id="__codelineno-63-23" name="__codelineno-63-23" href="#__codelineno-63-23"></a>
<a id="__codelineno-63-24" name="__codelineno-63-24" href="#__codelineno-63-24"></a>
<a id="__codelineno-63-25" name="__codelineno-63-25" href="#__codelineno-63-25"></a>}(flat=true)
</code></pre></div>
5. Select <strong>Results</strong> for an overview of the fields that will be extracted from the <a href="/docs/platform/grail/dynatrace-pattern-language/dpl-architect#match-preview" title="Extract fields with Dynatrace Pattern Language Architect.">match preview dataset</a>.</p>
<p><img alt="display results" src="https://dt-cdn.net/images/2024-03-06-14-28-54-816-6ec66c1606.png" />
6. Select <strong>Insert pattern</strong> to append the pattern to your DQL query.</p>
<p><img alt="Insert pattern in DPL Architect" src="https://dt-cdn.net/images/2024-03-11-08-59-35-613-d01beb3deb.png" />
7. Select <strong>Run</strong> to execute the query.</p>
<ol>
<li>Filter events</li>
</ol>
<p>To find out which IPs have unauthorized activity, you need to</p>
<ul>
<li><a href="/docs/platform/grail/dynatrace-query-language/commands/structuring-commands#expand" title="DQL structuring commands">Expand</a> the source IP array</li>
<li><a href="/docs/platform/grail/dynatrace-query-language/commands/aggregation-commands#summarize" title="DQL aggregation commands">Summarize</a> the results with the relevant fields extracted previously</li>
<li>
<p><a href="/docs/platform/grail/dynatrace-query-language/commands/filtering-commands#filter" title="DQL filter and search commands">Filter</a> the results to view only unauthorized requests (<code>401</code>) and forbidden requests (<code>403</code>)</p>
</li>
<li>
<p>In the query input, add the following DQL snippet, then select <strong>Run</strong> to execute the query.</p>
</li>
</ul>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-64-1" name="__codelineno-64-1" href="#__codelineno-64-1"></a>| expand sourceIPs
<a id="__codelineno-64-2" name="__codelineno-64-2" href="#__codelineno-64-2"></a>
<a id="__codelineno-64-3" name="__codelineno-64-3" href="#__codelineno-64-3"></a>
<a id="__codelineno-64-4" name="__codelineno-64-4" href="#__codelineno-64-4"></a>
<a id="__codelineno-64-5" name="__codelineno-64-5" href="#__codelineno-64-5"></a>| summarize count(), by: {sourceIPs, username, verb, resource=objectRef, responseStatus}
<a id="__codelineno-64-6" name="__codelineno-64-6" href="#__codelineno-64-6"></a>
<a id="__codelineno-64-7" name="__codelineno-64-7" href="#__codelineno-64-7"></a>
<a id="__codelineno-64-8" name="__codelineno-64-8" href="#__codelineno-64-8"></a>
<a id="__codelineno-64-9" name="__codelineno-64-9" href="#__codelineno-64-9"></a>| filter in(responseStatus, {401, 403})
</code></pre></div>
2. In the results table menu, sort results by count to see which IP addresses had the most connections.</p>
<p><img alt="filter the relevant events" src="https://dt-cdn.net/images/2024-03-07-08-11-17-1448-777bfa0c1e.png" /></p>
<p>It looks like you found the origin of your security notification:</p>
<ul>
<li>An unauthorized external IP address is trying to fetch secrets from your control plane (in our example, <code>198.51.100.2</code>, with <code>401</code> response code and 122 connections). This is not surprising, since security scanners are attempting this daily from the internet.</li>
<li>
<p>A private IP address is trying to enumerate pods repeatedly (in our example, <code>172.31.29.138</code>, with <code>403</code> response code and 2090 connections). It seems to be one of the pods in your Kubernetes cluster, and such behavior might indicate a compromised pod!</p>
</li>
<li>
<p>Add IPs as evidence</p>
</li>
</ul>
<p>Both IP addresses need to be analyzed further, but the one with a <code>403</code> response and 2090 attempts is more critical and requires special attention.</p>
<p>To save the IPs as <a href="/docs/secure/investigations/manage-evidence" title="Collect and preserve investigation artifacts in Investigations.">evidence</a>, you can add the first IP (<code>198.51.100.2</code>) to a preset evidence list and the second one (<code>172.31.29.138</code>) to a new customized evidence list:</p>
<ol>
<li>Right-click on <code>198.51.100.2</code>, then select <strong>Add to evidence list</strong> &gt; <strong>Suspicious IPs</strong>.</li>
<li>Right-click on <code>172.31.29.138</code>, select <strong>Add to evidence list</strong> &gt; <strong>New evidence list</strong> and enter a name, for example, "Suspicious pod".</li>
</ol>
<p><img alt="add to IP collections" src="https://dt-cdn.net/images/2024-03-07-08-32-32-357-51a8b2b145.png" /></p>
<h2 id="investigation-path-2-investigate-potential-target">Investigation path 2: Investigate potential target<a class="headerlink" href="#investigation-path-2-investigate-potential-target" title="Permanent link">&para;</a></h2>
<p>To understand what the pod did and which other service logs you need for your investigation, you can start with the network logs. For AWS, the best place to start is the <a href="https://dt-url.net/6c0385l">VPC network flow logs√Ø¬ª¬ø</a>.</p>
<ol>
<li>
<p>Fetch VPC flow logs</p>
</li>
<li>
<p>Using the <a href="/docs/secure/investigations/concepts#query-tree" title="Key concepts for using Dynatrace Investigations across security, operations, and performance analysis.">query tree</a> created during your investigation, navigate to the <a href="#fetch-k8s-logs">Fetch Kubernetes cluster audit logs</a> step.</p>
</li>
<li>In the query results, find the record with the log group that contains your VPC flow logs (in our example, <code>/aws/vpc/unguard-secla-demo/vpc-flow-logs</code>), and add it as a filter to the DQL query.</li>
</ol>
<p><img alt="VPC flow logs" src="https://dt-cdn.net/images/2024-03-06-16-11-40-1905-ed76689a2c.png" /></p>
<p>The node in the query tree has changed its icon, which means you√¢¬Ä¬ôre in the middle of editing the query. You can either revert to the original query to update the results table or execute the modified query. When you run the modified query, a new node is created with the respective query and its results. You can <a href="/docs/secure/investigations/query-tree" title="Visualize and structure complex queries in Investigations.">give the node a distinctive name and color</a> to recognize it later.
3. In the query input, remove the <code>summarize</code> command, then select <strong>Run</strong> to execute the modified query.</p>
<p><img alt="execute modified query" src="https://dt-cdn.net/images/2024-03-07-18-21-06-1913-6f988f1771.png" /></p>
<p>This creates a second branch in the query tree. A branch is the visual representation of an investigation path. Let's see where this new path takes us.</p>
<ol>
<li>Extract fields</li>
</ol>
<p>For more accurate results, you need to extract fields from the log records with DPL Architect.</p>
<ol>
<li>In the query results table, right-click on any cell in the <strong>content</strong> field and select <strong>Extract fields</strong>.</li>
<li>In DPL Architect, select <strong>Saved patterns</strong>.</li>
<li>In <strong>Dynatrace patterns</strong>, select <strong>aws</strong> &gt; <strong>vpc-flow-full</strong>.</li>
<li>Select <strong>Insert pattern</strong>.</li>
<li>
<p>Select <strong>Run</strong> to execute the query.</p>
</li>
<li>
<p>Filter results</p>
</li>
</ol>
<p>Since you√¢¬Ä¬ôre interested only in the results from the suspicious pod, you can add a filter to your DQL query based on the evidence created in the <a href="#evidence">Add evidence for later use</a> step.</p>
<ol>
<li>Go to <strong>Evidence lists</strong> and select the evidence menu for the <code>Suspicious pod</code> list to see the filtering options and the suitable field names that match the <code>IPADDR</code> type.</li>
<li>Select <strong>Filter for</strong> &gt; <strong>Filter within field <code>pkt_srcaddr</code></strong>. This appends the filter to your DQL query.</li>
</ol>
<p><img alt="Filter by evidence" src="https://dt-cdn.net/images/2024-03-07-08-51-47-790-18cc53cc6c.png" />
3. To get a better overview about the network connections, append the following command to the DQL query in the query input:</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-65-1" name="__codelineno-65-1" href="#__codelineno-65-1"></a>| summarize count(), by: { pkt_dstaddr, protocol, action, dstport}
<a id="__codelineno-65-2" name="__codelineno-65-2" href="#__codelineno-65-2"></a>
<a id="__codelineno-65-3" name="__codelineno-65-3" href="#__codelineno-65-3"></a>
<a id="__codelineno-65-4" name="__codelineno-65-4" href="#__codelineno-65-4"></a>
<a id="__codelineno-65-5" name="__codelineno-65-5" href="#__codelineno-65-5"></a>| sort `count()` desc
</code></pre></div>
4. Select <strong>Run</strong> to execute the query.</p>
<p>You can see that the suspicious pod has most often connected to the cluster's DNS service via UDP port 53.</p>
<p><img alt="Better overview of network connections" src="https://dt-cdn.net/images/2024-03-07-09-20-38-1421-bf0a76a211.png" /></p>
<p>There could be an application misconfiguration or something suspicious might be happening with that pod.</p>
<h2 id="investigation-path-3-identify-what-data-the-pod-sent-out">Investigation path 3: Identify what data the pod sent out<a class="headerlink" href="#investigation-path-3-identify-what-data-the-pod-sent-out" title="Permanent link">&para;</a></h2>
<p>To look for the DNS names resolved by a pod you need to check the CoreDNS logs. If configured properly, the query logs are visible in the CoreDNS container logs.</p>
<ol>
<li>
<p>Fetch coreDNS logs</p>
</li>
<li>
<p>To fetch CoreDNS container logs, navigate to the <a href="#fetch-k8s-logs">Fetch Kubernetes cluster audit logs</a> step and modify the query in the query input as follows:</p>
</li>
</ol>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-66-1" name="__codelineno-66-1" href="#__codelineno-66-1"></a>fetch logs
<a id="__codelineno-66-2" name="__codelineno-66-2" href="#__codelineno-66-2"></a>
<a id="__codelineno-66-3" name="__codelineno-66-3" href="#__codelineno-66-3"></a>
<a id="__codelineno-66-4" name="__codelineno-66-4" href="#__codelineno-66-4"></a>
<a id="__codelineno-66-5" name="__codelineno-66-5" href="#__codelineno-66-5"></a>| filter k8s.container.name == &quot;coredns&quot;
</code></pre></div>
2. Select <strong>Run</strong> to execute the query. This creates a third branch in the query tree.</p>
<p><img alt="Fetch coreDNS logs" src="https://dt-cdn.net/images/2024-03-07-19-14-29-1919-bdcb4fef59.png" /></p>
<ol>
<li>
<p>Extract fields</p>
</li>
<li>
<p>In the query results table, right-click on any cell in the <strong>content</strong> field and select <strong>Extract fields</strong>.</p>
</li>
<li>In DPL Architect, select <strong>Saved patterns</strong>.</li>
<li>In <strong>Dynatrace patterns</strong>, select <strong>k8s</strong> &gt; <strong>coredns-query</strong>.</li>
<li>Select <strong>Insert pattern</strong>.</li>
<li>
<p>Select <strong>Run</strong> to execute the query.</p>
</li>
<li>
<p>Filter results</p>
</li>
</ol>
<p>To view only records containing the DNS requests originating from your suspicious pod, select the <strong>source_ip</strong> column header, then select <strong>Filter for</strong> &gt; <strong>Suspicious pod</strong>.</p>
<p><img alt="Filter the source_ip field by the suspicious pod" src="https://dt-cdn.net/images/2024-03-07-09-52-47-539-9ece6d7f6f.png" /></p>
<ol>
<li>Extract domain name</li>
</ol>
<p>There could be quite a lot of DNS requests in the results table. For a better understanding of the resolved hostnames, you need to extract the domain name portion from the name field and summarize results based on it.</p>
<ol>
<li>In the query input, add the following snippet to the DQL query:</li>
</ol>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-67-1" name="__codelineno-67-1" href="#__codelineno-67-1"></a>| parse name, &quot;ld* &#39;.&#39;? ( (ld &#39;.&#39; ld):domain &#39;.&#39; eos)&quot;
<a id="__codelineno-67-2" name="__codelineno-67-2" href="#__codelineno-67-2"></a>
<a id="__codelineno-67-3" name="__codelineno-67-3" href="#__codelineno-67-3"></a>
<a id="__codelineno-67-4" name="__codelineno-67-4" href="#__codelineno-67-4"></a>
<a id="__codelineno-67-5" name="__codelineno-67-5" href="#__codelineno-67-5"></a>| summarize count = count(), by: {domain}
</code></pre></div>
2. Select <strong>Run</strong> to execute the query.</p>
<p>You notice that, besides internal or local domains, one suspicious domain (<code>tiitha-maliciousdomain.com</code>) is being resolved quite a lot!</p>
<p><img alt="suspicious domain identified" src="https://dt-cdn.net/images/2024-03-07-10-01-49-503-598f18f1d7.png" /></p>
<ol>
<li>
<p>Add domain as evidence</p>
</li>
<li>
<p>In the query results table, right-click on the suspicious domain name, then select <strong>Add to evidence list</strong> &gt; <strong>New evidence list</strong>.</p>
</li>
<li>Enter a name for your new evidence list, for example, <strong>Attacker domain</strong>.</li>
</ol>
<p><img alt="Add attacker domain as evidence" src="https://dt-cdn.net/images/2024-03-07-18-32-15-488-857db7fc3a.png" /></p>
<ol>
<li>
<p>Filter by attacker domain</p>
</li>
<li>
<p>In the query results table, select the cell with the suspicious domain, then select <strong>Filter for</strong> to add a filter to the query that fetches only requests that include the attacker domain.</p>
</li>
</ol>
<p><img alt="Filter for the malicious domain" src="https://dt-cdn.net/images/2024-03-07-10-17-10-1039-fc84720720.png" />
2. In the query input, remove the <code>summarize</code> command and select <strong>Run</strong> to execute the query.</p>
<p>It looks like there's some kind of data movement between the suspicious pod and the attacker domain. Looking at the query names and considering the number of queries, data appears to be extracted via DNS tunneling.</p>
<p><img alt="data is being extracted via DNS tunnelling" src="https://dt-cdn.net/images/2024-03-07-10-24-01-1450-8d1cdc2027.png" /></p>
<ol>
<li>Analyze DNS requests</li>
</ol>
<p>As there are thousands of DNS requests towards that particular domain, you may want to aggregate the data to determine how to proceed further.</p>
<ol>
<li>In the query results, select the <strong>type</strong> column header, then select <a href="/docs/secure/investigations/enhance-results#aggregate" title="Organize and interpret query outputs across investigations --- from performance analysis to threat detection."><strong>Summarize</strong></a>.</li>
<li>Select <strong>Run</strong> to execute the query.</li>
</ol>
<p><img alt="Summarize by type" src="https://dt-cdn.net/images/2024-03-07-10-40-41-399-c7c4bf8285.png" /></p>
<p>You notice many A, AAAA, and TXT requests from the pod. You start investigating the A requests.
3. In the query results table, right-click on an <strong>A</strong> cell and select <strong>Filter for</strong> to add a filter to the DQL query.
4. In the query input, remove the <code>summarize</code> command and select <strong>Run</strong> to execute the query.</p>
<p>To determine what is being sent out, you need to extract the subdomain portion of the domain. For this, you need to analyze one of the DNS queries that is resolving the attacker domain.
5. Double-click on any cell in the query results table.
6. In the <strong>Details (√¢¬Ä¬¶)</strong> window, check the data in the <strong>name</strong> field.</p>
<p>It seems that the DNS name is structured by an ID followed by the payload portion encoded in hex, and these parts are delimited by <code>.</code>.</p>
<p><img alt="Inspect the name" src="https://dt-cdn.net/images/2024-03-07-11-09-13-997-28d0d5a17a.png" />
7. To parse and decode the payload, add the following DQL snippet to the DQL query:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-68-1" name="__codelineno-68-1" href="#__codelineno-68-1"></a>| parse name, &quot;&quot;&quot;ld:id &#39;.&#39; ld:payload &#39;.tiitha-maliciousdomain&#39;&quot;&quot;&quot;
<a id="__codelineno-68-2" name="__codelineno-68-2" href="#__codelineno-68-2"></a>
<a id="__codelineno-68-3" name="__codelineno-68-3" href="#__codelineno-68-3"></a>
<a id="__codelineno-68-4" name="__codelineno-68-4" href="#__codelineno-68-4"></a>
<a id="__codelineno-68-5" name="__codelineno-68-5" href="#__codelineno-68-5"></a>| fieldsAdd payload=replaceString(payload,&quot;.&quot;,&quot;&quot;)
<a id="__codelineno-68-6" name="__codelineno-68-6" href="#__codelineno-68-6"></a>
<a id="__codelineno-68-7" name="__codelineno-68-7" href="#__codelineno-68-7"></a>
<a id="__codelineno-68-8" name="__codelineno-68-8" href="#__codelineno-68-8"></a>
<a id="__codelineno-68-9" name="__codelineno-68-9" href="#__codelineno-68-9"></a>| fields timestamp, id, payload=decodeBase16ToString(payload)
<a id="__codelineno-68-10" name="__codelineno-68-10" href="#__codelineno-68-10"></a>
<a id="__codelineno-68-11" name="__codelineno-68-11" href="#__codelineno-68-11"></a>
<a id="__codelineno-68-12" name="__codelineno-68-12" href="#__codelineno-68-12"></a>
<a id="__codelineno-68-13" name="__codelineno-68-13" href="#__codelineno-68-13"></a>| sort timestamp, id
</code></pre></div>
<p>The result proves that data from your pod is definitely being extracted and sent out!</p>
<p><img alt="data from pod is extracted and sent out" src="https://dt-cdn.net/images/2024-03-07-11-11-40-1106-e7433155ee.png" /></p>
<h2 id="investigation-path-4-find-out-how-the-commands-were-sent-to-the-pod">Investigation path 4: Find out how the commands were sent to the pod<a class="headerlink" href="#investigation-path-4-find-out-how-the-commands-were-sent-to-the-pod" title="Permanent link">&para;</a></h2>
<p>You know for sure the pod is sending information to an external DNS server, but you haven√¢¬Ä¬ôt figured out how it gets the commands. Since TXT-type DNS queries enable larger responses and are sometimes used for malicious transactions as well, you need to take a look at those requests. Since CoreDNS records don't contain the response payload, you turn to Route53 logs.</p>
<ol>
<li>
<p>Analyze TXT records</p>
</li>
<li>
<p>Using the query tree, navigate to the <a href="#fetch-k8s-logs">Fetch Kubernetes cluster audit logs</a> step.</p>
</li>
<li>In the query results, find the record with your Route53 log group (in our example, <code>/aws/route53/unguard-secla-demo/resolver-logs</code>) and add it as a filter to your DQL query.</li>
<li>In the query input, remove the <code>summarize</code> command and select <strong>Run</strong> to execute the query. This creates a fourth branch in the query tree.</li>
</ol>
<p><img alt="Analyze TXT records" src="https://dt-cdn.net/images/2024-03-07-18-55-59-1919-a0b7fff314.png" /></p>
<ol>
<li>
<p>Extract fields from log records</p>
</li>
<li>
<p>In the query results table, right-click on any cell in the <strong>content</strong> field and select <strong>Extract fields</strong>.</p>
</li>
<li>In DPL Architect, select <strong>Saved patterns</strong>.</li>
<li>In <strong>Dynatrace patterns</strong>, select <strong>aws</strong> &gt; <strong>route53-query</strong>.</li>
<li>You need to extract the <code>query_name</code>, <code>query_type</code>, <code>srcaddr</code>, and <code>answers</code> values from the log record. In the query input, you can replace the pattern as follows:</li>
</ol>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-69-1" name="__codelineno-69-1" href="#__codelineno-69-1"></a>json{
<a id="__codelineno-69-2" name="__codelineno-69-2" href="#__codelineno-69-2"></a>
<a id="__codelineno-69-3" name="__codelineno-69-3" href="#__codelineno-69-3"></a>
<a id="__codelineno-69-4" name="__codelineno-69-4" href="#__codelineno-69-4"></a>
<a id="__codelineno-69-5" name="__codelineno-69-5" href="#__codelineno-69-5"></a>string:query_name,
<a id="__codelineno-69-6" name="__codelineno-69-6" href="#__codelineno-69-6"></a>
<a id="__codelineno-69-7" name="__codelineno-69-7" href="#__codelineno-69-7"></a>
<a id="__codelineno-69-8" name="__codelineno-69-8" href="#__codelineno-69-8"></a>
<a id="__codelineno-69-9" name="__codelineno-69-9" href="#__codelineno-69-9"></a>string:query_type,
<a id="__codelineno-69-10" name="__codelineno-69-10" href="#__codelineno-69-10"></a>
<a id="__codelineno-69-11" name="__codelineno-69-11" href="#__codelineno-69-11"></a>
<a id="__codelineno-69-12" name="__codelineno-69-12" href="#__codelineno-69-12"></a>
<a id="__codelineno-69-13" name="__codelineno-69-13" href="#__codelineno-69-13"></a>json_array:answers,
<a id="__codelineno-69-14" name="__codelineno-69-14" href="#__codelineno-69-14"></a>
<a id="__codelineno-69-15" name="__codelineno-69-15" href="#__codelineno-69-15"></a>
<a id="__codelineno-69-16" name="__codelineno-69-16" href="#__codelineno-69-16"></a>
<a id="__codelineno-69-17" name="__codelineno-69-17" href="#__codelineno-69-17"></a>ipaddr:srcaddr
<a id="__codelineno-69-18" name="__codelineno-69-18" href="#__codelineno-69-18"></a>
<a id="__codelineno-69-19" name="__codelineno-69-19" href="#__codelineno-69-19"></a>
<a id="__codelineno-69-20" name="__codelineno-69-20" href="#__codelineno-69-20"></a>
<a id="__codelineno-69-21" name="__codelineno-69-21" href="#__codelineno-69-21"></a>}(flat=true)
</code></pre></div>
5. Select <strong>Insert pattern</strong>.
6. Select <strong>Run</strong> to execute the query.</p>
<ol>
<li>
<p>Filter data</p>
</li>
<li>
<p>In the query results, select the <code>query_name</code> column header, then select <strong>Filter for</strong> &gt; <strong>Attacker domain</strong>.</p>
</li>
<li>Select <strong>Run</strong> to execute the query.</li>
</ol>
<p>You only care about the queries with the TXT type, so you can append the filter with the appropriate expression. Since the answers portion is an array, expand the field so that each value in the array is a separate record. The only fields you need are <code>srcaddr</code>, <code>query_name</code>, and the <code>Rdata</code> element from the answer object.
3. In the query input, modify the <code>filter</code> command by adding the following snippet:</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-70-1" name="__codelineno-70-1" href="#__codelineno-70-1"></a>| filter endsWith(query_name, &quot;tiitha-maliciousdomain.com.&quot;) and query_type == &quot;TXT&quot;
<a id="__codelineno-70-2" name="__codelineno-70-2" href="#__codelineno-70-2"></a>
<a id="__codelineno-70-3" name="__codelineno-70-3" href="#__codelineno-70-3"></a>
<a id="__codelineno-70-4" name="__codelineno-70-4" href="#__codelineno-70-4"></a>
<a id="__codelineno-70-5" name="__codelineno-70-5" href="#__codelineno-70-5"></a>| expand answers
<a id="__codelineno-70-6" name="__codelineno-70-6" href="#__codelineno-70-6"></a>
<a id="__codelineno-70-7" name="__codelineno-70-7" href="#__codelineno-70-7"></a>
<a id="__codelineno-70-8" name="__codelineno-70-8" href="#__codelineno-70-8"></a>
<a id="__codelineno-70-9" name="__codelineno-70-9" href="#__codelineno-70-9"></a>| fields srcaddr, uery_name, answer=answers[Rdata]
</code></pre></div>
4. Select <strong>Run</strong> to execute the query.</p>
<p>Your hypothesis is correct: the TXT DNS queries were used to fetch the commands. The executed commands (including the Kubernetes control plane requests as curl commands) show up as responses in your DNS logs!</p>
<p><img alt="Correct hypothesis: TXT DNS queries were used to fetch the commands" src="https://dt-cdn.net/images/2024-03-07-19-02-39-1919-08659833f4.png" /></p>
<h2 id="conclusion_1">Conclusion<a class="headerlink" href="#conclusion_1" title="Permanent link">&para;</a></h2>
<p>You've found out what happened but haven't figured out what else the pod has done, what process or activity is triggering the DNS requests, who controls the data extraction, how and when the pod was infected, and other relevant aspects of a security incident.</p>
<p>From here on, the complexity of the investigation will only grow, and the ability to navigate between different stages of an investigation is even more crucial. All these questions might trigger a new branch in the query tree, if not a separate investigation. Our investigation introduces many additional questions that require answers.</p>
<h2 id="related-topics_4">Related topics<a class="headerlink" href="#related-topics_4" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="/docs/secure/use-cases/analyze-aws-cloudtrail-logs-with-security-investigator" title="Analyze CloudTrail logs and find potential security issues with Dynatrace.">Analyze AWS CloudTrail logs with Investigations</a></li>
<li><a href="/docs/secure/use-cases/analyze-aws-api-gateway-access-logs-with-security-investigator" title="Monitor and identify errors in your Amazon API Gateway access logs with Dynatrace.">Analyze Amazon API Gateway access logs with Investigations</a></li>
<li><a href="/docs/secure/use-cases/detect-threats-against-aws-secrets-with-security-investigator" title="Monitor and identify potential threats against your AWS Secrets with Dynatrace.">Detect threats against your AWS Secrets with Investigations</a></li>
<li><a href="/docs/secure/use-cases/resolve-incidents-faster-with-templates" title="Speed up your log-related investigations with Investigations templates.">Resolve incidents faster with Investigations templates</a></li>
<li><a href="/docs/secure/use-cases/operationalize-query-results" title="Build DQL queries from your query results faster and more conveniently with Dynatrace Investigations.">Operationalize DQL query results with Investigations</a></li>
</ul>
<hr />
<h2 id="source-visualize-and-analyze-security-findingsmd">Source: visualize-and-analyze-security-findings.md<a class="headerlink" href="#source-visualize-and-analyze-security-findingsmd" title="Permanent link">&para;</a></h2>
<hr />
<p>title: Visualize and analyze security findings
source: https://www.dynatrace.com/docs/secure/use-cases/visualize-and-analyze-security-findings
scraped: 2026-02-16T21:21:56.163251</p>
<hr />
<h1 id="visualize-and-analyze-security-findings">Visualize and analyze security findings<a class="headerlink" href="#visualize-and-analyze-security-findings" title="Permanent link">&para;</a></h1>
<h1 id="visualize-and-analyze-security-findings_1">Visualize and analyze security findings<a class="headerlink" href="#visualize-and-analyze-security-findings_1" title="Permanent link">&para;</a></h1>
<ul>
<li>Latest Dynatrace</li>
<li>Tutorial</li>
<li>Updated on Oct 07, 2025</li>
</ul>
<p>Organizations use multiple security products and tools that generate security findings in various data formats. Accessing the data in a siloed approach makes the life of security analysts hard, as they must spend a lot of manual effort generating a combined security posture picture.</p>
<p>In this context, you can</p>
<ul>
<li>Ingest security findings from your security tools (see <a href="/docs/secure/threat-observability/security-events-ingest" title="Ingest external security data into Grail.">Security integrations</a>) or vulnerability finding events from Dynatrace-monitored processes (see <a href="/docs/secure/vulnerabilities/concepts#tpv-events" title="Concepts that are specific to the Dynatrace Vulnerabilities app.">Third-party library events</a>) and map them to the <a href="https://dt-url.net/3q03pb0">Dynatrace Semantic Dictionary√Ø¬ª¬ø</a>, which makes events from different tools uniformly accessible with DQL.</li>
<li>View and analyze security findings across products and tools with our dashboards, which can also be a good foundation for tailoring further visual customization to meet your organization's posture analysis and reporting requirements.</li>
<li><a href="/docs/platform/grail/dynatrace-query-language" title="How to use Dynatrace Query Language.">Query</a> ingested data in our dedicated apps.</li>
</ul>
<h2 id="target-audience_14">Target audience<a class="headerlink" href="#target-audience_14" title="Permanent link">&para;</a></h2>
<p>Security analysts and managers responsible for analyzing and reporting the organization's security posture.</p>
<p>Key use cases include:</p>
<ul>
<li>Gaining a unified view of all the security findings</li>
<li>Prioritizing security findings across products</li>
<li>Identifying top affected assets</li>
</ul>
<h2 id="prerequisites_15">Prerequisites<a class="headerlink" href="#prerequisites_15" title="Permanent link">&para;</a></h2>
<p>Depending on the ingestion source, follow the appropriate setup:</p>
<ul>
<li><strong>Third-party security products</strong>: <a href="/docs/secure/threat-observability/security-events-ingest" title="Ingest external security data into Grail.">Set up a supported integration</a>.</li>
<li><strong>Dynatrace-monitored environments</strong>: <a href="/docs/secure/application-security/vulnerability-analytics#tpv-detection" title="Monitor, visualize, analyze, and remediate third-party and code-level vulnerabilities, track the remediation progress, and create monitoring rules.">Enable third-party vulnerability detection</a> to ingest vulnerability finding events from third-party libraries.</li>
</ul>
<h2 id="get-started_12">Get started<a class="headerlink" href="#get-started_12" title="Permanent link">&para;</a></h2>
<ol>
<li>
<p>Visualize</p>
</li>
<li>
<p>Open <a href="/docs/analyze-explore-automate/dashboards-and-notebooks/dashboards-new" title="Create interactive, customizable views to visualize, analyze, and share your observability data in real time."><img alt="Dashboards" src="https://dt-cdn.net/images/dashboards-512-b1f1e9690b.png" title="Dashboards" /> <strong>Dashboards</strong></a> and go to <strong>Ready-made</strong>.</p>
</li>
</ol>
<p>Ready-made dashboards are available for third-party tool integrations. Vulnerability finding events from Dynatrace-monitored environments are accessible via DQL but aren't currently included in those dashboards.
2. Search for and select <strong>Security findings</strong> for the desired integration.</p>
<p>Example result:</p>
<p><img alt="dashboard sample result" src="https://dt-cdn.net/images/2025-05-07-15-06-056-1903-93aa46287c.png" /></p>
<ol>
<li>Analyze</li>
</ol>
<p>Open <a href="/docs/analyze-explore-automate/dashboards-and-notebooks/notebooks" title="Analyze, visualize, and share insights from your observability data√¢¬Ä¬îall in one collaborative, customizable workspace."><img alt="Notebooks" src="https://dt-cdn.net/images/notebooks-768-046137830a.webp" title="Notebooks" /> <strong>Notebooks</strong></a> or <a href="/docs/secure/investigations" title="Combine Grail functionalities for evidence-driven investigations, including incident resolution, root cause analysis, and threat hunting."><img alt="Investigations" src="https://dt-cdn.net/images/security-investigator-256-93f6c187d9.png" title="Investigations" /> <strong>Investigations</strong></a> to <a href="/docs/platform/grail/dynatrace-query-language" title="How to use Dynatrace Query Language.">query</a> ingested data, using the data format in <a href="https://dt-url.net/3q03pb0">Semantic Dictionary√Ø¬ª¬ø</a>.</p>
<p>For a better understanding of how to build your queries, see <a href="/docs/secure/threat-observability/dql-examples#ingested" title="DQL examples for security data powered by Grail.">DQL query examples for ingested events</a>.</p>
<hr />












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  –ö –Ω–∞—á–∞–ª—É
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      ¬© 2026 Dynatrace Managed Docs
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/Yerkebulan-Ardabayev" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.expand", "navigation.top", "navigation.instant", "search.suggest", "search.highlight", "content.code.copy", "toc.follow"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "\u0421\u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u043e \u0432 \u0431\u0443\u0444\u0435\u0440", "clipboard.copy": "\u041a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0432 \u0431\u0443\u0444\u0435\u0440", "search.result.more.one": "\u0415\u0449\u0451 1 \u043d\u0430 \u044d\u0442\u043e\u0439 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0435", "search.result.more.other": "\u0415\u0449\u0451 # \u043d\u0430 \u044d\u0442\u043e\u0439 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0435", "search.result.none": "\u0421\u043e\u0432\u043f\u0430\u0434\u0435\u043d\u0438\u0439 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e", "search.result.one": "\u041d\u0430\u0439\u0434\u0435\u043d\u043e 1 \u0441\u043e\u0432\u043f\u0430\u0434\u0435\u043d\u0438\u0435", "search.result.other": "\u041d\u0430\u0439\u0434\u0435\u043d\u043e \u0441\u043e\u0432\u043f\u0430\u0434\u0435\u043d\u0438\u0439: #", "search.result.placeholder": "\u041d\u0430\u0447\u043d\u0438\u0442\u0435 \u043f\u0435\u0447\u0430\u0442\u0430\u0442\u044c \u0434\u043b\u044f \u043f\u043e\u0438\u0441\u043a\u0430", "search.result.term.missing": "\u041e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u0435\u0442", "select.version": "\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0432\u0435\u0440\u0441\u0438\u044e"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="../../assets/javascripts/groq-chat.js"></script>
      
    
  </body>
</html>